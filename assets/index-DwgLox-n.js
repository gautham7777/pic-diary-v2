(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function cC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var gv={exports:{}},gu={},yv={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zs=Symbol.for("react.element"),dC=Symbol.for("react.portal"),fC=Symbol.for("react.fragment"),hC=Symbol.for("react.strict_mode"),pC=Symbol.for("react.profiler"),mC=Symbol.for("react.provider"),gC=Symbol.for("react.context"),yC=Symbol.for("react.forward_ref"),_C=Symbol.for("react.suspense"),vC=Symbol.for("react.memo"),TC=Symbol.for("react.lazy"),Dm=Symbol.iterator;function EC(n){return n===null||typeof n!="object"?null:(n=Dm&&n[Dm]||n["@@iterator"],typeof n=="function"?n:null)}var _v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vv=Object.assign,Tv={};function ho(n,e,t){this.props=n,this.context=e,this.refs=Tv,this.updater=t||_v}ho.prototype.isReactComponent={};ho.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};ho.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Ev(){}Ev.prototype=ho.prototype;function bf(n,e,t){this.props=n,this.context=e,this.refs=Tv,this.updater=t||_v}var Uf=bf.prototype=new Ev;Uf.constructor=bf;vv(Uf,ho.prototype);Uf.isPureReactComponent=!0;var Nm=Array.isArray,Iv=Object.prototype.hasOwnProperty,Of={current:null},wv={key:!0,ref:!0,__self:!0,__source:!0};function Cv(n,e,t){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Iv.call(e,r)&&!wv.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Zs,type:n,key:o,ref:s,props:i,_owner:Of.current}}function IC(n,e){return{$$typeof:Zs,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Bf(n){return typeof n=="object"&&n!==null&&n.$$typeof===Zs}function wC(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var km=/\/+/g;function wc(n,e){return typeof n=="object"&&n!==null&&n.key!=null?wC(""+n.key):e.toString(36)}function al(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case Zs:case dC:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+wc(s,0):r,Nm(i)?(t="",n!=null&&(t=n.replace(km,"$&/")+"/"),al(i,e,t,"",function(c){return c})):i!=null&&(Bf(i)&&(i=IC(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(km,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Nm(n))for(var a=0;a<n.length;a++){o=n[a];var l=r+wc(o,a);s+=al(o,e,t,l,i)}else if(l=EC(n),typeof l=="function")for(n=l.call(n),a=0;!(o=n.next()).done;)o=o.value,l=r+wc(o,a++),s+=al(o,e,t,l,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Va(n,e,t){if(n==null)return n;var r=[],i=0;return al(n,r,"","",function(o){return e.call(t,o,i++)}),r}function CC(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var vt={current:null},ll={transition:null},SC={ReactCurrentDispatcher:vt,ReactCurrentBatchConfig:ll,ReactCurrentOwner:Of};function Sv(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:Va,forEach:function(n,e,t){Va(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Va(n,function(){e++}),e},toArray:function(n){return Va(n,function(e){return e})||[]},only:function(n){if(!Bf(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};re.Component=ho;re.Fragment=fC;re.Profiler=pC;re.PureComponent=bf;re.StrictMode=hC;re.Suspense=_C;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=SC;re.act=Sv;re.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=vv({},n.props),i=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Of.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)Iv.call(e,l)&&!wv.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Zs,type:n.type,key:i,ref:o,props:r,_owner:s}};re.createContext=function(n){return n={$$typeof:gC,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:mC,_context:n},n.Consumer=n};re.createElement=Cv;re.createFactory=function(n){var e=Cv.bind(null,n);return e.type=n,e};re.createRef=function(){return{current:null}};re.forwardRef=function(n){return{$$typeof:yC,render:n}};re.isValidElement=Bf;re.lazy=function(n){return{$$typeof:TC,_payload:{_status:-1,_result:n},_init:CC}};re.memo=function(n,e){return{$$typeof:vC,type:n,compare:e===void 0?null:e}};re.startTransition=function(n){var e=ll.transition;ll.transition={};try{n()}finally{ll.transition=e}};re.unstable_act=Sv;re.useCallback=function(n,e){return vt.current.useCallback(n,e)};re.useContext=function(n){return vt.current.useContext(n)};re.useDebugValue=function(){};re.useDeferredValue=function(n){return vt.current.useDeferredValue(n)};re.useEffect=function(n,e){return vt.current.useEffect(n,e)};re.useId=function(){return vt.current.useId()};re.useImperativeHandle=function(n,e,t){return vt.current.useImperativeHandle(n,e,t)};re.useInsertionEffect=function(n,e){return vt.current.useInsertionEffect(n,e)};re.useLayoutEffect=function(n,e){return vt.current.useLayoutEffect(n,e)};re.useMemo=function(n,e){return vt.current.useMemo(n,e)};re.useReducer=function(n,e,t){return vt.current.useReducer(n,e,t)};re.useRef=function(n){return vt.current.useRef(n)};re.useState=function(n){return vt.current.useState(n)};re.useSyncExternalStore=function(n,e,t){return vt.current.useSyncExternalStore(n,e,t)};re.useTransition=function(){return vt.current.useTransition()};re.version="18.3.1";yv.exports=re;var oe=yv.exports;const AC=cC(oe);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RC=oe,xC=Symbol.for("react.element"),PC=Symbol.for("react.fragment"),DC=Object.prototype.hasOwnProperty,NC=RC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kC={key:!0,ref:!0,__self:!0,__source:!0};function Av(n,e,t){var r,i={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)DC.call(e,r)&&!kC.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:xC,type:n,key:o,ref:s,props:i,_owner:NC.current}}gu.Fragment=PC;gu.jsx=Av;gu.jsxs=Av;gv.exports=gu;var b=gv.exports,sd={},Rv={exports:{}},Ut={},xv={exports:{}},Pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(H,Z){var te=H.length;H.push(Z);e:for(;0<te;){var Ae=te-1>>>1,me=H[Ae];if(0<i(me,Z))H[Ae]=Z,H[te]=me,te=Ae;else break e}}function t(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var Z=H[0],te=H.pop();if(te!==Z){H[0]=te;e:for(var Ae=0,me=H.length,Fe=me>>>1;Ae<Fe;){var mn=2*(Ae+1)-1,gn=H[mn],yn=mn+1,_n=H[yn];if(0>i(gn,te))yn<me&&0>i(_n,gn)?(H[Ae]=_n,H[yn]=te,Ae=yn):(H[Ae]=gn,H[mn]=te,Ae=mn);else if(yn<me&&0>i(_n,te))H[Ae]=_n,H[yn]=te,Ae=yn;else break e}}return Z}function i(H,Z){var te=H.sortIndex-Z.sortIndex;return te!==0?te:H.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var l=[],c=[],h=1,m=null,g=3,_=!1,I=!1,x=!1,k=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(H){for(var Z=t(c);Z!==null;){if(Z.callback===null)r(c);else if(Z.startTime<=H)r(c),Z.sortIndex=Z.expirationTime,e(l,Z);else break;Z=t(c)}}function N(H){if(x=!1,S(H),!I)if(t(l)!==null)I=!0,Eo(O);else{var Z=t(c);Z!==null&&pn(N,Z.startTime-H)}}function O(H,Z){I=!1,x&&(x=!1,w(v),v=-1),_=!0;var te=g;try{for(S(Z),m=t(l);m!==null&&(!(m.expirationTime>Z)||H&&!D());){var Ae=m.callback;if(typeof Ae=="function"){m.callback=null,g=m.priorityLevel;var me=Ae(m.expirationTime<=Z);Z=n.unstable_now(),typeof me=="function"?m.callback=me:m===t(l)&&r(l),S(Z)}else r(l);m=t(l)}if(m!==null)var Fe=!0;else{var mn=t(c);mn!==null&&pn(N,mn.startTime-Z),Fe=!1}return Fe}finally{m=null,g=te,_=!1}}var B=!1,C=null,v=-1,A=5,R=-1;function D(){return!(n.unstable_now()-R<A)}function V(){if(C!==null){var H=n.unstable_now();R=H;var Z=!0;try{Z=C(!0,H)}finally{Z?P():(B=!1,C=null)}}else B=!1}var P;if(typeof E=="function")P=function(){E(V)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,Qt=de.port2;de.port1.onmessage=V,P=function(){Qt.postMessage(null)}}else P=function(){k(V,0)};function Eo(H){C=H,B||(B=!0,P())}function pn(H,Z){v=k(function(){H(n.unstable_now())},Z)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(H){H.callback=null},n.unstable_continueExecution=function(){I||_||(I=!0,Eo(O))},n.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<H?Math.floor(1e3/H):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(H){switch(g){case 1:case 2:case 3:var Z=3;break;default:Z=g}var te=g;g=Z;try{return H()}finally{g=te}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(H,Z){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var te=g;g=H;try{return Z()}finally{g=te}},n.unstable_scheduleCallback=function(H,Z,te){var Ae=n.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Ae+te:Ae):te=Ae,H){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=te+me,H={id:h++,callback:Z,priorityLevel:H,startTime:te,expirationTime:me,sortIndex:-1},te>Ae?(H.sortIndex=te,e(c,H),t(l)===null&&H===t(c)&&(x?(w(v),v=-1):x=!0,pn(N,te-Ae))):(H.sortIndex=me,e(l,H),I||_||(I=!0,Eo(O))),H},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(H){var Z=g;return function(){var te=g;g=Z;try{return H.apply(this,arguments)}finally{g=te}}}})(Pv);xv.exports=Pv;var VC=xv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MC=oe,Ft=VC;function z(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dv=new Set,Ts={};function ai(n,e){Qi(n,e),Qi(n+"Capture",e)}function Qi(n,e){for(Ts[n]=e,n=0;n<e.length;n++)Dv.add(e[n])}var xn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ad=Object.prototype.hasOwnProperty,LC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Vm={},Mm={};function FC(n){return ad.call(Mm,n)?!0:ad.call(Vm,n)?!1:LC.test(n)?Mm[n]=!0:(Vm[n]=!0,!1)}function bC(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function UC(n,e,t,r){if(e===null||typeof e>"u"||bC(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Tt(n,e,t,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){tt[n]=new Tt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];tt[e]=new Tt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){tt[n]=new Tt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){tt[n]=new Tt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){tt[n]=new Tt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){tt[n]=new Tt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){tt[n]=new Tt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){tt[n]=new Tt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){tt[n]=new Tt(n,5,!1,n.toLowerCase(),null,!1,!1)});var qf=/[\-:]([a-z])/g;function zf(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(qf,zf);tt[e]=new Tt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(qf,zf);tt[e]=new Tt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(qf,zf);tt[e]=new Tt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){tt[n]=new Tt(n,1,!1,n.toLowerCase(),null,!1,!1)});tt.xlinkHref=new Tt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){tt[n]=new Tt(n,1,!1,n.toLowerCase(),null,!0,!0)});function Gf(n,e,t,r){var i=tt.hasOwnProperty(e)?tt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(UC(e,t,i,r)&&(t=null),r||i===null?FC(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Ln=MC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ma=Symbol.for("react.element"),Pi=Symbol.for("react.portal"),Di=Symbol.for("react.fragment"),$f=Symbol.for("react.strict_mode"),ld=Symbol.for("react.profiler"),Nv=Symbol.for("react.provider"),kv=Symbol.for("react.context"),Kf=Symbol.for("react.forward_ref"),ud=Symbol.for("react.suspense"),cd=Symbol.for("react.suspense_list"),Hf=Symbol.for("react.memo"),Gn=Symbol.for("react.lazy"),Vv=Symbol.for("react.offscreen"),Lm=Symbol.iterator;function Lo(n){return n===null||typeof n!="object"?null:(n=Lm&&n[Lm]||n["@@iterator"],typeof n=="function"?n:null)}var Ne=Object.assign,Cc;function Jo(n){if(Cc===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Cc=e&&e[1]||""}return`
`+Cc+n}var Sc=!1;function Ac(n,e){if(!n||Sc)return"";Sc=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=a);break}}}finally{Sc=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Jo(n):""}function OC(n){switch(n.tag){case 5:return Jo(n.type);case 16:return Jo("Lazy");case 13:return Jo("Suspense");case 19:return Jo("SuspenseList");case 0:case 2:case 15:return n=Ac(n.type,!1),n;case 11:return n=Ac(n.type.render,!1),n;case 1:return n=Ac(n.type,!0),n;default:return""}}function dd(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Di:return"Fragment";case Pi:return"Portal";case ld:return"Profiler";case $f:return"StrictMode";case ud:return"Suspense";case cd:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case kv:return(n.displayName||"Context")+".Consumer";case Nv:return(n._context.displayName||"Context")+".Provider";case Kf:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Hf:return e=n.displayName||null,e!==null?e:dd(n.type)||"Memo";case Gn:e=n._payload,n=n._init;try{return dd(n(e))}catch{}}return null}function BC(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dd(e);case 8:return e===$f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function dr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Mv(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qC(n){var e=Mv(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function La(n){n._valueTracker||(n._valueTracker=qC(n))}function Lv(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=Mv(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Dl(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function fd(n,e){var t=e.checked;return Ne({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function Fm(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=dr(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Fv(n,e){e=e.checked,e!=null&&Gf(n,"checked",e,!1)}function hd(n,e){Fv(n,e);var t=dr(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?pd(n,e.type,t):e.hasOwnProperty("defaultValue")&&pd(n,e.type,dr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function bm(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function pd(n,e,t){(e!=="number"||Dl(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Xo=Array.isArray;function qi(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+dr(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function md(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(z(91));return Ne({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Um(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(z(92));if(Xo(t)){if(1<t.length)throw Error(z(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:dr(t)}}function bv(n,e){var t=dr(e.value),r=dr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function Om(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function Uv(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gd(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?Uv(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Fa,Ov=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Fa=Fa||document.createElement("div"),Fa.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fa.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Es(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var os={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},zC=["Webkit","ms","Moz","O"];Object.keys(os).forEach(function(n){zC.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),os[e]=os[n]})});function Bv(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||os.hasOwnProperty(n)&&os[n]?(""+e).trim():e+"px"}function qv(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=Bv(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var GC=Ne({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yd(n,e){if(e){if(GC[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(z(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(z(62))}}function _d(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vd=null;function Wf(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Td=null,zi=null,Gi=null;function Bm(n){if(n=na(n)){if(typeof Td!="function")throw Error(z(280));var e=n.stateNode;e&&(e=Eu(e),Td(n.stateNode,n.type,e))}}function zv(n){zi?Gi?Gi.push(n):Gi=[n]:zi=n}function Gv(){if(zi){var n=zi,e=Gi;if(Gi=zi=null,Bm(n),e)for(n=0;n<e.length;n++)Bm(e[n])}}function $v(n,e){return n(e)}function Kv(){}var Rc=!1;function Hv(n,e,t){if(Rc)return n(e,t);Rc=!0;try{return $v(n,e,t)}finally{Rc=!1,(zi!==null||Gi!==null)&&(Kv(),Gv())}}function Is(n,e){var t=n.stateNode;if(t===null)return null;var r=Eu(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(z(231,e,typeof t));return t}var Ed=!1;if(xn)try{var Fo={};Object.defineProperty(Fo,"passive",{get:function(){Ed=!0}}),window.addEventListener("test",Fo,Fo),window.removeEventListener("test",Fo,Fo)}catch{Ed=!1}function $C(n,e,t,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(h){this.onError(h)}}var ss=!1,Nl=null,kl=!1,Id=null,KC={onError:function(n){ss=!0,Nl=n}};function HC(n,e,t,r,i,o,s,a,l){ss=!1,Nl=null,$C.apply(KC,arguments)}function WC(n,e,t,r,i,o,s,a,l){if(HC.apply(this,arguments),ss){if(ss){var c=Nl;ss=!1,Nl=null}else throw Error(z(198));kl||(kl=!0,Id=c)}}function li(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function Wv(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function qm(n){if(li(n)!==n)throw Error(z(188))}function QC(n){var e=n.alternate;if(!e){if(e=li(n),e===null)throw Error(z(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return qm(i),n;if(o===r)return qm(i),e;o=o.sibling}throw Error(z(188))}if(t.return!==r.return)t=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===t){s=!0,t=i,r=o;break}if(a===r){s=!0,r=i,t=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===t){s=!0,t=o,r=i;break}if(a===r){s=!0,r=o,t=i;break}a=a.sibling}if(!s)throw Error(z(189))}}if(t.alternate!==r)throw Error(z(190))}if(t.tag!==3)throw Error(z(188));return t.stateNode.current===t?n:e}function Qv(n){return n=QC(n),n!==null?Yv(n):null}function Yv(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=Yv(n);if(e!==null)return e;n=n.sibling}return null}var Jv=Ft.unstable_scheduleCallback,zm=Ft.unstable_cancelCallback,YC=Ft.unstable_shouldYield,JC=Ft.unstable_requestPaint,be=Ft.unstable_now,XC=Ft.unstable_getCurrentPriorityLevel,Qf=Ft.unstable_ImmediatePriority,Xv=Ft.unstable_UserBlockingPriority,Vl=Ft.unstable_NormalPriority,jC=Ft.unstable_LowPriority,jv=Ft.unstable_IdlePriority,yu=null,cn=null;function ZC(n){if(cn&&typeof cn.onCommitFiberRoot=="function")try{cn.onCommitFiberRoot(yu,n,void 0,(n.current.flags&128)===128)}catch{}}var en=Math.clz32?Math.clz32:nS,eS=Math.log,tS=Math.LN2;function nS(n){return n>>>=0,n===0?32:31-(eS(n)/tS|0)|0}var ba=64,Ua=4194304;function jo(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ml(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var a=s&~i;a!==0?r=jo(a):(o&=s,o!==0&&(r=jo(o)))}else s=t&~i,s!==0?r=jo(s):o!==0&&(r=jo(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-en(e),i=1<<t,r|=n[t],e&=~i;return r}function rS(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iS(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-en(o),a=1<<s,l=i[s];l===-1?(!(a&t)||a&r)&&(i[s]=rS(a,e)):l<=e&&(n.expiredLanes|=a),o&=~a}}function wd(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function Zv(){var n=ba;return ba<<=1,!(ba&4194240)&&(ba=64),n}function xc(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ea(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-en(e),n[e]=t}function oS(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-en(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function Yf(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-en(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var he=0;function eT(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var tT,Jf,nT,rT,iT,Cd=!1,Oa=[],jn=null,Zn=null,er=null,ws=new Map,Cs=new Map,Kn=[],sS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Gm(n,e){switch(n){case"focusin":case"focusout":jn=null;break;case"dragenter":case"dragleave":Zn=null;break;case"mouseover":case"mouseout":er=null;break;case"pointerover":case"pointerout":ws.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cs.delete(e.pointerId)}}function bo(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=na(e),e!==null&&Jf(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function aS(n,e,t,r,i){switch(e){case"focusin":return jn=bo(jn,n,e,t,r,i),!0;case"dragenter":return Zn=bo(Zn,n,e,t,r,i),!0;case"mouseover":return er=bo(er,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return ws.set(o,bo(ws.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Cs.set(o,bo(Cs.get(o)||null,n,e,t,r,i)),!0}return!1}function oT(n){var e=Ur(n.target);if(e!==null){var t=li(e);if(t!==null){if(e=t.tag,e===13){if(e=Wv(t),e!==null){n.blockedOn=e,iT(n.priority,function(){nT(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ul(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Sd(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);vd=r,t.target.dispatchEvent(r),vd=null}else return e=na(t),e!==null&&Jf(e),n.blockedOn=t,!1;e.shift()}return!0}function $m(n,e,t){ul(n)&&t.delete(e)}function lS(){Cd=!1,jn!==null&&ul(jn)&&(jn=null),Zn!==null&&ul(Zn)&&(Zn=null),er!==null&&ul(er)&&(er=null),ws.forEach($m),Cs.forEach($m)}function Uo(n,e){n.blockedOn===e&&(n.blockedOn=null,Cd||(Cd=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,lS)))}function Ss(n){function e(i){return Uo(i,n)}if(0<Oa.length){Uo(Oa[0],n);for(var t=1;t<Oa.length;t++){var r=Oa[t];r.blockedOn===n&&(r.blockedOn=null)}}for(jn!==null&&Uo(jn,n),Zn!==null&&Uo(Zn,n),er!==null&&Uo(er,n),ws.forEach(e),Cs.forEach(e),t=0;t<Kn.length;t++)r=Kn[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Kn.length&&(t=Kn[0],t.blockedOn===null);)oT(t),t.blockedOn===null&&Kn.shift()}var $i=Ln.ReactCurrentBatchConfig,Ll=!0;function uS(n,e,t,r){var i=he,o=$i.transition;$i.transition=null;try{he=1,Xf(n,e,t,r)}finally{he=i,$i.transition=o}}function cS(n,e,t,r){var i=he,o=$i.transition;$i.transition=null;try{he=4,Xf(n,e,t,r)}finally{he=i,$i.transition=o}}function Xf(n,e,t,r){if(Ll){var i=Sd(n,e,t,r);if(i===null)Uc(n,e,r,Fl,t),Gm(n,r);else if(aS(i,n,e,t,r))r.stopPropagation();else if(Gm(n,r),e&4&&-1<sS.indexOf(n)){for(;i!==null;){var o=na(i);if(o!==null&&tT(o),o=Sd(n,e,t,r),o===null&&Uc(n,e,r,Fl,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else Uc(n,e,r,null,t)}}var Fl=null;function Sd(n,e,t,r){if(Fl=null,n=Wf(r),n=Ur(n),n!==null)if(e=li(n),e===null)n=null;else if(t=e.tag,t===13){if(n=Wv(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Fl=n,null}function sT(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(XC()){case Qf:return 1;case Xv:return 4;case Vl:case jC:return 16;case jv:return 536870912;default:return 16}default:return 16}}var Yn=null,jf=null,cl=null;function aT(){if(cl)return cl;var n,e=jf,t=e.length,r,i="value"in Yn?Yn.value:Yn.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[o-r];r++);return cl=i.slice(n,1<r?1-r:void 0)}function dl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ba(){return!0}function Km(){return!1}function Ot(n){function e(t,r,i,o,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ba:Km,this.isPropagationStopped=Km,this}return Ne(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),e}var po={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zf=Ot(po),ta=Ne({},po,{view:0,detail:0}),dS=Ot(ta),Pc,Dc,Oo,_u=Ne({},ta,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:eh,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Oo&&(Oo&&n.type==="mousemove"?(Pc=n.screenX-Oo.screenX,Dc=n.screenY-Oo.screenY):Dc=Pc=0,Oo=n),Pc)},movementY:function(n){return"movementY"in n?n.movementY:Dc}}),Hm=Ot(_u),fS=Ne({},_u,{dataTransfer:0}),hS=Ot(fS),pS=Ne({},ta,{relatedTarget:0}),Nc=Ot(pS),mS=Ne({},po,{animationName:0,elapsedTime:0,pseudoElement:0}),gS=Ot(mS),yS=Ne({},po,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),_S=Ot(yS),vS=Ne({},po,{data:0}),Wm=Ot(vS),TS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ES={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},IS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wS(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=IS[n])?!!e[n]:!1}function eh(){return wS}var CS=Ne({},ta,{key:function(n){if(n.key){var e=TS[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=dl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ES[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:eh,charCode:function(n){return n.type==="keypress"?dl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?dl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),SS=Ot(CS),AS=Ne({},_u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qm=Ot(AS),RS=Ne({},ta,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:eh}),xS=Ot(RS),PS=Ne({},po,{propertyName:0,elapsedTime:0,pseudoElement:0}),DS=Ot(PS),NS=Ne({},_u,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kS=Ot(NS),VS=[9,13,27,32],th=xn&&"CompositionEvent"in window,as=null;xn&&"documentMode"in document&&(as=document.documentMode);var MS=xn&&"TextEvent"in window&&!as,lT=xn&&(!th||as&&8<as&&11>=as),Ym=" ",Jm=!1;function uT(n,e){switch(n){case"keyup":return VS.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Ni=!1;function LS(n,e){switch(n){case"compositionend":return cT(e);case"keypress":return e.which!==32?null:(Jm=!0,Ym);case"textInput":return n=e.data,n===Ym&&Jm?null:n;default:return null}}function FS(n,e){if(Ni)return n==="compositionend"||!th&&uT(n,e)?(n=aT(),cl=jf=Yn=null,Ni=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lT&&e.locale!=="ko"?null:e.data;default:return null}}var bS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xm(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!bS[n.type]:e==="textarea"}function dT(n,e,t,r){zv(r),e=bl(e,"onChange"),0<e.length&&(t=new Zf("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ls=null,As=null;function US(n){IT(n,0)}function vu(n){var e=Mi(n);if(Lv(e))return n}function OS(n,e){if(n==="change")return e}var fT=!1;if(xn){var kc;if(xn){var Vc="oninput"in document;if(!Vc){var jm=document.createElement("div");jm.setAttribute("oninput","return;"),Vc=typeof jm.oninput=="function"}kc=Vc}else kc=!1;fT=kc&&(!document.documentMode||9<document.documentMode)}function Zm(){ls&&(ls.detachEvent("onpropertychange",hT),As=ls=null)}function hT(n){if(n.propertyName==="value"&&vu(As)){var e=[];dT(e,As,n,Wf(n)),Hv(US,e)}}function BS(n,e,t){n==="focusin"?(Zm(),ls=e,As=t,ls.attachEvent("onpropertychange",hT)):n==="focusout"&&Zm()}function qS(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return vu(As)}function zS(n,e){if(n==="click")return vu(e)}function GS(n,e){if(n==="input"||n==="change")return vu(e)}function $S(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var nn=typeof Object.is=="function"?Object.is:$S;function Rs(n,e){if(nn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!ad.call(e,i)||!nn(n[i],e[i]))return!1}return!0}function eg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function tg(n,e){var t=eg(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=eg(t)}}function pT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?pT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function mT(){for(var n=window,e=Dl();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Dl(n.document)}return e}function nh(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function KS(n){var e=mT(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&pT(t.ownerDocument.documentElement,t)){if(r!==null&&nh(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=tg(t,o);var s=tg(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var HS=xn&&"documentMode"in document&&11>=document.documentMode,ki=null,Ad=null,us=null,Rd=!1;function ng(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Rd||ki==null||ki!==Dl(r)||(r=ki,"selectionStart"in r&&nh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),us&&Rs(us,r)||(us=r,r=bl(Ad,"onSelect"),0<r.length&&(e=new Zf("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=ki)))}function qa(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Vi={animationend:qa("Animation","AnimationEnd"),animationiteration:qa("Animation","AnimationIteration"),animationstart:qa("Animation","AnimationStart"),transitionend:qa("Transition","TransitionEnd")},Mc={},gT={};xn&&(gT=document.createElement("div").style,"AnimationEvent"in window||(delete Vi.animationend.animation,delete Vi.animationiteration.animation,delete Vi.animationstart.animation),"TransitionEvent"in window||delete Vi.transitionend.transition);function Tu(n){if(Mc[n])return Mc[n];if(!Vi[n])return n;var e=Vi[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in gT)return Mc[n]=e[t];return n}var yT=Tu("animationend"),_T=Tu("animationiteration"),vT=Tu("animationstart"),TT=Tu("transitionend"),ET=new Map,rg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yr(n,e){ET.set(n,e),ai(e,[n])}for(var Lc=0;Lc<rg.length;Lc++){var Fc=rg[Lc],WS=Fc.toLowerCase(),QS=Fc[0].toUpperCase()+Fc.slice(1);yr(WS,"on"+QS)}yr(yT,"onAnimationEnd");yr(_T,"onAnimationIteration");yr(vT,"onAnimationStart");yr("dblclick","onDoubleClick");yr("focusin","onFocus");yr("focusout","onBlur");yr(TT,"onTransitionEnd");Qi("onMouseEnter",["mouseout","mouseover"]);Qi("onMouseLeave",["mouseout","mouseover"]);Qi("onPointerEnter",["pointerout","pointerover"]);Qi("onPointerLeave",["pointerout","pointerover"]);ai("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ai("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ai("onBeforeInput",["compositionend","keypress","textInput","paste"]);ai("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ai("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),YS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zo));function ig(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,WC(r,e,void 0,n),n.currentTarget=null}function IT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;ig(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;ig(i,a,c),o=l}}}if(kl)throw n=Id,kl=!1,Id=null,n}function ve(n,e){var t=e[kd];t===void 0&&(t=e[kd]=new Set);var r=n+"__bubble";t.has(r)||(wT(e,n,2,!1),t.add(r))}function bc(n,e,t){var r=0;e&&(r|=4),wT(t,n,r,e)}var za="_reactListening"+Math.random().toString(36).slice(2);function xs(n){if(!n[za]){n[za]=!0,Dv.forEach(function(t){t!=="selectionchange"&&(YS.has(t)||bc(t,!1,n),bc(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[za]||(e[za]=!0,bc("selectionchange",!1,e))}}function wT(n,e,t,r){switch(sT(e)){case 1:var i=uS;break;case 4:i=cS;break;default:i=Xf}t=i.bind(null,e,t,n),i=void 0,!Ed||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Uc(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Ur(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}Hv(function(){var c=o,h=Wf(t),m=[];e:{var g=ET.get(n);if(g!==void 0){var _=Zf,I=n;switch(n){case"keypress":if(dl(t)===0)break e;case"keydown":case"keyup":_=SS;break;case"focusin":I="focus",_=Nc;break;case"focusout":I="blur",_=Nc;break;case"beforeblur":case"afterblur":_=Nc;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=Hm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=hS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=xS;break;case yT:case _T:case vT:_=gS;break;case TT:_=DS;break;case"scroll":_=dS;break;case"wheel":_=kS;break;case"copy":case"cut":case"paste":_=_S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=Qm}var x=(e&4)!==0,k=!x&&n==="scroll",w=x?g!==null?g+"Capture":null:g;x=[];for(var E=c,S;E!==null;){S=E;var N=S.stateNode;if(S.tag===5&&N!==null&&(S=N,w!==null&&(N=Is(E,w),N!=null&&x.push(Ps(E,N,S)))),k)break;E=E.return}0<x.length&&(g=new _(g,I,null,t,h),m.push({event:g,listeners:x}))}}if(!(e&7)){e:{if(g=n==="mouseover"||n==="pointerover",_=n==="mouseout"||n==="pointerout",g&&t!==vd&&(I=t.relatedTarget||t.fromElement)&&(Ur(I)||I[Pn]))break e;if((_||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,_?(I=t.relatedTarget||t.toElement,_=c,I=I?Ur(I):null,I!==null&&(k=li(I),I!==k||I.tag!==5&&I.tag!==6)&&(I=null)):(_=null,I=c),_!==I)){if(x=Hm,N="onMouseLeave",w="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(x=Qm,N="onPointerLeave",w="onPointerEnter",E="pointer"),k=_==null?g:Mi(_),S=I==null?g:Mi(I),g=new x(N,E+"leave",_,t,h),g.target=k,g.relatedTarget=S,N=null,Ur(h)===c&&(x=new x(w,E+"enter",I,t,h),x.target=S,x.relatedTarget=k,N=x),k=N,_&&I)t:{for(x=_,w=I,E=0,S=x;S;S=vi(S))E++;for(S=0,N=w;N;N=vi(N))S++;for(;0<E-S;)x=vi(x),E--;for(;0<S-E;)w=vi(w),S--;for(;E--;){if(x===w||w!==null&&x===w.alternate)break t;x=vi(x),w=vi(w)}x=null}else x=null;_!==null&&og(m,g,_,x,!1),I!==null&&k!==null&&og(m,k,I,x,!0)}}e:{if(g=c?Mi(c):window,_=g.nodeName&&g.nodeName.toLowerCase(),_==="select"||_==="input"&&g.type==="file")var O=OS;else if(Xm(g))if(fT)O=GS;else{O=qS;var B=BS}else(_=g.nodeName)&&_.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(O=zS);if(O&&(O=O(n,c))){dT(m,O,t,h);break e}B&&B(n,g,c),n==="focusout"&&(B=g._wrapperState)&&B.controlled&&g.type==="number"&&pd(g,"number",g.value)}switch(B=c?Mi(c):window,n){case"focusin":(Xm(B)||B.contentEditable==="true")&&(ki=B,Ad=c,us=null);break;case"focusout":us=Ad=ki=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,ng(m,t,h);break;case"selectionchange":if(HS)break;case"keydown":case"keyup":ng(m,t,h)}var C;if(th)e:{switch(n){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ni?uT(n,t)&&(v="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(v="onCompositionStart");v&&(lT&&t.locale!=="ko"&&(Ni||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ni&&(C=aT()):(Yn=h,jf="value"in Yn?Yn.value:Yn.textContent,Ni=!0)),B=bl(c,v),0<B.length&&(v=new Wm(v,n,null,t,h),m.push({event:v,listeners:B}),C?v.data=C:(C=cT(t),C!==null&&(v.data=C)))),(C=MS?LS(n,t):FS(n,t))&&(c=bl(c,"onBeforeInput"),0<c.length&&(h=new Wm("onBeforeInput","beforeinput",null,t,h),m.push({event:h,listeners:c}),h.data=C))}IT(m,e)})}function Ps(n,e,t){return{instance:n,listener:e,currentTarget:t}}function bl(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Is(n,t),o!=null&&r.unshift(Ps(n,o,i)),o=Is(n,e),o!=null&&r.push(Ps(n,o,i))),n=n.return}return r}function vi(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function og(n,e,t,r,i){for(var o=e._reactName,s=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Is(t,o),l!=null&&s.unshift(Ps(t,l,a))):i||(l=Is(t,o),l!=null&&s.push(Ps(t,l,a)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var JS=/\r\n?/g,XS=/\u0000|\uFFFD/g;function sg(n){return(typeof n=="string"?n:""+n).replace(JS,`
`).replace(XS,"")}function Ga(n,e,t){if(e=sg(e),sg(n)!==e&&t)throw Error(z(425))}function Ul(){}var xd=null,Pd=null;function Dd(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nd=typeof setTimeout=="function"?setTimeout:void 0,jS=typeof clearTimeout=="function"?clearTimeout:void 0,ag=typeof Promise=="function"?Promise:void 0,ZS=typeof queueMicrotask=="function"?queueMicrotask:typeof ag<"u"?function(n){return ag.resolve(null).then(n).catch(eA)}:Nd;function eA(n){setTimeout(function(){throw n})}function Oc(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Ss(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Ss(e)}function tr(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function lg(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var mo=Math.random().toString(36).slice(2),sn="__reactFiber$"+mo,Ds="__reactProps$"+mo,Pn="__reactContainer$"+mo,kd="__reactEvents$"+mo,tA="__reactListeners$"+mo,nA="__reactHandles$"+mo;function Ur(n){var e=n[sn];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Pn]||t[sn]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=lg(n);n!==null;){if(t=n[sn])return t;n=lg(n)}return e}n=t,t=n.parentNode}return null}function na(n){return n=n[sn]||n[Pn],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Mi(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(z(33))}function Eu(n){return n[Ds]||null}var Vd=[],Li=-1;function _r(n){return{current:n}}function Te(n){0>Li||(n.current=Vd[Li],Vd[Li]=null,Li--)}function ye(n,e){Li++,Vd[Li]=n.current,n.current=e}var fr={},ct=_r(fr),At=_r(!1),Kr=fr;function Yi(n,e){var t=n.type.contextTypes;if(!t)return fr;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(n){return n=n.childContextTypes,n!=null}function Ol(){Te(At),Te(ct)}function ug(n,e,t){if(ct.current!==fr)throw Error(z(168));ye(ct,e),ye(At,t)}function CT(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(z(108,BC(n)||"Unknown",i));return Ne({},t,r)}function Bl(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||fr,Kr=ct.current,ye(ct,n),ye(At,At.current),!0}function cg(n,e,t){var r=n.stateNode;if(!r)throw Error(z(169));t?(n=CT(n,e,Kr),r.__reactInternalMemoizedMergedChildContext=n,Te(At),Te(ct),ye(ct,n)):Te(At),ye(At,t)}var In=null,Iu=!1,Bc=!1;function ST(n){In===null?In=[n]:In.push(n)}function rA(n){Iu=!0,ST(n)}function vr(){if(!Bc&&In!==null){Bc=!0;var n=0,e=he;try{var t=In;for(he=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}In=null,Iu=!1}catch(i){throw In!==null&&(In=In.slice(n+1)),Jv(Qf,vr),i}finally{he=e,Bc=!1}}return null}var Fi=[],bi=0,ql=null,zl=0,Bt=[],qt=0,Hr=null,wn=1,Cn="";function Dr(n,e){Fi[bi++]=zl,Fi[bi++]=ql,ql=n,zl=e}function AT(n,e,t){Bt[qt++]=wn,Bt[qt++]=Cn,Bt[qt++]=Hr,Hr=n;var r=wn;n=Cn;var i=32-en(r)-1;r&=~(1<<i),t+=1;var o=32-en(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,wn=1<<32-en(e)+i|t<<i|r,Cn=o+n}else wn=1<<o|t<<i|r,Cn=n}function rh(n){n.return!==null&&(Dr(n,1),AT(n,1,0))}function ih(n){for(;n===ql;)ql=Fi[--bi],Fi[bi]=null,zl=Fi[--bi],Fi[bi]=null;for(;n===Hr;)Hr=Bt[--qt],Bt[qt]=null,Cn=Bt[--qt],Bt[qt]=null,wn=Bt[--qt],Bt[qt]=null}var Lt=null,kt=null,Ie=!1,Zt=null;function RT(n,e){var t=zt(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function dg(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Lt=n,kt=tr(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Lt=n,kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Hr!==null?{id:wn,overflow:Cn}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=zt(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Lt=n,kt=null,!0):!1;default:return!1}}function Md(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Ld(n){if(Ie){var e=kt;if(e){var t=e;if(!dg(n,e)){if(Md(n))throw Error(z(418));e=tr(t.nextSibling);var r=Lt;e&&dg(n,e)?RT(r,t):(n.flags=n.flags&-4097|2,Ie=!1,Lt=n)}}else{if(Md(n))throw Error(z(418));n.flags=n.flags&-4097|2,Ie=!1,Lt=n}}}function fg(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Lt=n}function $a(n){if(n!==Lt)return!1;if(!Ie)return fg(n),Ie=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Dd(n.type,n.memoizedProps)),e&&(e=kt)){if(Md(n))throw xT(),Error(z(418));for(;e;)RT(n,e),e=tr(e.nextSibling)}if(fg(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(z(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){kt=tr(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}kt=null}}else kt=Lt?tr(n.stateNode.nextSibling):null;return!0}function xT(){for(var n=kt;n;)n=tr(n.nextSibling)}function Ji(){kt=Lt=null,Ie=!1}function oh(n){Zt===null?Zt=[n]:Zt.push(n)}var iA=Ln.ReactCurrentBatchConfig;function Bo(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(z(309));var r=t.stateNode}if(!r)throw Error(z(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(z(284));if(!t._owner)throw Error(z(290,n))}return n}function Ka(n,e){throw n=Object.prototype.toString.call(e),Error(z(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function hg(n){var e=n._init;return e(n._payload)}function PT(n){function e(w,E){if(n){var S=w.deletions;S===null?(w.deletions=[E],w.flags|=16):S.push(E)}}function t(w,E){if(!n)return null;for(;E!==null;)e(w,E),E=E.sibling;return null}function r(w,E){for(w=new Map;E!==null;)E.key!==null?w.set(E.key,E):w.set(E.index,E),E=E.sibling;return w}function i(w,E){return w=or(w,E),w.index=0,w.sibling=null,w}function o(w,E,S){return w.index=S,n?(S=w.alternate,S!==null?(S=S.index,S<E?(w.flags|=2,E):S):(w.flags|=2,E)):(w.flags|=1048576,E)}function s(w){return n&&w.alternate===null&&(w.flags|=2),w}function a(w,E,S,N){return E===null||E.tag!==6?(E=Wc(S,w.mode,N),E.return=w,E):(E=i(E,S),E.return=w,E)}function l(w,E,S,N){var O=S.type;return O===Di?h(w,E,S.props.children,N,S.key):E!==null&&(E.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Gn&&hg(O)===E.type)?(N=i(E,S.props),N.ref=Bo(w,E,S),N.return=w,N):(N=_l(S.type,S.key,S.props,null,w.mode,N),N.ref=Bo(w,E,S),N.return=w,N)}function c(w,E,S,N){return E===null||E.tag!==4||E.stateNode.containerInfo!==S.containerInfo||E.stateNode.implementation!==S.implementation?(E=Qc(S,w.mode,N),E.return=w,E):(E=i(E,S.children||[]),E.return=w,E)}function h(w,E,S,N,O){return E===null||E.tag!==7?(E=zr(S,w.mode,N,O),E.return=w,E):(E=i(E,S),E.return=w,E)}function m(w,E,S){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Wc(""+E,w.mode,S),E.return=w,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Ma:return S=_l(E.type,E.key,E.props,null,w.mode,S),S.ref=Bo(w,null,E),S.return=w,S;case Pi:return E=Qc(E,w.mode,S),E.return=w,E;case Gn:var N=E._init;return m(w,N(E._payload),S)}if(Xo(E)||Lo(E))return E=zr(E,w.mode,S,null),E.return=w,E;Ka(w,E)}return null}function g(w,E,S,N){var O=E!==null?E.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return O!==null?null:a(w,E,""+S,N);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Ma:return S.key===O?l(w,E,S,N):null;case Pi:return S.key===O?c(w,E,S,N):null;case Gn:return O=S._init,g(w,E,O(S._payload),N)}if(Xo(S)||Lo(S))return O!==null?null:h(w,E,S,N,null);Ka(w,S)}return null}function _(w,E,S,N,O){if(typeof N=="string"&&N!==""||typeof N=="number")return w=w.get(S)||null,a(E,w,""+N,O);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ma:return w=w.get(N.key===null?S:N.key)||null,l(E,w,N,O);case Pi:return w=w.get(N.key===null?S:N.key)||null,c(E,w,N,O);case Gn:var B=N._init;return _(w,E,S,B(N._payload),O)}if(Xo(N)||Lo(N))return w=w.get(S)||null,h(E,w,N,O,null);Ka(E,N)}return null}function I(w,E,S,N){for(var O=null,B=null,C=E,v=E=0,A=null;C!==null&&v<S.length;v++){C.index>v?(A=C,C=null):A=C.sibling;var R=g(w,C,S[v],N);if(R===null){C===null&&(C=A);break}n&&C&&R.alternate===null&&e(w,C),E=o(R,E,v),B===null?O=R:B.sibling=R,B=R,C=A}if(v===S.length)return t(w,C),Ie&&Dr(w,v),O;if(C===null){for(;v<S.length;v++)C=m(w,S[v],N),C!==null&&(E=o(C,E,v),B===null?O=C:B.sibling=C,B=C);return Ie&&Dr(w,v),O}for(C=r(w,C);v<S.length;v++)A=_(C,w,v,S[v],N),A!==null&&(n&&A.alternate!==null&&C.delete(A.key===null?v:A.key),E=o(A,E,v),B===null?O=A:B.sibling=A,B=A);return n&&C.forEach(function(D){return e(w,D)}),Ie&&Dr(w,v),O}function x(w,E,S,N){var O=Lo(S);if(typeof O!="function")throw Error(z(150));if(S=O.call(S),S==null)throw Error(z(151));for(var B=O=null,C=E,v=E=0,A=null,R=S.next();C!==null&&!R.done;v++,R=S.next()){C.index>v?(A=C,C=null):A=C.sibling;var D=g(w,C,R.value,N);if(D===null){C===null&&(C=A);break}n&&C&&D.alternate===null&&e(w,C),E=o(D,E,v),B===null?O=D:B.sibling=D,B=D,C=A}if(R.done)return t(w,C),Ie&&Dr(w,v),O;if(C===null){for(;!R.done;v++,R=S.next())R=m(w,R.value,N),R!==null&&(E=o(R,E,v),B===null?O=R:B.sibling=R,B=R);return Ie&&Dr(w,v),O}for(C=r(w,C);!R.done;v++,R=S.next())R=_(C,w,v,R.value,N),R!==null&&(n&&R.alternate!==null&&C.delete(R.key===null?v:R.key),E=o(R,E,v),B===null?O=R:B.sibling=R,B=R);return n&&C.forEach(function(V){return e(w,V)}),Ie&&Dr(w,v),O}function k(w,E,S,N){if(typeof S=="object"&&S!==null&&S.type===Di&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Ma:e:{for(var O=S.key,B=E;B!==null;){if(B.key===O){if(O=S.type,O===Di){if(B.tag===7){t(w,B.sibling),E=i(B,S.props.children),E.return=w,w=E;break e}}else if(B.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Gn&&hg(O)===B.type){t(w,B.sibling),E=i(B,S.props),E.ref=Bo(w,B,S),E.return=w,w=E;break e}t(w,B);break}else e(w,B);B=B.sibling}S.type===Di?(E=zr(S.props.children,w.mode,N,S.key),E.return=w,w=E):(N=_l(S.type,S.key,S.props,null,w.mode,N),N.ref=Bo(w,E,S),N.return=w,w=N)}return s(w);case Pi:e:{for(B=S.key;E!==null;){if(E.key===B)if(E.tag===4&&E.stateNode.containerInfo===S.containerInfo&&E.stateNode.implementation===S.implementation){t(w,E.sibling),E=i(E,S.children||[]),E.return=w,w=E;break e}else{t(w,E);break}else e(w,E);E=E.sibling}E=Qc(S,w.mode,N),E.return=w,w=E}return s(w);case Gn:return B=S._init,k(w,E,B(S._payload),N)}if(Xo(S))return I(w,E,S,N);if(Lo(S))return x(w,E,S,N);Ka(w,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,E!==null&&E.tag===6?(t(w,E.sibling),E=i(E,S),E.return=w,w=E):(t(w,E),E=Wc(S,w.mode,N),E.return=w,w=E),s(w)):t(w,E)}return k}var Xi=PT(!0),DT=PT(!1),Gl=_r(null),$l=null,Ui=null,sh=null;function ah(){sh=Ui=$l=null}function lh(n){var e=Gl.current;Te(Gl),n._currentValue=e}function Fd(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Ki(n,e){$l=n,sh=Ui=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(wt=!0),n.firstContext=null)}function Ht(n){var e=n._currentValue;if(sh!==n)if(n={context:n,memoizedValue:e,next:null},Ui===null){if($l===null)throw Error(z(308));Ui=n,$l.dependencies={lanes:0,firstContext:n}}else Ui=Ui.next=n;return e}var Or=null;function uh(n){Or===null?Or=[n]:Or.push(n)}function NT(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,uh(e)):(t.next=i.next,i.next=t),e.interleaved=t,Dn(n,r)}function Dn(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var $n=!1;function ch(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kT(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function An(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function nr(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Dn(n,t)}return i=r.interleaved,i===null?(e.next=e,uh(r)):(e.next=i.next,i.next=e),r.interleaved=e,Dn(n,t)}function fl(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Yf(n,t)}}function pg(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Kl(n,e,t,r){var i=n.updateQueue;$n=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==s&&(a===null?h.firstBaseUpdate=c:a.next=c,h.lastBaseUpdate=l))}if(o!==null){var m=i.baseState;s=0,h=c=l=null,a=o;do{var g=a.lane,_=a.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:_,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var I=n,x=a;switch(g=e,_=t,x.tag){case 1:if(I=x.payload,typeof I=="function"){m=I.call(_,m,g);break e}m=I;break e;case 3:I.flags=I.flags&-65537|128;case 0:if(I=x.payload,g=typeof I=="function"?I.call(_,m,g):I,g==null)break e;m=Ne({},m,g);break e;case 2:$n=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,g=i.effects,g===null?i.effects=[a]:g.push(a))}else _={eventTime:_,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(c=h=_,l=m):h=h.next=_,s|=g;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;g=a,a=g.next,g.next=null,i.lastBaseUpdate=g,i.shared.pending=null}}while(!0);if(h===null&&(l=m),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Qr|=s,n.lanes=s,n.memoizedState=m}}function mg(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(z(191,i));i.call(r)}}}var ra={},dn=_r(ra),Ns=_r(ra),ks=_r(ra);function Br(n){if(n===ra)throw Error(z(174));return n}function dh(n,e){switch(ye(ks,e),ye(Ns,n),ye(dn,ra),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gd(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=gd(e,n)}Te(dn),ye(dn,e)}function ji(){Te(dn),Te(Ns),Te(ks)}function VT(n){Br(ks.current);var e=Br(dn.current),t=gd(e,n.type);e!==t&&(ye(Ns,n),ye(dn,t))}function fh(n){Ns.current===n&&(Te(dn),Te(Ns))}var Re=_r(0);function Hl(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var qc=[];function hh(){for(var n=0;n<qc.length;n++)qc[n]._workInProgressVersionPrimary=null;qc.length=0}var hl=Ln.ReactCurrentDispatcher,zc=Ln.ReactCurrentBatchConfig,Wr=0,Pe=null,ze=null,He=null,Wl=!1,cs=!1,Vs=0,oA=0;function ot(){throw Error(z(321))}function ph(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!nn(n[t],e[t]))return!1;return!0}function mh(n,e,t,r,i,o){if(Wr=o,Pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,hl.current=n===null||n.memoizedState===null?uA:cA,n=t(r,i),cs){o=0;do{if(cs=!1,Vs=0,25<=o)throw Error(z(301));o+=1,He=ze=null,e.updateQueue=null,hl.current=dA,n=t(r,i)}while(cs)}if(hl.current=Ql,e=ze!==null&&ze.next!==null,Wr=0,He=ze=Pe=null,Wl=!1,e)throw Error(z(300));return n}function gh(){var n=Vs!==0;return Vs=0,n}function on(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Pe.memoizedState=He=n:He=He.next=n,He}function Wt(){if(ze===null){var n=Pe.alternate;n=n!==null?n.memoizedState:null}else n=ze.next;var e=He===null?Pe.memoizedState:He.next;if(e!==null)He=e,ze=n;else{if(n===null)throw Error(z(310));ze=n,n={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},He===null?Pe.memoizedState=He=n:He=He.next=n}return He}function Ms(n,e){return typeof e=="function"?e(n):e}function Gc(n){var e=Wt(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=ze,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var h=c.lane;if((Wr&h)===h)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var m={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=m,s=r):l=l.next=m,Pe.lanes|=h,Qr|=h}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,nn(r,e.memoizedState)||(wt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,Pe.lanes|=o,Qr|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function $c(n){var e=Wt(),t=e.queue;if(t===null)throw Error(z(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do o=n(o,s.action),s=s.next;while(s!==i);nn(o,e.memoizedState)||(wt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function MT(){}function LT(n,e){var t=Pe,r=Wt(),i=e(),o=!nn(r.memoizedState,i);if(o&&(r.memoizedState=i,wt=!0),r=r.queue,yh(UT.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||He!==null&&He.memoizedState.tag&1){if(t.flags|=2048,Ls(9,bT.bind(null,t,r,i,e),void 0,null),We===null)throw Error(z(349));Wr&30||FT(t,e,i)}return i}function FT(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function bT(n,e,t,r){e.value=t,e.getSnapshot=r,OT(e)&&BT(n)}function UT(n,e,t){return t(function(){OT(e)&&BT(n)})}function OT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!nn(n,t)}catch{return!0}}function BT(n){var e=Dn(n,1);e!==null&&tn(e,n,1,-1)}function gg(n){var e=on();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ms,lastRenderedState:n},e.queue=n,n=n.dispatch=lA.bind(null,Pe,n),[e.memoizedState,n]}function Ls(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function qT(){return Wt().memoizedState}function pl(n,e,t,r){var i=on();Pe.flags|=n,i.memoizedState=Ls(1|e,t,void 0,r===void 0?null:r)}function wu(n,e,t,r){var i=Wt();r=r===void 0?null:r;var o=void 0;if(ze!==null){var s=ze.memoizedState;if(o=s.destroy,r!==null&&ph(r,s.deps)){i.memoizedState=Ls(e,t,o,r);return}}Pe.flags|=n,i.memoizedState=Ls(1|e,t,o,r)}function yg(n,e){return pl(8390656,8,n,e)}function yh(n,e){return wu(2048,8,n,e)}function zT(n,e){return wu(4,2,n,e)}function GT(n,e){return wu(4,4,n,e)}function $T(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function KT(n,e,t){return t=t!=null?t.concat([n]):null,wu(4,4,$T.bind(null,e,n),t)}function _h(){}function HT(n,e){var t=Wt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ph(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function WT(n,e){var t=Wt();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&ph(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function QT(n,e,t){return Wr&21?(nn(t,e)||(t=Zv(),Pe.lanes|=t,Qr|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,wt=!0),n.memoizedState=t)}function sA(n,e){var t=he;he=t!==0&&4>t?t:4,n(!0);var r=zc.transition;zc.transition={};try{n(!1),e()}finally{he=t,zc.transition=r}}function YT(){return Wt().memoizedState}function aA(n,e,t){var r=ir(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},JT(n))XT(e,t);else if(t=NT(n,e,t,r),t!==null){var i=yt();tn(t,n,r,i),jT(t,e,r)}}function lA(n,e,t){var r=ir(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(JT(n))XT(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,t);if(i.hasEagerState=!0,i.eagerState=a,nn(a,s)){var l=e.interleaved;l===null?(i.next=i,uh(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=NT(n,e,i,r),t!==null&&(i=yt(),tn(t,n,r,i),jT(t,e,r))}}function JT(n){var e=n.alternate;return n===Pe||e!==null&&e===Pe}function XT(n,e){cs=Wl=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function jT(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,Yf(n,t)}}var Ql={readContext:Ht,useCallback:ot,useContext:ot,useEffect:ot,useImperativeHandle:ot,useInsertionEffect:ot,useLayoutEffect:ot,useMemo:ot,useReducer:ot,useRef:ot,useState:ot,useDebugValue:ot,useDeferredValue:ot,useTransition:ot,useMutableSource:ot,useSyncExternalStore:ot,useId:ot,unstable_isNewReconciler:!1},uA={readContext:Ht,useCallback:function(n,e){return on().memoizedState=[n,e===void 0?null:e],n},useContext:Ht,useEffect:yg,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,pl(4194308,4,$T.bind(null,e,n),t)},useLayoutEffect:function(n,e){return pl(4194308,4,n,e)},useInsertionEffect:function(n,e){return pl(4,2,n,e)},useMemo:function(n,e){var t=on();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=on();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=aA.bind(null,Pe,n),[r.memoizedState,n]},useRef:function(n){var e=on();return n={current:n},e.memoizedState=n},useState:gg,useDebugValue:_h,useDeferredValue:function(n){return on().memoizedState=n},useTransition:function(){var n=gg(!1),e=n[0];return n=sA.bind(null,n[1]),on().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Pe,i=on();if(Ie){if(t===void 0)throw Error(z(407));t=t()}else{if(t=e(),We===null)throw Error(z(349));Wr&30||FT(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,yg(UT.bind(null,r,o,n),[n]),r.flags|=2048,Ls(9,bT.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=on(),e=We.identifierPrefix;if(Ie){var t=Cn,r=wn;t=(r&~(1<<32-en(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Vs++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=oA++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},cA={readContext:Ht,useCallback:HT,useContext:Ht,useEffect:yh,useImperativeHandle:KT,useInsertionEffect:zT,useLayoutEffect:GT,useMemo:WT,useReducer:Gc,useRef:qT,useState:function(){return Gc(Ms)},useDebugValue:_h,useDeferredValue:function(n){var e=Wt();return QT(e,ze.memoizedState,n)},useTransition:function(){var n=Gc(Ms)[0],e=Wt().memoizedState;return[n,e]},useMutableSource:MT,useSyncExternalStore:LT,useId:YT,unstable_isNewReconciler:!1},dA={readContext:Ht,useCallback:HT,useContext:Ht,useEffect:yh,useImperativeHandle:KT,useInsertionEffect:zT,useLayoutEffect:GT,useMemo:WT,useReducer:$c,useRef:qT,useState:function(){return $c(Ms)},useDebugValue:_h,useDeferredValue:function(n){var e=Wt();return ze===null?e.memoizedState=n:QT(e,ze.memoizedState,n)},useTransition:function(){var n=$c(Ms)[0],e=Wt().memoizedState;return[n,e]},useMutableSource:MT,useSyncExternalStore:LT,useId:YT,unstable_isNewReconciler:!1};function Xt(n,e){if(n&&n.defaultProps){e=Ne({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function bd(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ne({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Cu={isMounted:function(n){return(n=n._reactInternals)?li(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=yt(),i=ir(n),o=An(r,i);o.payload=e,t!=null&&(o.callback=t),e=nr(n,o,i),e!==null&&(tn(e,n,i,r),fl(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=yt(),i=ir(n),o=An(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=nr(n,o,i),e!==null&&(tn(e,n,i,r),fl(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=yt(),r=ir(n),i=An(t,r);i.tag=2,e!=null&&(i.callback=e),e=nr(n,i,r),e!==null&&(tn(e,n,r,t),fl(e,n,r))}};function _g(n,e,t,r,i,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Rs(t,r)||!Rs(i,o):!0}function ZT(n,e,t){var r=!1,i=fr,o=e.contextType;return typeof o=="object"&&o!==null?o=Ht(o):(i=Rt(e)?Kr:ct.current,r=e.contextTypes,o=(r=r!=null)?Yi(n,i):fr),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Cu,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function vg(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Cu.enqueueReplaceState(e,e.state,null)}function Ud(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},ch(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Ht(o):(o=Rt(e)?Kr:ct.current,i.context=Yi(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(bd(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Cu.enqueueReplaceState(i,i.state,null),Kl(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function Zi(n,e){try{var t="",r=e;do t+=OC(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function Kc(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Od(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var fA=typeof WeakMap=="function"?WeakMap:Map;function eE(n,e,t){t=An(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Jl||(Jl=!0,Yd=r),Od(n,e)},t}function tE(n,e,t){t=An(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Od(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){Od(n,e),typeof r!="function"&&(rr===null?rr=new Set([this]):rr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function Tg(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new fA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=AA.bind(null,n,e,t),e.then(n,n))}function Eg(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function Ig(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=An(-1,1),e.tag=2,nr(t,e,1))),t.lanes|=1),n)}var hA=Ln.ReactCurrentOwner,wt=!1;function mt(n,e,t,r){e.child=n===null?DT(e,null,t,r):Xi(e,n.child,t,r)}function wg(n,e,t,r,i){t=t.render;var o=e.ref;return Ki(e,i),r=mh(n,e,t,r,o,i),t=gh(),n!==null&&!wt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Nn(n,e,i)):(Ie&&t&&rh(e),e.flags|=1,mt(n,e,r,i),e.child)}function Cg(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!Ah(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,nE(n,e,o,r,i)):(n=_l(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:Rs,t(s,r)&&n.ref===e.ref)return Nn(n,e,i)}return e.flags|=1,n=or(o,r),n.ref=e.ref,n.return=e,e.child=n}function nE(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(Rs(o,r)&&n.ref===e.ref)if(wt=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(wt=!0);else return e.lanes=n.lanes,Nn(n,e,i)}return Bd(n,e,t,r,i)}function rE(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Bi,Nt),Nt|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,ye(Bi,Nt),Nt|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,ye(Bi,Nt),Nt|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,ye(Bi,Nt),Nt|=r;return mt(n,e,i,t),e.child}function iE(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Bd(n,e,t,r,i){var o=Rt(t)?Kr:ct.current;return o=Yi(e,o),Ki(e,i),t=mh(n,e,t,r,o,i),r=gh(),n!==null&&!wt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,Nn(n,e,i)):(Ie&&r&&rh(e),e.flags|=1,mt(n,e,t,i),e.child)}function Sg(n,e,t,r,i){if(Rt(t)){var o=!0;Bl(e)}else o=!1;if(Ki(e,i),e.stateNode===null)ml(n,e),ZT(e,t,r),Ud(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=t.contextType;typeof c=="object"&&c!==null?c=Ht(c):(c=Rt(t)?Kr:ct.current,c=Yi(e,c));var h=t.getDerivedStateFromProps,m=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";m||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&vg(e,s,r,c),$n=!1;var g=e.memoizedState;s.state=g,Kl(e,r,s,i),l=e.memoizedState,a!==r||g!==l||At.current||$n?(typeof h=="function"&&(bd(e,t,h,r),l=e.memoizedState),(a=$n||_g(e,t,a,r,g,l,c))?(m||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,kT(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Xt(e.type,a),s.props=c,m=e.pendingProps,g=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ht(l):(l=Rt(t)?Kr:ct.current,l=Yi(e,l));var _=t.getDerivedStateFromProps;(h=typeof _=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==m||g!==l)&&vg(e,s,r,l),$n=!1,g=e.memoizedState,s.state=g,Kl(e,r,s,i);var I=e.memoizedState;a!==m||g!==I||At.current||$n?(typeof _=="function"&&(bd(e,t,_,r),I=e.memoizedState),(c=$n||_g(e,t,c,r,g,I,l)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,I,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,I,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=I),s.props=r,s.state=I,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),r=!1)}return qd(n,e,t,r,o,i)}function qd(n,e,t,r,i,o){iE(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&cg(e,t,!1),Nn(n,e,o);r=e.stateNode,hA.current=e;var a=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=Xi(e,n.child,null,o),e.child=Xi(e,null,a,o)):mt(n,e,a,o),e.memoizedState=r.state,i&&cg(e,t,!0),e.child}function oE(n){var e=n.stateNode;e.pendingContext?ug(n,e.pendingContext,e.pendingContext!==e.context):e.context&&ug(n,e.context,!1),dh(n,e.containerInfo)}function Ag(n,e,t,r,i){return Ji(),oh(i),e.flags|=256,mt(n,e,t,r),e.child}var zd={dehydrated:null,treeContext:null,retryLane:0};function Gd(n){return{baseLanes:n,cachePool:null,transitions:null}}function sE(n,e,t){var r=e.pendingProps,i=Re.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),ye(Re,i&1),n===null)return Ld(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=Ru(s,r,0,null),n=zr(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=Gd(t),e.memoizedState=zd,n):vh(e,s));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return pA(n,e,s,r,a,i,t);if(o){o=r.fallback,s=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=or(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=or(a,o):(o=zr(o,s,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=n.child.memoizedState,s=s===null?Gd(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=zd,r}return o=n.child,n=o.sibling,r=or(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function vh(n,e){return e=Ru({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ha(n,e,t,r){return r!==null&&oh(r),Xi(e,n.child,null,t),n=vh(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function pA(n,e,t,r,i,o,s){if(t)return e.flags&256?(e.flags&=-257,r=Kc(Error(z(422))),Ha(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=Ru({mode:"visible",children:r.children},i,0,null),o=zr(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Xi(e,n.child,null,s),e.child.memoizedState=Gd(s),e.memoizedState=zd,o);if(!(e.mode&1))return Ha(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(z(419)),r=Kc(o,r,void 0),Ha(n,e,s,r)}if(a=(s&n.childLanes)!==0,wt||a){if(r=We,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Dn(n,i),tn(r,n,i,-1))}return Sh(),r=Kc(Error(z(421))),Ha(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=RA.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,kt=tr(i.nextSibling),Lt=e,Ie=!0,Zt=null,n!==null&&(Bt[qt++]=wn,Bt[qt++]=Cn,Bt[qt++]=Hr,wn=n.id,Cn=n.overflow,Hr=e),e=vh(e,r.children),e.flags|=4096,e)}function Rg(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Fd(n.return,e,t)}function Hc(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function aE(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(mt(n,e,r.children,t),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Rg(n,t,e);else if(n.tag===19)Rg(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(ye(Re,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Hl(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Hc(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Hl(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Hc(e,!0,t,null,o);break;case"together":Hc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ml(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Nn(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Qr|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(z(153));if(e.child!==null){for(n=e.child,t=or(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=or(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function mA(n,e,t){switch(e.tag){case 3:oE(e),Ji();break;case 5:VT(e);break;case 1:Rt(e.type)&&Bl(e);break;case 4:dh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ye(Gl,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ye(Re,Re.current&1),e.flags|=128,null):t&e.child.childLanes?sE(n,e,t):(ye(Re,Re.current&1),n=Nn(n,e,t),n!==null?n.sibling:null);ye(Re,Re.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return aE(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ye(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,rE(n,e,t)}return Nn(n,e,t)}var lE,$d,uE,cE;lE=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};$d=function(){};uE=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Br(dn.current);var o=null;switch(t){case"input":i=fd(n,i),r=fd(n,r),o=[];break;case"select":i=Ne({},i,{value:void 0}),r=Ne({},r,{value:void 0}),o=[];break;case"textarea":i=md(n,i),r=md(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=Ul)}yd(t,r);var s;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ts.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(o||(o=[]),o.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ts.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ve("scroll",n),o||a===l||(o=[])):(o=o||[]).push(c,l))}t&&(o=o||[]).push("style",t);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};cE=function(n,e,t,r){t!==r&&(e.flags|=4)};function qo(n,e){if(!Ie)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function st(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function gA(n,e,t){var r=e.pendingProps;switch(ih(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(e),null;case 1:return Rt(e.type)&&Ol(),st(e),null;case 3:return r=e.stateNode,ji(),Te(At),Te(ct),hh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&($a(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Zt!==null&&(jd(Zt),Zt=null))),$d(n,e),st(e),null;case 5:fh(e);var i=Br(ks.current);if(t=e.type,n!==null&&e.stateNode!=null)uE(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(z(166));return st(e),null}if(n=Br(dn.current),$a(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[sn]=e,r[Ds]=o,n=(e.mode&1)!==0,t){case"dialog":ve("cancel",r),ve("close",r);break;case"iframe":case"object":case"embed":ve("load",r);break;case"video":case"audio":for(i=0;i<Zo.length;i++)ve(Zo[i],r);break;case"source":ve("error",r);break;case"img":case"image":case"link":ve("error",r),ve("load",r);break;case"details":ve("toggle",r);break;case"input":Fm(r,o),ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ve("invalid",r);break;case"textarea":Um(r,o),ve("invalid",r)}yd(t,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&Ga(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Ga(r.textContent,a,n),i=["children",""+a]):Ts.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&ve("scroll",r)}switch(t){case"input":La(r),bm(r,o,!0);break;case"textarea":La(r),Om(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ul)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Uv(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[sn]=e,n[Ds]=r,lE(n,e,!1,!1),e.stateNode=n;e:{switch(s=_d(t,r),t){case"dialog":ve("cancel",n),ve("close",n),i=r;break;case"iframe":case"object":case"embed":ve("load",n),i=r;break;case"video":case"audio":for(i=0;i<Zo.length;i++)ve(Zo[i],n);i=r;break;case"source":ve("error",n),i=r;break;case"img":case"image":case"link":ve("error",n),ve("load",n),i=r;break;case"details":ve("toggle",n),i=r;break;case"input":Fm(n,r),i=fd(n,r),ve("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ne({},r,{value:void 0}),ve("invalid",n);break;case"textarea":Um(n,r),i=md(n,r),ve("invalid",n);break;default:i=r}yd(t,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?qv(n,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ov(n,l)):o==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Es(n,l):typeof l=="number"&&Es(n,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ts.hasOwnProperty(o)?l!=null&&o==="onScroll"&&ve("scroll",n):l!=null&&Gf(n,o,l,s))}switch(t){case"input":La(n),bm(n,r,!1);break;case"textarea":La(n),Om(n);break;case"option":r.value!=null&&n.setAttribute("value",""+dr(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?qi(n,!!r.multiple,o,!1):r.defaultValue!=null&&qi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=Ul)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return st(e),null;case 6:if(n&&e.stateNode!=null)cE(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(z(166));if(t=Br(ks.current),Br(dn.current),$a(e)){if(r=e.stateNode,t=e.memoizedProps,r[sn]=e,(o=r.nodeValue!==t)&&(n=Lt,n!==null))switch(n.tag){case 3:Ga(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ga(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[sn]=e,e.stateNode=r}return st(e),null;case 13:if(Te(Re),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ie&&kt!==null&&e.mode&1&&!(e.flags&128))xT(),Ji(),e.flags|=98560,o=!1;else if(o=$a(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(z(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(z(317));o[sn]=e}else Ji(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;st(e),o=!1}else Zt!==null&&(jd(Zt),Zt=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Re.current&1?Ge===0&&(Ge=3):Sh())),e.updateQueue!==null&&(e.flags|=4),st(e),null);case 4:return ji(),$d(n,e),n===null&&xs(e.stateNode.containerInfo),st(e),null;case 10:return lh(e.type._context),st(e),null;case 17:return Rt(e.type)&&Ol(),st(e),null;case 19:if(Te(Re),o=e.memoizedState,o===null)return st(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)qo(o,!1);else{if(Ge!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=Hl(n),s!==null){for(e.flags|=128,qo(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return ye(Re,Re.current&1|2),e.child}n=n.sibling}o.tail!==null&&be()>eo&&(e.flags|=128,r=!0,qo(o,!1),e.lanes=4194304)}else{if(!r)if(n=Hl(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),qo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ie)return st(e),null}else 2*be()-o.renderingStartTime>eo&&t!==1073741824&&(e.flags|=128,r=!0,qo(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=be(),e.sibling=null,t=Re.current,ye(Re,r?t&1|2:t&1),e):(st(e),null);case 22:case 23:return Ch(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nt&1073741824&&(st(e),e.subtreeFlags&6&&(e.flags|=8192)):st(e),null;case 24:return null;case 25:return null}throw Error(z(156,e.tag))}function yA(n,e){switch(ih(e),e.tag){case 1:return Rt(e.type)&&Ol(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ji(),Te(At),Te(ct),hh(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return fh(e),null;case 13:if(Te(Re),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(z(340));Ji()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Te(Re),null;case 4:return ji(),null;case 10:return lh(e.type._context),null;case 22:case 23:return Ch(),null;case 24:return null;default:return null}}var Wa=!1,ut=!1,_A=typeof WeakSet=="function"?WeakSet:Set,W=null;function Oi(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Ve(n,e,r)}else t.current=null}function Kd(n,e,t){try{t()}catch(r){Ve(n,e,r)}}var xg=!1;function vA(n,e){if(xd=Ll,n=mT(),nh(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,a=-1,l=-1,c=0,h=0,m=n,g=null;t:for(;;){for(var _;m!==t||i!==0&&m.nodeType!==3||(a=s+i),m!==o||r!==0&&m.nodeType!==3||(l=s+r),m.nodeType===3&&(s+=m.nodeValue.length),(_=m.firstChild)!==null;)g=m,m=_;for(;;){if(m===n)break t;if(g===t&&++c===i&&(a=s),g===o&&++h===r&&(l=s),(_=m.nextSibling)!==null)break;m=g,g=m.parentNode}m=_}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(Pd={focusedElem:n,selectionRange:t},Ll=!1,W=e;W!==null;)if(e=W,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,W=n;else for(;W!==null;){e=W;try{var I=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(I!==null){var x=I.memoizedProps,k=I.memoizedState,w=e.stateNode,E=w.getSnapshotBeforeUpdate(e.elementType===e.type?x:Xt(e.type,x),k);w.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(z(163))}}catch(N){Ve(e,e.return,N)}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}return I=xg,xg=!1,I}function ds(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&Kd(e,t,o)}i=i.next}while(i!==r)}}function Su(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function Hd(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function dE(n){var e=n.alternate;e!==null&&(n.alternate=null,dE(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[sn],delete e[Ds],delete e[kd],delete e[tA],delete e[nA])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function fE(n){return n.tag===5||n.tag===3||n.tag===4}function Pg(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||fE(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Wd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Ul));else if(r!==4&&(n=n.child,n!==null))for(Wd(n,e,t),n=n.sibling;n!==null;)Wd(n,e,t),n=n.sibling}function Qd(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Qd(n,e,t),n=n.sibling;n!==null;)Qd(n,e,t),n=n.sibling}var Je=null,jt=!1;function Bn(n,e,t){for(t=t.child;t!==null;)hE(n,e,t),t=t.sibling}function hE(n,e,t){if(cn&&typeof cn.onCommitFiberUnmount=="function")try{cn.onCommitFiberUnmount(yu,t)}catch{}switch(t.tag){case 5:ut||Oi(t,e);case 6:var r=Je,i=jt;Je=null,Bn(n,e,t),Je=r,jt=i,Je!==null&&(jt?(n=Je,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Je.removeChild(t.stateNode));break;case 18:Je!==null&&(jt?(n=Je,t=t.stateNode,n.nodeType===8?Oc(n.parentNode,t):n.nodeType===1&&Oc(n,t),Ss(n)):Oc(Je,t.stateNode));break;case 4:r=Je,i=jt,Je=t.stateNode.containerInfo,jt=!0,Bn(n,e,t),Je=r,jt=i;break;case 0:case 11:case 14:case 15:if(!ut&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Kd(t,e,s),i=i.next}while(i!==r)}Bn(n,e,t);break;case 1:if(!ut&&(Oi(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Ve(t,e,a)}Bn(n,e,t);break;case 21:Bn(n,e,t);break;case 22:t.mode&1?(ut=(r=ut)||t.memoizedState!==null,Bn(n,e,t),ut=r):Bn(n,e,t);break;default:Bn(n,e,t)}}function Dg(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new _A),e.forEach(function(r){var i=xA.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Jt(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:Je=a.stateNode,jt=!1;break e;case 3:Je=a.stateNode.containerInfo,jt=!0;break e;case 4:Je=a.stateNode.containerInfo,jt=!0;break e}a=a.return}if(Je===null)throw Error(z(160));hE(o,s,i),Je=null,jt=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Ve(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)pE(e,n),e=e.sibling}function pE(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Jt(e,n),rn(n),r&4){try{ds(3,n,n.return),Su(3,n)}catch(x){Ve(n,n.return,x)}try{ds(5,n,n.return)}catch(x){Ve(n,n.return,x)}}break;case 1:Jt(e,n),rn(n),r&512&&t!==null&&Oi(t,t.return);break;case 5:if(Jt(e,n),rn(n),r&512&&t!==null&&Oi(t,t.return),n.flags&32){var i=n.stateNode;try{Es(i,"")}catch(x){Ve(n,n.return,x)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&Fv(i,o),_d(a,s);var c=_d(a,o);for(s=0;s<l.length;s+=2){var h=l[s],m=l[s+1];h==="style"?qv(i,m):h==="dangerouslySetInnerHTML"?Ov(i,m):h==="children"?Es(i,m):Gf(i,h,m,c)}switch(a){case"input":hd(i,o);break;case"textarea":bv(i,o);break;case"select":var g=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var _=o.value;_!=null?qi(i,!!o.multiple,_,!1):g!==!!o.multiple&&(o.defaultValue!=null?qi(i,!!o.multiple,o.defaultValue,!0):qi(i,!!o.multiple,o.multiple?[]:"",!1))}i[Ds]=o}catch(x){Ve(n,n.return,x)}}break;case 6:if(Jt(e,n),rn(n),r&4){if(n.stateNode===null)throw Error(z(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(x){Ve(n,n.return,x)}}break;case 3:if(Jt(e,n),rn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Ss(e.containerInfo)}catch(x){Ve(n,n.return,x)}break;case 4:Jt(e,n),rn(n);break;case 13:Jt(e,n),rn(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Ih=be())),r&4&&Dg(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(ut=(c=ut)||h,Jt(e,n),ut=c):Jt(e,n),rn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!h&&n.mode&1)for(W=n,h=n.child;h!==null;){for(m=W=h;W!==null;){switch(g=W,_=g.child,g.tag){case 0:case 11:case 14:case 15:ds(4,g,g.return);break;case 1:Oi(g,g.return);var I=g.stateNode;if(typeof I.componentWillUnmount=="function"){r=g,t=g.return;try{e=r,I.props=e.memoizedProps,I.state=e.memoizedState,I.componentWillUnmount()}catch(x){Ve(r,t,x)}}break;case 5:Oi(g,g.return);break;case 22:if(g.memoizedState!==null){kg(m);continue}}_!==null?(_.return=g,W=_):kg(m)}h=h.sibling}e:for(h=null,m=n;;){if(m.tag===5){if(h===null){h=m;try{i=m.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=m.stateNode,l=m.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=Bv("display",s))}catch(x){Ve(n,n.return,x)}}}else if(m.tag===6){if(h===null)try{m.stateNode.nodeValue=c?"":m.memoizedProps}catch(x){Ve(n,n.return,x)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===n)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===n)break e;for(;m.sibling===null;){if(m.return===null||m.return===n)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Jt(e,n),rn(n),r&4&&Dg(n);break;case 21:break;default:Jt(e,n),rn(n)}}function rn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(fE(t)){var r=t;break e}t=t.return}throw Error(z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Es(i,""),r.flags&=-33);var o=Pg(n);Qd(n,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Pg(n);Wd(n,a,s);break;default:throw Error(z(161))}}catch(l){Ve(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function TA(n,e,t){W=n,mE(n)}function mE(n,e,t){for(var r=(n.mode&1)!==0;W!==null;){var i=W,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Wa;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||ut;a=Wa;var c=ut;if(Wa=s,(ut=l)&&!c)for(W=i;W!==null;)s=W,l=s.child,s.tag===22&&s.memoizedState!==null?Vg(i):l!==null?(l.return=s,W=l):Vg(i);for(;o!==null;)W=o,mE(o),o=o.sibling;W=i,Wa=a,ut=c}Ng(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,W=o):Ng(n)}}function Ng(n){for(;W!==null;){var e=W;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ut||Su(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ut)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:Xt(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&mg(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}mg(e,s,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var h=c.memoizedState;if(h!==null){var m=h.dehydrated;m!==null&&Ss(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(z(163))}ut||e.flags&512&&Hd(e)}catch(g){Ve(e,e.return,g)}}if(e===n){W=null;break}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}}function kg(n){for(;W!==null;){var e=W;if(e===n){W=null;break}var t=e.sibling;if(t!==null){t.return=e.return,W=t;break}W=e.return}}function Vg(n){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Su(4,e)}catch(l){Ve(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Ve(e,i,l)}}var o=e.return;try{Hd(e)}catch(l){Ve(e,o,l)}break;case 5:var s=e.return;try{Hd(e)}catch(l){Ve(e,s,l)}}}catch(l){Ve(e,e.return,l)}if(e===n){W=null;break}var a=e.sibling;if(a!==null){a.return=e.return,W=a;break}W=e.return}}var EA=Math.ceil,Yl=Ln.ReactCurrentDispatcher,Th=Ln.ReactCurrentOwner,$t=Ln.ReactCurrentBatchConfig,le=0,We=null,Oe=null,et=0,Nt=0,Bi=_r(0),Ge=0,Fs=null,Qr=0,Au=0,Eh=0,fs=null,It=null,Ih=0,eo=1/0,En=null,Jl=!1,Yd=null,rr=null,Qa=!1,Jn=null,Xl=0,hs=0,Jd=null,gl=-1,yl=0;function yt(){return le&6?be():gl!==-1?gl:gl=be()}function ir(n){return n.mode&1?le&2&&et!==0?et&-et:iA.transition!==null?(yl===0&&(yl=Zv()),yl):(n=he,n!==0||(n=window.event,n=n===void 0?16:sT(n.type)),n):1}function tn(n,e,t,r){if(50<hs)throw hs=0,Jd=null,Error(z(185));ea(n,t,r),(!(le&2)||n!==We)&&(n===We&&(!(le&2)&&(Au|=t),Ge===4&&Hn(n,et)),xt(n,r),t===1&&le===0&&!(e.mode&1)&&(eo=be()+500,Iu&&vr()))}function xt(n,e){var t=n.callbackNode;iS(n,e);var r=Ml(n,n===We?et:0);if(r===0)t!==null&&zm(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&zm(t),e===1)n.tag===0?rA(Mg.bind(null,n)):ST(Mg.bind(null,n)),ZS(function(){!(le&6)&&vr()}),t=null;else{switch(eT(r)){case 1:t=Qf;break;case 4:t=Xv;break;case 16:t=Vl;break;case 536870912:t=jv;break;default:t=Vl}t=wE(t,gE.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function gE(n,e){if(gl=-1,yl=0,le&6)throw Error(z(327));var t=n.callbackNode;if(Hi()&&n.callbackNode!==t)return null;var r=Ml(n,n===We?et:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=jl(n,r);else{e=r;var i=le;le|=2;var o=_E();(We!==n||et!==e)&&(En=null,eo=be()+500,qr(n,e));do try{CA();break}catch(a){yE(n,a)}while(!0);ah(),Yl.current=o,le=i,Oe!==null?e=0:(We=null,et=0,e=Ge)}if(e!==0){if(e===2&&(i=wd(n),i!==0&&(r=i,e=Xd(n,i))),e===1)throw t=Fs,qr(n,0),Hn(n,r),xt(n,be()),t;if(e===6)Hn(n,r);else{if(i=n.current.alternate,!(r&30)&&!IA(i)&&(e=jl(n,r),e===2&&(o=wd(n),o!==0&&(r=o,e=Xd(n,o))),e===1))throw t=Fs,qr(n,0),Hn(n,r),xt(n,be()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(z(345));case 2:Nr(n,It,En);break;case 3:if(Hn(n,r),(r&130023424)===r&&(e=Ih+500-be(),10<e)){if(Ml(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){yt(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=Nd(Nr.bind(null,n,It,En),e);break}Nr(n,It,En);break;case 4:if(Hn(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-en(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*EA(r/1960))-r,10<r){n.timeoutHandle=Nd(Nr.bind(null,n,It,En),r);break}Nr(n,It,En);break;case 5:Nr(n,It,En);break;default:throw Error(z(329))}}}return xt(n,be()),n.callbackNode===t?gE.bind(null,n):null}function Xd(n,e){var t=fs;return n.current.memoizedState.isDehydrated&&(qr(n,e).flags|=256),n=jl(n,e),n!==2&&(e=It,It=t,e!==null&&jd(e)),n}function jd(n){It===null?It=n:It.push.apply(It,n)}function IA(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!nn(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Hn(n,e){for(e&=~Eh,e&=~Au,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-en(e),r=1<<t;n[t]=-1,e&=~r}}function Mg(n){if(le&6)throw Error(z(327));Hi();var e=Ml(n,0);if(!(e&1))return xt(n,be()),null;var t=jl(n,e);if(n.tag!==0&&t===2){var r=wd(n);r!==0&&(e=r,t=Xd(n,r))}if(t===1)throw t=Fs,qr(n,0),Hn(n,e),xt(n,be()),t;if(t===6)throw Error(z(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Nr(n,It,En),xt(n,be()),null}function wh(n,e){var t=le;le|=1;try{return n(e)}finally{le=t,le===0&&(eo=be()+500,Iu&&vr())}}function Yr(n){Jn!==null&&Jn.tag===0&&!(le&6)&&Hi();var e=le;le|=1;var t=$t.transition,r=he;try{if($t.transition=null,he=1,n)return n()}finally{he=r,$t.transition=t,le=e,!(le&6)&&vr()}}function Ch(){Nt=Bi.current,Te(Bi)}function qr(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,jS(t)),Oe!==null)for(t=Oe.return;t!==null;){var r=t;switch(ih(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ol();break;case 3:ji(),Te(At),Te(ct),hh();break;case 5:fh(r);break;case 4:ji();break;case 13:Te(Re);break;case 19:Te(Re);break;case 10:lh(r.type._context);break;case 22:case 23:Ch()}t=t.return}if(We=n,Oe=n=or(n.current,null),et=Nt=e,Ge=0,Fs=null,Eh=Au=Qr=0,It=fs=null,Or!==null){for(e=0;e<Or.length;e++)if(t=Or[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}t.pending=r}Or=null}return n}function yE(n,e){do{var t=Oe;try{if(ah(),hl.current=Ql,Wl){for(var r=Pe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Wl=!1}if(Wr=0,He=ze=Pe=null,cs=!1,Vs=0,Th.current=null,t===null||t.return===null){Ge=1,Fs=e,Oe=null;break}e:{var o=n,s=t.return,a=t,l=e;if(e=et,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,h=a,m=h.tag;if(!(h.mode&1)&&(m===0||m===11||m===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=Eg(s);if(_!==null){_.flags&=-257,Ig(_,s,a,o,e),_.mode&1&&Tg(o,c,e),e=_,l=c;var I=e.updateQueue;if(I===null){var x=new Set;x.add(l),e.updateQueue=x}else I.add(l);break e}else{if(!(e&1)){Tg(o,c,e),Sh();break e}l=Error(z(426))}}else if(Ie&&a.mode&1){var k=Eg(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Ig(k,s,a,o,e),oh(Zi(l,a));break e}}o=l=Zi(l,a),Ge!==4&&(Ge=2),fs===null?fs=[o]:fs.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var w=eE(o,l,e);pg(o,w);break e;case 1:a=l;var E=o.type,S=o.stateNode;if(!(o.flags&128)&&(typeof E.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(rr===null||!rr.has(S)))){o.flags|=65536,e&=-e,o.lanes|=e;var N=tE(o,a,e);pg(o,N);break e}}o=o.return}while(o!==null)}TE(t)}catch(O){e=O,Oe===t&&t!==null&&(Oe=t=t.return);continue}break}while(!0)}function _E(){var n=Yl.current;return Yl.current=Ql,n===null?Ql:n}function Sh(){(Ge===0||Ge===3||Ge===2)&&(Ge=4),We===null||!(Qr&268435455)&&!(Au&268435455)||Hn(We,et)}function jl(n,e){var t=le;le|=2;var r=_E();(We!==n||et!==e)&&(En=null,qr(n,e));do try{wA();break}catch(i){yE(n,i)}while(!0);if(ah(),le=t,Yl.current=r,Oe!==null)throw Error(z(261));return We=null,et=0,Ge}function wA(){for(;Oe!==null;)vE(Oe)}function CA(){for(;Oe!==null&&!YC();)vE(Oe)}function vE(n){var e=IE(n.alternate,n,Nt);n.memoizedProps=n.pendingProps,e===null?TE(n):Oe=e,Th.current=null}function TE(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=yA(t,e),t!==null){t.flags&=32767,Oe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ge=6,Oe=null;return}}else if(t=gA(t,e,Nt),t!==null){Oe=t;return}if(e=e.sibling,e!==null){Oe=e;return}Oe=e=n}while(e!==null);Ge===0&&(Ge=5)}function Nr(n,e,t){var r=he,i=$t.transition;try{$t.transition=null,he=1,SA(n,e,t,r)}finally{$t.transition=i,he=r}return null}function SA(n,e,t,r){do Hi();while(Jn!==null);if(le&6)throw Error(z(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(z(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(oS(n,o),n===We&&(Oe=We=null,et=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Qa||(Qa=!0,wE(Vl,function(){return Hi(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=$t.transition,$t.transition=null;var s=he;he=1;var a=le;le|=4,Th.current=null,vA(n,t),pE(t,n),KS(Pd),Ll=!!xd,Pd=xd=null,n.current=t,TA(t),JC(),le=a,he=s,$t.transition=o}else n.current=t;if(Qa&&(Qa=!1,Jn=n,Xl=i),o=n.pendingLanes,o===0&&(rr=null),ZC(t.stateNode),xt(n,be()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(Jl)throw Jl=!1,n=Yd,Yd=null,n;return Xl&1&&n.tag!==0&&Hi(),o=n.pendingLanes,o&1?n===Jd?hs++:(hs=0,Jd=n):hs=0,vr(),null}function Hi(){if(Jn!==null){var n=eT(Xl),e=$t.transition,t=he;try{if($t.transition=null,he=16>n?16:n,Jn===null)var r=!1;else{if(n=Jn,Jn=null,Xl=0,le&6)throw Error(z(331));var i=le;for(le|=4,W=n.current;W!==null;){var o=W,s=o.child;if(W.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(W=c;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:ds(8,h,o)}var m=h.child;if(m!==null)m.return=h,W=m;else for(;W!==null;){h=W;var g=h.sibling,_=h.return;if(dE(h),h===c){W=null;break}if(g!==null){g.return=_,W=g;break}W=_}}}var I=o.alternate;if(I!==null){var x=I.child;if(x!==null){I.child=null;do{var k=x.sibling;x.sibling=null,x=k}while(x!==null)}}W=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,W=s;else e:for(;W!==null;){if(o=W,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ds(9,o,o.return)}var w=o.sibling;if(w!==null){w.return=o.return,W=w;break e}W=o.return}}var E=n.current;for(W=E;W!==null;){s=W;var S=s.child;if(s.subtreeFlags&2064&&S!==null)S.return=s,W=S;else e:for(s=E;W!==null;){if(a=W,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Su(9,a)}}catch(O){Ve(a,a.return,O)}if(a===s){W=null;break e}var N=a.sibling;if(N!==null){N.return=a.return,W=N;break e}W=a.return}}if(le=i,vr(),cn&&typeof cn.onPostCommitFiberRoot=="function")try{cn.onPostCommitFiberRoot(yu,n)}catch{}r=!0}return r}finally{he=t,$t.transition=e}}return!1}function Lg(n,e,t){e=Zi(t,e),e=eE(n,e,1),n=nr(n,e,1),e=yt(),n!==null&&(ea(n,1,e),xt(n,e))}function Ve(n,e,t){if(n.tag===3)Lg(n,n,t);else for(;e!==null;){if(e.tag===3){Lg(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(rr===null||!rr.has(r))){n=Zi(t,n),n=tE(e,n,1),e=nr(e,n,1),n=yt(),e!==null&&(ea(e,1,n),xt(e,n));break}}e=e.return}}function AA(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=yt(),n.pingedLanes|=n.suspendedLanes&t,We===n&&(et&t)===t&&(Ge===4||Ge===3&&(et&130023424)===et&&500>be()-Ih?qr(n,0):Eh|=t),xt(n,e)}function EE(n,e){e===0&&(n.mode&1?(e=Ua,Ua<<=1,!(Ua&130023424)&&(Ua=4194304)):e=1);var t=yt();n=Dn(n,e),n!==null&&(ea(n,e,t),xt(n,t))}function RA(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),EE(n,t)}function xA(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(z(314))}r!==null&&r.delete(e),EE(n,t)}var IE;IE=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||At.current)wt=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return wt=!1,mA(n,e,t);wt=!!(n.flags&131072)}else wt=!1,Ie&&e.flags&1048576&&AT(e,zl,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;ml(n,e),n=e.pendingProps;var i=Yi(e,ct.current);Ki(e,t),i=mh(null,e,r,n,i,t);var o=gh();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(r)?(o=!0,Bl(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ch(e),i.updater=Cu,e.stateNode=i,i._reactInternals=e,Ud(e,r,n,t),e=qd(null,e,r,!0,o,t)):(e.tag=0,Ie&&o&&rh(e),mt(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(ml(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=DA(r),n=Xt(r,n),i){case 0:e=Bd(null,e,r,n,t);break e;case 1:e=Sg(null,e,r,n,t);break e;case 11:e=wg(null,e,r,n,t);break e;case 14:e=Cg(null,e,r,Xt(r.type,n),t);break e}throw Error(z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),Bd(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),Sg(n,e,r,i,t);case 3:e:{if(oE(e),n===null)throw Error(z(387));r=e.pendingProps,o=e.memoizedState,i=o.element,kT(n,e),Kl(e,r,null,t);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Zi(Error(z(423)),e),e=Ag(n,e,r,t,i);break e}else if(r!==i){i=Zi(Error(z(424)),e),e=Ag(n,e,r,t,i);break e}else for(kt=tr(e.stateNode.containerInfo.firstChild),Lt=e,Ie=!0,Zt=null,t=DT(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Ji(),r===i){e=Nn(n,e,t);break e}mt(n,e,r,t)}e=e.child}return e;case 5:return VT(e),n===null&&Ld(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,s=i.children,Dd(r,i)?s=null:o!==null&&Dd(r,o)&&(e.flags|=32),iE(n,e),mt(n,e,s,t),e.child;case 6:return n===null&&Ld(e),null;case 13:return sE(n,e,t);case 4:return dh(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Xi(e,null,r,t):mt(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),wg(n,e,r,i,t);case 7:return mt(n,e,e.pendingProps,t),e.child;case 8:return mt(n,e,e.pendingProps.children,t),e.child;case 12:return mt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ye(Gl,r._currentValue),r._currentValue=s,o!==null)if(nn(o.value,s)){if(o.children===i.children&&!At.current){e=Nn(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=An(-1,t&-t),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var h=c.pending;h===null?l.next=l:(l.next=h.next,h.next=l),c.pending=l}}o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),Fd(o.return,t,e),a.lanes|=t;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(z(341));s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),Fd(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}mt(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ki(e,t),i=Ht(i),r=r(i),e.flags|=1,mt(n,e,r,t),e.child;case 14:return r=e.type,i=Xt(r,e.pendingProps),i=Xt(r.type,i),Cg(n,e,r,i,t);case 15:return nE(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Xt(r,i),ml(n,e),e.tag=1,Rt(r)?(n=!0,Bl(e)):n=!1,Ki(e,t),ZT(e,r,i),Ud(e,r,i,t),qd(null,e,r,!0,n,t);case 19:return aE(n,e,t);case 22:return rE(n,e,t)}throw Error(z(156,e.tag))};function wE(n,e){return Jv(n,e)}function PA(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zt(n,e,t,r){return new PA(n,e,t,r)}function Ah(n){return n=n.prototype,!(!n||!n.isReactComponent)}function DA(n){if(typeof n=="function")return Ah(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Kf)return 11;if(n===Hf)return 14}return 2}function or(n,e){var t=n.alternate;return t===null?(t=zt(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function _l(n,e,t,r,i,o){var s=2;if(r=n,typeof n=="function")Ah(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Di:return zr(t.children,i,o,e);case $f:s=8,i|=8;break;case ld:return n=zt(12,t,e,i|2),n.elementType=ld,n.lanes=o,n;case ud:return n=zt(13,t,e,i),n.elementType=ud,n.lanes=o,n;case cd:return n=zt(19,t,e,i),n.elementType=cd,n.lanes=o,n;case Vv:return Ru(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Nv:s=10;break e;case kv:s=9;break e;case Kf:s=11;break e;case Hf:s=14;break e;case Gn:s=16,r=null;break e}throw Error(z(130,n==null?n:typeof n,""))}return e=zt(s,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function zr(n,e,t,r){return n=zt(7,n,r,e),n.lanes=t,n}function Ru(n,e,t,r){return n=zt(22,n,r,e),n.elementType=Vv,n.lanes=t,n.stateNode={isHidden:!1},n}function Wc(n,e,t){return n=zt(6,n,null,e),n.lanes=t,n}function Qc(n,e,t){return e=zt(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function NA(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xc(0),this.expirationTimes=xc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Rh(n,e,t,r,i,o,s,a,l){return n=new NA(n,e,t,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=zt(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},ch(o),n}function kA(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Pi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function CE(n){if(!n)return fr;n=n._reactInternals;e:{if(li(n)!==n||n.tag!==1)throw Error(z(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(z(171))}if(n.tag===1){var t=n.type;if(Rt(t))return CT(n,t,e)}return e}function SE(n,e,t,r,i,o,s,a,l){return n=Rh(t,r,!0,n,i,o,s,a,l),n.context=CE(null),t=n.current,r=yt(),i=ir(t),o=An(r,i),o.callback=e??null,nr(t,o,i),n.current.lanes=i,ea(n,i,r),xt(n,r),n}function xu(n,e,t,r){var i=e.current,o=yt(),s=ir(i);return t=CE(t),e.context===null?e.context=t:e.pendingContext=t,e=An(o,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=nr(i,e,s),n!==null&&(tn(n,i,s,o),fl(n,i,s)),s}function Zl(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Fg(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function xh(n,e){Fg(n,e),(n=n.alternate)&&Fg(n,e)}function VA(){return null}var AE=typeof reportError=="function"?reportError:function(n){console.error(n)};function Ph(n){this._internalRoot=n}Pu.prototype.render=Ph.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(z(409));xu(n,e,null,null)};Pu.prototype.unmount=Ph.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Yr(function(){xu(null,n,null,null)}),e[Pn]=null}};function Pu(n){this._internalRoot=n}Pu.prototype.unstable_scheduleHydration=function(n){if(n){var e=rT();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Kn.length&&e!==0&&e<Kn[t].priority;t++);Kn.splice(t,0,n),t===0&&oT(n)}};function Dh(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Du(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function bg(){}function MA(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=Zl(s);o.call(c)}}var s=SE(e,r,n,0,null,!1,!1,"",bg);return n._reactRootContainer=s,n[Pn]=s.current,xs(n.nodeType===8?n.parentNode:n),Yr(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Zl(l);a.call(c)}}var l=Rh(n,0,!1,null,null,!1,!1,"",bg);return n._reactRootContainer=l,n[Pn]=l.current,xs(n.nodeType===8?n.parentNode:n),Yr(function(){xu(e,l,t,r)}),l}function Nu(n,e,t,r,i){var o=t._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Zl(s);a.call(l)}}xu(e,s,n,i)}else s=MA(t,e,n,i,r);return Zl(s)}tT=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=jo(e.pendingLanes);t!==0&&(Yf(e,t|1),xt(e,be()),!(le&6)&&(eo=be()+500,vr()))}break;case 13:Yr(function(){var r=Dn(n,1);if(r!==null){var i=yt();tn(r,n,1,i)}}),xh(n,1)}};Jf=function(n){if(n.tag===13){var e=Dn(n,134217728);if(e!==null){var t=yt();tn(e,n,134217728,t)}xh(n,134217728)}};nT=function(n){if(n.tag===13){var e=ir(n),t=Dn(n,e);if(t!==null){var r=yt();tn(t,n,e,r)}xh(n,e)}};rT=function(){return he};iT=function(n,e){var t=he;try{return he=n,e()}finally{he=t}};Td=function(n,e,t){switch(e){case"input":if(hd(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=Eu(r);if(!i)throw Error(z(90));Lv(r),hd(r,i)}}}break;case"textarea":bv(n,t);break;case"select":e=t.value,e!=null&&qi(n,!!t.multiple,e,!1)}};$v=wh;Kv=Yr;var LA={usingClientEntryPoint:!1,Events:[na,Mi,Eu,zv,Gv,wh]},zo={findFiberByHostInstance:Ur,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},FA={bundleType:zo.bundleType,version:zo.version,rendererPackageName:zo.rendererPackageName,rendererConfig:zo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ln.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Qv(n),n===null?null:n.stateNode},findFiberByHostInstance:zo.findFiberByHostInstance||VA,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{yu=Ya.inject(FA),cn=Ya}catch{}}Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LA;Ut.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dh(e))throw Error(z(200));return kA(n,e,null,t)};Ut.createRoot=function(n,e){if(!Dh(n))throw Error(z(299));var t=!1,r="",i=AE;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Rh(n,1,!1,null,null,t,!1,r,i),n[Pn]=e.current,xs(n.nodeType===8?n.parentNode:n),new Ph(e)};Ut.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(z(188)):(n=Object.keys(n).join(","),Error(z(268,n)));return n=Qv(e),n=n===null?null:n.stateNode,n};Ut.flushSync=function(n){return Yr(n)};Ut.hydrate=function(n,e,t){if(!Du(e))throw Error(z(200));return Nu(null,n,e,!0,t)};Ut.hydrateRoot=function(n,e,t){if(!Dh(n))throw Error(z(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",s=AE;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=SE(e,null,n,1,t??null,i,!1,o,s),n[Pn]=e.current,xs(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Pu(e)};Ut.render=function(n,e,t){if(!Du(e))throw Error(z(200));return Nu(null,n,e,!1,t)};Ut.unmountComponentAtNode=function(n){if(!Du(n))throw Error(z(40));return n._reactRootContainer?(Yr(function(){Nu(null,null,n,!1,function(){n._reactRootContainer=null,n[Pn]=null})}),!0):!1};Ut.unstable_batchedUpdates=wh;Ut.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!Du(t))throw Error(z(200));if(n==null||n._reactInternals===void 0)throw Error(z(38));return Nu(n,e,t,!1,r)};Ut.version="18.3.1-next-f1338f8080-20240426";function RE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(RE)}catch(n){console.error(n)}}RE(),Rv.exports=Ut;var bA=Rv.exports,Ug=bA;sd.createRoot=Ug.createRoot,sd.hydrateRoot=Ug.hydrateRoot;const UA=({onAddPhotoClick:n,searchTerm:e,onSearchChange:t,isGridEmpty:r,onToggleFavorites:i,showFavorites:o})=>b.jsx("header",{className:"sticky top-0 z-20 p-4 bg-primary-bg/80 backdrop-blur-lg border-b border-accent-soft/50",children:b.jsxs("div",{className:"container mx-auto flex justify-between items-center gap-2 sm:gap-4",children:[b.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7 text-accent",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),b.jsx("h1",{className:"text-xl font-semibold text-primary-text hidden md:block",children:"Our Photo Diary"})]}),b.jsx("div",{className:"flex-1 w-full max-w-lg",children:b.jsx("input",{type:"text",placeholder:"Search memories...",value:e,onChange:s=>t(s.target.value),className:"w-full px-5 py-2 bg-secondary-bg/70 border border-accent-soft/60 rounded-full text-primary-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-accent transition-all duration-300 shadow-inner shadow-accent-soft/20 text-sm"})}),b.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[b.jsx("button",{onClick:i,className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 group ${o?"bg-accent/20":"hover:bg-accent/10"}`,"aria-label":"Show favorites",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transition-all duration-300 ${o?"text-accent":"text-accent/70 group-hover:text-accent"}`,viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})})}),b.jsx("button",{onClick:n,className:`bg-accent hover:bg-accent-hover text-white font-bold w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 shadow-lg shadow-accent/30 hover:shadow-accent/50 transform hover:scale-110 shrink-0 ${r?"animate-soft-pulse":""}`,"aria-label":"Add new memory",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})})]})]})}),OA=({photo:n,onDelete:e,onFavorite:t,onClick:r,index:i})=>{const o=a=>{a.stopPropagation(),window.confirm("Are you sure you want to delete this memory?")&&e(n)},s=a=>{a.stopPropagation(),t(n)};return b.jsxs("div",{className:"relative group overflow-hidden rounded-xl mb-4 break-inside-avoid shadow-gentle hover:shadow-gentle-lg transition-all duration-300 bg-secondary-bg cursor-pointer opacity-0 animate-fade-in-up",onClick:()=>r(n),style:{animationDelay:`${i*50}ms`},children:[b.jsx("img",{src:n.imageUrl,alt:n.description||"Photo entry",className:"w-full h-auto object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),b.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent"}),b.jsx("div",{className:"absolute bottom-0 left-0 p-4 w-full text-white",children:b.jsx("p",{className:"text-sm font-semibold transform transition-all duration-300 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 translate-y-4",children:n.description})}),n.commentCount>0&&b.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center gap-1 text-xs bg-black/40 backdrop-blur-sm px-2 py-1 rounded-full text-white/90",children:[b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z",clipRule:"evenodd"})}),b.jsx("span",{children:n.commentCount})]}),b.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:[b.jsx("button",{onClick:s,"aria-label":"Favorite photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-colors duration-200",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",className:`transition-opacity ${n.isFavorite?"opacity-100 text-accent":"opacity-60"}`,clipRule:"evenodd"})})}),b.jsx("button",{onClick:o,"aria-label":"Delete photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-white hover:bg-red-500 focus:outline-none transition-colors duration-200",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})},bs=()=>b.jsxs("div",{className:"flex justify-center items-center h-full",children:[b.jsx("svg",{className:"h-10 w-10 text-accent",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",style:{animation:"pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),b.jsx("style",{children:`
          @keyframes pulse {
            0%, 100% {
              opacity: 1;
              transform: scale(1);
            }
            50% {
              opacity: 0.7;
              transform: scale(0.9);
            }
          }
        `})]}),BA=n=>{const e=new Date(n),t=e.getTimezoneOffset()*6e4,r=new Date(e.getTime()+t);return new Intl.DateTimeFormat("en-US",{dateStyle:"full"}).format(r)},qA=({photos:n,loading:e,error:t,onDeletePhoto:r,onFavoritePhoto:i,onPhotoClick:o})=>{if(e)return b.jsx("div",{className:"mt-20",children:b.jsx(bs,{})});if(t)return b.jsxs("div",{className:"text-center text-red-800 bg-red-100 border border-red-300 p-6 rounded-xl mt-10 max-w-2xl mx-auto shadow-gentle",children:[b.jsx("p",{className:"font-bold text-xl text-red-900",children:"Oh no, something went wrong!"}),b.jsx("p",{className:"text-sm mt-2",children:t})]});if(n.length===0)return b.jsxs("div",{className:"text-center text-secondary-text mt-20 bg-secondary-bg/50 p-10 rounded-xl max-w-md mx-auto border border-accent-soft/40 shadow-gentle flex flex-col items-center",children:[b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-20 w-20 text-accent-soft mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),b.jsx("h2",{className:"text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400",children:"No Memories Found"}),b.jsx("p",{className:"mt-2",children:"Try a different search, or click the '+' to add a photo."})]});const s=n.reduce((c,h)=>{if(!h.createdAt||!h.createdAt.toDate)return c;const m=h.createdAt.toDate().toLocaleDateString("en-CA");return c[m]||(c[m]=[]),c[m].push(h),c},{}),a=Object.keys(s).sort((c,h)=>new Date(h).getTime()-new Date(c).getTime());let l=0;return b.jsx("div",{className:"w-full mx-auto space-y-12",children:a.map(c=>b.jsxs("section",{children:[b.jsx("h2",{className:"text-xl font-semibold text-primary-text pb-2 mb-6 border-b border-accent-soft",children:BA(c)}),b.jsx("div",{className:"columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-4 md:gap-6",children:s[c].map(h=>b.jsx(OA,{photo:h,onDelete:r,onFavorite:i,onClick:o,index:l++},h.id))})]},c))})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let zA,GA;function $A(){return{geminiUrl:zA,vertexUrl:GA}}function KA(n,e,t){var r,i,o;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const s=$A();return n.vertexai?(i=s.vertexUrl)!==null&&i!==void 0?i:e:(o=s.geminiUrl)!==null&&o!==void 0?o:t}return n.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ia{}function X(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(n,e,t){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const a=s.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let c=0;c<l.length;c++){const h=l[c];f(h,e.slice(o+1),t[c])}else for(const c of l)f(c,e.slice(o+1),t)}return}else if(s.endsWith("[0]")){const a=s.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];f(l[0],e.slice(o+1),t);return}(!n[s]||typeof n[s]!="object")&&(n[s]={}),n=n[s]}const r=e[e.length-1],i=n[r];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function d(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in n){const o=n[i];return Array.isArray(o)?o.map(s=>d(s,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ce(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function xE(n,e){const t=Ce(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function PE(n,e){return Array.isArray(e)?e.map(t=>eu(n,t)):[eu(n,e)]}function eu(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function HA(n,e){const t=eu(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function WA(n,e){const t=eu(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Og(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function DE(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Og(n,t)):[Og(n,e)]}function Zd(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function Bg(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function qg(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ct(n,e){if(e==null)throw new Error("ContentUnion is required");return Zd(e)?e:{role:"user",parts:DE(n,e)}}function NE(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Ct(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Ct(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ct(n,t)):[Ct(n,e)]}function Tr(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Bg(e)||qg(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ct(n,e)]}const t=[],r=[],i=Zd(e[0]);for(const o of e){const s=Zd(o);if(s!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(o);else{if(Bg(o)||qg(o))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(o)}}return i||t.push({role:"user",parts:DE(n,r)}),t}function kE(n,e){return e}function VE(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function ku(n,e){return e}function Vu(n,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function QA(n,e,t,r=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:i?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function Er(n,e){if(typeof e!="string")throw new Error("name must be a string");return QA(n,e,"cachedContents")}function ME(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Ir(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function YA(n){return n!=null&&typeof n=="object"&&"name"in n}function JA(n){return n!=null&&typeof n=="object"&&"video"in n}function XA(n){return n!=null&&typeof n=="object"&&"uri"in n}function LE(n,e){var t;let r;if(YA(e)&&(r=e.name),!(XA(e)&&(r=e.uri,r===void 0))&&!(JA(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const o=r.split("files/")[1].match(/[a-z0-9]+/);if(o===null)throw new Error(`Could not extract file name from URI ${r}`);r=o[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function FE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function bE(n,e){for(const t of["models","tunedModels","publisherModels"])if(jA(e,t))return e[t];return[]}function jA(n,e){return n!==null&&typeof n=="object"&&e in n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZA(n,e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["data"]);r!=null&&f(t,["data"],r);const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function eR(n,e){const t={};if(d(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=d(e,["thought"]);r!=null&&f(t,["thought"],r);const i=d(e,["inlineData"]);i!=null&&f(t,["inlineData"],ZA(n,i));const o=d(e,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const s=d(e,["executableCode"]);s!=null&&f(t,["executableCode"],s);const a=d(e,["fileData"]);a!=null&&f(t,["fileData"],a);const l=d(e,["functionCall"]);l!=null&&f(t,["functionCall"],l);const c=d(e,["functionResponse"]);c!=null&&f(t,["functionResponse"],c);const h=d(e,["text"]);return h!=null&&f(t,["text"],h),t}function zg(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>eR(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function tR(){return{}}function nR(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function rR(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],nR(n,r)),t}function iR(n,e){const t={};if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");d(e,["googleSearch"])!=null&&f(t,["googleSearch"],tR());const i=d(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],rR(n,i)),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=d(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const s=d(e,["functionDeclarations"]);return s!=null&&f(t,["functionDeclarations"],s),t}function oR(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["allowedFunctionNames"]);return i!=null&&f(t,["allowedFunctionNames"],i),t}function sR(n,e){const t={},r=d(e,["functionCallingConfig"]);if(r!=null&&f(t,["functionCallingConfig"],oR(n,r)),d(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function aR(n,e,t){const r={},i=d(e,["ttl"]);t!==void 0&&i!=null&&f(t,["ttl"],i);const o=d(e,["expireTime"]);t!==void 0&&o!=null&&f(t,["expireTime"],o);const s=d(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let m=Tr(n,a);Array.isArray(m)&&(m=m.map(g=>zg(n,g))),f(t,["contents"],m)}const l=d(e,["systemInstruction"]);t!==void 0&&l!=null&&f(t,["systemInstruction"],zg(n,Ct(n,l)));const c=d(e,["tools"]);if(t!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>iR(n,g))),f(t,["tools"],m)}const h=d(e,["toolConfig"]);return t!==void 0&&h!=null&&f(t,["toolConfig"],sR(n,h)),r}function lR(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["model"],xE(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],aR(n,i,t)),t}function uR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function cR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function dR(n,e,t){const r={},i=d(e,["ttl"]);t!==void 0&&i!=null&&f(t,["ttl"],i);const o=d(e,["expireTime"]);return t!==void 0&&o!=null&&f(t,["expireTime"],o),r}function fR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],dR(n,i,t)),t}function hR(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);return t!==void 0&&o!=null&&f(t,["_query","pageToken"],o),r}function pR(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],hR(n,r,t)),t}function mR(n,e){const t={},r=d(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=d(e,["data"]);i!=null&&f(t,["data"],i);const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function gR(n,e){const t={},r=d(e,["videoMetadata"]);r!=null&&f(t,["videoMetadata"],r);const i=d(e,["thought"]);i!=null&&f(t,["thought"],i);const o=d(e,["inlineData"]);o!=null&&f(t,["inlineData"],mR(n,o));const s=d(e,["codeExecutionResult"]);s!=null&&f(t,["codeExecutionResult"],s);const a=d(e,["executableCode"]);a!=null&&f(t,["executableCode"],a);const l=d(e,["fileData"]);l!=null&&f(t,["fileData"],l);const c=d(e,["functionCall"]);c!=null&&f(t,["functionCall"],c);const h=d(e,["functionResponse"]);h!=null&&f(t,["functionResponse"],h);const m=d(e,["text"]);return m!=null&&f(t,["text"],m),t}function Gg(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>gR(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function yR(){return{}}function _R(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function vR(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],_R(n,r)),t}function TR(){return{}}function ER(n,e){const t={},r=d(e,["apiKeyString"]);return r!=null&&f(t,["apiKeyString"],r),t}function IR(n,e){const t={},r=d(e,["apiKeyConfig"]);r!=null&&f(t,["apiKeyConfig"],ER(n,r));const i=d(e,["authType"]);i!=null&&f(t,["authType"],i);const o=d(e,["googleServiceAccountConfig"]);o!=null&&f(t,["googleServiceAccountConfig"],o);const s=d(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const a=d(e,["oauthConfig"]);a!=null&&f(t,["oauthConfig"],a);const l=d(e,["oidcConfig"]);return l!=null&&f(t,["oidcConfig"],l),t}function wR(n,e){const t={},r=d(e,["authConfig"]);return r!=null&&f(t,["authConfig"],IR(n,r)),t}function CR(n,e){const t={},r=d(e,["retrieval"]);r!=null&&f(t,["retrieval"],r),d(e,["googleSearch"])!=null&&f(t,["googleSearch"],yR());const o=d(e,["googleSearchRetrieval"]);o!=null&&f(t,["googleSearchRetrieval"],vR(n,o)),d(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],TR());const a=d(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],wR(n,a));const l=d(e,["codeExecution"]);l!=null&&f(t,["codeExecution"],l);const c=d(e,["functionDeclarations"]);return c!=null&&f(t,["functionDeclarations"],c),t}function SR(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["allowedFunctionNames"]);return i!=null&&f(t,["allowedFunctionNames"],i),t}function AR(n,e){const t={},r=d(e,["latitude"]);r!=null&&f(t,["latitude"],r);const i=d(e,["longitude"]);return i!=null&&f(t,["longitude"],i),t}function RR(n,e){const t={},r=d(e,["latLng"]);return r!=null&&f(t,["latLng"],AR(n,r)),t}function xR(n,e){const t={},r=d(e,["functionCallingConfig"]);r!=null&&f(t,["functionCallingConfig"],SR(n,r));const i=d(e,["retrievalConfig"]);return i!=null&&f(t,["retrievalConfig"],RR(n,i)),t}function PR(n,e,t){const r={},i=d(e,["ttl"]);t!==void 0&&i!=null&&f(t,["ttl"],i);const o=d(e,["expireTime"]);t!==void 0&&o!=null&&f(t,["expireTime"],o);const s=d(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const a=d(e,["contents"]);if(t!==void 0&&a!=null){let m=Tr(n,a);Array.isArray(m)&&(m=m.map(g=>Gg(n,g))),f(t,["contents"],m)}const l=d(e,["systemInstruction"]);t!==void 0&&l!=null&&f(t,["systemInstruction"],Gg(n,Ct(n,l)));const c=d(e,["tools"]);if(t!==void 0&&c!=null){let m=c;Array.isArray(m)&&(m=m.map(g=>CR(n,g))),f(t,["tools"],m)}const h=d(e,["toolConfig"]);return t!==void 0&&h!=null&&f(t,["toolConfig"],xR(n,h)),r}function DR(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["model"],xE(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],PR(n,i,t)),t}function NR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function kR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function VR(n,e,t){const r={},i=d(e,["ttl"]);t!==void 0&&i!=null&&f(t,["ttl"],i);const o=d(e,["expireTime"]);return t!==void 0&&o!=null&&f(t,["expireTime"],o),r}function MR(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],Er(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],VR(n,i,t)),t}function LR(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);return t!==void 0&&o!=null&&f(t,["_query","pageToken"],o),r}function FR(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],LR(n,r,t)),t}function vl(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["model"]);o!=null&&f(t,["model"],o);const s=d(e,["createTime"]);s!=null&&f(t,["createTime"],s);const a=d(e,["updateTime"]);a!=null&&f(t,["updateTime"],a);const l=d(e,["expireTime"]);l!=null&&f(t,["expireTime"],l);const c=d(e,["usageMetadata"]);return c!=null&&f(t,["usageMetadata"],c),t}function bR(){return{}}function UR(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>vl(n,s))),f(t,["cachedContents"],o)}return t}function Tl(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["model"]);o!=null&&f(t,["model"],o);const s=d(e,["createTime"]);s!=null&&f(t,["createTime"],s);const a=d(e,["updateTime"]);a!=null&&f(t,["updateTime"],a);const l=d(e,["expireTime"]);l!=null&&f(t,["expireTime"],l);const c=d(e,["usageMetadata"]);return c!=null&&f(t,["usageMetadata"],c),t}function OR(){return{}}function BR(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Tl(n,s))),f(t,["cachedContents"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var to;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(to||(to={}));class Mu{constructor(e,t,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,i)}init(e,t,r){var i,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let s={config:{}};r?typeof r=="object"?s=Object.assign({},r):s=r:s={config:{}},s.config&&(s.config.pageToken=t.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $g;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($g||($g={}));var Kg;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Kg||(Kg={}));var Hg;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Hg||(Hg={}));var Wg;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Wg||(Wg={}));var Qg;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Qg||(Qg={}));var Yg;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(Yg||(Yg={}));var Jg;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(Jg||(Jg={}));var Xg;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(Xg||(Xg={}));var jg;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(jg||(jg={}));var Zg;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(Zg||(Zg={}));var ey;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ey||(ey={}));var ty;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(ty||(ty={}));var ny;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(ny||(ny={}));var tu;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(tu||(tu={}));var ry;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(ry||(ry={}));var ef;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(ef||(ef={}));var iy;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(iy||(iy={}));var oy;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(oy||(oy={}));var sy;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(sy||(sy={}));var ay;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(ay||(ay={}));var ly;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(ly||(ly={}));var uy;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(uy||(uy={}));var cy;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(cy||(cy={}));var dy;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(dy||(dy={}));var fy;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(fy||(fy={}));var hy;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(hy||(hy={}));var py;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(py||(py={}));var my;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(my||(my={}));var gy;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(gy||(gy={}));var yy;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(yy||(yy={}));var _y;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(_y||(_y={}));var vy;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(vy||(vy={}));var Ty;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(Ty||(Ty={}));var Ey;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Ey||(Ey={}));class Ja{get text(){var e,t,r,i,o,s,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let c="",h=!1;const m=[];for(const g of(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[_,I]of Object.entries(g))_!=="text"&&_!=="thought"&&(I!==null||I!==void 0)&&m.push(_);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;h=!0,c+=g.text}}return m.length>0&&console.warn(`there are non-text parts ${m} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?c:void 0}get data(){var e,t,r,i,o,s,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let c="";const h=[];for(const m of(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,_]of Object.entries(m))g!=="inlineData"&&(_!==null||_!==void 0)&&h.push(g);m.inlineData&&typeof m.inlineData.data=="string"&&(c+=atob(m.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),c.length>0?btoa(c):void 0}get functionCalls(){var e,t,r,i,o,s,a,l;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const c=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((c==null?void 0:c.length)!==0)return c}get executableCode(){var e,t,r,i,o,s,a,l,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.executableCode).map(m=>m.executableCode).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return(c=h==null?void 0:h[0])===null||c===void 0?void 0:c.code}get codeExecutionResult(){var e,t,r,i,o,s,a,l,c;if(((i=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(l=(a=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(m=>m.codeExecutionResult).map(m=>m.codeExecutionResult).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return(c=h==null?void 0:h[0])===null||c===void 0?void 0:c.output}}class Iy{}class wy{}class qR{}class zR{}class Cy{}class Sy{}class Ay{}class GR{}class Ry{}class xy{}class Py{}class $R{}class tf{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class KR{}class HR{}class WR{get text(){var e,t,r;let i="",o=!1;const s=[];for(const a of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(a))l!=="text"&&l!=="thought"&&c!==null&&s.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,i+=a.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,t,r;let i="";const o=[];for(const s of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[a,l]of Object.entries(s))a!=="inlineData"&&l!==null&&o.push(a);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QR extends ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Mu(to.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=DR(this.apiClient,e);return a=X("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Tl(this.apiClient,h))}else{const c=lR(this.apiClient,e);return a=X("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>vl(this.apiClient,h))}}async get(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=NR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Tl(this.apiClient,h))}else{const c=uR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>vl(this.apiClient,h))}}async delete(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=kR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(()=>{const h=OR(),m=new xy;return Object.assign(m,h),m})}else{const c=cR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(()=>{const h=bR(),m=new xy;return Object.assign(m,h),m})}}async update(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=MR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Tl(this.apiClient,h))}else{const c=fR(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>vl(this.apiClient,h))}}async listInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=FR(this.apiClient,e);return a=X("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=BR(this.apiClient,h),g=new Py;return Object.assign(g,m),g})}else{const c=pR(this.apiClient,e);return a=X("cachedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=UR(this.apiClient,h),g=new Py;return Object.assign(g,m),g})}}}function Dy(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function lt(n){return this instanceof lt?(this.v=n,this):new lt(n)}function nu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(_){return function(I){return Promise.resolve(I).then(_,m)}}function a(_,I){r[_]&&(i[_]=function(x){return new Promise(function(k,w){o.push([_,x,k,w])>1||l(_,x)})},I&&(i[_]=I(i[_])))}function l(_,I){try{c(r[_](I))}catch(x){g(o[0][3],x)}}function c(_){_.value instanceof lt?Promise.resolve(_.value.v).then(h,m):g(o[0][2],_)}function h(_){l("next",_)}function m(_){l("throw",_)}function g(_,I){_(I),o.shift(),o.length&&l(o[0][0],o[0][1])}}function nf(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof Dy=="function"?Dy(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=n[o]&&function(s){return new Promise(function(a,l){s=n[o](s),i(a,l,s.done,s.value)})}}function i(o,s,a,l){Promise.resolve(l).then(function(c){o({value:c,done:a})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YR(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:UE(t)}function UE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function JR(n){if(n.length!==0){if(n[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function XR(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0,i=n[0];for(;r<t;)if(n[r].role==="user")i=n[r],r++;else{const o=[];let s=!0;for(;r<t&&n[r].role==="model";)o.push(n[r]),s&&!UE(n[r])&&(s=!1),r++;s&&(e.push(i),e.push(...o))}return e}class jR{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new ZR(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}class ZR{constructor(e,t,r,i={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),JR(o)}async sendMessage(e){var t;await this.sendPromise;const r=Ct(this.apiClient,e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,s;const l=(s=(o=(await i).candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,c=l?[l]:[];this.recordHistory(r,c)})(),await this.sendPromise,i}async sendMessageStream(e){var t;await this.sendPromise;const r=Ct(this.apiClient,e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){return e?XR(this.history):this.history}processStreamResponse(e,t){var r,i;return nu(this,arguments,function*(){var s,a,l,c;const h=[];try{for(var m=!0,g=nf(e),_;_=yield lt(g.next()),s=_.done,!s;m=!0){c=_.value,m=!1;const I=c;if(YR(I)){const x=(i=(r=I.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;x!==void 0&&h.push(x)}yield yield lt(I)}}catch(I){a={error:I}}finally{try{!m&&!s&&(l=g.return)&&(yield lt(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(t,h)})}recordHistory(e,t){let r=[];t.length>0&&t.every(i=>i.role==="model")?r=t:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ex(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);return t!==void 0&&o!=null&&f(t,["_query","pageToken"],o),r}function tx(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],ex(n,r,t)),t}function nx(n,e){const t={},r=d(e,["details"]);r!=null&&f(t,["details"],r);const i=d(e,["message"]);i!=null&&f(t,["message"],i);const o=d(e,["code"]);return o!=null&&f(t,["code"],o),t}function rx(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["mimeType"]);o!=null&&f(t,["mimeType"],o);const s=d(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const a=d(e,["createTime"]);a!=null&&f(t,["createTime"],a);const l=d(e,["expirationTime"]);l!=null&&f(t,["expirationTime"],l);const c=d(e,["updateTime"]);c!=null&&f(t,["updateTime"],c);const h=d(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=d(e,["uri"]);m!=null&&f(t,["uri"],m);const g=d(e,["downloadUri"]);g!=null&&f(t,["downloadUri"],g);const _=d(e,["state"]);_!=null&&f(t,["state"],_);const I=d(e,["source"]);I!=null&&f(t,["source"],I);const x=d(e,["videoMetadata"]);x!=null&&f(t,["videoMetadata"],x);const k=d(e,["error"]);return k!=null&&f(t,["error"],nx(n,k)),t}function ix(n,e){const t={},r=d(e,["file"]);r!=null&&f(t,["file"],rx(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function ox(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","file"],LE(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function sx(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","file"],LE(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function ax(n,e){const t={},r=d(e,["details"]);r!=null&&f(t,["details"],r);const i=d(e,["message"]);i!=null&&f(t,["message"],i);const o=d(e,["code"]);return o!=null&&f(t,["code"],o),t}function rf(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["mimeType"]);o!=null&&f(t,["mimeType"],o);const s=d(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const a=d(e,["createTime"]);a!=null&&f(t,["createTime"],a);const l=d(e,["expirationTime"]);l!=null&&f(t,["expirationTime"],l);const c=d(e,["updateTime"]);c!=null&&f(t,["updateTime"],c);const h=d(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=d(e,["uri"]);m!=null&&f(t,["uri"],m);const g=d(e,["downloadUri"]);g!=null&&f(t,["downloadUri"],g);const _=d(e,["state"]);_!=null&&f(t,["state"],_);const I=d(e,["source"]);I!=null&&f(t,["source"],I);const x=d(e,["videoMetadata"]);x!=null&&f(t,["videoMetadata"],x);const k=d(e,["error"]);return k!=null&&f(t,["error"],ax(n,k)),t}function lx(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>rf(n,s))),f(t,["files"],o)}return t}function ux(){return{}}function cx(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dx extends ia{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Mu(to.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>rf(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tx(this.apiClient,e);return o=X("files",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=lx(this.apiClient,l),h=new $R;return Object.assign(h,c),h})}}async createInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ix(this.apiClient,e);return o=X("upload/v1beta/files",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(()=>{const l=ux(),c=new KR;return Object.assign(c,l),c})}}async get(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ox(this.apiClient,e);return o=X("files/{file}",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>rf(this.apiClient,l))}}async delete(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=sx(this.apiClient,e);return o=X("files/{file}",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(()=>{const l=cx(),c=new HR;return Object.assign(c,l),c})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function fx(n,e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["data"]);r!=null&&f(t,["data"],r);const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function hx(n,e){const t={},r=d(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=d(e,["data"]);i!=null&&f(t,["data"],i);const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function px(n,e){const t={};if(d(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=d(e,["thought"]);r!=null&&f(t,["thought"],r);const i=d(e,["inlineData"]);i!=null&&f(t,["inlineData"],fx(n,i));const o=d(e,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const s=d(e,["executableCode"]);s!=null&&f(t,["executableCode"],s);const a=d(e,["fileData"]);a!=null&&f(t,["fileData"],a);const l=d(e,["functionCall"]);l!=null&&f(t,["functionCall"],l);const c=d(e,["functionResponse"]);c!=null&&f(t,["functionResponse"],c);const h=d(e,["text"]);return h!=null&&f(t,["text"],h),t}function mx(n,e){const t={},r=d(e,["videoMetadata"]);r!=null&&f(t,["videoMetadata"],r);const i=d(e,["thought"]);i!=null&&f(t,["thought"],i);const o=d(e,["inlineData"]);o!=null&&f(t,["inlineData"],hx(n,o));const s=d(e,["codeExecutionResult"]);s!=null&&f(t,["codeExecutionResult"],s);const a=d(e,["executableCode"]);a!=null&&f(t,["executableCode"],a);const l=d(e,["fileData"]);l!=null&&f(t,["fileData"],l);const c=d(e,["functionCall"]);c!=null&&f(t,["functionCall"],c);const h=d(e,["functionResponse"]);h!=null&&f(t,["functionResponse"],h);const m=d(e,["text"]);return m!=null&&f(t,["text"],m),t}function gx(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>px(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function yx(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>mx(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function _x(){return{}}function vx(){return{}}function Tx(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function Ex(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function Ix(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],Tx(n,r)),t}function wx(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],Ex(n,r)),t}function Cx(){return{}}function Sx(n,e){const t={},r=d(e,["apiKeyString"]);return r!=null&&f(t,["apiKeyString"],r),t}function Ax(n,e){const t={},r=d(e,["apiKeyConfig"]);r!=null&&f(t,["apiKeyConfig"],Sx(n,r));const i=d(e,["authType"]);i!=null&&f(t,["authType"],i);const o=d(e,["googleServiceAccountConfig"]);o!=null&&f(t,["googleServiceAccountConfig"],o);const s=d(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const a=d(e,["oauthConfig"]);a!=null&&f(t,["oauthConfig"],a);const l=d(e,["oidcConfig"]);return l!=null&&f(t,["oidcConfig"],l),t}function Rx(n,e){const t={},r=d(e,["authConfig"]);return r!=null&&f(t,["authConfig"],Ax(n,r)),t}function xx(n,e){const t={};if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");d(e,["googleSearch"])!=null&&f(t,["googleSearch"],_x());const i=d(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],Ix(n,i)),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=d(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const s=d(e,["functionDeclarations"]);return s!=null&&f(t,["functionDeclarations"],s),t}function Px(n,e){const t={},r=d(e,["retrieval"]);r!=null&&f(t,["retrieval"],r),d(e,["googleSearch"])!=null&&f(t,["googleSearch"],vx());const o=d(e,["googleSearchRetrieval"]);o!=null&&f(t,["googleSearchRetrieval"],wx(n,o)),d(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],Cx());const a=d(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],Rx(n,a));const l=d(e,["codeExecution"]);l!=null&&f(t,["codeExecution"],l);const c=d(e,["functionDeclarations"]);return c!=null&&f(t,["functionDeclarations"],c),t}function Dx(n,e){const t={},r=d(e,["handle"]);if(r!=null&&f(t,["handle"],r),d(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function Nx(n,e){const t={},r=d(e,["handle"]);r!=null&&f(t,["handle"],r);const i=d(e,["transparent"]);return i!=null&&f(t,["transparent"],i),t}function Ny(){return{}}function ky(){return{}}function kx(n,e){const t={},r=d(e,["disabled"]);r!=null&&f(t,["disabled"],r);const i=d(e,["startOfSpeechSensitivity"]);i!=null&&f(t,["startOfSpeechSensitivity"],i);const o=d(e,["endOfSpeechSensitivity"]);o!=null&&f(t,["endOfSpeechSensitivity"],o);const s=d(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const a=d(e,["silenceDurationMs"]);return a!=null&&f(t,["silenceDurationMs"],a),t}function Vx(n,e){const t={},r=d(e,["disabled"]);r!=null&&f(t,["disabled"],r);const i=d(e,["startOfSpeechSensitivity"]);i!=null&&f(t,["startOfSpeechSensitivity"],i);const o=d(e,["endOfSpeechSensitivity"]);o!=null&&f(t,["endOfSpeechSensitivity"],o);const s=d(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const a=d(e,["silenceDurationMs"]);return a!=null&&f(t,["silenceDurationMs"],a),t}function Mx(n,e){const t={},r=d(e,["automaticActivityDetection"]);r!=null&&f(t,["automaticActivityDetection"],kx(n,r));const i=d(e,["activityHandling"]);i!=null&&f(t,["activityHandling"],i);const o=d(e,["turnCoverage"]);return o!=null&&f(t,["turnCoverage"],o),t}function Lx(n,e){const t={},r=d(e,["automaticActivityDetection"]);r!=null&&f(t,["automaticActivityDetection"],Vx(n,r));const i=d(e,["activityHandling"]);i!=null&&f(t,["activityHandling"],i);const o=d(e,["turnCoverage"]);return o!=null&&f(t,["turnCoverage"],o),t}function Fx(n,e){const t={},r=d(e,["targetTokens"]);return r!=null&&f(t,["targetTokens"],r),t}function bx(n,e){const t={},r=d(e,["targetTokens"]);return r!=null&&f(t,["targetTokens"],r),t}function Ux(n,e){const t={},r=d(e,["triggerTokens"]);r!=null&&f(t,["triggerTokens"],r);const i=d(e,["slidingWindow"]);return i!=null&&f(t,["slidingWindow"],Fx(n,i)),t}function Ox(n,e){const t={},r=d(e,["triggerTokens"]);r!=null&&f(t,["triggerTokens"],r);const i=d(e,["slidingWindow"]);return i!=null&&f(t,["slidingWindow"],bx(n,i)),t}function Bx(n,e,t){const r={},i=d(e,["generationConfig"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig"],i);const o=d(e,["responseModalities"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","responseModalities"],o);const s=d(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&f(t,["setup","generationConfig","topP"],a);const l=d(e,["topK"]);t!==void 0&&l!=null&&f(t,["setup","generationConfig","topK"],l);const c=d(e,["maxOutputTokens"]);t!==void 0&&c!=null&&f(t,["setup","generationConfig","maxOutputTokens"],c);const h=d(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=d(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const g=d(e,["speechConfig"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","speechConfig"],g);const _=d(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],gx(n,Ct(n,_)));const I=d(e,["tools"]);if(t!==void 0&&I!=null){let N=Vu(n,I);Array.isArray(N)&&(N=N.map(O=>xx(n,ku(n,O)))),f(t,["setup","tools"],N)}const x=d(e,["sessionResumption"]);t!==void 0&&x!=null&&f(t,["setup","sessionResumption"],Dx(n,x));const k=d(e,["inputAudioTranscription"]);t!==void 0&&k!=null&&f(t,["setup","inputAudioTranscription"],Ny());const w=d(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&f(t,["setup","outputAudioTranscription"],Ny());const E=d(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&f(t,["setup","realtimeInputConfig"],Mx(n,E));const S=d(e,["contextWindowCompression"]);return t!==void 0&&S!=null&&f(t,["setup","contextWindowCompression"],Ux(n,S)),r}function qx(n,e,t){const r={},i=d(e,["generationConfig"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig"],i);const o=d(e,["responseModalities"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","responseModalities"],o);const s=d(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const a=d(e,["topP"]);t!==void 0&&a!=null&&f(t,["setup","generationConfig","topP"],a);const l=d(e,["topK"]);t!==void 0&&l!=null&&f(t,["setup","generationConfig","topK"],l);const c=d(e,["maxOutputTokens"]);t!==void 0&&c!=null&&f(t,["setup","generationConfig","maxOutputTokens"],c);const h=d(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=d(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const g=d(e,["speechConfig"]);t!==void 0&&g!=null&&f(t,["setup","generationConfig","speechConfig"],g);const _=d(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],yx(n,Ct(n,_)));const I=d(e,["tools"]);if(t!==void 0&&I!=null){let N=Vu(n,I);Array.isArray(N)&&(N=N.map(O=>Px(n,ku(n,O)))),f(t,["setup","tools"],N)}const x=d(e,["sessionResumption"]);t!==void 0&&x!=null&&f(t,["setup","sessionResumption"],Nx(n,x));const k=d(e,["inputAudioTranscription"]);t!==void 0&&k!=null&&f(t,["setup","inputAudioTranscription"],ky());const w=d(e,["outputAudioTranscription"]);t!==void 0&&w!=null&&f(t,["setup","outputAudioTranscription"],ky());const E=d(e,["realtimeInputConfig"]);t!==void 0&&E!=null&&f(t,["setup","realtimeInputConfig"],Lx(n,E));const S=d(e,["contextWindowCompression"]);return t!==void 0&&S!=null&&f(t,["setup","contextWindowCompression"],Ox(n,S)),r}function zx(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["setup","model"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],Bx(n,i,t)),t}function Gx(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["setup","model"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],qx(n,i,t)),t}function $x(){return{}}function Kx(){return{}}function Hx(){return{}}function Wx(){return{}}function Qx(n,e){const t={},r=d(e,["media"]);r!=null&&f(t,["mediaChunks"],PE(n,r));const i=d(e,["audio"]);i!=null&&f(t,["audio"],WA(n,i));const o=d(e,["audioStreamEnd"]);o!=null&&f(t,["audioStreamEnd"],o);const s=d(e,["video"]);s!=null&&f(t,["video"],HA(n,s));const a=d(e,["text"]);return a!=null&&f(t,["text"],a),d(e,["activityStart"])!=null&&f(t,["activityStart"],$x()),d(e,["activityEnd"])!=null&&f(t,["activityEnd"],Hx()),t}function Yx(n,e){const t={},r=d(e,["media"]);if(r!=null&&f(t,["mediaChunks"],PE(n,r)),d(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const i=d(e,["audioStreamEnd"]);if(i!=null&&f(t,["audioStreamEnd"],i),d(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(d(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return d(e,["activityStart"])!=null&&f(t,["activityStart"],Kx()),d(e,["activityEnd"])!=null&&f(t,["activityEnd"],Wx()),t}function Jx(){return{}}function Xx(){return{}}function jx(n,e){const t={},r=d(e,["data"]);r!=null&&f(t,["data"],r);const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function Zx(n,e){const t={},r=d(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=d(e,["data"]);i!=null&&f(t,["data"],i);const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function eP(n,e){const t={},r=d(e,["thought"]);r!=null&&f(t,["thought"],r);const i=d(e,["inlineData"]);i!=null&&f(t,["inlineData"],jx(n,i));const o=d(e,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const s=d(e,["executableCode"]);s!=null&&f(t,["executableCode"],s);const a=d(e,["fileData"]);a!=null&&f(t,["fileData"],a);const l=d(e,["functionCall"]);l!=null&&f(t,["functionCall"],l);const c=d(e,["functionResponse"]);c!=null&&f(t,["functionResponse"],c);const h=d(e,["text"]);return h!=null&&f(t,["text"],h),t}function tP(n,e){const t={},r=d(e,["videoMetadata"]);r!=null&&f(t,["videoMetadata"],r);const i=d(e,["thought"]);i!=null&&f(t,["thought"],i);const o=d(e,["inlineData"]);o!=null&&f(t,["inlineData"],Zx(n,o));const s=d(e,["codeExecutionResult"]);s!=null&&f(t,["codeExecutionResult"],s);const a=d(e,["executableCode"]);a!=null&&f(t,["executableCode"],a);const l=d(e,["fileData"]);l!=null&&f(t,["fileData"],l);const c=d(e,["functionCall"]);c!=null&&f(t,["functionCall"],c);const h=d(e,["functionResponse"]);h!=null&&f(t,["functionResponse"],h);const m=d(e,["text"]);return m!=null&&f(t,["text"],m),t}function nP(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>eP(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function rP(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>tP(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function Vy(n,e){const t={},r=d(e,["text"]);r!=null&&f(t,["text"],r);const i=d(e,["finished"]);return i!=null&&f(t,["finished"],i),t}function My(n,e){const t={},r=d(e,["text"]);r!=null&&f(t,["text"],r);const i=d(e,["finished"]);return i!=null&&f(t,["finished"],i),t}function iP(n,e){const t={},r=d(e,["modelTurn"]);r!=null&&f(t,["modelTurn"],nP(n,r));const i=d(e,["turnComplete"]);i!=null&&f(t,["turnComplete"],i);const o=d(e,["interrupted"]);o!=null&&f(t,["interrupted"],o);const s=d(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const a=d(e,["generationComplete"]);a!=null&&f(t,["generationComplete"],a);const l=d(e,["inputTranscription"]);l!=null&&f(t,["inputTranscription"],Vy(n,l));const c=d(e,["outputTranscription"]);return c!=null&&f(t,["outputTranscription"],Vy(n,c)),t}function oP(n,e){const t={},r=d(e,["modelTurn"]);r!=null&&f(t,["modelTurn"],rP(n,r));const i=d(e,["turnComplete"]);i!=null&&f(t,["turnComplete"],i);const o=d(e,["interrupted"]);o!=null&&f(t,["interrupted"],o);const s=d(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const a=d(e,["generationComplete"]);a!=null&&f(t,["generationComplete"],a);const l=d(e,["inputTranscription"]);l!=null&&f(t,["inputTranscription"],My(n,l));const c=d(e,["outputTranscription"]);return c!=null&&f(t,["outputTranscription"],My(n,c)),t}function sP(n,e){const t={},r=d(e,["id"]);r!=null&&f(t,["id"],r);const i=d(e,["args"]);i!=null&&f(t,["args"],i);const o=d(e,["name"]);return o!=null&&f(t,["name"],o),t}function aP(n,e){const t={},r=d(e,["args"]);r!=null&&f(t,["args"],r);const i=d(e,["name"]);return i!=null&&f(t,["name"],i),t}function lP(n,e){const t={},r=d(e,["functionCalls"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>sP(n,o))),f(t,["functionCalls"],i)}return t}function uP(n,e){const t={},r=d(e,["functionCalls"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>aP(n,o))),f(t,["functionCalls"],i)}return t}function cP(n,e){const t={},r=d(e,["ids"]);return r!=null&&f(t,["ids"],r),t}function dP(n,e){const t={},r=d(e,["ids"]);return r!=null&&f(t,["ids"],r),t}function Xa(n,e){const t={},r=d(e,["modality"]);r!=null&&f(t,["modality"],r);const i=d(e,["tokenCount"]);return i!=null&&f(t,["tokenCount"],i),t}function ja(n,e){const t={},r=d(e,["modality"]);r!=null&&f(t,["modality"],r);const i=d(e,["tokenCount"]);return i!=null&&f(t,["tokenCount"],i),t}function fP(n,e){const t={},r=d(e,["promptTokenCount"]);r!=null&&f(t,["promptTokenCount"],r);const i=d(e,["cachedContentTokenCount"]);i!=null&&f(t,["cachedContentTokenCount"],i);const o=d(e,["responseTokenCount"]);o!=null&&f(t,["responseTokenCount"],o);const s=d(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const a=d(e,["thoughtsTokenCount"]);a!=null&&f(t,["thoughtsTokenCount"],a);const l=d(e,["totalTokenCount"]);l!=null&&f(t,["totalTokenCount"],l);const c=d(e,["promptTokensDetails"]);if(c!=null){let _=c;Array.isArray(_)&&(_=_.map(I=>Xa(n,I))),f(t,["promptTokensDetails"],_)}const h=d(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(I=>Xa(n,I))),f(t,["cacheTokensDetails"],_)}const m=d(e,["responseTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(I=>Xa(n,I))),f(t,["responseTokensDetails"],_)}const g=d(e,["toolUsePromptTokensDetails"]);if(g!=null){let _=g;Array.isArray(_)&&(_=_.map(I=>Xa(n,I))),f(t,["toolUsePromptTokensDetails"],_)}return t}function hP(n,e){const t={},r=d(e,["promptTokenCount"]);r!=null&&f(t,["promptTokenCount"],r);const i=d(e,["cachedContentTokenCount"]);i!=null&&f(t,["cachedContentTokenCount"],i);const o=d(e,["candidatesTokenCount"]);o!=null&&f(t,["responseTokenCount"],o);const s=d(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const a=d(e,["thoughtsTokenCount"]);a!=null&&f(t,["thoughtsTokenCount"],a);const l=d(e,["totalTokenCount"]);l!=null&&f(t,["totalTokenCount"],l);const c=d(e,["promptTokensDetails"]);if(c!=null){let I=c;Array.isArray(I)&&(I=I.map(x=>ja(n,x))),f(t,["promptTokensDetails"],I)}const h=d(e,["cacheTokensDetails"]);if(h!=null){let I=h;Array.isArray(I)&&(I=I.map(x=>ja(n,x))),f(t,["cacheTokensDetails"],I)}const m=d(e,["candidatesTokensDetails"]);if(m!=null){let I=m;Array.isArray(I)&&(I=I.map(x=>ja(n,x))),f(t,["responseTokensDetails"],I)}const g=d(e,["toolUsePromptTokensDetails"]);if(g!=null){let I=g;Array.isArray(I)&&(I=I.map(x=>ja(n,x))),f(t,["toolUsePromptTokensDetails"],I)}const _=d(e,["trafficType"]);return _!=null&&f(t,["trafficType"],_),t}function pP(n,e){const t={},r=d(e,["timeLeft"]);return r!=null&&f(t,["timeLeft"],r),t}function mP(n,e){const t={},r=d(e,["timeLeft"]);return r!=null&&f(t,["timeLeft"],r),t}function gP(n,e){const t={},r=d(e,["newHandle"]);r!=null&&f(t,["newHandle"],r);const i=d(e,["resumable"]);i!=null&&f(t,["resumable"],i);const o=d(e,["lastConsumedClientMessageIndex"]);return o!=null&&f(t,["lastConsumedClientMessageIndex"],o),t}function yP(n,e){const t={},r=d(e,["newHandle"]);r!=null&&f(t,["newHandle"],r);const i=d(e,["resumable"]);i!=null&&f(t,["resumable"],i);const o=d(e,["lastConsumedClientMessageIndex"]);return o!=null&&f(t,["lastConsumedClientMessageIndex"],o),t}function _P(n,e){const t={};d(e,["setupComplete"])!=null&&f(t,["setupComplete"],Jx());const i=d(e,["serverContent"]);i!=null&&f(t,["serverContent"],iP(n,i));const o=d(e,["toolCall"]);o!=null&&f(t,["toolCall"],lP(n,o));const s=d(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],cP(n,s));const a=d(e,["usageMetadata"]);a!=null&&f(t,["usageMetadata"],fP(n,a));const l=d(e,["goAway"]);l!=null&&f(t,["goAway"],pP(n,l));const c=d(e,["sessionResumptionUpdate"]);return c!=null&&f(t,["sessionResumptionUpdate"],gP(n,c)),t}function vP(n,e){const t={};d(e,["setupComplete"])!=null&&f(t,["setupComplete"],Xx());const i=d(e,["serverContent"]);i!=null&&f(t,["serverContent"],oP(n,i));const o=d(e,["toolCall"]);o!=null&&f(t,["toolCall"],uP(n,o));const s=d(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],dP(n,s));const a=d(e,["usageMetadata"]);a!=null&&f(t,["usageMetadata"],hP(n,a));const l=d(e,["goAway"]);l!=null&&f(t,["goAway"],mP(n,l));const c=d(e,["sessionResumptionUpdate"]);return c!=null&&f(t,["sessionResumptionUpdate"],yP(n,c)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function TP(n,e){const t={};if(d(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=d(e,["data"]);r!=null&&f(t,["data"],r);const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function EP(n,e){const t={};if(d(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=d(e,["thought"]);r!=null&&f(t,["thought"],r);const i=d(e,["inlineData"]);i!=null&&f(t,["inlineData"],TP(n,i));const o=d(e,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const s=d(e,["executableCode"]);s!=null&&f(t,["executableCode"],s);const a=d(e,["fileData"]);a!=null&&f(t,["fileData"],a);const l=d(e,["functionCall"]);l!=null&&f(t,["functionCall"],l);const c=d(e,["functionResponse"]);c!=null&&f(t,["functionResponse"],c);const h=d(e,["text"]);return h!=null&&f(t,["text"],h),t}function Lu(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>EP(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function IP(n,e){const t={};if(d(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=d(e,["category"]);r!=null&&f(t,["category"],r);const i=d(e,["threshold"]);return i!=null&&f(t,["threshold"],i),t}function wP(){return{}}function CP(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function SP(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],CP(n,r)),t}function AP(n,e){const t={};if(d(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");d(e,["googleSearch"])!=null&&f(t,["googleSearch"],wP());const i=d(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],SP(n,i)),d(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(d(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const o=d(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const s=d(e,["functionDeclarations"]);return s!=null&&f(t,["functionDeclarations"],s),t}function RP(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["allowedFunctionNames"]);return i!=null&&f(t,["allowedFunctionNames"],i),t}function xP(n,e){const t={},r=d(e,["functionCallingConfig"]);if(r!=null&&f(t,["functionCallingConfig"],RP(n,r)),d(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return t}function PP(n,e){const t={},r=d(e,["voiceName"]);return r!=null&&f(t,["voiceName"],r),t}function DP(n,e){const t={},r=d(e,["prebuiltVoiceConfig"]);return r!=null&&f(t,["prebuiltVoiceConfig"],PP(n,r)),t}function NP(n,e){const t={},r=d(e,["voiceConfig"]);r!=null&&f(t,["voiceConfig"],DP(n,r));const i=d(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function kP(n,e){const t={},r=d(e,["includeThoughts"]);r!=null&&f(t,["includeThoughts"],r);const i=d(e,["thinkingBudget"]);return i!=null&&f(t,["thinkingBudget"],i),t}function VP(n,e,t){const r={},i=d(e,["systemInstruction"]);t!==void 0&&i!=null&&f(t,["systemInstruction"],Lu(n,Ct(n,i)));const o=d(e,["temperature"]);o!=null&&f(r,["temperature"],o);const s=d(e,["topP"]);s!=null&&f(r,["topP"],s);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&f(r,["maxOutputTokens"],c);const h=d(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const m=d(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const _=d(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const I=d(e,["frequencyPenalty"]);I!=null&&f(r,["frequencyPenalty"],I);const x=d(e,["seed"]);x!=null&&f(r,["seed"],x);const k=d(e,["responseMimeType"]);k!=null&&f(r,["responseMimeType"],k);const w=d(e,["responseSchema"]);if(w!=null&&f(r,["responseSchema"],kE(n,w)),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=d(e,["safetySettings"]);if(t!==void 0&&E!=null){let R=E;Array.isArray(R)&&(R=R.map(D=>IP(n,D))),f(t,["safetySettings"],R)}const S=d(e,["tools"]);if(t!==void 0&&S!=null){let R=Vu(n,S);Array.isArray(R)&&(R=R.map(D=>AP(n,ku(n,D)))),f(t,["tools"],R)}const N=d(e,["toolConfig"]);if(t!==void 0&&N!=null&&f(t,["toolConfig"],xP(n,N)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const O=d(e,["cachedContent"]);t!==void 0&&O!=null&&f(t,["cachedContent"],Er(n,O));const B=d(e,["responseModalities"]);B!=null&&f(r,["responseModalities"],B);const C=d(e,["mediaResolution"]);C!=null&&f(r,["mediaResolution"],C);const v=d(e,["speechConfig"]);if(v!=null&&f(r,["speechConfig"],NP(n,VE(n,v))),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const A=d(e,["thinkingConfig"]);return A!=null&&f(r,["thinkingConfig"],kP(n,A)),r}function Ly(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);if(i!=null){let s=Tr(n,i);Array.isArray(s)&&(s=s.map(a=>Lu(n,a))),f(t,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(t,["generationConfig"],VP(n,o,t)),t}function MP(n,e,t){const r={},i=d(e,["taskType"]);t!==void 0&&i!=null&&f(t,["requests[]","taskType"],i);const o=d(e,["title"]);t!==void 0&&o!=null&&f(t,["requests[]","title"],o);const s=d(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&f(t,["requests[]","outputDimensionality"],s),d(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function LP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);i!=null&&f(t,["requests[]","content"],NE(n,i));const o=d(e,["config"]);o!=null&&f(t,["config"],MP(n,o,t));const s=d(e,["model"]);return s!==void 0&&f(t,["requests[]","model"],Ce(n,s)),t}function FP(n,e,t){const r={};if(d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=d(e,["numberOfImages"]);t!==void 0&&i!=null&&f(t,["parameters","sampleCount"],i);const o=d(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const s=d(e,["guidanceScale"]);if(t!==void 0&&s!=null&&f(t,["parameters","guidanceScale"],s),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=d(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&f(t,["parameters","safetySetting"],a);const l=d(e,["personGeneration"]);t!==void 0&&l!=null&&f(t,["parameters","personGeneration"],l);const c=d(e,["includeSafetyAttributes"]);t!==void 0&&c!=null&&f(t,["parameters","includeSafetyAttributes"],c);const h=d(e,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const m=d(e,["language"]);t!==void 0&&m!=null&&f(t,["parameters","language"],m);const g=d(e,["outputMimeType"]);t!==void 0&&g!=null&&f(t,["parameters","outputOptions","mimeType"],g);const _=d(e,["outputCompressionQuality"]);if(t!==void 0&&_!=null&&f(t,["parameters","outputOptions","compressionQuality"],_),d(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function bP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["prompt"]);i!=null&&f(t,["instances[0]","prompt"],i);const o=d(e,["config"]);return o!=null&&f(t,["config"],FP(n,o,t)),t}function UP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","name"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function OP(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);t!==void 0&&o!=null&&f(t,["_query","pageToken"],o);const s=d(e,["filter"]);t!==void 0&&s!=null&&f(t,["_query","filter"],s);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],FE(n,a)),r}function BP(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],OP(n,r,t)),t}function qP(n,e,t){const r={},i=d(e,["displayName"]);t!==void 0&&i!=null&&f(t,["displayName"],i);const o=d(e,["description"]);t!==void 0&&o!=null&&f(t,["description"],o);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),r}function zP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","name"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],qP(n,i,t)),t}function GP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","name"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function $P(n,e){const t={};if(d(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function KP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);if(i!=null){let s=Tr(n,i);Array.isArray(s)&&(s=s.map(a=>Lu(n,a))),f(t,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(t,["config"],$P(n,o)),t}function HP(n,e){const t={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=d(e,["imageBytes"]);r!=null&&f(t,["bytesBase64Encoded"],Ir(n,r));const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function WP(n,e,t){const r={},i=d(e,["numberOfVideos"]);if(t!==void 0&&i!=null&&f(t,["parameters","sampleCount"],i),d(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const o=d(e,["durationSeconds"]);if(t!==void 0&&o!=null&&f(t,["parameters","durationSeconds"],o),d(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=d(e,["aspectRatio"]);if(t!==void 0&&s!=null&&f(t,["parameters","aspectRatio"],s),d(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const a=d(e,["personGeneration"]);if(t!==void 0&&a!=null&&f(t,["parameters","personGeneration"],a),d(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(e,["negativePrompt"]);if(t!==void 0&&l!=null&&f(t,["parameters","negativePrompt"],l),d(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function QP(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["prompt"]);i!=null&&f(t,["instances[0]","prompt"],i);const o=d(e,["image"]);o!=null&&f(t,["instances[0]","image"],HP(n,o));const s=d(e,["config"]);return s!=null&&f(t,["config"],WP(n,s,t)),t}function YP(n,e){const t={},r=d(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=d(e,["data"]);i!=null&&f(t,["data"],i);const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function JP(n,e){const t={},r=d(e,["videoMetadata"]);r!=null&&f(t,["videoMetadata"],r);const i=d(e,["thought"]);i!=null&&f(t,["thought"],i);const o=d(e,["inlineData"]);o!=null&&f(t,["inlineData"],YP(n,o));const s=d(e,["codeExecutionResult"]);s!=null&&f(t,["codeExecutionResult"],s);const a=d(e,["executableCode"]);a!=null&&f(t,["executableCode"],a);const l=d(e,["fileData"]);l!=null&&f(t,["fileData"],l);const c=d(e,["functionCall"]);c!=null&&f(t,["functionCall"],c);const h=d(e,["functionResponse"]);h!=null&&f(t,["functionResponse"],h);const m=d(e,["text"]);return m!=null&&f(t,["text"],m),t}function go(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>JP(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function XP(n,e){const t={},r=d(e,["featureSelectionPreference"]);return r!=null&&f(t,["featureSelectionPreference"],r),t}function jP(n,e){const t={},r=d(e,["method"]);r!=null&&f(t,["method"],r);const i=d(e,["category"]);i!=null&&f(t,["category"],i);const o=d(e,["threshold"]);return o!=null&&f(t,["threshold"],o),t}function ZP(){return{}}function e1(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["dynamicThreshold"]);return i!=null&&f(t,["dynamicThreshold"],i),t}function t1(n,e){const t={},r=d(e,["dynamicRetrievalConfig"]);return r!=null&&f(t,["dynamicRetrievalConfig"],e1(n,r)),t}function n1(){return{}}function r1(n,e){const t={},r=d(e,["apiKeyString"]);return r!=null&&f(t,["apiKeyString"],r),t}function i1(n,e){const t={},r=d(e,["apiKeyConfig"]);r!=null&&f(t,["apiKeyConfig"],r1(n,r));const i=d(e,["authType"]);i!=null&&f(t,["authType"],i);const o=d(e,["googleServiceAccountConfig"]);o!=null&&f(t,["googleServiceAccountConfig"],o);const s=d(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const a=d(e,["oauthConfig"]);a!=null&&f(t,["oauthConfig"],a);const l=d(e,["oidcConfig"]);return l!=null&&f(t,["oidcConfig"],l),t}function o1(n,e){const t={},r=d(e,["authConfig"]);return r!=null&&f(t,["authConfig"],i1(n,r)),t}function OE(n,e){const t={},r=d(e,["retrieval"]);r!=null&&f(t,["retrieval"],r),d(e,["googleSearch"])!=null&&f(t,["googleSearch"],ZP());const o=d(e,["googleSearchRetrieval"]);o!=null&&f(t,["googleSearchRetrieval"],t1(n,o)),d(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],n1());const a=d(e,["googleMaps"]);a!=null&&f(t,["googleMaps"],o1(n,a));const l=d(e,["codeExecution"]);l!=null&&f(t,["codeExecution"],l);const c=d(e,["functionDeclarations"]);return c!=null&&f(t,["functionDeclarations"],c),t}function s1(n,e){const t={},r=d(e,["mode"]);r!=null&&f(t,["mode"],r);const i=d(e,["allowedFunctionNames"]);return i!=null&&f(t,["allowedFunctionNames"],i),t}function a1(n,e){const t={},r=d(e,["latitude"]);r!=null&&f(t,["latitude"],r);const i=d(e,["longitude"]);return i!=null&&f(t,["longitude"],i),t}function l1(n,e){const t={},r=d(e,["latLng"]);return r!=null&&f(t,["latLng"],a1(n,r)),t}function u1(n,e){const t={},r=d(e,["functionCallingConfig"]);r!=null&&f(t,["functionCallingConfig"],s1(n,r));const i=d(e,["retrievalConfig"]);return i!=null&&f(t,["retrievalConfig"],l1(n,i)),t}function c1(n,e){const t={},r=d(e,["voiceName"]);return r!=null&&f(t,["voiceName"],r),t}function d1(n,e){const t={},r=d(e,["prebuiltVoiceConfig"]);return r!=null&&f(t,["prebuiltVoiceConfig"],c1(n,r)),t}function f1(n,e){const t={},r=d(e,["voiceConfig"]);r!=null&&f(t,["voiceConfig"],d1(n,r));const i=d(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function h1(n,e){const t={},r=d(e,["includeThoughts"]);r!=null&&f(t,["includeThoughts"],r);const i=d(e,["thinkingBudget"]);return i!=null&&f(t,["thinkingBudget"],i),t}function p1(n,e,t){const r={},i=d(e,["systemInstruction"]);t!==void 0&&i!=null&&f(t,["systemInstruction"],go(n,Ct(n,i)));const o=d(e,["temperature"]);o!=null&&f(r,["temperature"],o);const s=d(e,["topP"]);s!=null&&f(r,["topP"],s);const a=d(e,["topK"]);a!=null&&f(r,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(r,["candidateCount"],l);const c=d(e,["maxOutputTokens"]);c!=null&&f(r,["maxOutputTokens"],c);const h=d(e,["stopSequences"]);h!=null&&f(r,["stopSequences"],h);const m=d(e,["responseLogprobs"]);m!=null&&f(r,["responseLogprobs"],m);const g=d(e,["logprobs"]);g!=null&&f(r,["logprobs"],g);const _=d(e,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const I=d(e,["frequencyPenalty"]);I!=null&&f(r,["frequencyPenalty"],I);const x=d(e,["seed"]);x!=null&&f(r,["seed"],x);const k=d(e,["responseMimeType"]);k!=null&&f(r,["responseMimeType"],k);const w=d(e,["responseSchema"]);w!=null&&f(r,["responseSchema"],kE(n,w));const E=d(e,["routingConfig"]);E!=null&&f(r,["routingConfig"],E);const S=d(e,["modelSelectionConfig"]);S!=null&&f(r,["modelConfig"],XP(n,S));const N=d(e,["safetySettings"]);if(t!==void 0&&N!=null){let de=N;Array.isArray(de)&&(de=de.map(Qt=>jP(n,Qt))),f(t,["safetySettings"],de)}const O=d(e,["tools"]);if(t!==void 0&&O!=null){let de=Vu(n,O);Array.isArray(de)&&(de=de.map(Qt=>OE(n,ku(n,Qt)))),f(t,["tools"],de)}const B=d(e,["toolConfig"]);t!==void 0&&B!=null&&f(t,["toolConfig"],u1(n,B));const C=d(e,["labels"]);t!==void 0&&C!=null&&f(t,["labels"],C);const v=d(e,["cachedContent"]);t!==void 0&&v!=null&&f(t,["cachedContent"],Er(n,v));const A=d(e,["responseModalities"]);A!=null&&f(r,["responseModalities"],A);const R=d(e,["mediaResolution"]);R!=null&&f(r,["mediaResolution"],R);const D=d(e,["speechConfig"]);D!=null&&f(r,["speechConfig"],f1(n,VE(n,D)));const V=d(e,["audioTimestamp"]);V!=null&&f(r,["audioTimestamp"],V);const P=d(e,["thinkingConfig"]);return P!=null&&f(r,["thinkingConfig"],h1(n,P)),r}function Fy(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);if(i!=null){let s=Tr(n,i);Array.isArray(s)&&(s=s.map(a=>go(n,a))),f(t,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(t,["generationConfig"],p1(n,o,t)),t}function m1(n,e,t){const r={},i=d(e,["taskType"]);t!==void 0&&i!=null&&f(t,["instances[]","task_type"],i);const o=d(e,["title"]);t!==void 0&&o!=null&&f(t,["instances[]","title"],o);const s=d(e,["outputDimensionality"]);t!==void 0&&s!=null&&f(t,["parameters","outputDimensionality"],s);const a=d(e,["mimeType"]);t!==void 0&&a!=null&&f(t,["instances[]","mimeType"],a);const l=d(e,["autoTruncate"]);return t!==void 0&&l!=null&&f(t,["parameters","autoTruncate"],l),r}function g1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);i!=null&&f(t,["instances[]","content"],NE(n,i));const o=d(e,["config"]);return o!=null&&f(t,["config"],m1(n,o,t)),t}function y1(n,e,t){const r={},i=d(e,["outputGcsUri"]);t!==void 0&&i!=null&&f(t,["parameters","storageUri"],i);const o=d(e,["negativePrompt"]);t!==void 0&&o!=null&&f(t,["parameters","negativePrompt"],o);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&f(t,["parameters","aspectRatio"],a);const l=d(e,["guidanceScale"]);t!==void 0&&l!=null&&f(t,["parameters","guidanceScale"],l);const c=d(e,["seed"]);t!==void 0&&c!=null&&f(t,["parameters","seed"],c);const h=d(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=d(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const g=d(e,["includeSafetyAttributes"]);t!==void 0&&g!=null&&f(t,["parameters","includeSafetyAttributes"],g);const _=d(e,["includeRaiReason"]);t!==void 0&&_!=null&&f(t,["parameters","includeRaiReason"],_);const I=d(e,["language"]);t!==void 0&&I!=null&&f(t,["parameters","language"],I);const x=d(e,["outputMimeType"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","mimeType"],x);const k=d(e,["outputCompressionQuality"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","compressionQuality"],k);const w=d(e,["addWatermark"]);t!==void 0&&w!=null&&f(t,["parameters","addWatermark"],w);const E=d(e,["enhancePrompt"]);return t!==void 0&&E!=null&&f(t,["parameters","enhancePrompt"],E),r}function _1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["prompt"]);i!=null&&f(t,["instances[0]","prompt"],i);const o=d(e,["config"]);return o!=null&&f(t,["config"],y1(n,o,t)),t}function Nh(n,e){const t={},r=d(e,["gcsUri"]);r!=null&&f(t,["gcsUri"],r);const i=d(e,["imageBytes"]);i!=null&&f(t,["bytesBase64Encoded"],Ir(n,i));const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function v1(n,e){const t={},r=d(e,["maskMode"]);r!=null&&f(t,["maskMode"],r);const i=d(e,["segmentationClasses"]);i!=null&&f(t,["maskClasses"],i);const o=d(e,["maskDilation"]);return o!=null&&f(t,["dilation"],o),t}function T1(n,e){const t={},r=d(e,["controlType"]);r!=null&&f(t,["controlType"],r);const i=d(e,["enableControlImageComputation"]);return i!=null&&f(t,["computeControl"],i),t}function E1(n,e){const t={},r=d(e,["styleDescription"]);return r!=null&&f(t,["styleDescription"],r),t}function I1(n,e){const t={},r=d(e,["subjectType"]);r!=null&&f(t,["subjectType"],r);const i=d(e,["subjectDescription"]);return i!=null&&f(t,["subjectDescription"],i),t}function w1(n,e){const t={},r=d(e,["referenceImage"]);r!=null&&f(t,["referenceImage"],Nh(n,r));const i=d(e,["referenceId"]);i!=null&&f(t,["referenceId"],i);const o=d(e,["referenceType"]);o!=null&&f(t,["referenceType"],o);const s=d(e,["maskImageConfig"]);s!=null&&f(t,["maskImageConfig"],v1(n,s));const a=d(e,["controlImageConfig"]);a!=null&&f(t,["controlImageConfig"],T1(n,a));const l=d(e,["styleImageConfig"]);l!=null&&f(t,["styleImageConfig"],E1(n,l));const c=d(e,["subjectImageConfig"]);return c!=null&&f(t,["subjectImageConfig"],I1(n,c)),t}function C1(n,e,t){const r={},i=d(e,["outputGcsUri"]);t!==void 0&&i!=null&&f(t,["parameters","storageUri"],i);const o=d(e,["negativePrompt"]);t!==void 0&&o!=null&&f(t,["parameters","negativePrompt"],o);const s=d(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const a=d(e,["aspectRatio"]);t!==void 0&&a!=null&&f(t,["parameters","aspectRatio"],a);const l=d(e,["guidanceScale"]);t!==void 0&&l!=null&&f(t,["parameters","guidanceScale"],l);const c=d(e,["seed"]);t!==void 0&&c!=null&&f(t,["parameters","seed"],c);const h=d(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=d(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const g=d(e,["includeSafetyAttributes"]);t!==void 0&&g!=null&&f(t,["parameters","includeSafetyAttributes"],g);const _=d(e,["includeRaiReason"]);t!==void 0&&_!=null&&f(t,["parameters","includeRaiReason"],_);const I=d(e,["language"]);t!==void 0&&I!=null&&f(t,["parameters","language"],I);const x=d(e,["outputMimeType"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","mimeType"],x);const k=d(e,["outputCompressionQuality"]);t!==void 0&&k!=null&&f(t,["parameters","outputOptions","compressionQuality"],k);const w=d(e,["editMode"]);t!==void 0&&w!=null&&f(t,["parameters","editMode"],w);const E=d(e,["baseSteps"]);return t!==void 0&&E!=null&&f(t,["parameters","editConfig","baseSteps"],E),r}function S1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["prompt"]);i!=null&&f(t,["instances[0]","prompt"],i);const o=d(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>w1(n,l))),f(t,["instances[0]","referenceImages"],a)}const s=d(e,["config"]);return s!=null&&f(t,["config"],C1(n,s,t)),t}function A1(n,e,t){const r={},i=d(e,["includeRaiReason"]);t!==void 0&&i!=null&&f(t,["parameters","includeRaiReason"],i);const o=d(e,["outputMimeType"]);t!==void 0&&o!=null&&f(t,["parameters","outputOptions","mimeType"],o);const s=d(e,["outputCompressionQuality"]);t!==void 0&&s!=null&&f(t,["parameters","outputOptions","compressionQuality"],s);const a=d(e,["numberOfImages"]);t!==void 0&&a!=null&&f(t,["parameters","sampleCount"],a);const l=d(e,["mode"]);return t!==void 0&&l!=null&&f(t,["parameters","mode"],l),r}function R1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["image"]);i!=null&&f(t,["instances[0]","image"],Nh(n,i));const o=d(e,["upscaleFactor"]);o!=null&&f(t,["parameters","upscaleConfig","upscaleFactor"],o);const s=d(e,["config"]);return s!=null&&f(t,["config"],A1(n,s,t)),t}function x1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","name"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function P1(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);t!==void 0&&o!=null&&f(t,["_query","pageToken"],o);const s=d(e,["filter"]);t!==void 0&&s!=null&&f(t,["_query","filter"],s);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],FE(n,a)),r}function D1(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],P1(n,r,t)),t}function N1(n,e,t){const r={},i=d(e,["displayName"]);t!==void 0&&i!=null&&f(t,["displayName"],i);const o=d(e,["description"]);t!==void 0&&o!=null&&f(t,["description"],o);const s=d(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),r}function k1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],N1(n,i,t)),t}function V1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","name"],Ce(n,r));const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function M1(n,e,t){const r={},i=d(e,["systemInstruction"]);t!==void 0&&i!=null&&f(t,["systemInstruction"],go(n,Ct(n,i)));const o=d(e,["tools"]);if(t!==void 0&&o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>OE(n,l))),f(t,["tools"],a)}const s=d(e,["generationConfig"]);return t!==void 0&&s!=null&&f(t,["generationConfig"],s),r}function L1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);if(i!=null){let s=Tr(n,i);Array.isArray(s)&&(s=s.map(a=>go(n,a))),f(t,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(t,["config"],M1(n,o,t)),t}function F1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["contents"]);if(i!=null){let s=Tr(n,i);Array.isArray(s)&&(s=s.map(a=>go(n,a))),f(t,["contents"],s)}const o=d(e,["config"]);return o!=null&&f(t,["config"],o),t}function b1(n,e,t){const r={},i=d(e,["numberOfVideos"]);t!==void 0&&i!=null&&f(t,["parameters","sampleCount"],i);const o=d(e,["outputGcsUri"]);t!==void 0&&o!=null&&f(t,["parameters","storageUri"],o);const s=d(e,["fps"]);t!==void 0&&s!=null&&f(t,["parameters","fps"],s);const a=d(e,["durationSeconds"]);t!==void 0&&a!=null&&f(t,["parameters","durationSeconds"],a);const l=d(e,["seed"]);t!==void 0&&l!=null&&f(t,["parameters","seed"],l);const c=d(e,["aspectRatio"]);t!==void 0&&c!=null&&f(t,["parameters","aspectRatio"],c);const h=d(e,["resolution"]);t!==void 0&&h!=null&&f(t,["parameters","resolution"],h);const m=d(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const g=d(e,["pubsubTopic"]);t!==void 0&&g!=null&&f(t,["parameters","pubsubTopic"],g);const _=d(e,["negativePrompt"]);t!==void 0&&_!=null&&f(t,["parameters","negativePrompt"],_);const I=d(e,["enhancePrompt"]);return t!==void 0&&I!=null&&f(t,["parameters","enhancePrompt"],I),r}function U1(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["_url","model"],Ce(n,r));const i=d(e,["prompt"]);i!=null&&f(t,["instances[0]","prompt"],i);const o=d(e,["image"]);o!=null&&f(t,["instances[0]","image"],Nh(n,o));const s=d(e,["config"]);return s!=null&&f(t,["config"],b1(n,s,t)),t}function O1(n,e){const t={},r=d(e,["data"]);r!=null&&f(t,["data"],r);const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function B1(n,e){const t={},r=d(e,["thought"]);r!=null&&f(t,["thought"],r);const i=d(e,["inlineData"]);i!=null&&f(t,["inlineData"],O1(n,i));const o=d(e,["codeExecutionResult"]);o!=null&&f(t,["codeExecutionResult"],o);const s=d(e,["executableCode"]);s!=null&&f(t,["executableCode"],s);const a=d(e,["fileData"]);a!=null&&f(t,["fileData"],a);const l=d(e,["functionCall"]);l!=null&&f(t,["functionCall"],l);const c=d(e,["functionResponse"]);c!=null&&f(t,["functionResponse"],c);const h=d(e,["text"]);return h!=null&&f(t,["text"],h),t}function q1(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>B1(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function z1(n,e){const t={},r=d(e,["citationSources"]);return r!=null&&f(t,["citations"],r),t}function G1(n,e){const t={},r=d(e,["content"]);r!=null&&f(t,["content"],q1(n,r));const i=d(e,["citationMetadata"]);i!=null&&f(t,["citationMetadata"],z1(n,i));const o=d(e,["tokenCount"]);o!=null&&f(t,["tokenCount"],o);const s=d(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&f(t,["avgLogprobs"],a);const l=d(e,["groundingMetadata"]);l!=null&&f(t,["groundingMetadata"],l);const c=d(e,["index"]);c!=null&&f(t,["index"],c);const h=d(e,["logprobsResult"]);h!=null&&f(t,["logprobsResult"],h);const m=d(e,["safetyRatings"]);return m!=null&&f(t,["safetyRatings"],m),t}function by(n,e){const t={},r=d(e,["candidates"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>G1(n,l))),f(t,["candidates"],a)}const i=d(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const o=d(e,["promptFeedback"]);o!=null&&f(t,["promptFeedback"],o);const s=d(e,["usageMetadata"]);return s!=null&&f(t,["usageMetadata"],s),t}function $1(n,e){const t={},r=d(e,["values"]);return r!=null&&f(t,["values"],r),t}function K1(){return{}}function H1(n,e){const t={},r=d(e,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>$1(n,s))),f(t,["embeddings"],o)}return d(e,["metadata"])!=null&&f(t,["metadata"],K1()),t}function W1(n,e){const t={},r=d(e,["bytesBase64Encoded"]);r!=null&&f(t,["imageBytes"],Ir(n,r));const i=d(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function BE(n,e){const t={},r=d(e,["safetyAttributes","categories"]);r!=null&&f(t,["categories"],r);const i=d(e,["safetyAttributes","scores"]);i!=null&&f(t,["scores"],i);const o=d(e,["contentType"]);return o!=null&&f(t,["contentType"],o),t}function Q1(n,e){const t={},r=d(e,["_self"]);r!=null&&f(t,["image"],W1(n,r));const i=d(e,["raiFilteredReason"]);i!=null&&f(t,["raiFilteredReason"],i);const o=d(e,["_self"]);return o!=null&&f(t,["safetyAttributes"],BE(n,o)),t}function Y1(n,e){const t={},r=d(e,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Q1(n,s))),f(t,["generatedImages"],o)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],BE(n,i)),t}function J1(n,e){const t={},r=d(e,["baseModel"]);r!=null&&f(t,["baseModel"],r);const i=d(e,["createTime"]);i!=null&&f(t,["createTime"],i);const o=d(e,["updateTime"]);return o!=null&&f(t,["updateTime"],o),t}function of(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["description"]);o!=null&&f(t,["description"],o);const s=d(e,["version"]);s!=null&&f(t,["version"],s);const a=d(e,["_self"]);a!=null&&f(t,["tunedModelInfo"],J1(n,a));const l=d(e,["inputTokenLimit"]);l!=null&&f(t,["inputTokenLimit"],l);const c=d(e,["outputTokenLimit"]);c!=null&&f(t,["outputTokenLimit"],c);const h=d(e,["supportedGenerationMethods"]);return h!=null&&f(t,["supportedActions"],h),t}function X1(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["_self"]);if(i!=null){let o=bE(n,i);Array.isArray(o)&&(o=o.map(s=>of(n,s))),f(t,["models"],o)}return t}function j1(){return{}}function Z1(n,e){const t={},r=d(e,["totalTokens"]);r!=null&&f(t,["totalTokens"],r);const i=d(e,["cachedContentTokenCount"]);return i!=null&&f(t,["cachedContentTokenCount"],i),t}function eD(n,e){const t={},r=d(e,["video","uri"]);r!=null&&f(t,["uri"],r);const i=d(e,["video","encodedVideo"]);i!=null&&f(t,["videoBytes"],Ir(n,i));const o=d(e,["encoding"]);return o!=null&&f(t,["mimeType"],o),t}function tD(n,e){const t={},r=d(e,["_self"]);return r!=null&&f(t,["video"],eD(n,r)),t}function nD(n,e){const t={},r=d(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>tD(n,a))),f(t,["generatedVideos"],s)}const i=d(e,["raiMediaFilteredCount"]);i!=null&&f(t,["raiMediaFilteredCount"],i);const o=d(e,["raiMediaFilteredReasons"]);return o!=null&&f(t,["raiMediaFilteredReasons"],o),t}function rD(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["metadata"]);i!=null&&f(t,["metadata"],i);const o=d(e,["done"]);o!=null&&f(t,["done"],o);const s=d(e,["error"]);s!=null&&f(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&f(t,["response"],nD(n,a)),t}function iD(n,e){const t={},r=d(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=d(e,["data"]);i!=null&&f(t,["data"],i);const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function oD(n,e){const t={},r=d(e,["videoMetadata"]);r!=null&&f(t,["videoMetadata"],r);const i=d(e,["thought"]);i!=null&&f(t,["thought"],i);const o=d(e,["inlineData"]);o!=null&&f(t,["inlineData"],iD(n,o));const s=d(e,["codeExecutionResult"]);s!=null&&f(t,["codeExecutionResult"],s);const a=d(e,["executableCode"]);a!=null&&f(t,["executableCode"],a);const l=d(e,["fileData"]);l!=null&&f(t,["fileData"],l);const c=d(e,["functionCall"]);c!=null&&f(t,["functionCall"],c);const h=d(e,["functionResponse"]);h!=null&&f(t,["functionResponse"],h);const m=d(e,["text"]);return m!=null&&f(t,["text"],m),t}function sD(n,e){const t={},r=d(e,["parts"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>oD(n,s))),f(t,["parts"],o)}const i=d(e,["role"]);return i!=null&&f(t,["role"],i),t}function aD(n,e){const t={},r=d(e,["citations"]);return r!=null&&f(t,["citations"],r),t}function lD(n,e){const t={},r=d(e,["content"]);r!=null&&f(t,["content"],sD(n,r));const i=d(e,["citationMetadata"]);i!=null&&f(t,["citationMetadata"],aD(n,i));const o=d(e,["finishMessage"]);o!=null&&f(t,["finishMessage"],o);const s=d(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const a=d(e,["avgLogprobs"]);a!=null&&f(t,["avgLogprobs"],a);const l=d(e,["groundingMetadata"]);l!=null&&f(t,["groundingMetadata"],l);const c=d(e,["index"]);c!=null&&f(t,["index"],c);const h=d(e,["logprobsResult"]);h!=null&&f(t,["logprobsResult"],h);const m=d(e,["safetyRatings"]);return m!=null&&f(t,["safetyRatings"],m),t}function Uy(n,e){const t={},r=d(e,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(h=>lD(n,h))),f(t,["candidates"],c)}const i=d(e,["createTime"]);i!=null&&f(t,["createTime"],i);const o=d(e,["responseId"]);o!=null&&f(t,["responseId"],o);const s=d(e,["modelVersion"]);s!=null&&f(t,["modelVersion"],s);const a=d(e,["promptFeedback"]);a!=null&&f(t,["promptFeedback"],a);const l=d(e,["usageMetadata"]);return l!=null&&f(t,["usageMetadata"],l),t}function uD(n,e){const t={},r=d(e,["truncated"]);r!=null&&f(t,["truncated"],r);const i=d(e,["token_count"]);return i!=null&&f(t,["tokenCount"],i),t}function cD(n,e){const t={},r=d(e,["values"]);r!=null&&f(t,["values"],r);const i=d(e,["statistics"]);return i!=null&&f(t,["statistics"],uD(n,i)),t}function dD(n,e){const t={},r=d(e,["billableCharacterCount"]);return r!=null&&f(t,["billableCharacterCount"],r),t}function fD(n,e){const t={},r=d(e,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>cD(n,s))),f(t,["embeddings"],o)}const i=d(e,["metadata"]);return i!=null&&f(t,["metadata"],dD(n,i)),t}function hD(n,e){const t={},r=d(e,["gcsUri"]);r!=null&&f(t,["gcsUri"],r);const i=d(e,["bytesBase64Encoded"]);i!=null&&f(t,["imageBytes"],Ir(n,i));const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function qE(n,e){const t={},r=d(e,["safetyAttributes","categories"]);r!=null&&f(t,["categories"],r);const i=d(e,["safetyAttributes","scores"]);i!=null&&f(t,["scores"],i);const o=d(e,["contentType"]);return o!=null&&f(t,["contentType"],o),t}function kh(n,e){const t={},r=d(e,["_self"]);r!=null&&f(t,["image"],hD(n,r));const i=d(e,["raiFilteredReason"]);i!=null&&f(t,["raiFilteredReason"],i);const o=d(e,["_self"]);o!=null&&f(t,["safetyAttributes"],qE(n,o));const s=d(e,["prompt"]);return s!=null&&f(t,["enhancedPrompt"],s),t}function pD(n,e){const t={},r=d(e,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>kh(n,s))),f(t,["generatedImages"],o)}const i=d(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],qE(n,i)),t}function mD(n,e){const t={},r=d(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>kh(n,o))),f(t,["generatedImages"],i)}return t}function gD(n,e){const t={},r=d(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>kh(n,o))),f(t,["generatedImages"],i)}return t}function yD(n,e){const t={},r=d(e,["endpoint"]);r!=null&&f(t,["name"],r);const i=d(e,["deployedModelId"]);return i!=null&&f(t,["deployedModelId"],i),t}function _D(n,e){const t={},r=d(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&f(t,["baseModel"],r);const i=d(e,["createTime"]);i!=null&&f(t,["createTime"],i);const o=d(e,["updateTime"]);return o!=null&&f(t,["updateTime"],o),t}function vD(n,e){const t={},r=d(e,["checkpointId"]);r!=null&&f(t,["checkpointId"],r);const i=d(e,["epoch"]);i!=null&&f(t,["epoch"],i);const o=d(e,["step"]);return o!=null&&f(t,["step"],o),t}function sf(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["displayName"]);i!=null&&f(t,["displayName"],i);const o=d(e,["description"]);o!=null&&f(t,["description"],o);const s=d(e,["versionId"]);s!=null&&f(t,["version"],s);const a=d(e,["deployedModels"]);if(a!=null){let g=a;Array.isArray(g)&&(g=g.map(_=>yD(n,_))),f(t,["endpoints"],g)}const l=d(e,["labels"]);l!=null&&f(t,["labels"],l);const c=d(e,["_self"]);c!=null&&f(t,["tunedModelInfo"],_D(n,c));const h=d(e,["defaultCheckpointId"]);h!=null&&f(t,["defaultCheckpointId"],h);const m=d(e,["checkpoints"]);if(m!=null){let g=m;Array.isArray(g)&&(g=g.map(_=>vD(n,_))),f(t,["checkpoints"],g)}return t}function TD(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["_self"]);if(i!=null){let o=bE(n,i);Array.isArray(o)&&(o=o.map(s=>sf(n,s))),f(t,["models"],o)}return t}function ED(){return{}}function ID(n,e){const t={},r=d(e,["totalTokens"]);return r!=null&&f(t,["totalTokens"],r),t}function wD(n,e){const t={},r=d(e,["tokensInfo"]);return r!=null&&f(t,["tokensInfo"],r),t}function CD(n,e){const t={},r=d(e,["gcsUri"]);r!=null&&f(t,["uri"],r);const i=d(e,["bytesBase64Encoded"]);i!=null&&f(t,["videoBytes"],Ir(n,i));const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function SD(n,e){const t={},r=d(e,["_self"]);return r!=null&&f(t,["video"],CD(n,r)),t}function AD(n,e){const t={},r=d(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>SD(n,a))),f(t,["generatedVideos"],s)}const i=d(e,["raiMediaFilteredCount"]);i!=null&&f(t,["raiMediaFilteredCount"],i);const o=d(e,["raiMediaFilteredReasons"]);return o!=null&&f(t,["raiMediaFilteredReasons"],o),t}function RD(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["metadata"]);i!=null&&f(t,["metadata"],i);const o=d(e,["done"]);o!=null&&f(t,["done"],o);const s=d(e,["error"]);s!=null&&f(t,["error"],s);const a=d(e,["response"]);return a!=null&&f(t,["response"],AD(n,a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xD="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function PD(n,e,t){const r=new WR;let i;if(t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),n.isVertexAI()){const o=vP(n,i);Object.assign(r,o)}else{const o=_P(n,i);Object.assign(r,o)}e(r)}class DD{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r,i,o;const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion();let l;const c=MD(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())l=`${s}/ws/google.cloud.aiplatform.${a}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(c);else{const N=this.apiClient.getApiKey();l=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateContent?key=${N}`}let h=()=>{};const m=new Promise(N=>{h=N}),g=e.callbacks,_=function(){var N;(N=g==null?void 0:g.onopen)===null||N===void 0||N.call(g),h({})},I=this.apiClient,x={onopen:_,onmessage:N=>{PD(I,g.onmessage,N)},onerror:(t=g==null?void 0:g.onerror)!==null&&t!==void 0?t:function(N){},onclose:(r=g==null?void 0:g.onclose)!==null&&r!==void 0?r:function(N){}},k=this.webSocketFactory.create(l,VD(c),x);k.connect(),await m;let w=Ce(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&w.startsWith("publishers/")){const N=this.apiClient.getProject(),O=this.apiClient.getLocation();w=`projects/${N}/locations/${O}/`+w}let E={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[tu.AUDIO]}:e.config.responseModalities=[tu.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S={model:w,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?E=Gx(this.apiClient,S):E=zx(this.apiClient,S),delete E.config,k.send(JSON.stringify(E)),new kD(k,this.apiClient)}}const ND={turnComplete:!0};class kD{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Tr(e,t.turns),e.isVertexAI()?r=r.map(i=>go(e,i)):r=r.map(i=>Lu(e,i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(xD)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},ND),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Yx(this.apiClient,e)}:t={realtimeInput:Qx(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function VD(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function MD(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class LD extends ia{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>await this.generateContentInternal(t),this.generateContentStream=async t=>await this.generateContentStreamInternal(t),this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=l==null?void 0:l.safetyAttributes:s.push(l);let a;return o?a={generatedImages:s,positivePromptSafetyAttributes:o}:a={generatedImages:s},a}),this.list=async t=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new Mu(to.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(s),s)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(i)}}async generateContentInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=Fy(this.apiClient,e);return a=X("{model}:generateContent",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=Uy(this.apiClient,h),g=new Ja;return Object.assign(g,m),g})}else{const c=Ly(this.apiClient,e);return a=X("{model}:generateContent",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=by(this.apiClient,h),g=new Ja;return Object.assign(g,m),g})}}async generateContentStreamInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=Fy(this.apiClient,e);a=X("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=this.apiClient;return s=h.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(m){return nu(this,arguments,function*(){var g,_,I,x;try{for(var k=!0,w=nf(m),E;E=yield lt(w.next()),g=E.done,!g;k=!0){x=E.value,k=!1;const N=Uy(h,yield lt(x.json())),O=new Ja;Object.assign(O,N),yield yield lt(O)}}catch(S){_={error:S}}finally{try{!k&&!g&&(I=w.return)&&(yield lt(I.call(w)))}finally{if(_)throw _.error}}})})}else{const c=Ly(this.apiClient,e);a=X("{model}:streamGenerateContent?alt=sse",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=this.apiClient;return s=h.requestStream({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(m){return nu(this,arguments,function*(){var g,_,I,x;try{for(var k=!0,w=nf(m),E;E=yield lt(w.next()),g=E.done,!g;k=!0){x=E.value,k=!1;const N=by(h,yield lt(x.json())),O=new Ja;Object.assign(O,N),yield yield lt(O)}}catch(S){_={error:S}}finally{try{!k&&!g&&(I=w.return)&&(yield lt(I.call(w)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=g1(this.apiClient,e);return a=X("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=fD(this.apiClient,h),g=new Iy;return Object.assign(g,m),g})}else{const c=LP(this.apiClient,e);return a=X("{model}:batchEmbedContents",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=H1(this.apiClient,h),g=new Iy;return Object.assign(g,m),g})}}async generateImagesInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=_1(this.apiClient,e);return a=X("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=pD(this.apiClient,h),g=new wy;return Object.assign(g,m),g})}else{const c=bP(this.apiClient,e);return a=X("{model}:predict",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=Y1(this.apiClient,h),g=new wy;return Object.assign(g,m),g})}}async editImageInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=S1(this.apiClient,e);return o=X("{model}:predict",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=mD(this.apiClient,l),h=new qR;return Object.assign(h,c),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=R1(this.apiClient,e);return o=X("{model}:predict",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=gD(this.apiClient,l),h=new zR;return Object.assign(h,c),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=x1(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>sf(this.apiClient,h))}else{const c=UP(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>of(this.apiClient,h))}}async listInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=D1(this.apiClient,e);return a=X("{models_url}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=TD(this.apiClient,h),g=new Cy;return Object.assign(g,m),g})}else{const c=BP(this.apiClient,e);return a=X("{models_url}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=X1(this.apiClient,h),g=new Cy;return Object.assign(g,m),g})}}async update(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=k1(this.apiClient,e);return a=X("{model}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>sf(this.apiClient,h))}else{const c=zP(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>of(this.apiClient,h))}}async delete(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=V1(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(()=>{const h=ED(),m=new Sy;return Object.assign(m,h),m})}else{const c=GP(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(()=>{const h=j1(),m=new Sy;return Object.assign(m,h),m})}}async countTokens(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=L1(this.apiClient,e);return a=X("{model}:countTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=ID(this.apiClient,h),g=new Ay;return Object.assign(g,m),g})}else{const c=KP(this.apiClient,e);return a=X("{model}:countTokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=Z1(this.apiClient,h),g=new Ay;return Object.assign(g,m),g})}}async computeTokens(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=F1(this.apiClient,e);return o=X("{model}:computeTokens",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const c=wD(this.apiClient,l),h=new GR;return Object.assign(h,c),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=U1(this.apiClient,e);return a=X("{model}:predictLongRunning",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>RD(this.apiClient,h))}else{const c=QP(this.apiClient,e);return a=X("{model}:predictLongRunning",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>rD(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FD(n,e){const t={},r=d(e,["operationName"]);r!=null&&f(t,["_url","operationName"],r);const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function bD(n,e){const t={},r=d(e,["operationName"]);r!=null&&f(t,["_url","operationName"],r);const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function UD(n,e){const t={},r=d(e,["operationName"]);r!=null&&f(t,["operationName"],r);const i=d(e,["resourceName"]);i!=null&&f(t,["_url","resourceName"],i);const o=d(e,["config"]);return o!=null&&f(t,["config"],o),t}function OD(n,e){const t={},r=d(e,["video","uri"]);r!=null&&f(t,["uri"],r);const i=d(e,["video","encodedVideo"]);i!=null&&f(t,["videoBytes"],Ir(n,i));const o=d(e,["encoding"]);return o!=null&&f(t,["mimeType"],o),t}function BD(n,e){const t={},r=d(e,["_self"]);return r!=null&&f(t,["video"],OD(n,r)),t}function qD(n,e){const t={},r=d(e,["generatedSamples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>BD(n,a))),f(t,["generatedVideos"],s)}const i=d(e,["raiMediaFilteredCount"]);i!=null&&f(t,["raiMediaFilteredCount"],i);const o=d(e,["raiMediaFilteredReasons"]);return o!=null&&f(t,["raiMediaFilteredReasons"],o),t}function zD(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["metadata"]);i!=null&&f(t,["metadata"],i);const o=d(e,["done"]);o!=null&&f(t,["done"],o);const s=d(e,["error"]);s!=null&&f(t,["error"],s);const a=d(e,["response","generateVideoResponse"]);return a!=null&&f(t,["response"],qD(n,a)),t}function GD(n,e){const t={},r=d(e,["gcsUri"]);r!=null&&f(t,["uri"],r);const i=d(e,["bytesBase64Encoded"]);i!=null&&f(t,["videoBytes"],Ir(n,i));const o=d(e,["mimeType"]);return o!=null&&f(t,["mimeType"],o),t}function $D(n,e){const t={},r=d(e,["_self"]);return r!=null&&f(t,["video"],GD(n,r)),t}function KD(n,e){const t={},r=d(e,["videos"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>$D(n,a))),f(t,["generatedVideos"],s)}const i=d(e,["raiMediaFilteredCount"]);i!=null&&f(t,["raiMediaFilteredCount"],i);const o=d(e,["raiMediaFilteredReasons"]);return o!=null&&f(t,["raiMediaFilteredReasons"],o),t}function Oy(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["metadata"]);i!=null&&f(t,["metadata"],i);const o=d(e,["done"]);o!=null&&f(t,["done"],o);const s=d(e,["error"]);s!=null&&f(t,["error"],s);const a=d(e,["response"]);return a!=null&&f(t,["response"],KD(n,a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HD extends ia{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let o;return r&&"httpOptions"in r&&(o=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:o}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=bD(this.apiClient,e);return a=X("{operationName}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Oy(this.apiClient,h))}else{const c=FD(this.apiClient,e);return a=X("{operationName}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>zD(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=UD(this.apiClient,e);return o=X("{resourceName}:fetchPredictOperation",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>Oy(this.apiClient,l))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const WD="Content-Type",QD="X-Server-Timeout",YD="User-Agent",JD="x-goog-api-client",XD="0.14.1",jD=`google-genai-sdk/${XD}`,ZD="v1beta1",eN="v1beta",By=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class zE extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class af extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class tN{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:ZD,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:eN,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const i=[this.getRequestUrlInternal(t)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[s,a]of Object.entries(e.queryParams))i.searchParams.append(s,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(t))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const i=new AbortController,o=i.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>i.abort(),t.timeout),r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=o}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await qy(i),new tf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async i=>(await qy(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var t;return nu(this,arguments,function*(){const i=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";for(;;){const{done:a,value:l}=yield lt(i.read());if(a){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const c=o.decode(l);try{const m=JSON.parse(c);if("error"in m){const g=JSON.parse(JSON.stringify(m.error)),_=g.status,I=g.code,x=`got status: ${_}. ${JSON.stringify(m)}`;if(I>=400&&I<500)throw new zE(x);if(I>=500&&I<600)throw new af(x)}}catch(m){const g=m;if(g.name==="ClientError"||g.name==="ServerError")throw m}s+=c;let h=s.match(By);for(;h;){const m=h[1];try{const g=new Response(m,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield lt(new tf(g)),s=s.slice(h[0].length),h=s.match(By)}catch(g){throw new Error(`exception parsing stream chunk ${m}. ${g}`)}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=jD+" "+this.clientOptions.userAgentExtra;return e[YD]=t,e[JD]=t,e[WD]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))t.append(r,i);e.timeout&&e.timeout>0&&t.append(QD,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);i.sizeBytes=String(s.size);const a=(r=t==null?void 0:t.mimeType)!==null&&r!==void 0?r:s.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=a;const l=await this.fetchUploadUrl(i,t);return o.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let i={};t!=null&&t.httpOptions?i=t.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},s=await this.request({path:X("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:i});if(!s||!(s!=null&&s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(r=s==null?void 0:s.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function qy(n){var e;if(n===void 0)throw new af("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const o=`got status: ${t} ${r}. ${JSON.stringify(i)}`;throw t>=400&&t<500?new zE(o):t>=500&&t<600?new af(o):new Error(o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nN(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],r);const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function rN(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);t!==void 0&&o!=null&&f(t,["_query","pageToken"],o);const s=d(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),r}function iN(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],rN(n,r,t)),t}function oN(n,e){const t={},r=d(e,["textInput"]);r!=null&&f(t,["textInput"],r);const i=d(e,["output"]);return i!=null&&f(t,["output"],i),t}function sN(n,e){const t={};if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=d(e,["examples"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>oN(n,o))),f(t,["examples","examples"],i)}return t}function aN(n,e,t){const r={};if(d(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=d(e,["tunedModelDisplayName"]);if(t!==void 0&&i!=null&&f(t,["displayName"],i),d(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const o=d(e,["epochCount"]);t!==void 0&&o!=null&&f(t,["tuningTask","hyperparameters","epochCount"],o);const s=d(e,["learningRateMultiplier"]);if(s!=null&&f(r,["tuningTask","hyperparameters","learningRateMultiplier"],s),d(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(e,["batchSize"]);t!==void 0&&a!=null&&f(t,["tuningTask","hyperparameters","batchSize"],a);const l=d(e,["learningRate"]);return t!==void 0&&l!=null&&f(t,["tuningTask","hyperparameters","learningRate"],l),r}function lN(n,e){const t={},r=d(e,["baseModel"]);r!=null&&f(t,["baseModel"],r);const i=d(e,["trainingDataset"]);i!=null&&f(t,["tuningTask","trainingData"],sN(n,i));const o=d(e,["config"]);return o!=null&&f(t,["config"],aN(n,o,t)),t}function uN(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["_url","name"],r);const i=d(e,["config"]);return i!=null&&f(t,["config"],i),t}function cN(n,e,t){const r={},i=d(e,["pageSize"]);t!==void 0&&i!=null&&f(t,["_query","pageSize"],i);const o=d(e,["pageToken"]);t!==void 0&&o!=null&&f(t,["_query","pageToken"],o);const s=d(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),r}function dN(n,e){const t={},r=d(e,["config"]);return r!=null&&f(t,["config"],cN(n,r,t)),t}function fN(n,e,t){const r={},i=d(e,["gcsUri"]);if(t!==void 0&&i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],i),d(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function hN(n,e){const t={},r=d(e,["gcsUri"]);return r!=null&&f(t,["validationDatasetUri"],r),t}function pN(n,e,t){const r={},i=d(e,["validationDataset"]);t!==void 0&&i!=null&&f(t,["supervisedTuningSpec"],hN(n,i));const o=d(e,["tunedModelDisplayName"]);t!==void 0&&o!=null&&f(t,["tunedModelDisplayName"],o);const s=d(e,["description"]);t!==void 0&&s!=null&&f(t,["description"],s);const a=d(e,["epochCount"]);t!==void 0&&a!=null&&f(t,["supervisedTuningSpec","hyperParameters","epochCount"],a);const l=d(e,["learningRateMultiplier"]);t!==void 0&&l!=null&&f(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],l);const c=d(e,["exportLastCheckpointOnly"]);t!==void 0&&c!=null&&f(t,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const h=d(e,["adapterSize"]);if(t!==void 0&&h!=null&&f(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),d(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function mN(n,e){const t={},r=d(e,["baseModel"]);r!=null&&f(t,["baseModel"],r);const i=d(e,["trainingDataset"]);i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],fN(n,i,t));const o=d(e,["config"]);return o!=null&&f(t,["config"],pN(n,o,t)),t}function gN(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["model"],r);const i=d(e,["name"]);return i!=null&&f(t,["endpoint"],i),t}function GE(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["state"]);i!=null&&f(t,["state"],ME(n,i));const o=d(e,["createTime"]);o!=null&&f(t,["createTime"],o);const s=d(e,["tuningTask","startTime"]);s!=null&&f(t,["startTime"],s);const a=d(e,["tuningTask","completeTime"]);a!=null&&f(t,["endTime"],a);const l=d(e,["updateTime"]);l!=null&&f(t,["updateTime"],l);const c=d(e,["description"]);c!=null&&f(t,["description"],c);const h=d(e,["baseModel"]);h!=null&&f(t,["baseModel"],h);const m=d(e,["_self"]);m!=null&&f(t,["tunedModel"],gN(n,m));const g=d(e,["distillationSpec"]);g!=null&&f(t,["distillationSpec"],g);const _=d(e,["experiment"]);_!=null&&f(t,["experiment"],_);const I=d(e,["labels"]);I!=null&&f(t,["labels"],I);const x=d(e,["pipelineJob"]);x!=null&&f(t,["pipelineJob"],x);const k=d(e,["tunedModelDisplayName"]);return k!=null&&f(t,["tunedModelDisplayName"],k),t}function yN(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>GE(n,s))),f(t,["tuningJobs"],o)}return t}function _N(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["metadata"]);i!=null&&f(t,["metadata"],i);const o=d(e,["done"]);o!=null&&f(t,["done"],o);const s=d(e,["error"]);return s!=null&&f(t,["error"],s),t}function vN(n,e){const t={},r=d(e,["checkpointId"]);r!=null&&f(t,["checkpointId"],r);const i=d(e,["epoch"]);i!=null&&f(t,["epoch"],i);const o=d(e,["step"]);o!=null&&f(t,["step"],o);const s=d(e,["endpoint"]);return s!=null&&f(t,["endpoint"],s),t}function TN(n,e){const t={},r=d(e,["model"]);r!=null&&f(t,["model"],r);const i=d(e,["endpoint"]);i!=null&&f(t,["endpoint"],i);const o=d(e,["checkpoints"]);if(o!=null){let s=o;Array.isArray(s)&&(s=s.map(a=>vN(n,a))),f(t,["checkpoints"],s)}return t}function lf(n,e){const t={},r=d(e,["name"]);r!=null&&f(t,["name"],r);const i=d(e,["state"]);i!=null&&f(t,["state"],ME(n,i));const o=d(e,["createTime"]);o!=null&&f(t,["createTime"],o);const s=d(e,["startTime"]);s!=null&&f(t,["startTime"],s);const a=d(e,["endTime"]);a!=null&&f(t,["endTime"],a);const l=d(e,["updateTime"]);l!=null&&f(t,["updateTime"],l);const c=d(e,["error"]);c!=null&&f(t,["error"],c);const h=d(e,["description"]);h!=null&&f(t,["description"],h);const m=d(e,["baseModel"]);m!=null&&f(t,["baseModel"],m);const g=d(e,["tunedModel"]);g!=null&&f(t,["tunedModel"],TN(n,g));const _=d(e,["supervisedTuningSpec"]);_!=null&&f(t,["supervisedTuningSpec"],_);const I=d(e,["tuningDataStats"]);I!=null&&f(t,["tuningDataStats"],I);const x=d(e,["encryptionSpec"]);x!=null&&f(t,["encryptionSpec"],x);const k=d(e,["partnerModelTuningSpec"]);k!=null&&f(t,["partnerModelTuningSpec"],k);const w=d(e,["distillationSpec"]);w!=null&&f(t,["distillationSpec"],w);const E=d(e,["experiment"]);E!=null&&f(t,["experiment"],E);const S=d(e,["labels"]);S!=null&&f(t,["labels"],S);const N=d(e,["pipelineJob"]);N!=null&&f(t,["pipelineJob"],N);const O=d(e,["tunedModelDisplayName"]);return O!=null&&f(t,["tunedModelDisplayName"],O),t}function EN(n,e){const t={},r=d(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=d(e,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>lf(n,s))),f(t,["tuningJobs"],o)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IN extends ia{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Mu(to.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let i="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?i=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(i=r.name.split("/operations/")[0]),{name:i,state:ef.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=uN(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>lf(this.apiClient,h))}else{const c=nN(this.apiClient,e);return a=X("{name}",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>GE(this.apiClient,h))}}async listInternal(e){var t,r,i,o;let s,a="",l={};if(this.apiClient.isVertexAI()){const c=dN(this.apiClient,e);return a=X("tuningJobs",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const m=EN(this.apiClient,h),g=new Ry;return Object.assign(g,m),g})}else{const c=iN(this.apiClient,e);return a=X("tunedModels",c._url),l=c._query,delete c.config,delete c._url,delete c._query,s=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const m=yN(this.apiClient,h),g=new Ry;return Object.assign(g,m),g})}}async tuneInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const a=mN(this.apiClient,e);return o=X("tuningJobs",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>lf(this.apiClient,l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=lN(this.apiClient,e);return o=X("tunedModels",a._url),s=a._query,delete a.config,delete a._url,delete a._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>_N(this.apiClient,l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wN{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const CN=1024*1024*8,SN=3,AN=1e3,RN=2,Yc="x-goog-upload-status";async function xN(n,e,t){var r,i,o;let s=0,a=0,l=new tf(new Response),c="upload";for(s=n.size;a<s;){const m=Math.min(CN,s-a),g=n.slice(a,a+m);a+m>=s&&(c+=", finalize");let _=0,I=AN;for(;_<SN&&(l=await t.request({path:"",body:g,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":c,"X-Goog-Upload-Offset":String(a),"Content-Length":String(m)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[Yc]));)_++,await DN(I),I=I*RN;if(a+=m,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[Yc])!=="active")break;if(s<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(l==null?void 0:l.json());if(((o=l==null?void 0:l.headers)===null||o===void 0?void 0:o[Yc])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function PN(n){return{size:n.size,type:n.type}}function DN(n){return new Promise(e=>setTimeout(e,n))}class NN{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await xN(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await PN(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kN{create(e,t,r){return new VN(e,t,r)}}class VN{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const zy="x-goog-api-key";class MN{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(zy)===null&&e.append(zy,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const LN="gl-node/";class Vh{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=KA(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new MN(this.apiKey);this.apiClient=new tN({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:LN+"web",uploader:new NN,downloader:new wN}),this.models=new LD(this.apiClient),this.live=new DD(this.apiClient,i,new kN),this.chats=new jR(this.models,this.apiClient),this.caches=new QR(this.apiClient),this.files=new dx(this.apiClient),this.operations=new HD(this.apiClient),this.tunings=new IN(this.apiClient)}}var Gy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $E=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},FN=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=n[t++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=n[t++],s=n[t++],a=n[t++],l=((i&7)<<18|(o&63)<<12|(s&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const o=n[t++],s=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},KE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const o=n[i],s=i+1<n.length,a=s?n[i+1]:0,l=i+2<n.length,c=l?n[i+2]:0,h=o>>2,m=(o&3)<<4|a>>4;let g=(a&15)<<2|c>>6,_=c&63;l||(_=64,s||(g=64)),r.push(t[h],t[m],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray($E(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):FN(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const o=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const c=i<n.length?t[n.charAt(i)]:64;++i;const m=i<n.length?t[n.charAt(i)]:64;if(++i,o==null||a==null||c==null||m==null)throw new bN;const g=o<<2|a>>4;if(r.push(g),c!==64){const _=a<<4&240|c>>2;if(r.push(_),m!==64){const I=c<<6&192|m;r.push(I)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class bN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const UN=function(n){const e=$E(n);return KE.encodeByteArray(e,!0)},ru=function(n){return UN(n).replace(/\./g,"")},ON=function(n){try{return KE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=()=>BN().__FIREBASE_DEFAULTS__,zN=()=>{if(typeof process>"u"||typeof Gy>"u")return;const n=Gy.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},GN=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&ON(n[1]);return e&&JSON.parse(e)},Mh=()=>{try{return qN()||zN()||GN()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$N=n=>{var e,t;return(t=(e=Mh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},HE=n=>{const e=$N(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},WE=()=>{var n;return(n=Mh())===null||n===void 0?void 0:n.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QE(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,o=n.sub||n.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ru(JSON.stringify(t)),ru(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iu(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function HN(){var n;const e=(n=Mh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YE(){return!HN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function JE(){try{return typeof indexedDB=="object"}catch{return!1}}function WN(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QN="FirebaseError";class ui extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=QN,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,XE.prototype.create)}}class XE{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?YN(o,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new ui(i,a,r)}}function YN(n,e){return n.replace(JN,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const JN=/\{\$([^}]+)}/g;function uf(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const o=n[i],s=e[i];if($y(o)&&$y(s)){if(!uf(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function $y(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dt(n){return n&&n._delegate?n._delegate:n}class no{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new KN;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ZN(e))try{this.getOrInitializeService({instanceIdentifier:kr})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kr){return this.instances.has(e)}getOptions(e=kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[o,s]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(o);r===a&&s.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:jN(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kr){return this.component?this.component.multipleInstances?e:kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function jN(n){return n===kr?void 0:n}function ZN(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new XN(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ae;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(ae||(ae={}));const tk={debug:ae.DEBUG,verbose:ae.VERBOSE,info:ae.INFO,warn:ae.WARN,error:ae.ERROR,silent:ae.SILENT},nk=ae.INFO,rk={[ae.DEBUG]:"log",[ae.VERBOSE]:"log",[ae.INFO]:"info",[ae.WARN]:"warn",[ae.ERROR]:"error"},ik=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=rk[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class jE{constructor(e){this.name=e,this._logLevel=nk,this._logHandler=ik,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ae))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?tk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ae.DEBUG,...e),this._logHandler(this,ae.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ae.VERBOSE,...e),this._logHandler(this,ae.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ae.INFO,...e),this._logHandler(this,ae.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ae.WARN,...e),this._logHandler(this,ae.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ae.ERROR,...e),this._logHandler(this,ae.ERROR,...e)}}const ok=(n,e)=>e.some(t=>n instanceof t);let Ky,Hy;function sk(){return Ky||(Ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ak(){return Hy||(Hy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ZE=new WeakMap,cf=new WeakMap,eI=new WeakMap,Jc=new WeakMap,Lh=new WeakMap;function lk(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",o),n.removeEventListener("error",s)},o=()=>{t(sr(n.result)),i()},s=()=>{r(n.error),i()};n.addEventListener("success",o),n.addEventListener("error",s)});return e.then(t=>{t instanceof IDBCursor&&ZE.set(t,n)}).catch(()=>{}),Lh.set(e,n),e}function uk(n){if(cf.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",o),n.removeEventListener("error",s),n.removeEventListener("abort",s)},o=()=>{t(),i()},s=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",o),n.addEventListener("error",s),n.addEventListener("abort",s)});cf.set(n,e)}let df={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return cf.get(n);if(e==="objectStoreNames")return n.objectStoreNames||eI.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return sr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function ck(n){df=n(df)}function dk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Xc(this),e,...t);return eI.set(r,e.sort?e.sort():[e]),sr(r)}:ak().includes(n)?function(...e){return n.apply(Xc(this),e),sr(ZE.get(this))}:function(...e){return sr(n.apply(Xc(this),e))}}function fk(n){return typeof n=="function"?dk(n):(n instanceof IDBTransaction&&uk(n),ok(n,sk())?new Proxy(n,df):n)}function sr(n){if(n instanceof IDBRequest)return lk(n);if(Jc.has(n))return Jc.get(n);const e=fk(n);return e!==n&&(Jc.set(n,e),Lh.set(e,n)),e}const Xc=n=>Lh.get(n);function hk(n,e,{blocked:t,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(n,e),a=sr(s);return r&&s.addEventListener("upgradeneeded",l=>{r(sr(s.result),l.oldVersion,l.newVersion,sr(s.transaction),l)}),t&&s.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{o&&l.addEventListener("close",()=>o()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const pk=["get","getKey","getAll","getAllKeys","count"],mk=["put","add","delete","clear"],jc=new Map;function Wy(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(jc.get(e))return jc.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=mk.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||pk.includes(t)))return;const o=async function(s,...a){const l=this.transaction(s,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),i&&l.done]))[0]};return jc.set(e,o),o}ck(n=>({...n,get:(e,t,r)=>Wy(e,t)||n.get(e,t,r),has:(e,t)=>!!Wy(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(yk(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function yk(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ff="@firebase/app",Qy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn=new jE("@firebase/app"),_k="@firebase/app-compat",vk="@firebase/analytics-compat",Tk="@firebase/analytics",Ek="@firebase/app-check-compat",Ik="@firebase/app-check",wk="@firebase/auth",Ck="@firebase/auth-compat",Sk="@firebase/database",Ak="@firebase/data-connect",Rk="@firebase/database-compat",xk="@firebase/functions",Pk="@firebase/functions-compat",Dk="@firebase/installations",Nk="@firebase/installations-compat",kk="@firebase/messaging",Vk="@firebase/messaging-compat",Mk="@firebase/performance",Lk="@firebase/performance-compat",Fk="@firebase/remote-config",bk="@firebase/remote-config-compat",Uk="@firebase/storage",Ok="@firebase/storage-compat",Bk="@firebase/firestore",qk="@firebase/vertexai-preview",zk="@firebase/firestore-compat",Gk="firebase",$k="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf="[DEFAULT]",Kk={[ff]:"fire-core",[_k]:"fire-core-compat",[Tk]:"fire-analytics",[vk]:"fire-analytics-compat",[Ik]:"fire-app-check",[Ek]:"fire-app-check-compat",[wk]:"fire-auth",[Ck]:"fire-auth-compat",[Sk]:"fire-rtdb",[Ak]:"fire-data-connect",[Rk]:"fire-rtdb-compat",[xk]:"fire-fn",[Pk]:"fire-fn-compat",[Dk]:"fire-iid",[Nk]:"fire-iid-compat",[kk]:"fire-fcm",[Vk]:"fire-fcm-compat",[Mk]:"fire-perf",[Lk]:"fire-perf-compat",[Fk]:"fire-rc",[bk]:"fire-rc-compat",[Uk]:"fire-gcs",[Ok]:"fire-gcs-compat",[Bk]:"fire-fst",[zk]:"fire-fst-compat",[qk]:"fire-vertex","fire-js":"fire-js",[Gk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ou=new Map,Hk=new Map,pf=new Map;function Yy(n,e){try{n.container.addComponent(e)}catch(t){kn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Us(n){const e=n.name;if(pf.has(e))return kn.debug(`There were multiple attempts to register component ${e}.`),!1;pf.set(e,n);for(const t of ou.values())Yy(t,n);for(const t of Hk.values())Yy(t,n);return!0}function tI(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ar=new XE("app","Firebase",Wk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qk{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new no("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ar.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI=$k;function rI(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:hf,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ar.create("bad-app-name",{appName:String(i)});if(t||(t=WE()),!t)throw ar.create("no-options");const o=ou.get(i);if(o){if(uf(t,o.options)&&uf(r,o.config))return o;throw ar.create("duplicate-app",{appName:i})}const s=new ek(i);for(const l of pf.values())s.addComponent(l);const a=new Qk(t,r,s);return ou.set(i,a),a}function iI(n=hf){const e=ou.get(n);if(!e&&n===hf&&WE())return rI();if(!e)throw ar.create("no-app",{appName:n});return e}function lr(n,e,t){var r;let i=(r=Kk[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const a=[`Unable to register library "${i}" with version "${e}":`];o&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&a.push("and"),s&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),kn.warn(a.join(" "));return}Us(new no(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yk="firebase-heartbeat-database",Jk=1,Os="firebase-heartbeat-store";let Zc=null;function oI(){return Zc||(Zc=hk(Yk,Jk,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Os)}catch(t){console.warn(t)}}}}).catch(n=>{throw ar.create("idb-open",{originalErrorMessage:n.message})})),Zc}async function Xk(n){try{const t=(await oI()).transaction(Os),r=await t.objectStore(Os).get(sI(n));return await t.done,r}catch(e){if(e instanceof ui)kn.warn(e.message);else{const t=ar.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});kn.warn(t.message)}}}async function Jy(n,e){try{const r=(await oI()).transaction(Os,"readwrite");await r.objectStore(Os).put(e,sI(n)),await r.done}catch(t){if(t instanceof ui)kn.warn(t.message);else{const r=ar.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});kn.warn(r.message)}}}function sI(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=1024,Zk=30*24*60*60*1e3;class eV{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new nV(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Xy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const a=new Date(s.date).valueOf();return Date.now()-a<=Zk}),this._storage.overwrite(this._heartbeatsCache))}catch(r){kn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Xy(),{heartbeatsToSend:r,unsentEntries:i}=tV(this._heartbeatsCache.heartbeats),o=ru(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(t){return kn.warn(t),""}}}function Xy(){return new Date().toISOString().substring(0,10)}function tV(n,e=jk){const t=[];let r=n.slice();for(const i of n){const o=t.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),jy(t)>e){o.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),jy(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class nV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return JE()?WN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await Xk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Jy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return Jy(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function jy(n){return ru(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rV(n){Us(new no("platform-logger",e=>new gk(e),"PRIVATE")),Us(new no("heartbeat",e=>new eV(e),"PRIVATE")),lr(ff,Qy,n),lr(ff,Qy,"esm2017"),lr("fire-js","")}rV("");var Zy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gr,aI;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,v){function A(){}A.prototype=v.prototype,C.D=v.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(R,D,V){for(var P=Array(arguments.length-2),de=2;de<arguments.length;de++)P[de-2]=arguments[de];return v.prototype[D].apply(R,P)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,v,A){A||(A=0);var R=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)R[D]=v.charCodeAt(A++)|v.charCodeAt(A++)<<8|v.charCodeAt(A++)<<16|v.charCodeAt(A++)<<24;else for(D=0;16>D;++D)R[D]=v[A++]|v[A++]<<8|v[A++]<<16|v[A++]<<24;v=C.g[0],A=C.g[1],D=C.g[2];var V=C.g[3],P=v+(V^A&(D^V))+R[0]+3614090360&4294967295;v=A+(P<<7&4294967295|P>>>25),P=V+(D^v&(A^D))+R[1]+3905402710&4294967295,V=v+(P<<12&4294967295|P>>>20),P=D+(A^V&(v^A))+R[2]+606105819&4294967295,D=V+(P<<17&4294967295|P>>>15),P=A+(v^D&(V^v))+R[3]+3250441966&4294967295,A=D+(P<<22&4294967295|P>>>10),P=v+(V^A&(D^V))+R[4]+4118548399&4294967295,v=A+(P<<7&4294967295|P>>>25),P=V+(D^v&(A^D))+R[5]+1200080426&4294967295,V=v+(P<<12&4294967295|P>>>20),P=D+(A^V&(v^A))+R[6]+2821735955&4294967295,D=V+(P<<17&4294967295|P>>>15),P=A+(v^D&(V^v))+R[7]+4249261313&4294967295,A=D+(P<<22&4294967295|P>>>10),P=v+(V^A&(D^V))+R[8]+1770035416&4294967295,v=A+(P<<7&4294967295|P>>>25),P=V+(D^v&(A^D))+R[9]+2336552879&4294967295,V=v+(P<<12&4294967295|P>>>20),P=D+(A^V&(v^A))+R[10]+4294925233&4294967295,D=V+(P<<17&4294967295|P>>>15),P=A+(v^D&(V^v))+R[11]+2304563134&4294967295,A=D+(P<<22&4294967295|P>>>10),P=v+(V^A&(D^V))+R[12]+1804603682&4294967295,v=A+(P<<7&4294967295|P>>>25),P=V+(D^v&(A^D))+R[13]+4254626195&4294967295,V=v+(P<<12&4294967295|P>>>20),P=D+(A^V&(v^A))+R[14]+2792965006&4294967295,D=V+(P<<17&4294967295|P>>>15),P=A+(v^D&(V^v))+R[15]+1236535329&4294967295,A=D+(P<<22&4294967295|P>>>10),P=v+(D^V&(A^D))+R[1]+4129170786&4294967295,v=A+(P<<5&4294967295|P>>>27),P=V+(A^D&(v^A))+R[6]+3225465664&4294967295,V=v+(P<<9&4294967295|P>>>23),P=D+(v^A&(V^v))+R[11]+643717713&4294967295,D=V+(P<<14&4294967295|P>>>18),P=A+(V^v&(D^V))+R[0]+3921069994&4294967295,A=D+(P<<20&4294967295|P>>>12),P=v+(D^V&(A^D))+R[5]+3593408605&4294967295,v=A+(P<<5&4294967295|P>>>27),P=V+(A^D&(v^A))+R[10]+38016083&4294967295,V=v+(P<<9&4294967295|P>>>23),P=D+(v^A&(V^v))+R[15]+3634488961&4294967295,D=V+(P<<14&4294967295|P>>>18),P=A+(V^v&(D^V))+R[4]+3889429448&4294967295,A=D+(P<<20&4294967295|P>>>12),P=v+(D^V&(A^D))+R[9]+568446438&4294967295,v=A+(P<<5&4294967295|P>>>27),P=V+(A^D&(v^A))+R[14]+3275163606&4294967295,V=v+(P<<9&4294967295|P>>>23),P=D+(v^A&(V^v))+R[3]+4107603335&4294967295,D=V+(P<<14&4294967295|P>>>18),P=A+(V^v&(D^V))+R[8]+1163531501&4294967295,A=D+(P<<20&4294967295|P>>>12),P=v+(D^V&(A^D))+R[13]+2850285829&4294967295,v=A+(P<<5&4294967295|P>>>27),P=V+(A^D&(v^A))+R[2]+4243563512&4294967295,V=v+(P<<9&4294967295|P>>>23),P=D+(v^A&(V^v))+R[7]+1735328473&4294967295,D=V+(P<<14&4294967295|P>>>18),P=A+(V^v&(D^V))+R[12]+2368359562&4294967295,A=D+(P<<20&4294967295|P>>>12),P=v+(A^D^V)+R[5]+4294588738&4294967295,v=A+(P<<4&4294967295|P>>>28),P=V+(v^A^D)+R[8]+2272392833&4294967295,V=v+(P<<11&4294967295|P>>>21),P=D+(V^v^A)+R[11]+1839030562&4294967295,D=V+(P<<16&4294967295|P>>>16),P=A+(D^V^v)+R[14]+4259657740&4294967295,A=D+(P<<23&4294967295|P>>>9),P=v+(A^D^V)+R[1]+2763975236&4294967295,v=A+(P<<4&4294967295|P>>>28),P=V+(v^A^D)+R[4]+1272893353&4294967295,V=v+(P<<11&4294967295|P>>>21),P=D+(V^v^A)+R[7]+4139469664&4294967295,D=V+(P<<16&4294967295|P>>>16),P=A+(D^V^v)+R[10]+3200236656&4294967295,A=D+(P<<23&4294967295|P>>>9),P=v+(A^D^V)+R[13]+681279174&4294967295,v=A+(P<<4&4294967295|P>>>28),P=V+(v^A^D)+R[0]+3936430074&4294967295,V=v+(P<<11&4294967295|P>>>21),P=D+(V^v^A)+R[3]+3572445317&4294967295,D=V+(P<<16&4294967295|P>>>16),P=A+(D^V^v)+R[6]+76029189&4294967295,A=D+(P<<23&4294967295|P>>>9),P=v+(A^D^V)+R[9]+3654602809&4294967295,v=A+(P<<4&4294967295|P>>>28),P=V+(v^A^D)+R[12]+3873151461&4294967295,V=v+(P<<11&4294967295|P>>>21),P=D+(V^v^A)+R[15]+530742520&4294967295,D=V+(P<<16&4294967295|P>>>16),P=A+(D^V^v)+R[2]+3299628645&4294967295,A=D+(P<<23&4294967295|P>>>9),P=v+(D^(A|~V))+R[0]+4096336452&4294967295,v=A+(P<<6&4294967295|P>>>26),P=V+(A^(v|~D))+R[7]+1126891415&4294967295,V=v+(P<<10&4294967295|P>>>22),P=D+(v^(V|~A))+R[14]+2878612391&4294967295,D=V+(P<<15&4294967295|P>>>17),P=A+(V^(D|~v))+R[5]+4237533241&4294967295,A=D+(P<<21&4294967295|P>>>11),P=v+(D^(A|~V))+R[12]+1700485571&4294967295,v=A+(P<<6&4294967295|P>>>26),P=V+(A^(v|~D))+R[3]+2399980690&4294967295,V=v+(P<<10&4294967295|P>>>22),P=D+(v^(V|~A))+R[10]+4293915773&4294967295,D=V+(P<<15&4294967295|P>>>17),P=A+(V^(D|~v))+R[1]+2240044497&4294967295,A=D+(P<<21&4294967295|P>>>11),P=v+(D^(A|~V))+R[8]+1873313359&4294967295,v=A+(P<<6&4294967295|P>>>26),P=V+(A^(v|~D))+R[15]+4264355552&4294967295,V=v+(P<<10&4294967295|P>>>22),P=D+(v^(V|~A))+R[6]+2734768916&4294967295,D=V+(P<<15&4294967295|P>>>17),P=A+(V^(D|~v))+R[13]+1309151649&4294967295,A=D+(P<<21&4294967295|P>>>11),P=v+(D^(A|~V))+R[4]+4149444226&4294967295,v=A+(P<<6&4294967295|P>>>26),P=V+(A^(v|~D))+R[11]+3174756917&4294967295,V=v+(P<<10&4294967295|P>>>22),P=D+(v^(V|~A))+R[2]+718787259&4294967295,D=V+(P<<15&4294967295|P>>>17),P=A+(V^(D|~v))+R[9]+3951481745&4294967295,C.g[0]=C.g[0]+v&4294967295,C.g[1]=C.g[1]+(D+(P<<21&4294967295|P>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+V&4294967295}r.prototype.u=function(C,v){v===void 0&&(v=C.length);for(var A=v-this.blockSize,R=this.B,D=this.h,V=0;V<v;){if(D==0)for(;V<=A;)i(this,C,V),V+=this.blockSize;if(typeof C=="string"){for(;V<v;)if(R[D++]=C.charCodeAt(V++),D==this.blockSize){i(this,R),D=0;break}}else for(;V<v;)if(R[D++]=C[V++],D==this.blockSize){i(this,R),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var v=1;v<C.length-8;++v)C[v]=0;var A=8*this.o;for(v=C.length-8;v<C.length;++v)C[v]=A&255,A/=256;for(this.u(C),C=Array(16),v=A=0;4>v;++v)for(var R=0;32>R;R+=8)C[A++]=this.g[v]>>>R&255;return C};function o(C,v){var A=a;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=v(C)}function s(C,v){this.h=v;for(var A=[],R=!0,D=C.length-1;0<=D;D--){var V=C[D]|0;R&&V==v||(A[D]=V,R=!1)}this.g=A}var a={};function l(C){return-128<=C&&128>C?o(C,function(v){return new s([v|0],0>v?-1:0)}):new s([C|0],0>C?-1:0)}function c(C){if(isNaN(C)||!isFinite(C))return m;if(0>C)return k(c(-C));for(var v=[],A=1,R=0;C>=A;R++)v[R]=C/A|0,A*=4294967296;return new s(v,0)}function h(C,v){if(C.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(C.charAt(0)=="-")return k(h(C.substring(1),v));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=c(Math.pow(v,8)),R=m,D=0;D<C.length;D+=8){var V=Math.min(8,C.length-D),P=parseInt(C.substring(D,D+V),v);8>V?(V=c(Math.pow(v,V)),R=R.j(V).add(c(P))):(R=R.j(A),R=R.add(c(P)))}return R}var m=l(0),g=l(1),_=l(16777216);n=s.prototype,n.m=function(){if(x(this))return-k(this).m();for(var C=0,v=1,A=0;A<this.g.length;A++){var R=this.i(A);C+=(0<=R?R:4294967296+R)*v,v*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(I(this))return"0";if(x(this))return"-"+k(this).toString(C);for(var v=c(Math.pow(C,6)),A=this,R="";;){var D=N(A,v).g;A=w(A,D.j(v));var V=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=D,I(A))return V+R;for(;6>V.length;)V="0"+V;R=V+R}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function I(C){if(C.h!=0)return!1;for(var v=0;v<C.g.length;v++)if(C.g[v]!=0)return!1;return!0}function x(C){return C.h==-1}n.l=function(C){return C=w(this,C),x(C)?-1:I(C)?0:1};function k(C){for(var v=C.g.length,A=[],R=0;R<v;R++)A[R]=~C.g[R];return new s(A,~C.h).add(g)}n.abs=function(){return x(this)?k(this):this},n.add=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],R=0,D=0;D<=v;D++){var V=R+(this.i(D)&65535)+(C.i(D)&65535),P=(V>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);R=P>>>16,V&=65535,P&=65535,A[D]=P<<16|V}return new s(A,A[A.length-1]&-2147483648?-1:0)};function w(C,v){return C.add(k(v))}n.j=function(C){if(I(this)||I(C))return m;if(x(this))return x(C)?k(this).j(k(C)):k(k(this).j(C));if(x(C))return k(this.j(k(C)));if(0>this.l(_)&&0>C.l(_))return c(this.m()*C.m());for(var v=this.g.length+C.g.length,A=[],R=0;R<2*v;R++)A[R]=0;for(R=0;R<this.g.length;R++)for(var D=0;D<C.g.length;D++){var V=this.i(R)>>>16,P=this.i(R)&65535,de=C.i(D)>>>16,Qt=C.i(D)&65535;A[2*R+2*D]+=P*Qt,E(A,2*R+2*D),A[2*R+2*D+1]+=V*Qt,E(A,2*R+2*D+1),A[2*R+2*D+1]+=P*de,E(A,2*R+2*D+1),A[2*R+2*D+2]+=V*de,E(A,2*R+2*D+2)}for(R=0;R<v;R++)A[R]=A[2*R+1]<<16|A[2*R];for(R=v;R<2*v;R++)A[R]=0;return new s(A,0)};function E(C,v){for(;(C[v]&65535)!=C[v];)C[v+1]+=C[v]>>>16,C[v]&=65535,v++}function S(C,v){this.g=C,this.h=v}function N(C,v){if(I(v))throw Error("division by zero");if(I(C))return new S(m,m);if(x(C))return v=N(k(C),v),new S(k(v.g),k(v.h));if(x(v))return v=N(C,k(v)),new S(k(v.g),v.h);if(30<C.g.length){if(x(C)||x(v))throw Error("slowDivide_ only works with positive integers.");for(var A=g,R=v;0>=R.l(C);)A=O(A),R=O(R);var D=B(A,1),V=B(R,1);for(R=B(R,2),A=B(A,2);!I(R);){var P=V.add(R);0>=P.l(C)&&(D=D.add(A),V=P),R=B(R,1),A=B(A,1)}return v=w(C,D.j(v)),new S(D,v)}for(D=m;0<=C.l(v);){for(A=Math.max(1,Math.floor(C.m()/v.m())),R=Math.ceil(Math.log(A)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),V=c(A),P=V.j(v);x(P)||0<P.l(C);)A-=R,V=c(A),P=V.j(v);I(V)&&(V=g),D=D.add(V),C=w(C,P)}return new S(D,C)}n.A=function(C){return N(this,C).h},n.and=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],R=0;R<v;R++)A[R]=this.i(R)&C.i(R);return new s(A,this.h&C.h)},n.or=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],R=0;R<v;R++)A[R]=this.i(R)|C.i(R);return new s(A,this.h|C.h)},n.xor=function(C){for(var v=Math.max(this.g.length,C.g.length),A=[],R=0;R<v;R++)A[R]=this.i(R)^C.i(R);return new s(A,this.h^C.h)};function O(C){for(var v=C.g.length+1,A=[],R=0;R<v;R++)A[R]=C.i(R)<<1|C.i(R-1)>>>31;return new s(A,C.h)}function B(C,v){var A=v>>5;v%=32;for(var R=C.g.length-A,D=[],V=0;V<R;V++)D[V]=0<v?C.i(V+A)>>>v|C.i(V+A+1)<<32-v:C.i(V+A);return new s(D,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,aI=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=h,Gr=s}).apply(typeof Zy<"u"?Zy:typeof self<"u"?self:typeof window<"u"?window:{});var Za=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var lI,es,uI,El,mf,cI,dI,fI;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,y){return u==Array.prototype||u==Object.prototype||(u[p]=y.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Za=="object"&&Za];for(var p=0;p<u.length;++p){var y=u[p];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=t(this);function i(u,p){if(p)e:{var y=r;u=u.split(".");for(var T=0;T<u.length-1;T++){var M=u[T];if(!(M in y))break e;y=y[M]}u=u[u.length-1],T=y[u],p=p(T),p!=T&&p!=null&&e(y,u,{configurable:!0,writable:!0,value:p})}}function o(u,p){u instanceof String&&(u+="");var y=0,T=!1,M={next:function(){if(!T&&y<u.length){var F=y++;return{value:p(F,u[F]),done:!1}}return T=!0,{done:!0,value:void 0}}};return M[Symbol.iterator]=function(){return M},M}i("Array.prototype.values",function(u){return u||function(){return o(this,function(p,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,y){return u.call.apply(u.bind,arguments)}function m(u,p,y){if(!u)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var M=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(M,T),u.apply(p,M)}}return function(){return u.apply(p,arguments)}}function g(u,p,y){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:m,g.apply(null,arguments)}function _(u,p){var y=Array.prototype.slice.call(arguments,1);return function(){var T=y.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function I(u,p){function y(){}y.prototype=p.prototype,u.aa=p.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(T,M,F){for(var $=Array(arguments.length-2),ge=2;ge<arguments.length;ge++)$[ge-2]=arguments[ge];return p.prototype[M].apply(T,$)}}function x(u){const p=u.length;if(0<p){const y=Array(p);for(let T=0;T<p;T++)y[T]=u[T];return y}return[]}function k(u,p){for(let y=1;y<arguments.length;y++){const T=arguments[y];if(l(T)){const M=u.length||0,F=T.length||0;u.length=M+F;for(let $=0;$<F;$++)u[M+$]=T[$]}else u.push(T)}}class w{constructor(p,y){this.i=p,this.j=y,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function E(u){return/^[\s\xa0]*$/.test(u)}function S(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function N(u){return N[" "](u),u}N[" "]=function(){};var O=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function B(u,p,y){for(const T in u)p.call(y,u[T],T,u)}function C(u,p){for(const y in u)p.call(void 0,u[y],y,u)}function v(u){const p={};for(const y in u)p[y]=u[y];return p}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(u,p){let y,T;for(let M=1;M<arguments.length;M++){T=arguments[M];for(y in T)u[y]=T[y];for(let F=0;F<A.length;F++)y=A[F],Object.prototype.hasOwnProperty.call(T,y)&&(u[y]=T[y])}}function D(u){var p=1;u=u.split(":");const y=[];for(;0<p&&u.length;)y.push(u.shift()),p--;return u.length&&y.push(u.join(":")),y}function V(u){a.setTimeout(()=>{throw u},0)}function P(){var u=Z;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class de{constructor(){this.h=this.g=null}add(p,y){const T=Qt.get();T.set(p,y),this.h?this.h.next=T:this.g=T,this.h=T}}var Qt=new w(()=>new Eo,u=>u.reset());class Eo{constructor(){this.next=this.g=this.h=null}set(p,y){this.h=p,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let pn,H=!1,Z=new de,te=()=>{const u=a.Promise.resolve(void 0);pn=()=>{u.then(Ae)}};var Ae=()=>{for(var u;u=P();){try{u.h.call(u.g)}catch(y){V(y)}var p=Qt;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}H=!1};function me(){this.s=this.s,this.C=this.C}me.prototype.s=!1,me.prototype.ma=function(){this.s||(this.s=!0,this.N())},me.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Fe(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}Fe.prototype.h=function(){this.defaultPrevented=!0};var mn=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const y=()=>{};a.addEventListener("test",y,p),a.removeEventListener("test",y,p)}catch{}return u}();function gn(u,p){if(Fe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(O){e:{try{N(p.nodeName);var M=!0;break e}catch{}M=!1}M||(p=null)}}else y=="mouseover"?p=u.fromElement:y=="mouseout"&&(p=u.toElement);this.relatedTarget=p,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:yn[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&gn.aa.h.call(this)}}I(gn,Fe);var yn={2:"touch",3:"pen",4:"mouse"};gn.prototype.h=function(){gn.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var _n="closure_listenable_"+(1e6*Math.random()|0),V0=0;function M0(u,p,y,T,M){this.listener=u,this.proxy=null,this.src=p,this.type=y,this.capture=!!T,this.ha=M,this.key=++V0,this.da=this.fa=!1}function ma(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ga(u){this.src=u,this.g={},this.h=0}ga.prototype.add=function(u,p,y,T,M){var F=u.toString();u=this.g[F],u||(u=this.g[F]=[],this.h++);var $=tc(u,p,T,M);return-1<$?(p=u[$],y||(p.fa=!1)):(p=new M0(p,this.src,F,!!T,M),p.fa=y,u.push(p)),p};function ec(u,p){var y=p.type;if(y in u.g){var T=u.g[y],M=Array.prototype.indexOf.call(T,p,void 0),F;(F=0<=M)&&Array.prototype.splice.call(T,M,1),F&&(ma(p),u.g[y].length==0&&(delete u.g[y],u.h--))}}function tc(u,p,y,T){for(var M=0;M<u.length;++M){var F=u[M];if(!F.da&&F.listener==p&&F.capture==!!y&&F.ha==T)return M}return-1}var nc="closure_lm_"+(1e6*Math.random()|0),rc={};function Np(u,p,y,T,M){if(Array.isArray(p)){for(var F=0;F<p.length;F++)Np(u,p[F],y,T,M);return null}return y=Mp(y),u&&u[_n]?u.K(p,y,c(T)?!!T.capture:!1,M):L0(u,p,y,!1,T,M)}function L0(u,p,y,T,M,F){if(!p)throw Error("Invalid event type");var $=c(M)?!!M.capture:!!M,ge=oc(u);if(ge||(u[nc]=ge=new ga(u)),y=ge.add(p,y,T,$,F),y.proxy)return y;if(T=F0(),y.proxy=T,T.src=u,T.listener=y,u.addEventListener)mn||(M=$),M===void 0&&(M=!1),u.addEventListener(p.toString(),T,M);else if(u.attachEvent)u.attachEvent(Vp(p.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return y}function F0(){function u(y){return p.call(u.src,u.listener,y)}const p=b0;return u}function kp(u,p,y,T,M){if(Array.isArray(p))for(var F=0;F<p.length;F++)kp(u,p[F],y,T,M);else T=c(T)?!!T.capture:!!T,y=Mp(y),u&&u[_n]?(u=u.i,p=String(p).toString(),p in u.g&&(F=u.g[p],y=tc(F,y,T,M),-1<y&&(ma(F[y]),Array.prototype.splice.call(F,y,1),F.length==0&&(delete u.g[p],u.h--)))):u&&(u=oc(u))&&(p=u.g[p.toString()],u=-1,p&&(u=tc(p,y,T,M)),(y=-1<u?p[u]:null)&&ic(y))}function ic(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[_n])ec(p.i,u);else{var y=u.type,T=u.proxy;p.removeEventListener?p.removeEventListener(y,T,u.capture):p.detachEvent?p.detachEvent(Vp(y),T):p.addListener&&p.removeListener&&p.removeListener(T),(y=oc(p))?(ec(y,u),y.h==0&&(y.src=null,p[nc]=null)):ma(u)}}}function Vp(u){return u in rc?rc[u]:rc[u]="on"+u}function b0(u,p){if(u.da)u=!0;else{p=new gn(p,this);var y=u.listener,T=u.ha||u.src;u.fa&&ic(u),u=y.call(T,p)}return u}function oc(u){return u=u[nc],u instanceof ga?u:null}var sc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Mp(u){return typeof u=="function"?u:(u[sc]||(u[sc]=function(p){return u.handleEvent(p)}),u[sc])}function nt(){me.call(this),this.i=new ga(this),this.M=this,this.F=null}I(nt,me),nt.prototype[_n]=!0,nt.prototype.removeEventListener=function(u,p,y,T){kp(this,u,p,y,T)};function ft(u,p){var y,T=u.F;if(T)for(y=[];T;T=T.F)y.push(T);if(u=u.M,T=p.type||p,typeof p=="string")p=new Fe(p,u);else if(p instanceof Fe)p.target=p.target||u;else{var M=p;p=new Fe(T,u),R(p,M)}if(M=!0,y)for(var F=y.length-1;0<=F;F--){var $=p.g=y[F];M=ya($,T,!0,p)&&M}if($=p.g=u,M=ya($,T,!0,p)&&M,M=ya($,T,!1,p)&&M,y)for(F=0;F<y.length;F++)$=p.g=y[F],M=ya($,T,!1,p)&&M}nt.prototype.N=function(){if(nt.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var y=u.g[p],T=0;T<y.length;T++)ma(y[T]);delete u.g[p],u.h--}}this.F=null},nt.prototype.K=function(u,p,y,T){return this.i.add(String(u),p,!1,y,T)},nt.prototype.L=function(u,p,y,T){return this.i.add(String(u),p,!0,y,T)};function ya(u,p,y,T){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var M=!0,F=0;F<p.length;++F){var $=p[F];if($&&!$.da&&$.capture==y){var ge=$.listener,Ye=$.ha||$.src;$.fa&&ec(u.i,$),M=ge.call(Ye,T)!==!1&&M}}return M&&!T.defaultPrevented}function Lp(u,p,y){if(typeof u=="function")y&&(u=g(u,y));else if(u&&typeof u.handleEvent=="function")u=g(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function Fp(u){u.g=Lp(()=>{u.g=null,u.i&&(u.i=!1,Fp(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class U0 extends me{constructor(p,y){super(),this.m=p,this.l=y,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Fp(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Io(u){me.call(this),this.h=u,this.g={}}I(Io,me);var bp=[];function Up(u){B(u.g,function(p,y){this.g.hasOwnProperty(y)&&ic(p)},u),u.g={}}Io.prototype.N=function(){Io.aa.N.call(this),Up(this)},Io.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ac=a.JSON.stringify,O0=a.JSON.parse,B0=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function lc(){}lc.prototype.h=null;function Op(u){return u.h||(u.h=u.i())}function Bp(){}var wo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function uc(){Fe.call(this,"d")}I(uc,Fe);function cc(){Fe.call(this,"c")}I(cc,Fe);var Sr={},qp=null;function _a(){return qp=qp||new nt}Sr.La="serverreachability";function zp(u){Fe.call(this,Sr.La,u)}I(zp,Fe);function Co(u){const p=_a();ft(p,new zp(p))}Sr.STAT_EVENT="statevent";function Gp(u,p){Fe.call(this,Sr.STAT_EVENT,u),this.stat=p}I(Gp,Fe);function ht(u){const p=_a();ft(p,new Gp(p,u))}Sr.Ma="timingevent";function $p(u,p){Fe.call(this,Sr.Ma,u),this.size=p}I($p,Fe);function So(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function Ao(){this.g=!0}Ao.prototype.xa=function(){this.g=!1};function q0(u,p,y,T,M,F){u.info(function(){if(u.g)if(F)for(var $="",ge=F.split("&"),Ye=0;Ye<ge.length;Ye++){var ue=ge[Ye].split("=");if(1<ue.length){var rt=ue[0];ue=ue[1];var it=rt.split("_");$=2<=it.length&&it[1]=="type"?$+(rt+"="+ue+"&"):$+(rt+"=redacted&")}}else $=null;else $=F;return"XMLHTTP REQ ("+T+") [attempt "+M+"]: "+p+`
`+y+`
`+$})}function z0(u,p,y,T,M,F,$){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+M+"]: "+p+`
`+y+`
`+F+" "+$})}function mi(u,p,y,T){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+$0(u,y)+(T?" "+T:"")})}function G0(u,p){u.info(function(){return"TIMEOUT: "+p})}Ao.prototype.info=function(){};function $0(u,p){if(!u.g)return p;if(!p)return null;try{var y=JSON.parse(p);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var T=y[u];if(!(2>T.length)){var M=T[1];if(Array.isArray(M)&&!(1>M.length)){var F=M[0];if(F!="noop"&&F!="stop"&&F!="close")for(var $=1;$<M.length;$++)M[$]=""}}}}return ac(y)}catch{return p}}var va={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Kp={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dc;function Ta(){}I(Ta,lc),Ta.prototype.g=function(){return new XMLHttpRequest},Ta.prototype.i=function(){return{}},dc=new Ta;function bn(u,p,y,T){this.j=u,this.i=p,this.l=y,this.R=T||1,this.U=new Io(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Hp}function Hp(){this.i=null,this.g="",this.h=!1}var Wp={},fc={};function hc(u,p,y){u.L=1,u.v=Ca(vn(p)),u.m=y,u.P=!0,Qp(u,null)}function Qp(u,p){u.F=Date.now(),Ea(u),u.A=vn(u.v);var y=u.A,T=u.R;Array.isArray(T)||(T=[String(T)]),lm(y.i,"t",T),u.C=0,y=u.j.J,u.h=new Hp,u.g=Am(u.j,y?p:null,!u.m),0<u.O&&(u.M=new U0(g(u.Y,u,u.g),u.O)),p=u.U,y=u.g,T=u.ca;var M="readystatechange";Array.isArray(M)||(M&&(bp[0]=M.toString()),M=bp);for(var F=0;F<M.length;F++){var $=Np(y,M[F],T||p.handleEvent,!1,p.h||p);if(!$)break;p.g[$.key]=$}p=u.H?v(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),Co(),q0(u.i,u.u,u.A,u.l,u.R,u.m)}bn.prototype.ca=function(u){u=u.target;const p=this.M;p&&Tn(u)==3?p.j():this.Y(u)},bn.prototype.Y=function(u){try{if(u==this.g)e:{const it=Tn(this.g);var p=this.g.Ba();const _i=this.g.Z();if(!(3>it)&&(it!=3||this.g&&(this.h.h||this.g.oa()||mm(this.g)))){this.J||it!=4||p==7||(p==8||0>=_i?Co(3):Co(2)),pc(this);var y=this.g.Z();this.X=y;t:if(Yp(this)){var T=mm(this.g);u="";var M=T.length,F=Tn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ar(this),Ro(this);var $="";break t}this.h.i=new a.TextDecoder}for(p=0;p<M;p++)this.h.h=!0,u+=this.h.i.decode(T[p],{stream:!(F&&p==M-1)});T.length=0,this.h.g+=u,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=y==200,z0(this.i,this.u,this.A,this.l,this.R,it,y),this.o){if(this.T&&!this.K){t:{if(this.g){var ge,Ye=this.g;if((ge=Ye.g?Ye.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(ge)){var ue=ge;break t}}ue=null}if(y=ue)mi(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,mc(this,y);else{this.o=!1,this.s=3,ht(12),Ar(this),Ro(this);break e}}if(this.P){y=!0;let Yt;for(;!this.J&&this.C<$.length;)if(Yt=K0(this,$),Yt==fc){it==4&&(this.s=4,ht(14),y=!1),mi(this.i,this.l,null,"[Incomplete Response]");break}else if(Yt==Wp){this.s=4,ht(15),mi(this.i,this.l,$,"[Invalid Chunk]"),y=!1;break}else mi(this.i,this.l,Yt,null),mc(this,Yt);if(Yp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),it!=4||$.length!=0||this.h.h||(this.s=1,ht(16),y=!1),this.o=this.o&&y,!y)mi(this.i,this.l,$,"[Invalid Chunked Response]"),Ar(this),Ro(this);else if(0<$.length&&!this.W){this.W=!0;var rt=this.j;rt.g==this&&rt.ba&&!rt.M&&(rt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ec(rt),rt.M=!0,ht(11))}}else mi(this.i,this.l,$,null),mc(this,$);it==4&&Ar(this),this.o&&!this.J&&(it==4?Im(this.j,this):(this.o=!1,Ea(this)))}else lC(this.g),y==400&&0<$.indexOf("Unknown SID")?(this.s=3,ht(12)):(this.s=0,ht(13)),Ar(this),Ro(this)}}}catch{}finally{}};function Yp(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function K0(u,p){var y=u.C,T=p.indexOf(`
`,y);return T==-1?fc:(y=Number(p.substring(y,T)),isNaN(y)?Wp:(T+=1,T+y>p.length?fc:(p=p.slice(T,T+y),u.C=T+y,p)))}bn.prototype.cancel=function(){this.J=!0,Ar(this)};function Ea(u){u.S=Date.now()+u.I,Jp(u,u.I)}function Jp(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=So(g(u.ba,u),p)}function pc(u){u.B&&(a.clearTimeout(u.B),u.B=null)}bn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(G0(this.i,this.A),this.L!=2&&(Co(),ht(17)),Ar(this),this.s=2,Ro(this)):Jp(this,this.S-u)};function Ro(u){u.j.G==0||u.J||Im(u.j,u)}function Ar(u){pc(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,Up(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function mc(u,p){try{var y=u.j;if(y.G!=0&&(y.g==u||gc(y.h,u))){if(!u.K&&gc(y.h,u)&&y.G==3){try{var T=y.Da.g.parse(p)}catch{T=null}if(Array.isArray(T)&&T.length==3){var M=T;if(M[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)Da(y),xa(y);else break e;Tc(y),ht(18)}}else y.za=M[1],0<y.za-y.T&&37500>M[2]&&y.F&&y.v==0&&!y.C&&(y.C=So(g(y.Za,y),6e3));if(1>=Zp(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else xr(y,11)}else if((u.K||y.g==u)&&Da(y),!E(p))for(M=y.Da.g.parse(p),p=0;p<M.length;p++){let ue=M[p];if(y.T=ue[0],ue=ue[1],y.G==2)if(ue[0]=="c"){y.K=ue[1],y.ia=ue[2];const rt=ue[3];rt!=null&&(y.la=rt,y.j.info("VER="+y.la));const it=ue[4];it!=null&&(y.Aa=it,y.j.info("SVER="+y.Aa));const _i=ue[5];_i!=null&&typeof _i=="number"&&0<_i&&(T=1.5*_i,y.L=T,y.j.info("backChannelRequestTimeoutMs_="+T)),T=y;const Yt=u.g;if(Yt){const ka=Yt.g?Yt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ka){var F=T.h;F.g||ka.indexOf("spdy")==-1&&ka.indexOf("quic")==-1&&ka.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(yc(F,F.h),F.h=null))}if(T.D){const Ic=Yt.g?Yt.g.getResponseHeader("X-HTTP-Session-Id"):null;Ic&&(T.ya=Ic,_e(T.I,T.D,Ic))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),T=y;var $=u;if(T.qa=Sm(T,T.J?T.ia:null,T.W),$.K){em(T.h,$);var ge=$,Ye=T.L;Ye&&(ge.I=Ye),ge.B&&(pc(ge),Ea(ge)),T.g=$}else Tm(T);0<y.i.length&&Pa(y)}else ue[0]!="stop"&&ue[0]!="close"||xr(y,7);else y.G==3&&(ue[0]=="stop"||ue[0]=="close"?ue[0]=="stop"?xr(y,7):vc(y):ue[0]!="noop"&&y.l&&y.l.ta(ue),y.v=0)}}Co(4)}catch{}}var H0=class{constructor(u,p){this.g=u,this.map=p}};function Xp(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function jp(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Zp(u){return u.h?1:u.g?u.g.size:0}function gc(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function yc(u,p){u.g?u.g.add(p):u.h=p}function em(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}Xp.prototype.cancel=function(){if(this.i=tm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function tm(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const y of u.g.values())p=p.concat(y.D);return p}return x(u.i)}function W0(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],y=u.length,T=0;T<y;T++)p.push(u[T]);return p}p=[],y=0;for(T in u)p[y++]=u[T];return p}function Q0(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var y=0;y<u;y++)p.push(y);return p}p=[],y=0;for(const T in u)p[y++]=T;return p}}}function nm(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var y=Q0(u),T=W0(u),M=T.length,F=0;F<M;F++)p.call(void 0,T[F],y&&y[F],u)}var rm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Y0(u,p){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var T=u[y].indexOf("="),M=null;if(0<=T){var F=u[y].substring(0,T);M=u[y].substring(T+1)}else F=u[y];p(F,M?decodeURIComponent(M.replace(/\+/g," ")):"")}}}function Rr(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Rr){this.h=u.h,Ia(this,u.j),this.o=u.o,this.g=u.g,wa(this,u.s),this.l=u.l;var p=u.i,y=new Do;y.i=p.i,p.g&&(y.g=new Map(p.g),y.h=p.h),im(this,y),this.m=u.m}else u&&(p=String(u).match(rm))?(this.h=!1,Ia(this,p[1]||"",!0),this.o=xo(p[2]||""),this.g=xo(p[3]||"",!0),wa(this,p[4]),this.l=xo(p[5]||"",!0),im(this,p[6]||"",!0),this.m=xo(p[7]||"")):(this.h=!1,this.i=new Do(null,this.h))}Rr.prototype.toString=function(){var u=[],p=this.j;p&&u.push(Po(p,om,!0),":");var y=this.g;return(y||p=="file")&&(u.push("//"),(p=this.o)&&u.push(Po(p,om,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(Po(y,y.charAt(0)=="/"?j0:X0,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",Po(y,eC)),u.join("")};function vn(u){return new Rr(u)}function Ia(u,p,y){u.j=y?xo(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function wa(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function im(u,p,y){p instanceof Do?(u.i=p,tC(u.i,u.h)):(y||(p=Po(p,Z0)),u.i=new Do(p,u.h))}function _e(u,p,y){u.i.set(p,y)}function Ca(u){return _e(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function xo(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Po(u,p,y){return typeof u=="string"?(u=encodeURI(u).replace(p,J0),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function J0(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var om=/[#\/\?@]/g,X0=/[#\?:]/g,j0=/[#\?]/g,Z0=/[#\?@]/g,eC=/#/g;function Do(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function Un(u){u.g||(u.g=new Map,u.h=0,u.i&&Y0(u.i,function(p,y){u.add(decodeURIComponent(p.replace(/\+/g," ")),y)}))}n=Do.prototype,n.add=function(u,p){Un(this),this.i=null,u=gi(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(p),this.h+=1,this};function sm(u,p){Un(u),p=gi(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function am(u,p){return Un(u),p=gi(u,p),u.g.has(p)}n.forEach=function(u,p){Un(this),this.g.forEach(function(y,T){y.forEach(function(M){u.call(p,M,T,this)},this)},this)},n.na=function(){Un(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),y=[];for(let T=0;T<p.length;T++){const M=u[T];for(let F=0;F<M.length;F++)y.push(p[T])}return y},n.V=function(u){Un(this);let p=[];if(typeof u=="string")am(this,u)&&(p=p.concat(this.g.get(gi(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)p=p.concat(u[y])}return p},n.set=function(u,p){return Un(this),this.i=null,u=gi(this,u),am(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function lm(u,p,y){sm(u,p),0<y.length&&(u.i=null,u.g.set(gi(u,p),x(y)),u.h+=y.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var y=0;y<p.length;y++){var T=p[y];const F=encodeURIComponent(String(T)),$=this.V(T);for(T=0;T<$.length;T++){var M=F;$[T]!==""&&(M+="="+encodeURIComponent(String($[T]))),u.push(M)}}return this.i=u.join("&")};function gi(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function tC(u,p){p&&!u.j&&(Un(u),u.i=null,u.g.forEach(function(y,T){var M=T.toLowerCase();T!=M&&(sm(this,T),lm(this,M,y))},u)),u.j=p}function nC(u,p){const y=new Ao;if(a.Image){const T=new Image;T.onload=_(On,y,"TestLoadImage: loaded",!0,p,T),T.onerror=_(On,y,"TestLoadImage: error",!1,p,T),T.onabort=_(On,y,"TestLoadImage: abort",!1,p,T),T.ontimeout=_(On,y,"TestLoadImage: timeout",!1,p,T),a.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else p(!1)}function rC(u,p){const y=new Ao,T=new AbortController,M=setTimeout(()=>{T.abort(),On(y,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:T.signal}).then(F=>{clearTimeout(M),F.ok?On(y,"TestPingServer: ok",!0,p):On(y,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(M),On(y,"TestPingServer: error",!1,p)})}function On(u,p,y,T,M){try{M&&(M.onload=null,M.onerror=null,M.onabort=null,M.ontimeout=null),T(y)}catch{}}function iC(){this.g=new B0}function oC(u,p,y){const T=y||"";try{nm(u,function(M,F){let $=M;c(M)&&($=ac(M)),p.push(T+F+"="+encodeURIComponent($))})}catch(M){throw p.push(T+"type="+encodeURIComponent("_badmap")),M}}function Sa(u){this.l=u.Ub||null,this.j=u.eb||!1}I(Sa,lc),Sa.prototype.g=function(){return new Aa(this.l,this.j)},Sa.prototype.i=function(u){return function(){return u}}({});function Aa(u,p){nt.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}I(Aa,nt),n=Aa.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,ko(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,No(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ko(this)),this.g&&(this.readyState=3,ko(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;um(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function um(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?No(this):ko(this),this.readyState==3&&um(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,No(this))},n.Qa=function(u){this.g&&(this.response=u,No(this))},n.ga=function(){this.g&&No(this)};function No(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ko(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var y=p.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=p.next();return u.join(`\r
`)};function ko(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Aa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function cm(u){let p="";return B(u,function(y,T){p+=T,p+=":",p+=y,p+=`\r
`}),p}function _c(u,p,y){e:{for(T in y){var T=!1;break e}T=!0}T||(y=cm(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):_e(u,p,y))}function ke(u){nt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}I(ke,nt);var sC=/^https?$/i,aC=["POST","PUT"];n=ke.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,y,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dc.g(),this.v=this.o?Op(this.o):Op(dc),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(F){dm(this,F);return}if(u=y||"",y=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var M in T)y.set(M,T[M]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const F of T.keys())y.set(F,T.get(F));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(y.keys()).find(F=>F.toLowerCase()=="content-type"),M=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(aC,p,void 0))||T||M||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,$]of y)this.g.setRequestHeader(F,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{pm(this),this.u=!0,this.g.send(u),this.u=!1}catch(F){dm(this,F)}};function dm(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,fm(u),Ra(u)}function fm(u){u.A||(u.A=!0,ft(u,"complete"),ft(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ft(this,"complete"),ft(this,"abort"),Ra(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ra(this,!0)),ke.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?hm(this):this.bb())},n.bb=function(){hm(this)};function hm(u){if(u.h&&typeof s<"u"&&(!u.v[1]||Tn(u)!=4||u.Z()!=2)){if(u.u&&Tn(u)==4)Lp(u.Ea,0,u);else if(ft(u,"readystatechange"),Tn(u)==4){u.h=!1;try{const $=u.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var y;if(!(y=p)){var T;if(T=$===0){var M=String(u.D).match(rm)[1]||null;!M&&a.self&&a.self.location&&(M=a.self.location.protocol.slice(0,-1)),T=!sC.test(M?M.toLowerCase():"")}y=T}if(y)ft(u,"complete"),ft(u,"success");else{u.m=6;try{var F=2<Tn(u)?u.g.statusText:""}catch{F=""}u.l=F+" ["+u.Z()+"]",fm(u)}}finally{Ra(u)}}}}function Ra(u,p){if(u.g){pm(u);const y=u.g,T=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||ft(u,"ready");try{y.onreadystatechange=T}catch{}}}function pm(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Tn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Tn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),O0(p)}};function mm(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function lC(u){const p={};u=(u.g&&2<=Tn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(E(u[T]))continue;var y=D(u[T]);const M=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const F=p[M]||[];p[M]=F,F.push(y)}C(p,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Vo(u,p,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||p}function gm(u){this.Aa=0,this.i=[],this.j=new Ao,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Vo("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Vo("baseRetryDelayMs",5e3,u),this.cb=Vo("retryDelaySeedMs",1e4,u),this.Wa=Vo("forwardChannelMaxRetries",2,u),this.wa=Vo("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Xp(u&&u.concurrentRequestLimit),this.Da=new iC,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=gm.prototype,n.la=8,n.G=1,n.connect=function(u,p,y,T){ht(0),this.W=u,this.H=p||{},y&&T!==void 0&&(this.H.OSID=y,this.H.OAID=T),this.F=this.X,this.I=Sm(this,null,this.W),Pa(this)};function vc(u){if(ym(u),u.G==3){var p=u.U++,y=vn(u.I);if(_e(y,"SID",u.K),_e(y,"RID",p),_e(y,"TYPE","terminate"),Mo(u,y),p=new bn(u,u.j,p),p.L=2,p.v=Ca(vn(y)),y=!1,a.navigator&&a.navigator.sendBeacon)try{y=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!y&&a.Image&&(new Image().src=p.v,y=!0),y||(p.g=Am(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Ea(p)}Cm(u)}function xa(u){u.g&&(Ec(u),u.g.cancel(),u.g=null)}function ym(u){xa(u),u.u&&(a.clearTimeout(u.u),u.u=null),Da(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Pa(u){if(!jp(u.h)&&!u.s){u.s=!0;var p=u.Ga;pn||te(),H||(pn(),H=!0),Z.add(p,u),u.B=0}}function uC(u,p){return Zp(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=So(g(u.Ga,u,p),wm(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const M=new bn(this,this.j,u);let F=this.o;if(this.S&&(F?(F=v(F),R(F,this.S)):F=this.S),this.m!==null||this.O||(M.H=F,F=null),this.P)e:{for(var p=0,y=0;y<this.i.length;y++){t:{var T=this.i[y];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(p+=T,4096<p){p=y;break e}if(p===4096||y===this.i.length-1){p=y+1;break e}}p=1e3}else p=1e3;p=vm(this,M,p),y=vn(this.I),_e(y,"RID",u),_e(y,"CVER",22),this.D&&_e(y,"X-HTTP-Session-Id",this.D),Mo(this,y),F&&(this.O?p="headers="+encodeURIComponent(String(cm(F)))+"&"+p:this.m&&_c(y,this.m,F)),yc(this.h,M),this.Ua&&_e(y,"TYPE","init"),this.P?(_e(y,"$req",p),_e(y,"SID","null"),M.T=!0,hc(M,y,null)):hc(M,y,p),this.G=2}}else this.G==3&&(u?_m(this,u):this.i.length==0||jp(this.h)||_m(this))};function _m(u,p){var y;p?y=p.l:y=u.U++;const T=vn(u.I);_e(T,"SID",u.K),_e(T,"RID",y),_e(T,"AID",u.T),Mo(u,T),u.m&&u.o&&_c(T,u.m,u.o),y=new bn(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),p&&(u.i=p.D.concat(u.i)),p=vm(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),yc(u.h,y),hc(y,T,p)}function Mo(u,p){u.H&&B(u.H,function(y,T){_e(p,T,y)}),u.l&&nm({},function(y,T){_e(p,T,y)})}function vm(u,p,y){y=Math.min(u.i.length,y);var T=u.l?g(u.l.Na,u.l,u):null;e:{var M=u.i;let F=-1;for(;;){const $=["count="+y];F==-1?0<y?(F=M[0].g,$.push("ofs="+F)):F=0:$.push("ofs="+F);let ge=!0;for(let Ye=0;Ye<y;Ye++){let ue=M[Ye].g;const rt=M[Ye].map;if(ue-=F,0>ue)F=Math.max(0,M[Ye].g-100),ge=!1;else try{oC(rt,$,"req"+ue+"_")}catch{T&&T(rt)}}if(ge){T=$.join("&");break e}}}return u=u.i.splice(0,y),p.D=u,T}function Tm(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;pn||te(),H||(pn(),H=!0),Z.add(p,u),u.v=0}}function Tc(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=So(g(u.Fa,u),wm(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Em(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=So(g(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ht(10),xa(this),Em(this))};function Ec(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Em(u){u.g=new bn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=vn(u.qa);_e(p,"RID","rpc"),_e(p,"SID",u.K),_e(p,"AID",u.T),_e(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&_e(p,"TO",u.ja),_e(p,"TYPE","xmlhttp"),Mo(u,p),u.m&&u.o&&_c(p,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=Ca(vn(p)),y.m=null,y.P=!0,Qp(y,u)}n.Za=function(){this.C!=null&&(this.C=null,xa(this),Tc(this),ht(19))};function Da(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Im(u,p){var y=null;if(u.g==p){Da(u),Ec(u),u.g=null;var T=2}else if(gc(u.h,p))y=p.D,em(u.h,p),T=1;else return;if(u.G!=0){if(p.o)if(T==1){y=p.m?p.m.length:0,p=Date.now()-p.F;var M=u.B;T=_a(),ft(T,new $p(T,y)),Pa(u)}else Tm(u);else if(M=p.s,M==3||M==0&&0<p.X||!(T==1&&uC(u,p)||T==2&&Tc(u)))switch(y&&0<y.length&&(p=u.h,p.i=p.i.concat(y)),M){case 1:xr(u,5);break;case 4:xr(u,10);break;case 3:xr(u,6);break;default:xr(u,2)}}}function wm(u,p){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*p}function xr(u,p){if(u.j.info("Error code "+p),p==2){var y=g(u.fb,u),T=u.Xa;const M=!T;T=new Rr(T||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ia(T,"https"),Ca(T),M?nC(T.toString(),y):rC(T.toString(),y)}else ht(2);u.G=0,u.l&&u.l.sa(p),Cm(u),ym(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))};function Cm(u){if(u.G=0,u.ka=[],u.l){const p=tm(u.h);(p.length!=0||u.i.length!=0)&&(k(u.ka,p),k(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Sm(u,p,y){var T=y instanceof Rr?vn(y):new Rr(y);if(T.g!="")p&&(T.g=p+"."+T.g),wa(T,T.s);else{var M=a.location;T=M.protocol,p=p?p+"."+M.hostname:M.hostname,M=+M.port;var F=new Rr(null);T&&Ia(F,T),p&&(F.g=p),M&&wa(F,M),y&&(F.l=y),T=F}return y=u.D,p=u.ya,y&&p&&_e(T,y,p),_e(T,"VER",u.la),Mo(u,T),T}function Am(u,p,y){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new ke(new Sa({eb:y})):new ke(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rm(){}n=Rm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Na(){}Na.prototype.g=function(u,p){return new Dt(u,p)};function Dt(u,p){nt.call(this),this.g=new gm(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!E(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!E(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new yi(this)}I(Dt,nt),Dt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Dt.prototype.close=function(){vc(this.g)},Dt.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=ac(u),u=y);p.i.push(new H0(p.Ya++,u)),p.G==3&&Pa(p)},Dt.prototype.N=function(){this.g.l=null,delete this.j,vc(this.g),delete this.g,Dt.aa.N.call(this)};function xm(u){uc.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const y in p){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}I(xm,uc);function Pm(){cc.call(this),this.status=1}I(Pm,cc);function yi(u){this.g=u}I(yi,Rm),yi.prototype.ua=function(){ft(this.g,"a")},yi.prototype.ta=function(u){ft(this.g,new xm(u))},yi.prototype.sa=function(u){ft(this.g,new Pm)},yi.prototype.ra=function(){ft(this.g,"b")},Na.prototype.createWebChannel=Na.prototype.g,Dt.prototype.send=Dt.prototype.o,Dt.prototype.open=Dt.prototype.m,Dt.prototype.close=Dt.prototype.close,fI=function(){return new Na},dI=function(){return _a()},cI=Sr,mf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},va.NO_ERROR=0,va.TIMEOUT=8,va.HTTP_ERROR=6,El=va,Kp.COMPLETE="complete",uI=Kp,Bp.EventType=wo,wo.OPEN="a",wo.CLOSE="b",wo.ERROR="c",wo.MESSAGE="d",nt.prototype.listen=nt.prototype.K,es=Bp,ke.prototype.listenOnce=ke.prototype.L,ke.prototype.getLastError=ke.prototype.Ka,ke.prototype.getLastErrorCode=ke.prototype.Ba,ke.prototype.getStatus=ke.prototype.Z,ke.prototype.getResponseJson=ke.prototype.Oa,ke.prototype.getResponseText=ke.prototype.oa,ke.prototype.send=ke.prototype.ea,ke.prototype.setWithCredentials=ke.prototype.Ha,lI=ke}).apply(typeof Za<"u"?Za:typeof self<"u"?self:typeof window<"u"?window:{});const e_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xe.UNAUTHENTICATED=new Xe(null),Xe.GOOGLE_CREDENTIALS=new Xe("google-credentials-uid"),Xe.FIRST_PARTY=new Xe("first-party-uid"),Xe.MOCK_USER=new Xe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yo="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr=new jE("@firebase/firestore");function Ci(){return Jr.logLevel}function q(n,...e){if(Jr.logLevel<=ae.DEBUG){const t=e.map(Fh);Jr.debug(`Firestore (${yo}): ${n}`,...t)}}function gt(n,...e){if(Jr.logLevel<=ae.ERROR){const t=e.map(Fh);Jr.error(`Firestore (${yo}): ${n}`,...t)}}function Xr(n,...e){if(Jr.logLevel<=ae.WARN){const t=e.map(Fh);Jr.warn(`Firestore (${yo}): ${n}`,...t)}}function Fh(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(n="Unexpected state"){const e=`FIRESTORE (${yo}) INTERNAL ASSERTION FAILED: `+n;throw gt(e),new Error(e)}function Y(n,e){n||Q()}function j(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class G extends ui{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hI{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iV{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Xe.UNAUTHENTICATED))}shutdown(){}}class oV{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sV{constructor(e){this.t=e,this.currentUser=Xe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){Y(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let o=new fn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new fn,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const l=o;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new fn)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new hI(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new Xe(e)}}class aV{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Xe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lV{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new aV(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Xe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class uV{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class cV{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Y(this.o===void 0);const r=o=>{o.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,q("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?t(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Y(typeof t.token=="string"),this.R=t.token,new uV(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dV(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=dV(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<t&&(r+=e.charAt(i[o]%e.length))}return r}}function ee(n,e){return n<e?-1:n>e?1:0}function ro(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function mI(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new G(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new G(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new G(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new G(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return De.fromMillis(Date.now())}static fromDate(e){return De.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new De(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(e){this.timestamp=e}static fromTimestamp(e){return new J(e)}static min(){return new J(new De(0,0))}static max(){return new J(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bs{constructor(e,t,r){t===void 0?t=0:t>e.length&&Q(),r===void 0?r=e.length-t:r>e.length-t&&Q(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Bs.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Bs?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const o=e.get(i),s=t.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ce extends Bs{construct(e,t,r){return new ce(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new G(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new ce(t)}static emptyPath(){return new ce([])}}const fV=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xe extends Bs{construct(e,t,r){return new xe(e,t,r)}static isValidIdentifier(e){return fV.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new xe(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const o=()=>{if(r.length===0)throw new G(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let s=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new G(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new G(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(s=!s,i++):a!=="."||s?(r+=a,i++):(o(),i++)}if(o(),s)throw new G(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xe(t)}static emptyPath(){return new xe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e){this.path=e}static fromPath(e){return new K(ce.fromString(e))}static fromName(e){return new K(ce.fromString(e).popFirst(5))}static empty(){return new K(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ce.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new K(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class su{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function gf(n){return n.fields.find(e=>e.kind===2)}function Vr(n){return n.fields.filter(e=>e.kind!==2)}su.UNKNOWN_ID=-1;class Il{constructor(e,t){this.fieldPath=e,this.kind=t}}class qs{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new qs(0,bt.min())}}function hV(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=J.fromTimestamp(r===1e9?new De(t+1,0):new De(t,r));return new bt(i,K.empty(),e)}function gI(n){return new bt(n.readTime,n.key,-1)}class bt{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new bt(J.min(),K.empty(),-1)}static max(){return new bt(J.max(),K.empty(),-1)}}function bh(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=K.comparator(n.documentKey,e.documentKey),t!==0?t:ee(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class _I{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==yI)throw n;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(t,o).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof L?t:L.resolve(t)}catch(t){return L.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):L.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):L.reject(t)}static resolve(e){return new L((t,r)=>{t(e)})}static reject(e){return new L((t,r)=>{r(e)})}static waitFor(e){return new L((t,r)=>{let i=0,o=0,s=!1;e.forEach(a=>{++i,a.next(()=>{++o,s&&o===i&&t()},l=>r(l))}),s=!0,o===i&&t()})}static or(e){let t=L.resolve(!1);for(const r of e)t=t.next(i=>i?L.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,o)=>{r.push(t.call(this,i,o))}),this.waitFor(r)}static mapArray(e,t){return new L((r,i)=>{const o=e.length,s=new Array(o);let a=0;for(let l=0;l<o;l++){const c=l;t(e[c]).next(h=>{s[c]=h,++a,a===o&&r(s)},h=>i(h))}})}static doWhile(e,t){return new L((r,i)=>{const o=()=>{e()===!0?t().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fu{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new fn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new ps(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Uh(r.target.error);this.V.reject(new ps(e,i))}}static open(e,t,r,i){try{return new Fu(t,e.transaction(i,r))}catch(o){throw new ps(t,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new mV(t)}}class ur{constructor(e,t,r){this.name=e,this.version=t,this.p=r,ur.S(iu())===12.2&&gt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return q("SimpleDb","Removing database:",e),Mr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!JE())return!1;if(ur.v())return!0;const e=iu(),t=ur.S(e),r=0<t&&t<10,i=vI(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(q("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const s=o.target.result;t(s)},i.onblocked=()=>{r(new ps(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const s=o.target.error;s.name==="VersionError"?r(new G(U.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new G(U.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new ps(e,s))},i.onupgradeneeded=o=>{q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=t=>this.N(t)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const o=t==="readonly";let s=0;for(;;){++s;try{this.db=await this.M(e);const a=Fu.open(this.db,e,o?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),L.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&s<3;if(q("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function vI(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class pV{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Mr(this.B.delete())}}class ps extends G{constructor(e,t){super(U.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function wr(n){return n.name==="IndexedDbTransactionError"}class mV{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(q("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Mr(r)}add(e){return q("SimpleDb","ADD",this.store.name,e,e),Mr(this.store.add(e))}get(e){return Mr(this.store.get(e)).next(t=>(t===void 0&&(t=null),q("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return q("SimpleDb","DELETE",this.store.name,e),Mr(this.store.delete(e))}count(){return q("SimpleDb","COUNT",this.store.name),Mr(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new L((s,a)=>{o.onerror=l=>{a(l.target.error)},o.onsuccess=l=>{s(l.target.result)}})}{const o=this.cursor(r),s=[];return this.W(o,(a,l)=>{s.push(l)}).next(()=>s)}}G(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new L((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,t){q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(o,s,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new L((r,i)=>{t.onerror=o=>{const s=Uh(o.target.error);i(s)},t.onsuccess=o=>{const s=o.target.result;s?e(s.primaryKey,s.value).next(a=>{a?s.continue():r()}):r()}})}W(e,t){const r=[];return new L((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{const a=s.target.result;if(!a)return void i();const l=new pV(a),c=t(a.primaryKey,a.value,l);if(c instanceof L){const h=c.catch(m=>(l.done(),L.reject(m)));r.push(h)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>L.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Mr(n){return new L((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Uh(r.target.error);t(i)}})}let t_=!1;function Uh(n){const e=ur.S(iu());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new G("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return t_||(t_=!0,setTimeout(()=>{throw r},0)),r}}return n}class gV{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(t){wr(t)?q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",t):await ci(t)}await this.X(6e4)})}}class yV{constructor(e,t){this.localStore=e,this.persistence=t}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.te(t,e))}te(e,t){const r=new Set;let i=t,o=!0;return L.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return q("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(a=>{i-=a,r.add(s)});o=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(o=>{const s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(a=>(q("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>s.size)}))}re(e,t){let r=e;return t.changes.forEach((i,o)=>{const s=gI(o);bh(s,r)>0&&(r=s)}),new bt(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Gt.oe=-1;function oa(n){return n==null}function zs(n){return n===0&&1/n==-1/0}function _V(n){return typeof n=="number"&&Number.isInteger(n)&&!zs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=n_(e)),e=vV(n.get(t),e);return n_(e)}function vV(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const o=n.charAt(i);switch(o){case"\0":t+="";break;case"":t+="";break;default:t+=o}}return t}function n_(n){return n+""}function an(n){const e=n.length;if(Y(e>=2),e===2)return Y(n.charAt(0)===""&&n.charAt(1)===""),ce.emptyPath();const t=e-2,r=[];let i="";for(let o=0;o<e;){const s=n.indexOf("",o);switch((s<0||s>t)&&Q(),n.charAt(s+1)){case"":const a=n.substring(o,s);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=n.substring(o,s),i+="\0";break;case"":i+=n.substring(o,s+1);break;default:Q()}o=s+2}return new ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(n,e){return[n,_t(e)]}function TI(n,e,t){return[n,_t(e),t]}const TV={},EV=["prefixPath","collectionGroup","readTime","documentId"],IV=["prefixPath","collectionGroup","documentId"],wV=["collectionGroup","readTime","prefixPath","documentId"],CV=["canonicalId","targetId"],SV=["targetId","path"],AV=["path","targetId"],RV=["collectionId","parent"],xV=["indexId","uid"],PV=["uid","sequenceNumber"],DV=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],NV=["indexId","uid","orderedDocumentKey"],kV=["userId","collectionPath","documentId"],VV=["userId","collectionPath","largestBatchId"],MV=["userId","collectionGroup","largestBatchId"],EI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],LV=[...EI,"documentOverlays"],II=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],wI=II,Oh=[...wI,"indexConfiguration","indexState","indexEntries"],FV=Oh,bV=[...Oh,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf extends _I{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function $e(n,e){const t=j(n);return ur.F(t._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function di(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function CI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Se{constructor(e,t){this.comparator=e,this.root=t||je.EMPTY}insert(e,t){return new Se(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,je.BLACK,null,null))}remove(e){return new Se(this.comparator,this.root.remove(e,this.comparator).copy(null,null,je.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new el(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new el(this.root,e,this.comparator,!1)}getReverseIterator(){return new el(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new el(this.root,e,this.comparator,!0)}}class el{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,t&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class je{constructor(e,t,r,i,o){this.key=e,this.value=t,this.color=r??je.RED,this.left=i??je.EMPTY,this.right=o??je.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,o){return new je(e??this.key,t??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,t,r),null):o===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return je.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return je.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,je.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,je.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}je.EMPTY=null,je.RED=!0,je.BLACK=!1;je.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(e,t,r,i,o){return this}insert(e,t,r){return new je(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new o_(this.data.getIterator())}getIteratorFrom(e){return new o_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof pe)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pe(this.comparator);return t.data=e,t}}class o_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ti(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.fields=e,e.sort(xe.comparator)}static empty(){return new St([])}unionWith(e){let t=new pe(xe.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new St(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ro(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new SI("Invalid base64 string: "+o):o}}(e);return new qe(t)}static fromUint8Array(e){const t=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new qe(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qe.EMPTY_BYTE_STRING=new qe("");const UV=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vn(n){if(Y(!!n),typeof n=="string"){let e=0;const t=UV.exec(n);if(Y(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ee(n.seconds),nanos:Ee(n.nanos)}}function Ee(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function hr(n){return typeof n=="string"?qe.fromBase64String(n):qe.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function qh(n){const e=n.mapValue.fields.__previous_value__;return Bh(e)?qh(e):e}function Gs(n){const e=Vn(n.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OV{constructor(e,t,r,i,o,s,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class jr{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new jr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof jr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Cl={nullValue:"NULL_VALUE"};function Zr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Bh(n)?4:AI(n)?9007199254740991:bu(n)?10:11:Q()}function hn(n,e){if(n===e)return!0;const t=Zr(n);if(t!==Zr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Gs(n).isEqual(Gs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Vn(i.timestampValue),a=Vn(o.timestampValue);return s.seconds===a.seconds&&s.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,o){return hr(i.bytesValue).isEqual(hr(o.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,o){return Ee(i.geoPointValue.latitude)===Ee(o.geoPointValue.latitude)&&Ee(i.geoPointValue.longitude)===Ee(o.geoPointValue.longitude)}(n,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Ee(i.integerValue)===Ee(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Ee(i.doubleValue),a=Ee(o.doubleValue);return s===a?zs(s)===zs(a):isNaN(s)&&isNaN(a)}return!1}(n,e);case 9:return ro(n.arrayValue.values||[],e.arrayValue.values||[],hn);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},a=o.mapValue.fields||{};if(i_(s)!==i_(a))return!1;for(const l in s)if(s.hasOwnProperty(l)&&(a[l]===void 0||!hn(s[l],a[l])))return!1;return!0}(n,e);default:return Q()}}function $s(n,e){return(n.values||[]).find(t=>hn(t,e))!==void 0}function pr(n,e){if(n===e)return 0;const t=Zr(n),r=Zr(e);if(t!==r)return ee(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ee(n.booleanValue,e.booleanValue);case 2:return function(o,s){const a=Ee(o.integerValue||o.doubleValue),l=Ee(s.integerValue||s.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return s_(n.timestampValue,e.timestampValue);case 4:return s_(Gs(n),Gs(e));case 5:return ee(n.stringValue,e.stringValue);case 6:return function(o,s){const a=hr(o),l=hr(s);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(o,s){const a=o.split("/"),l=s.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=ee(a[c],l[c]);if(h!==0)return h}return ee(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(o,s){const a=ee(Ee(o.latitude),Ee(s.latitude));return a!==0?a:ee(Ee(o.longitude),Ee(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return a_(n.arrayValue,e.arrayValue);case 10:return function(o,s){var a,l,c,h;const m=o.fields||{},g=s.fields||{},_=(a=m.value)===null||a===void 0?void 0:a.arrayValue,I=(l=g.value)===null||l===void 0?void 0:l.arrayValue,x=ee(((c=_==null?void 0:_.values)===null||c===void 0?void 0:c.length)||0,((h=I==null?void 0:I.values)===null||h===void 0?void 0:h.length)||0);return x!==0?x:a_(_,I)}(n.mapValue,e.mapValue);case 11:return function(o,s){if(o===Xn.mapValue&&s===Xn.mapValue)return 0;if(o===Xn.mapValue)return 1;if(s===Xn.mapValue)return-1;const a=o.fields||{},l=Object.keys(a),c=s.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let m=0;m<l.length&&m<h.length;++m){const g=ee(l[m],h[m]);if(g!==0)return g;const _=pr(a[l[m]],c[h[m]]);if(_!==0)return _}return ee(l.length,h.length)}(n.mapValue,e.mapValue);default:throw Q()}}function s_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ee(n,e);const t=Vn(n),r=Vn(e),i=ee(t.seconds,r.seconds);return i!==0?i:ee(t.nanos,r.nanos)}function a_(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const o=pr(t[i],r[i]);if(o)return o}return ee(t.length,r.length)}function io(n){return _f(n)}function _f(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Vn(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return hr(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return K.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const o of t.values||[])i?i=!1:r+=",",r+=_f(o);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${_f(t.fields[s])}`;return i+"}"}(n.mapValue):Q()}function Ks(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vf(n){return!!n&&"integerValue"in n}function Hs(n){return!!n&&"arrayValue"in n}function l_(n){return!!n&&"nullValue"in n}function u_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Sl(n){return!!n&&"mapValue"in n}function bu(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ms(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return di(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ms(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ms(n.arrayValue.values[t]);return e}return Object.assign({},n)}function AI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const RI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function BV(n){return"nullValue"in n?Cl:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ks(jr.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?bu(n)?RI:{mapValue:{}}:Q()}function qV(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ks(jr.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?RI:"mapValue"in n?bu(n)?{mapValue:{}}:Xn:Q()}function c_(n,e){const t=pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function d_(n,e){const t=pr(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.value=e}static empty(){return new Ze({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Sl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ms(t)}setAll(e){let t=xe.emptyPath(),r={},i=[];e.forEach((s,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}s?r[a.lastSegment()]=ms(s):i.push(a.lastSegment())});const o=this.getFieldsMap(t);this.applyChanges(o,r,i)}delete(e){const t=this.field(e.popLast());Sl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return hn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Sl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){di(t,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new Ze(ms(this.value))}}function xI(n){const e=[];return di(n.fields,(t,r)=>{const i=new xe([t]);if(Sl(r)){const o=xI(r.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new St(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e,t,r,i,o,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=a}static newInvalidDocument(e){return new we(e,0,J.min(),J.min(),J.min(),Ze.empty(),0)}static newFoundDocument(e,t,r,i){return new we(e,1,t,J.min(),r,i,0)}static newNoDocument(e,t){return new we(e,2,t,J.min(),J.min(),Ze.empty(),0)}static newUnknownDocument(e,t){return new we(e,3,t,J.min(),J.min(),Ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(J.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=J.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof we&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new we(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,t){this.position=e,this.inclusive=t}}function f_(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const o=e[i],s=n.position[i];if(o.field.isKeyField()?r=K.comparator(K.fromName(s.referenceValue),t.key):r=pr(s,t.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function h_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!hn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e,t="asc"){this.field=e,this.dir=t}}function zV(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{}class ie extends PI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new GV(e,t,r):t==="array-contains"?new HV(e,r):t==="in"?new LI(e,r):t==="not-in"?new WV(e,r):t==="array-contains-any"?new QV(e,r):new ie(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new $V(e,r):new KV(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(pr(t,this.value)):t!==null&&Zr(this.value)===Zr(t)&&this.matchesComparison(pr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fe extends PI{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new fe(e,t)}matches(e){return so(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function so(n){return n.op==="and"}function Tf(n){return n.op==="or"}function zh(n){return DI(n)&&so(n)}function DI(n){for(const e of n.filters)if(e instanceof fe)return!1;return!0}function Ef(n){if(n instanceof ie)return n.field.canonicalString()+n.op.toString()+io(n.value);if(zh(n))return n.filters.map(e=>Ef(e)).join(",");{const e=n.filters.map(t=>Ef(t)).join(",");return`${n.op}(${e})`}}function NI(n,e){return n instanceof ie?function(r,i){return i instanceof ie&&r.op===i.op&&r.field.isEqual(i.field)&&hn(r.value,i.value)}(n,e):n instanceof fe?function(r,i){return i instanceof fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,a)=>o&&NI(s,i.filters[a]),!0):!1}(n,e):void Q()}function kI(n,e){const t=n.filters.concat(e);return fe.create(t,n.op)}function VI(n){return n instanceof ie?function(t){return`${t.field.canonicalString()} ${t.op} ${io(t.value)}`}(n):n instanceof fe?function(t){return t.op.toString()+" {"+t.getFilters().map(VI).join(" ,")+"}"}(n):"Filter"}class GV extends ie{constructor(e,t,r){super(e,t,r),this.key=K.fromName(r.referenceValue)}matches(e){const t=K.comparator(e.key,this.key);return this.matchesComparison(t)}}class $V extends ie{constructor(e,t){super(e,"in",t),this.keys=MI("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class KV extends ie{constructor(e,t){super(e,"not-in",t),this.keys=MI("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function MI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>K.fromName(r.referenceValue))}class HV extends ie{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Hs(t)&&$s(t.arrayValue,this.value)}}class LI extends ie{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$s(this.value.arrayValue,t)}}class WV extends ie{constructor(e,t){super(e,"not-in",t)}matches(e){if($s(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!$s(this.value.arrayValue,t)}}class QV extends ie{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Hs(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>$s(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YV{constructor(e,t=null,r=[],i=[],o=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=a,this.ue=null}}function If(n,e=null,t=[],r=[],i=null,o=null,s=null){return new YV(n,e,t,r,i,o,s)}function ei(n){const e=j(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Ef(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),oa(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>io(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>io(r)).join(",")),e.ue=t}return e.ue}function sa(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!zV(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!NI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!h_(n.startAt,e.startAt)&&h_(n.endAt,e.endAt)}function au(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function lu(n,e){return n.filters.filter(t=>t instanceof ie&&t.field.isEqual(e))}function p_(n,e,t){let r=Cl,i=!0;for(const o of lu(n,e)){let s=Cl,a=!0;switch(o.op){case"<":case"<=":s=BV(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,a=!1;break;case"!=":case"not-in":s=Cl}c_({value:r,inclusive:i},{value:s,inclusive:a})<0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const s=t.position[o];c_({value:r,inclusive:i},{value:s,inclusive:t.inclusive})<0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}function m_(n,e,t){let r=Xn,i=!0;for(const o of lu(n,e)){let s=Xn,a=!0;switch(o.op){case">=":case">":s=qV(o.value),a=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,a=!1;break;case"!=":case"not-in":s=Xn}d_({value:r,inclusive:i},{value:s,inclusive:a})>0&&(r=s,i=a)}if(t!==null){for(let o=0;o<n.orderBy.length;++o)if(n.orderBy[o].field.isEqual(e)){const s=t.position[o];d_({value:r,inclusive:i},{value:s,inclusive:t.inclusive})>0&&(r=s,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e,t=null,r=[],i=[],o=null,s="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function JV(n,e,t,r,i,o,s,a){return new _o(n,e,t,r,i,o,s,a)}function Gh(n){return new _o(n)}function g_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function FI(n){return n.collectionGroup!==null}function gs(n){const e=j(n);if(e.ce===null){e.ce=[];const t=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),t.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let a=new pe(xe.comparator);return s.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(o=>{t.has(o.canonicalString())||o.isKeyField()||e.ce.push(new Ws(o,r))}),t.has(xe.keyField().canonicalString())||e.ce.push(new Ws(xe.keyField(),r))}return e.ce}function Kt(n){const e=j(n);return e.le||(e.le=XV(e,gs(n))),e.le}function XV(n,e){if(n.limitType==="F")return If(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new Ws(i.field,o)});const t=n.endAt?new oo(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new oo(n.startAt.position,n.startAt.inclusive):null;return If(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function wf(n,e){const t=n.filters.concat([e]);return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Cf(n,e,t){return new _o(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Uu(n,e){return sa(Kt(n),Kt(e))&&n.limitType===e.limitType}function bI(n){return`${ei(Kt(n))}|lt:${n.limitType}`}function Si(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>VI(i)).join(", ")}]`),oa(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>io(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>io(i)).join(",")),`Target(${r})`}(Kt(n))}; limitType=${n.limitType})`}function aa(n,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):K.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(n,e)&&function(r,i){for(const o of gs(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(s,a,l){const c=f_(s,a,l);return s.inclusive?c<=0:c<0}(r.startAt,gs(r),i)||r.endAt&&!function(s,a,l){const c=f_(s,a,l);return s.inclusive?c>=0:c>0}(r.endAt,gs(r),i))}(n,e)}function jV(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function UI(n){return(e,t)=>{let r=!1;for(const i of gs(n)){const o=ZV(i,e,t);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function ZV(n,e,t){const r=n.field.isKeyField()?K.comparator(e.key,t.key):function(o,s,a){const l=s.data.field(o),c=a.data.field(o);return l!==null&&c!==null?pr(l,c):Q()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){di(this.inner,(t,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return CI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM=new Se(K.comparator);function Vt(){return eM}const OI=new Se(K.comparator);function ts(...n){let e=OI;for(const t of n)e=e.insert(t.key,t);return e}function BI(n){let e=OI;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ln(){return ys()}function qI(){return ys()}function ys(){return new Cr(n=>n.toString(),(n,e)=>n.isEqual(e))}const tM=new Se(K.comparator),nM=new pe(K.comparator);function ne(...n){let e=nM;for(const t of n)e=e.add(t);return e}const rM=new pe(ee);function iM(){return rM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zs(e)?"-0":e}}function zI(n){return{integerValue:""+n}}function oM(n,e){return _V(e)?zI(e):$h(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(){this._=void 0}}function sM(n,e,t){return n instanceof ao?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Bh(o)&&(o=qh(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(t,e):n instanceof lo?$I(n,e):n instanceof uo?KI(n,e):function(i,o){const s=GI(i,o),a=y_(s)+y_(i.Pe);return vf(s)&&vf(i.Pe)?zI(a):$h(i.serializer,a)}(n,e)}function aM(n,e,t){return n instanceof lo?$I(n,e):n instanceof uo?KI(n,e):t}function GI(n,e){return n instanceof Qs?function(r){return vf(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class ao extends Ou{}class lo extends Ou{constructor(e){super(),this.elements=e}}function $I(n,e){const t=HI(e);for(const r of n.elements)t.some(i=>hn(i,r))||t.push(r);return{arrayValue:{values:t}}}class uo extends Ou{constructor(e){super(),this.elements=e}}function KI(n,e){let t=HI(e);for(const r of n.elements)t=t.filter(i=>!hn(i,r));return{arrayValue:{values:t}}}class Qs extends Ou{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function y_(n){return Ee(n.integerValue||n.doubleValue)}function HI(n){return Hs(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e,t){this.field=e,this.transform=t}}function lM(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof lo&&i instanceof lo||r instanceof uo&&i instanceof uo?ro(r.elements,i.elements,hn):r instanceof Qs&&i instanceof Qs?hn(r.Pe,i.Pe):r instanceof ao&&i instanceof ao}(n.transform,e.transform)}class uM{constructor(e,t){this.version=e,this.transformResults=t}}class Be{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Be}static exists(e){return new Be(void 0,e)}static updateTime(e){return new Be(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Al(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Bu{}function QI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new la(n.key,Be.none()):new vo(n.key,n.data,Be.none());{const t=n.data,r=Ze.empty();let i=new pe(xe.comparator);for(let o of e.fields)if(!i.has(o)){let s=t.field(o);s===null&&o.length>1&&(o=o.popLast(),s=t.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new Fn(n.key,r,new St(i.toArray()),Be.none())}}function cM(n,e,t){n instanceof vo?function(i,o,s){const a=i.value.clone(),l=v_(i.fieldTransforms,o,s.transformResults);a.setAll(l),o.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Fn?function(i,o,s){if(!Al(i.precondition,o))return void o.convertToUnknownDocument(s.version);const a=v_(i.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(YI(i)),l.setAll(a),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}(n,e,t):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function _s(n,e,t,r){return n instanceof vo?function(o,s,a,l){if(!Al(o.precondition,s))return a;const c=o.value.clone(),h=T_(o.fieldTransforms,l,s);return c.setAll(h),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Fn?function(o,s,a,l){if(!Al(o.precondition,s))return a;const c=T_(o.fieldTransforms,l,s),h=s.data;return h.setAll(YI(o)),h.setAll(c),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),a===null?null:a.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(o,s,a){return Al(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):a}(n,e,t)}function dM(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),o=GI(r.transform,i||null);o!=null&&(t===null&&(t=Ze.empty()),t.set(r.field,o))}return t||null}function __(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ro(r,i,(o,s)=>lM(o,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class vo extends Bu{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Fn extends Bu{constructor(e,t,r,i,o=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function YI(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function v_(n,e,t){const r=new Map;Y(n.length===t.length);for(let i=0;i<t.length;i++){const o=n[i],s=o.transform,a=e.data.field(o.field);r.set(o.field,aM(s,a,t[i]))}return r}function T_(n,e,t){const r=new Map;for(const i of n){const o=i.transform,s=t.data.field(i.field);r.set(i.field,sM(o,s,e))}return r}class la extends Bu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Kh extends Bu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&cM(o,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=qI();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let a=this.applyToLocalView(s,o.mutatedFields);a=t.has(i.key)?null:a;const l=QI(s,a);l!==null&&r.set(i.key,l),s.isValidDocument()||s.convertToNoDocument(J.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ne())}isEqual(e){return this.batchId===e.batchId&&ro(this.mutations,e.mutations,(t,r)=>__(t,r))&&ro(this.baseMutations,e.baseMutations,(t,r)=>__(t,r))}}class Wh{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Y(e.mutations.length===r.length);let i=function(){return tM}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new Wh(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ue,se;function JI(n){switch(n){default:return Q();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function XI(n){if(n===void 0)return gt("GRPC error has no .code"),U.UNKNOWN;switch(n){case Ue.OK:return U.OK;case Ue.CANCELLED:return U.CANCELLED;case Ue.UNKNOWN:return U.UNKNOWN;case Ue.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case Ue.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case Ue.INTERNAL:return U.INTERNAL;case Ue.UNAVAILABLE:return U.UNAVAILABLE;case Ue.UNAUTHENTICATED:return U.UNAUTHENTICATED;case Ue.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case Ue.NOT_FOUND:return U.NOT_FOUND;case Ue.ALREADY_EXISTS:return U.ALREADY_EXISTS;case Ue.PERMISSION_DENIED:return U.PERMISSION_DENIED;case Ue.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case Ue.ABORTED:return U.ABORTED;case Ue.OUT_OF_RANGE:return U.OUT_OF_RANGE;case Ue.UNIMPLEMENTED:return U.UNIMPLEMENTED;case Ue.DATA_LOSS:return U.DATA_LOSS;default:return Q()}}(se=Ue||(Ue={}))[se.OK=0]="OK",se[se.CANCELLED=1]="CANCELLED",se[se.UNKNOWN=2]="UNKNOWN",se[se.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",se[se.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",se[se.NOT_FOUND=5]="NOT_FOUND",se[se.ALREADY_EXISTS=6]="ALREADY_EXISTS",se[se.PERMISSION_DENIED=7]="PERMISSION_DENIED",se[se.UNAUTHENTICATED=16]="UNAUTHENTICATED",se[se.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",se[se.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",se[se.ABORTED=10]="ABORTED",se[se.OUT_OF_RANGE=11]="OUT_OF_RANGE",se[se.UNIMPLEMENTED=12]="UNIMPLEMENTED",se[se.INTERNAL=13]="INTERNAL",se[se.UNAVAILABLE=14]="UNAVAILABLE",se[se.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM=new Gr([4294967295,4294967295],0);function E_(n){const e=hM().encode(n),t=new aI;return t.update(e),new Uint8Array(t.digest())}function I_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Gr([t,r],0),new Gr([i,o],0)]}class Yh{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ns(`Invalid padding: ${t}`);if(r<0)throw new ns(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ns(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new ns(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Gr.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Gr.fromNumber(r)));return i.compare(pM)===1&&(i=new Gr([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=E_(e),[r,i]=I_(t);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new Yh(o,i,t);return r.forEach(a=>s.insert(a)),s}insert(e){if(this.Ie===0)return;const t=E_(e),[r,i]=I_(t);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ns extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,t,r,i,o){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,ua.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new qu(J.min(),i,new Se(ee),Vt(),ne())}}class ua{constructor(e,t,r,i,o){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new ua(r,t,ne(),ne(),ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class jI{constructor(e,t){this.targetId=e,this.me=t}}class ZI{constructor(e,t,r=qe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class w_{constructor(){this.fe=0,this.ge=S_(),this.pe=qe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ne(),t=ne(),r=ne();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Q()}}),new ua(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=S_()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class mM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Vt(),this.qe=C_(),this.Qe=new Se(ee)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Q()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const o=i.target;if(au(o))if(r===0){const s=new K(o.path);this.Ue(t,s,we.newNoDocument(s,J.min()))}else Y(r===1);else{const s=this.Ye(t);if(s!==r){const a=this.Ze(e),l=a?this.Xe(a,e,s):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=t;let s,a;try{s=hr(r).toUint8Array()}catch(l){if(l instanceof SI)return Xr("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Yh(s,i,o)}catch(l){return Xr(l instanceof ns?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(o=>{const s=this.Le.tt(),a=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,o,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((o,s)=>{const a=this.Je(s);if(a){if(o.current&&au(a.target)){const l=new K(a.target.path);this.ke.get(l)!==null||this.it(s,l)||this.Ue(s,l,we.newNoDocument(l,e))}o.be&&(t.set(s,o.ve()),o.Ce())}});let r=ne();this.qe.forEach((o,s)=>{let a=!0;s.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));const i=new qu(e,t,this.Qe,this.ke,r);return this.ke=Vt(),this.qe=C_(),this.Qe=new Se(ee),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new w_,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new pe(ee),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||q("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new w_),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function C_(){return new Se(K.comparator)}function S_(){return new Se(K.comparator)}const gM={asc:"ASCENDING",desc:"DESCENDING"},yM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_M={and:"AND",or:"OR"};class vM{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Sf(n,e){return n.useProto3Json||oa(e)?e:{value:e}}function co(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ew(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function TM(n,e){return co(n,e.toTimestamp())}function Qe(n){return Y(!!n),J.fromTimestamp(function(t){const r=Vn(t);return new De(r.seconds,r.nanos)}(n))}function Jh(n,e){return Af(n,e).canonicalString()}function Af(n,e){const t=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function tw(n){const e=ce.fromString(n);return Y(cw(e)),e}function Ys(n,e){return Jh(n.databaseId,e.path)}function Rn(n,e){const t=tw(e);if(t.get(1)!==n.databaseId.projectId)throw new G(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new G(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new K(iw(t))}function nw(n,e){return Jh(n.databaseId,e)}function rw(n){const e=tw(n);return e.length===4?ce.emptyPath():iw(e)}function Rf(n){return new ce(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function iw(n){return Y(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function A_(n,e,t){return{name:Ys(n,e),fields:t.value.mapValue.fields}}function EM(n,e,t){const r=Rn(n,e.name),i=Qe(e.updateTime),o=e.createTime?Qe(e.createTime):J.min(),s=new Ze({mapValue:{fields:e.fields}}),a=we.newFoundDocument(r,i,o,s);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function IM(n,e){return"found"in e?function(r,i){Y(!!i.found),i.found.name,i.found.updateTime;const o=Rn(r,i.found.name),s=Qe(i.found.updateTime),a=i.found.createTime?Qe(i.found.createTime):J.min(),l=new Ze({mapValue:{fields:i.found.fields}});return we.newFoundDocument(o,s,a,l)}(n,e):"missing"in e?function(r,i){Y(!!i.missing),Y(!!i.readTime);const o=Rn(r,i.missing),s=Qe(i.readTime);return we.newNoDocument(o,s)}(n,e):Q()}function wM(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(c,h){return c.useProto3Json?(Y(h===void 0||typeof h=="string"),qe.fromBase64String(h||"")):(Y(h===void 0||h instanceof Buffer||h instanceof Uint8Array),qe.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),s=e.targetChange.cause,a=s&&function(c){const h=c.code===void 0?U.UNKNOWN:XI(c.code);return new G(h,c.message||"")}(s);t=new ZI(r,i,o,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Rn(n,r.document.name),o=Qe(r.document.updateTime),s=r.document.createTime?Qe(r.document.createTime):J.min(),a=new Ze({mapValue:{fields:r.document.fields}}),l=we.newFoundDocument(i,o,s,a),c=r.targetIds||[],h=r.removedTargetIds||[];t=new Rl(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Rn(n,r.document),o=r.readTime?Qe(r.readTime):J.min(),s=we.newNoDocument(i,o),a=r.removedTargetIds||[];t=new Rl([],a,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Rn(n,r.document),o=r.removedTargetIds||[];t=new Rl([],o,i,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new fM(i,o),a=r.targetId;t=new jI(a,s)}}return t}function Js(n,e){let t;if(e instanceof vo)t={update:A_(n,e.key,e.value)};else if(e instanceof la)t={delete:Ys(n,e.key)};else if(e instanceof Fn)t={update:A_(n,e.key,e.data),updateMask:PM(e.fieldMask)};else{if(!(e instanceof Kh))return Q();t={verify:Ys(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(o,s){const a=s.transform;if(a instanceof ao)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof lo)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof uo)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Qs)return{fieldPath:s.field.canonicalString(),increment:a.Pe};throw Q()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:TM(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Q()}(n,e.precondition)),t}function xf(n,e){const t=e.currentDocument?function(o){return o.updateTime!==void 0?Be.updateTime(Qe(o.updateTime)):o.exists!==void 0?Be.exists(o.exists):Be.none()}(e.currentDocument):Be.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,a){let l=null;if("setToServerValue"in a)Y(a.setToServerValue==="REQUEST_TIME"),l=new ao;else if("appendMissingElements"in a){const h=a.appendMissingElements.values||[];l=new lo(h)}else if("removeAllFromArray"in a){const h=a.removeAllFromArray.values||[];l=new uo(h)}else"increment"in a?l=new Qs(s,a.increment):Q();const c=xe.fromServerFormat(a.fieldPath);return new WI(c,l)}(n,i)):[];if(e.update){e.update.name;const i=Rn(n,e.update.name),o=new Ze({mapValue:{fields:e.update.fields}});if(e.updateMask){const s=function(l){const c=l.fieldPaths||[];return new St(c.map(h=>xe.fromServerFormat(h)))}(e.updateMask);return new Fn(i,o,s,t,r)}return new vo(i,o,t,r)}if(e.delete){const i=Rn(n,e.delete);return new la(i,t)}if(e.verify){const i=Rn(n,e.verify);return new Kh(i,t)}return Q()}function CM(n,e){return n&&n.length>0?(Y(e!==void 0),n.map(t=>function(i,o){let s=i.updateTime?Qe(i.updateTime):Qe(o);return s.isEqual(J.min())&&(s=Qe(o)),new uM(s,i.transformResults||[])}(t,e))):[]}function ow(n,e){return{documents:[nw(n,e.path)]}}function sw(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=nw(n,i);const o=function(c){if(c.length!==0)return uw(fe.create(c,"and"))}(e.filters);o&&(t.structuredQuery.where=o);const s=function(c){if(c.length!==0)return c.map(h=>function(g){return{field:Ai(g.field),direction:AM(g.dir)}}(h))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);const a=Sf(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:i}}function aw(n){let e=rw(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Y(r===1);const h=t.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];t.where&&(o=function(m){const g=lw(m);return g instanceof fe&&zh(g)?g.getFilters():[g]}(t.where));let s=[];t.orderBy&&(s=function(m){return m.map(g=>function(I){return new Ws(Ri(I.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(I.direction))}(g))}(t.orderBy));let a=null;t.limit&&(a=function(m){let g;return g=typeof m=="object"?m.value:m,oa(g)?null:g}(t.limit));let l=null;t.startAt&&(l=function(m){const g=!!m.before,_=m.values||[];return new oo(_,g)}(t.startAt));let c=null;return t.endAt&&(c=function(m){const g=!m.before,_=m.values||[];return new oo(_,g)}(t.endAt)),JV(e,i,s,o,a,"F",l,c)}function SM(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function lw(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ri(t.unaryFilter.field);return ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ri(t.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ri(t.unaryFilter.field);return ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ri(t.unaryFilter.field);return ie.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(n):n.fieldFilter!==void 0?function(t){return ie.create(Ri(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return fe.create(t.compositeFilter.filters.map(r=>lw(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Q()}}(t.compositeFilter.op))}(n):Q()}function AM(n){return gM[n]}function RM(n){return yM[n]}function xM(n){return _M[n]}function Ai(n){return{fieldPath:n.canonicalString()}}function Ri(n){return xe.fromServerFormat(n.fieldPath)}function uw(n){return n instanceof ie?function(t){if(t.op==="=="){if(u_(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NAN"}};if(l_(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(u_(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NOT_NAN"}};if(l_(t.value))return{unaryFilter:{field:Ai(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ai(t.field),op:RM(t.op),value:t.value}}}(n):n instanceof fe?function(t){const r=t.getFilters().map(i=>uw(i));return r.length===1?r[0]:{compositeFilter:{op:xM(t.op),filters:r}}}(n):Q()}function PM(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function cw(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e,t,r,i,o=J.min(),s=J.min(),a=qe.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Sn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e){this.ct=e}}function DM(n,e){let t;if(e.document)t=EM(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=K.fromSegments(e.noDocument.path),i=ni(e.noDocument.readTime);t=we.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const r=K.fromSegments(e.unknownDocument.path),i=ni(e.unknownDocument.version);t=we.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const o=new De(i[0],i[1]);return J.fromTimestamp(o)}(e.readTime)),t}function R_(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:uu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:Ys(o,s.key),fields:s.data.value.mapValue.fields,updateTime:co(o,s.version.toTimestamp()),createTime:co(o,s.createTime.toTimestamp())}}(n.ct,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:ti(e.version)};else{if(!e.isUnknownDocument())return Q();r.unknownDocument={path:t.path.toArray(),version:ti(e.version)}}return r}function uu(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function ti(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ni(n){const e=new De(n.seconds,n.nanoseconds);return J.fromTimestamp(e)}function Lr(n,e){const t=(e.baseMutations||[]).map(o=>xf(n.ct,o));for(let o=0;o<e.mutations.length-1;++o){const s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const a=e.mutations[o+1];s.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>xf(n.ct,o)),i=De.fromMillis(e.localWriteTimeMs);return new Hh(e.batchId,i,t,r)}function rs(n){const e=ni(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ni(n.lastLimboFreeSnapshotVersion):J.min();let r;return r=function(o){return o.documents!==void 0}(n.query)?function(o){return Y(o.documents.length===1),Kt(Gh(rw(o.documents[0])))}(n.query):function(o){return Kt(aw(o))}(n.query),new Sn(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,qe.fromBase64String(n.resumeToken))}function fw(n,e){const t=ti(e.snapshotVersion),r=ti(e.lastLimboFreeSnapshotVersion);let i;i=au(e.target)?ow(n.ct,e.target):sw(n.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ei(e.target),readTime:t,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function hw(n){const e=aw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Cf(e,e.limit,"L"):e}function ed(n,e){return new Qh(e.largestBatchId,xf(n.ct,e.overlayMutation))}function x_(n,e){const t=e.path.lastSegment();return[n,_t(e.path.popLast()),t]}function P_(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:ti(r.readTime),documentKey:_t(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{getBundleMetadata(e,t){return D_(e).get(t).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ni(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,t){return D_(e).put(function(i){return{bundleId:i.id,createTime:ti(Qe(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return N_(e).get(t).next(r=>{if(r)return function(o){return{name:o.name,query:hw(o.bundledQuery),readTime:ni(o.readTime)}}(r)})}saveNamedQuery(e,t){return N_(e).put(function(i){return{name:i.name,readTime:ti(Qe(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function D_(n){return $e(n,"bundles")}function N_(n){return $e(n,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const r=t.uid||"";return new zu(e,r)}getOverlay(e,t){return Go(e).get(x_(this.userId,t)).next(r=>r?ed(this.serializer,r):null)}getOverlays(e,t){const r=ln();return L.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((o,s)=>{const a=new Qh(t,s);i.push(this.ht(e,a))}),L.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(s=>i.add(_t(s.getCollectionPath())));const o=[];return i.forEach(s=>{const a=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Go(e).j("collectionPathOverlayIndex",a))}),L.waitFor(o)}getOverlaysForCollection(e,t,r){const i=ln(),o=_t(t),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Go(e).U("collectionPathOverlayIndex",s).next(a=>{for(const l of a){const c=ed(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const o=ln();let s;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Go(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,h)=>{const m=ed(this.serializer,c);o.size()<i||m.largestBatchId===s?(o.set(m.getKey(),m),s=m.largestBatchId):h.done()}).next(()=>o)}ht(e,t){return Go(e).put(function(i,o,s){const[a,l,c]=x_(o,s.mutation.key);return{userId:o,collectionPath:l,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Js(i.ct,s.mutation)}}(this.serializer,this.userId,t))}}function Go(n){return $e(n,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{Pt(e){return $e(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?qe.fromUint8Array(r):qe.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Ee(e.integerValue));else if("doubleValue"in e){const r=Ee(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),zs(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Vn(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(hr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?AI(e)?this.dt(t,Number.MAX_SAFE_INTEGER):bu(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Q()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const o=e.fields||{};this.dt(t,53);const s="value",a=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(Ee(a)),this.Vt(s,t),this.Tt(o[s],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),K.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}Fr.vt=new Fr;function VM(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function k_(n){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const s=VM(255&r[o]);if(i+=s,s!==8)break}return i}(n);return Math.ceil(e/8)}class MM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=k_(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=k_(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(o){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;t===0?(this.Ut(0),this.Ut(255)):t===255?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;t===0?(this.Gt(0),this.Gt(255)):t===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class LM{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class FM{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class $o{constructor(){this.jt=new MM,this.Ht=new LM(this.jt),this.Jt=new FM(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new br(this.indexId,this.documentKey,this.arrayValue,r)}}function qn(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=V_(n.arrayValue,e.arrayValue),t!==0?t:(t=V_(n.directionalValue,e.directionalValue),t!==0?t:K.comparator(n.documentKey,e.documentKey)))}function V_(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this.Xt=new pe((t,r)=>xe.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Y(e.collectionGroup===this.collectionId),this.nn)return!1;const t=gf(e);if(t!==void 0&&!this.sn(t))return!1;const r=Vr(e);let i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[o];if(!this.on(a,l)||!this._n(this.en[s++],l))return!1}++o}for(;o<r.length;++o){const a=r[o];if(s>=this.en.length||!this._n(this.en[s++],a))return!1}return!0}an(){if(this.nn)return null;let e=new pe(xe.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Il(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Il(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Il(r.field,r.dir==="asc"?0:1)));return new su(su.UNKNOWN_ID,this.collectionId,t,qs.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pw(n){var e,t;if(Y(n instanceof ie||n instanceof fe),n instanceof ie){if(n instanceof LI){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(o=>ie.create(n.field,"==",o)))||[];return fe.create(i,"or")}return n}const r=n.filters.map(i=>pw(i));return fe.create(r,n.op)}function bM(n){if(n.getFilters().length===0)return[];const e=Nf(pw(n));return Y(mw(e)),Pf(e)||Df(e)?[e]:e.getFilters()}function Pf(n){return n instanceof ie}function Df(n){return n instanceof fe&&zh(n)}function mw(n){return Pf(n)||Df(n)||function(t){if(t instanceof fe&&Tf(t)){for(const r of t.getFilters())if(!Pf(r)&&!Df(r))return!1;return!0}return!1}(n)}function Nf(n){if(Y(n instanceof ie||n instanceof fe),n instanceof ie)return n;if(n.filters.length===1)return Nf(n.filters[0]);const e=n.filters.map(r=>Nf(r));let t=fe.create(e,n.op);return t=cu(t),mw(t)?t:(Y(t instanceof fe),Y(so(t)),Y(t.filters.length>1),t.filters.reduce((r,i)=>Xh(r,i)))}function Xh(n,e){let t;return Y(n instanceof ie||n instanceof fe),Y(e instanceof ie||e instanceof fe),t=n instanceof ie?e instanceof ie?function(i,o){return fe.create([i,o],"and")}(n,e):L_(n,e):e instanceof ie?L_(e,n):function(i,o){if(Y(i.filters.length>0&&o.filters.length>0),so(i)&&so(o))return kI(i,o.getFilters());const s=Tf(i)?i:o,a=Tf(i)?o:i,l=s.filters.map(c=>Xh(c,a));return fe.create(l,"or")}(n,e),cu(t)}function L_(n,e){if(so(e))return kI(e,n.getFilters());{const t=e.filters.map(r=>Xh(n,r));return fe.create(t,"or")}}function cu(n){if(Y(n instanceof ie||n instanceof fe),n instanceof ie)return n;const e=n.getFilters();if(e.length===1)return cu(e[0]);if(DI(n))return n;const t=e.map(i=>cu(i)),r=[];return t.forEach(i=>{i instanceof ie?r.push(i):i instanceof fe&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:fe.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.un=new jh}addToCollectionParentIndex(e,t){return this.un.add(t),L.resolve()}getCollectionParents(e,t){return L.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return L.resolve()}deleteFieldIndex(e,t){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,t){return L.resolve()}getDocumentsMatchingTarget(e,t){return L.resolve(null)}getIndexType(e,t){return L.resolve(0)}getFieldIndexes(e,t){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,t){return L.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,t){return L.resolve(bt.min())}updateCollectionGroup(e,t,r){return L.resolve()}updateIndexEntries(e,t){return L.resolve()}}class jh{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pe(ce.comparator),o=!i.has(r);return this.index[t]=i.add(r),o}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pe(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=new Uint8Array(0);class OM{constructor(e,t){this.databaseId=t,this.cn=new jh,this.ln=new Cr(r=>ei(r),(r,i)=>sa(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const o={collectionId:r,parent:_t(i)};return F_(e).put(o)}return L.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[mI(t),""],!1,!0);return F_(e).U(i).next(o=>{for(const s of o){if(s.collectionId!==t)break;r.push(an(s.parent))}return r})}addFieldIndex(e,t){const r=Ko(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(t);delete i.indexId;const o=r.add(i);if(t.indexState){const s=Ii(e);return o.next(a=>{s.put(P_(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return o.next()}deleteFieldIndex(e,t){const r=Ko(e),i=Ii(e),o=Ei(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ko(e),r=Ei(e),i=Ii(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return L.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new M_(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,t){const r=Ei(e);let i=!0;const o=new Map;return L.forEach(this.hn(t),s=>this.Pn(e,s).next(a=>{i&&(i=!!a),o.set(s,a)})).next(()=>{if(i){let s=ne();const a=[];return L.forEach(o,(l,c)=>{q("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(l)} to execute ${ei(t)}`);const h=function(S,N){const O=gf(N);if(O===void 0)return null;for(const B of lu(S,O.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(c,l),m=function(S,N){const O=new Map;for(const B of Vr(N))for(const C of lu(S,B.fieldPath))switch(C.op){case"==":case"in":O.set(B.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return O.set(B.fieldPath.canonicalString(),C.value),Array.from(O.values())}return null}(c,l),g=function(S,N){const O=[];let B=!0;for(const C of Vr(N)){const v=C.kind===0?p_(S,C.fieldPath,S.startAt):m_(S,C.fieldPath,S.startAt);O.push(v.value),B&&(B=v.inclusive)}return new oo(O,B)}(c,l),_=function(S,N){const O=[];let B=!0;for(const C of Vr(N)){const v=C.kind===0?m_(S,C.fieldPath,S.endAt):p_(S,C.fieldPath,S.endAt);O.push(v.value),B&&(B=v.inclusive)}return new oo(O,B)}(c,l),I=this.In(l,c,g),x=this.In(l,c,_),k=this.Tn(l,c,m),w=this.En(l.indexId,h,I,g.inclusive,x,_.inclusive,k);return L.forEach(w,E=>r.G(E,t.limit).next(S=>{S.forEach(N=>{const O=K.fromSegments(N.documentKey);s.has(O)||(s=s.add(O),a.push(O))})}))}).next(()=>a)}return L.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(e.filters.length===0?t=[e]:t=bM(fe.create(e.filters,"and")).map(r=>If(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,o,s,a){const l=(t!=null?t.length:1)*Math.max(r.length,o.length),c=l/(t!=null?t.length:1),h=[];for(let m=0;m<l;++m){const g=t?this.dn(t[m/c]):tl,_=this.An(e,g,r[m%c],i),I=this.Rn(e,g,o[m%c],s),x=a.map(k=>this.An(e,g,k,!0));h.push(...this.createRange(_,I,x))}return h}An(e,t,r,i){const o=new br(e,K.empty(),t,r);return i?o:o.Zt()}Rn(e,t,r,i){const o=new br(e,K.empty(),t,r);return i?o.Zt():o}Pn(e,t){const r=new M_(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(const a of o)r.rn(a)&&(!s||a.fields.length>s.fields.length)&&(s=a);return s})}getIndexType(e,t){let r=2;const i=this.hn(t);return L.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(l){let c=new pe(xe.comparator),h=!1;for(const m of l.filters)for(const g of m.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?h=!0:c=c.add(g.field));for(const m of l.orderBy)m.field.isKeyField()||(c=c.add(m.field));return c.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}Vn(e,t){const r=new $o;for(const i of Vr(e)){const o=t.data.field(i.fieldPath);if(o==null)return null;const s=r.Yt(i.kind);Fr.vt.It(o,s)}return r.zt()}dn(e){const t=new $o;return Fr.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new $o;return Fr.vt.It(Ks(this.databaseId,t),r.Yt(function(o){const s=Vr(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(r===null)return[];let i=[];i.push(new $o);let o=0;for(const s of Vr(e)){const a=r[o++];for(const l of i)if(this.fn(t,s.fieldPath)&&Hs(a))i=this.gn(i,s,a);else{const c=l.Yt(s.kind);Fr.vt.It(a,c)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],o=[];for(const s of r.arrayValue.values||[])for(const a of i){const l=new $o;l.seed(a.zt()),Fr.vt.It(s,l.Yt(t.kind)),o.push(l)}return o}fn(e,t){return!!e.filters.find(r=>r instanceof ie&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=Ko(e),i=Ii(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(o=>{const s=[];return L.forEach(o,a=>i.get([a.indexId,this.uid]).next(l=>{s.push(function(h,m){const g=m?new qs(m.sequenceNumber,new bt(ni(m.readTime),new K(an(m.documentKey)),m.largestBatchId)):qs.empty(),_=h.fields.map(([I,x])=>new Il(xe.fromServerFormat(I),x));return new su(h.indexId,h.collectionGroup,_,g)}(a,l))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:ee(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Ko(e),o=Ii(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>L.forEach(a,l=>o.put(P_(l.indexId,this.uid,s,r)))))}updateIndexEntries(e,t){const r=new Map;return L.forEach(t,(i,o)=>{const s=r.get(i.collectionGroup);return(s?L.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),L.forEach(a,l=>this.wn(e,i,l).next(c=>{const h=this.Sn(o,l);return c.isEqual(h)?L.resolve():this.bn(e,o,l,c,h)}))))})}Dn(e,t,r,i){return Ei(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return Ei(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=Ei(e);let o=new pe(qn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(s,a)=>{o=o.add(new br(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>o)}Sn(e,t){let r=new pe(qn);const i=this.Vn(t,e);if(i==null)return r;const o=gf(t);if(o!=null){const s=e.data.field(o.fieldPath);if(Hs(s))for(const a of s.arrayValue.values||[])r=r.add(new br(t.indexId,e.key,this.dn(a),i))}else r=r.add(new br(t.indexId,e.key,tl,i));return r}bn(e,t,r,i,o){q("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(l,c,h,m,g){const _=l.getIterator(),I=c.getIterator();let x=Ti(_),k=Ti(I);for(;x||k;){let w=!1,E=!1;if(x&&k){const S=h(x,k);S<0?E=!0:S>0&&(w=!0)}else x!=null?E=!0:w=!0;w?(m(k),k=Ti(I)):E?(g(x),x=Ti(_)):(x=Ti(_),k=Ti(I))}}(i,o,qn,a=>{s.push(this.Dn(e,t,r,a))},a=>{s.push(this.vn(e,t,r,a))}),L.waitFor(s)}yn(e){let t=1;return Ii(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((s,a)=>qn(s,a)).filter((s,a,l)=>!a||qn(s,l[a-1])!==0);const i=[];i.push(e);for(const s of r){const a=qn(s,e),l=qn(s,t);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(s),i.push(s.Zt());else if(l>0)break}i.push(t);const o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];const a=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,tl,[]],l=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,tl,[]];o.push(IDBKeyRange.bound(a,l))}return o}Cn(e,t){return qn(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(b_)}getMinOffset(e,t){return L.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Q())).next(b_)}}function F_(n){return $e(n,"collectionParents")}function Ei(n){return $e(n,"indexEntries")}function Ko(n){return $e(n,"indexConfiguration")}function Ii(n){return $e(n,"indexState")}function b_(n){Y(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;bh(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new bt(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Et{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Et(e,Et.DEFAULT_COLLECTION_PERCENTILE,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),o=[],s=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:s},(h,m,g)=>(a++,g.delete()));o.push(l.next(()=>{Y(a===1)}));const c=[];for(const h of t.mutations){const m=TI(e,h.key.path,t.batchId);o.push(i.delete(m)),c.push(h.key)}return L.waitFor(o).next(()=>c)}function du(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Q();e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Et.DEFAULT_COLLECTION_PERCENTILE=10,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Et.DEFAULT=new Et(41943040,Et.DEFAULT_COLLECTION_PERCENTILE,Et.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Et.DISABLED=new Et(-1,0,0);class Gu{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){Y(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new Gu(o,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{t=!1,s.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const o=xi(e),s=zn(e);return s.add({}).next(a=>{Y(typeof a=="number");const l=new Hh(a,t,r,i),c=function(_,I,x){const k=x.baseMutations.map(E=>Js(_.ct,E)),w=x.mutations.map(E=>Js(_.ct,E));return{userId:I,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:k,mutations:w}}(this.serializer,this.userId,l),h=[];let m=new pe((g,_)=>ee(g.canonicalString(),_.canonicalString()));for(const g of i){const _=TI(this.userId,g.key.path,a);m=m.add(g.key.path.popLast()),h.push(s.put(c)),h.push(o.put(_,TV))}return m.forEach(g=>{h.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),L.waitFor(h).next(()=>l)})}lookupMutationBatch(e,t){return zn(e).get(t).next(r=>r?(Y(r.userId===this.userId),Lr(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?L.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return zn(e).J({index:"userMutationsIndex",range:i},(s,a,l)=>{a.userId===this.userId&&(Y(a.batchId>=r),o=Lr(this.serializer,a)),l.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return zn(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).U("userMutationsIndex",t).next(r=>r.map(i=>Lr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=wl(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return xi(e).J({range:i},(s,a,l)=>{const[c,h,m]=s,g=an(h);if(c===this.userId&&t.path.isEqual(g))return zn(e).get(m).next(_=>{if(!_)throw Q();Y(_.userId===this.userId),o.push(Lr(this.serializer,_))});l.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(ee);const i=[];return t.forEach(o=>{const s=wl(this.userId,o.path),a=IDBKeyRange.lowerBound(s),l=xi(e).J({range:a},(c,h,m)=>{const[g,_,I]=c,x=an(_);g===this.userId&&o.path.isEqual(x)?r=r.add(I):m.done()});i.push(l)}),L.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,o=wl(this.userId,r),s=IDBKeyRange.lowerBound(o);let a=new pe(ee);return xi(e).J({range:s},(l,c,h)=>{const[m,g,_]=l,I=an(g);m===this.userId&&r.isPrefixOf(I)?I.length===i&&(a=a.add(_)):h.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],i=[];return t.forEach(o=>{i.push(zn(e).get(o).next(s=>{if(s===null)throw Q();Y(s.userId===this.userId),r.push(Lr(this.serializer,s))}))}),L.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return gw(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),L.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return L.resolve();const r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return xi(e).J({range:r},(o,s,a)=>{if(o[0]===this.userId){const l=an(o[1]);i.push(l)}else a.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,t){return yw(e,this.userId,t)}Nn(e){return _w(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function yw(n,e,t){const r=wl(e,t.path),i=r[1],o=IDBKeyRange.lowerBound(r);let s=!1;return xi(n).J({range:o,H:!0},(a,l,c)=>{const[h,m,g]=a;h===e&&m===i&&(s=!0),c.done()}).next(()=>s)}function zn(n){return $e(n,"mutations")}function xi(n){return $e(n,"documentMutations")}function _w(n){return $e(n,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ri(0)}static kn(){return new ri(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new ri(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>J.fromTimestamp(new De(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>wi(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const o=[];return wi(e).J((s,a)=>{const l=rs(a);l.sequenceNumber<=t&&r.get(l.targetId)===null&&(i++,o.push(this.removeTargetData(e,l)))}).next(()=>L.waitFor(o)).next(()=>i)}forEachTarget(e,t){return wi(e).J((r,i)=>{const o=rs(i);t(o)})}qn(e){return O_(e).get("targetGlobalKey").next(t=>(Y(t!==null),t))}Qn(e,t){return O_(e).put("targetGlobalKey",t)}Kn(e,t){return wi(e).put(fw(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=ei(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return wi(e).J({range:i,index:"queryTargetsIndex"},(s,a,l)=>{const c=rs(a);sa(t,c.target)&&(o=c,l.done())}).next(()=>o)}addMatchingKeys(e,t,r){const i=[],o=Wn(e);return t.forEach(s=>{const a=_t(s.path);i.push(o.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,s))}),L.waitFor(i)}removeMatchingKeys(e,t,r){const i=Wn(e);return L.forEach(t,o=>{const s=_t(o.path);return L.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,t){const r=Wn(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Wn(e);let o=ne();return i.J({range:r,H:!0},(s,a,l)=>{const c=an(s[1]),h=new K(c);o=o.add(h)}).next(()=>o)}containsKey(e,t){const r=_t(t.path),i=IDBKeyRange.bound([r],[mI(r)],!1,!0);let o=0;return Wn(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,a],l,c)=>{s!==0&&(o++,c.done())}).next(()=>o>0)}ot(e,t){return wi(e).get(t).next(r=>r?rs(r):null)}}function wi(n){return $e(n,"targets")}function O_(n){return $e(n,"targetGlobal")}function Wn(n){return $e(n,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B_([n,e],[t,r]){const i=ee(n,t);return i===0?ee(e,r):i}class qM{constructor(e){this.Un=e,this.buffer=new pe(B_),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();B_(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class zM{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){wr(t)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await ci(t)}await this.Hn(3e5)})}}class GM{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return L.resolve(Gt.oe);const r=new qM(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(U_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),U_):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,o,s,a,l,c;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(m=>(m>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,s=Date.now(),this.nthSequenceNumber(e,i))).next(m=>(r=m,a=Date.now(),this.removeTargets(e,r,t))).next(m=>(o=m,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(m=>(c=Date.now(),Ci()<=ae.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(a-s)+`ms
	Removed ${o} targets in `+(l-a)+`ms
	Removed ${m} documents in `+(c-l)+`ms
Total Duration: ${c-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:m})))}}function $M(n,e){return new GM(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e,t){this.db=e,this.garbageCollector=$M(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return nl(e,r)}removeReference(e,t,r){return nl(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return nl(e,t)}nr(e,t){return function(i,o){let s=!1;return _w(i).Y(a=>yw(i,a,o).next(l=>(l&&(s=!0),L.resolve(!l)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(s,a)=>{if(a<=t){const l=this.nr(e,s).next(c=>{if(!c)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,J.min()),Wn(e).delete(function(m){return[0,_t(m.path)]}(s))))});i.push(l)}}).next(()=>L.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return nl(e,t)}tr(e,t){const r=Wn(e);let i,o=Gt.oe;return r.J({index:"documentTargetsIndex"},([s,a],{path:l,sequenceNumber:c})=>{s===0?(o!==Gt.oe&&t(new K(an(i)),o),o=c,i=l):o=Gt.oe}).next(()=>{o!==Gt.oe&&t(new K(an(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nl(n,e){return Wn(n).put(function(r,i){return{targetId:0,path:_t(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(){this.changes=new Cr(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,we.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?L.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Pr(e).put(r)}removeEntry(e,t,r){return Pr(e).delete(function(o,s){const a=o.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],uu(s),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=we.newInvalidDocument(t);return Pr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ho(t))},(i,o)=>{r=this.ir(t,o)}).next(()=>r)}sr(e,t){let r={size:0,document:we.newInvalidDocument(t)};return Pr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ho(t))},(i,o)=>{r={document:this.ir(t,o),size:du(o)}}).next(()=>r)}getEntries(e,t){let r=Vt();return this._r(e,t,(i,o)=>{const s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,t){let r=Vt(),i=new Se(K.comparator);return this._r(e,t,(o,s)=>{const a=this.ir(o,s);r=r.insert(o,a),i=i.insert(o,du(s))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return L.resolve();let i=new pe(G_);t.forEach(l=>i=i.add(l));const o=IDBKeyRange.bound(Ho(i.first()),Ho(i.last())),s=i.getIterator();let a=s.getNext();return Pr(e).J({index:"documentKeyIndex",range:o},(l,c,h)=>{const m=K.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&G_(a,m)<0;)r(a,null),a=s.getNext();a&&a.isEqual(m)&&(r(a,c),a=s.hasNext()?s.getNext():null),a?h.$(Ho(a)):h.done()}).next(()=>{for(;a;)r(a,null),a=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,o){const s=t.path,a=[s.popLast().toArray(),s.lastSegment(),uu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Pr(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{o==null||o.incrementDocumentReadCount(c.length);let h=Vt();for(const m of c){const g=this.ir(K.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);g.isFoundDocument()&&(aa(t,g)||i.has(g.key))&&(h=h.insert(g.key,g))}return h})}getAllFromCollectionGroup(e,t,r,i){let o=Vt();const s=z_(t,r),a=z_(t,bt.max());return Pr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,a,!0)},(l,c,h)=>{const m=this.ir(K.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);o=o.insert(m.key,m),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new WM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return q_(e).get("remoteDocumentGlobalKey").next(t=>(Y(!!t),t))}rr(e,t){return q_(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=DM(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(J.min())))return r}return we.newInvalidDocument(e)}}function Tw(n){return new HM(n)}class WM extends vw{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Cr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new pe((o,s)=>ee(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{const a=this.lr.get(o);if(t.push(this.cr.removeEntry(e,o,a.readTime)),s.isValidDocument()){const l=R_(this.cr.serializer,s);i=i.add(o.path.popLast());const c=du(l);r+=c-a.size,t.push(this.cr.addEntry(e,o,l))}else if(r-=a.size,this.trackRemovals){const l=R_(this.cr.serializer,s.convertToNoDocument(J.min()));t.push(this.cr.addEntry(e,o,l))}}),i.forEach(o=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),t.push(this.cr.updateMetadata(e,r)),L.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}}function q_(n){return $e(n,"remoteDocumentGlobal")}function Pr(n){return $e(n,"remoteDocumentsV14")}function Ho(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function z_(n,e){const t=e.documentKey.path.toArray();return[n,uu(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function G_(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<t.length-2&&o<r.length-2;++o)if(i=ee(t[o],r[o]),i)return i;return i=ee(t.length,r.length),i||(i=ee(t[t.length-2],r[r.length-2]),i||ee(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ew{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&_s(r.mutation,i,St.empty(),De.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,t,r=ne()){const i=ln();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(o=>{let s=ts();return o.forEach((a,l)=>{s=s.insert(a,l.overlayedDocument)}),s}))}getOverlayedDocuments(e,t){const r=ln();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,ne()))}populateOverlays(e,t,r){const i=[];return r.forEach(o=>{t.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,a)=>{t.set(s,a)})})}computeViews(e,t,r,i){let o=Vt();const s=ys(),a=function(){return ys()}();return t.forEach((l,c)=>{const h=r.get(c.key);i.has(c.key)&&(h===void 0||h.mutation instanceof Fn)?o=o.insert(c.key,c):h!==void 0?(s.set(c.key,h.mutation.getFieldMask()),_s(h.mutation,c,h.mutation.getFieldMask(),De.now())):s.set(c.key,St.empty())}),this.recalculateAndSaveOverlays(e,o).next(l=>(l.forEach((c,h)=>s.set(c,h)),t.forEach((c,h)=>{var m;return a.set(c,new QM(h,(m=s.get(c))!==null&&m!==void 0?m:null))}),a))}recalculateAndSaveOverlays(e,t){const r=ys();let i=new Se((s,a)=>s-a),o=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(s=>{for(const a of s)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||St.empty();h=a.applyToLocalView(c,h),r.set(l,h);const m=(i.get(a.batchId)||ne()).add(l);i=i.insert(a.batchId,m)})}).next(()=>{const s=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,m=qI();h.forEach(g=>{if(!o.has(g)){const _=QI(t.get(g),r.get(g));_!==null&&m.set(g,_),o=o.add(g)}}),s.push(this.documentOverlayCache.saveOverlays(e,c,m))}return L.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(s){return K.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):FI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-o.size):L.resolve(ln());let a=-1,l=o;return s.next(c=>L.forEach(c,(h,m)=>(a<m.largestBatchId&&(a=m.largestBatchId),o.get(h)?L.resolve():this.remoteDocumentCache.getEntry(e,h).next(g=>{l=l.insert(h,g)}))).next(()=>this.populateOverlays(e,c,o)).next(()=>this.computeViews(e,l,c,ne())).next(h=>({batchId:a,changes:BI(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new K(t)).next(r=>{let i=ts();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const o=t.collectionGroup;let s=ts();return this.indexManager.getCollectionParents(e,o).next(a=>L.forEach(a,l=>{const c=function(m,g){return new _o(g,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,l.child(o));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(h=>{h.forEach((m,g)=>{s=s.insert(m,g)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,o,i))).next(s=>{o.forEach((l,c)=>{const h=c.getKey();s.get(h)===null&&(s=s.insert(h,we.newInvalidDocument(h)))});let a=ts();return s.forEach((l,c)=>{const h=o.get(l);h!==void 0&&_s(h.mutation,c,St.empty(),De.now()),aa(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return L.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Qe(i.createTime)}}(t)),L.resolve()}getNamedQuery(e,t){return L.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:hw(i.bundledQuery),readTime:Qe(i.readTime)}}(t)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(){this.overlays=new Se(K.comparator),this.Ir=new Map}getOverlay(e,t){return L.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ln();return L.forEach(t,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,o)=>{this.ht(e,t,o)}),L.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),L.resolve()}getOverlaysForCollection(e,t,r){const i=ln(),o=t.length+1,s=new K(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===o&&l.largestBatchId>r&&i.set(l.getKey(),l)}return L.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let o=new Se((c,h)=>c-h);const s=this.overlays.getIterator();for(;s.hasNext();){const c=s.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=o.get(c.largestBatchId);h===null&&(h=ln(),o=o.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=ln(),l=o.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=i)););return L.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Qh(t,r));let o=this.Ir.get(t);o===void 0&&(o=ne(),this.Ir.set(t,o)),this.Ir.set(t,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XM{constructor(){this.sessionToken=qe.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(){this.Tr=new pe(Ke.Er),this.dr=new pe(Ke.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Ke(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Ke(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new K(new ce([])),r=new Ke(t,e),i=new Ke(t,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new K(new ce([])),r=new Ke(t,e),i=new Ke(t,e+1);let o=ne();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){const t=new Ke(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ke{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return K.comparator(e.key,t.key)||ee(e.wr,t.wr)}static Ar(e,t){return ee(e.wr,t.wr)||K.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new pe(Ke.Er)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Hh(o,t,r,i);this.mutationQueue.push(s);for(const a of i)this.br=this.br.add(new Ke(a.key,o)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return L.resolve(s)}lookupMutationBatch(e,t){return L.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.vr(r),o=i<0?0:i;return L.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ke(t,0),i=new Ke(t,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{const a=this.Dr(s.wr);o.push(a)}),L.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pe(ee);return t.forEach(i=>{const o=new Ke(i,0),s=new Ke(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],a=>{r=r.add(a.wr)})}),L.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let o=r;K.isDocumentKey(o)||(o=o.child(""));const s=new Ke(new K(o),0);let a=new pe(ee);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},s),L.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){Y(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return L.forEach(t.mutations,i=>{const o=new Ke(i.key,t.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Ke(t,0),i=this.br.firstAfterOrEqual(r);return L.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(e){this.Mr=e,this.docs=function(){return new Se(K.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return L.resolve(r?r.document.mutableCopy():we.newInvalidDocument(t))}getEntries(e,t){let r=Vt();return t.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():we.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let o=Vt();const s=t.path,a=new K(s.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!s.isPrefixOf(c.path))break;c.path.length>s.length+1||bh(gI(h),r)<=0||(i.has(h.key)||aa(t,h))&&(o=o.insert(h.key,h.mutableCopy()))}return L.resolve(o)}getAllFromCollectionGroup(e,t,r,i){Q()}Or(e,t){return L.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new e2(this)}getSize(e){return L.resolve(this.size)}}class e2 extends vw{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),L.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e){this.persistence=e,this.Nr=new Cr(t=>ei(t),sa),this.lastRemoteSnapshotVersion=J.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Zh,this.targetCount=0,this.kr=ri.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),L.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new ri(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,L.resolve()}updateTargetData(e,t){return this.Kn(t),L.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,t,r){let i=0;const o=[];return this.Nr.forEach((s,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),L.waitFor(o).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return L.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),L.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,o=[];return i&&t.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),L.waitFor(o)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),L.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return L.resolve(r)}containsKey(e,t){return L.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Gt(0),this.Kr=!1,this.Kr=!0,this.$r=new XM,this.referenceDelegate=e(this),this.Ur=new t2(this),this.indexManager=new UM,this.remoteDocumentCache=function(i){return new ZM(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new dw(t),this.Gr=new YM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new JM,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new jM(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("MemoryPersistence","Starting transaction:",e);const i=new n2(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,t){return L.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class n2 extends _I{constructor(e){super(),this.currentSequenceNumber=e}}class $u{constructor(e){this.persistence=e,this.Jr=new Zh,this.Yr=null}static Zr(e){return new $u(e)}get Xr(){if(this.Yr)return this.Yr;throw Q()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),L.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),L.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.Xr,r=>{const i=K.fromPath(r);return this.ei(e,i).next(o=>{o||t.removeEntry(i,J.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return L.or([()=>L.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{constructor(e){this.serializer=e}O(e,t,r,i){const o=new Fu("createOrUpgrade",t);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",r_,{unique:!0}),l.createObjectStore("documentMutations")}(e),$_(e),function(l){l.createObjectStore("remoteDocuments")}(e));let s=L.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),$_(e)),s=s.next(()=>function(l){const c=l.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:J.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(l,c){return c.store("mutations").U().next(h=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",r_,{unique:!0});const m=c.store("mutations"),g=h.map(_=>m.put(_));return L.waitFor(g)})}(e,o))),s=s.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:kV});c.createIndex("collectionPathOverlayIndex",VV,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",MV,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:EV});c.createIndex("documentKeyIndex",IV),c.createIndex("collectionGroupIndex",wV)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:xV}).createIndex("sequenceNumberIndex",PV,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:DV}).createIndex("documentKeyIndex",NV,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=du(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>L.forEach(i,o=>{const s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(a=>L.forEach(a,l=>{Y(l.userId===o.userId);const c=Lr(this.serializer,l);return gw(e,o.userId,c).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((s,a)=>{const l=new ce(s),c=function(m){return[0,_t(m)]}(l);o.push(t.get(c).next(h=>h?L.resolve():(m=>t.put({targetId:0,path:_t(m),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>L.waitFor(o))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:RV});const r=t.store("collectionParents"),i=new jh,o=s=>{if(i.add(s)){const a=s.lastSegment(),l=s.popLast();return r.put({collectionId:a,parent:_t(l)})}};return t.store("remoteDocuments").J({H:!0},(s,a)=>{const l=new ce(s);return o(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([s,a,l],c)=>{const h=an(a);return o(h.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const o=rs(i),s=fw(this.serializer,o);return t.put(s)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((o,s)=>{const a=t.store("remoteDocumentsV14"),l=function(m){return m.document?new K(ce.fromString(m.document.name).popFirst(5)):m.noDocument?K.fromSegments(m.noDocument.path):m.unknownDocument?K.fromSegments(m.unknownDocument.path):Q()}(s).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(a.put(c))}).next(()=>L.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=Tw(this.serializer),o=new Iw($u.Zr,this.serializer.ct);return r.U().next(s=>{const a=new Map;return s.forEach(l=>{var c;let h=(c=a.get(l.userId))!==null&&c!==void 0?c:ne();Lr(this.serializer,l).keys().forEach(m=>h=h.add(m)),a.set(l.userId,h)}),L.forEach(a,(l,c)=>{const h=new Xe(c),m=zu.lt(this.serializer,h),g=o.getIndexManager(h),_=Gu.lt(h,this.serializer,g,o.referenceDelegate);return new Ew(i,_,m,g).recalculateAndSaveOverlaysForDocumentKeys(new yf(t,Gt.oe),l).next()})})}}function $_(n){n.createObjectStore("targetDocuments",{keyPath:SV}).createIndex("documentTargetsIndex",AV,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",CV,{unique:!0}),n.createObjectStore("targetGlobal")}const td="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ep{constructor(e,t,r,i,o,s,a,l,c,h,m=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=o,this.window=s,this.document=a,this.ci=c,this.li=h,this.hi=m,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=g=>Promise.resolve(),!ep.D())throw new G(U.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new KM(this,i),this.Ai=t+"main",this.serializer=new dw(l),this.Ri=new ur(this.Ai,this.hi,new r2(this.serializer)),this.$r=new kM,this.Ur=new BM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Tw(this.serializer),this.Gr=new NM,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&gt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new G(U.FAILED_PRECONDITION,td);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Gt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>rl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(wr(e))return q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Wo(e).get("owner").next(t=>L.resolve(this.vi(t)))}Ci(e){return rl(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=$e(t,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),s=i.filter(a=>o.indexOf(a)===-1);return L.forEach(s,a=>r.delete(a.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?L.resolve(!0):Wo(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new G(U.FAILED_PRECONDITION,td);return!1}}return!(!this.networkEnabled||!this.inForeground)||rl(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(o||s&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&q("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new yf(e,Gt.oe);return this.bi(t).next(()=>this.Ci(t))}),this.Ri.close(),this.qi()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>rl(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return Gu.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new OM(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return zu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){q("IndexedDbPersistence","Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",o=function(l){return l===17?bV:l===16?FV:l===15?Oh:l===14?wI:l===13?II:l===12?LV:l===11?EI:void Q()}(this.hi);let s;return this.Ri.runTransaction(e,i,o,a=>(s=new yf(a,this.Qr?this.Qr.next():Gt.oe),t==="readwrite-primary"?this.wi(s).next(l=>!!l||this.Si(s)).next(l=>{if(!l)throw gt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new G(U.FAILED_PRECONDITION,yI);return r(s)}).next(l=>this.Di(s).next(()=>l)):this.Ki(s).next(()=>r(s)))).then(a=>(s.raiseOnCommittedEvent(),a))}Ki(e){return Wo(e).get("owner").next(t=>{if(t!==null&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new G(U.FAILED_PRECONDITION,td)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Wo(e).put("owner",t)}static D(){return ur.D()}bi(e){const t=Wo(e);return t.get("owner").next(r=>this.vi(r)?(q("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):L.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(gt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;YE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=((t=this.Vi)===null||t===void 0?void 0:t.getItem(this.Oi(e)))!==null;return q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return gt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){gt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Wo(n){return $e(n,"owner")}function rl(n){return $e(n,"clientMetadata")}function i2(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=ne(),i=ne();for(const o of t.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new tp(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return YE()?8:vI(iu())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const o={result:null};return this.Yi(e,t).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,t,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new o2;return this.Xi(e,t,s).next(a=>{if(o.result=a,this.zi)return this.es(e,t,s,a.size)})}).next(()=>o.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Ci()<=ae.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Si(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),L.resolve()):(Ci()<=ae.DEBUG&&q("QueryEngine","Query:",Si(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ci()<=ae.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Si(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Kt(t))):L.resolve())}Yi(e,t){if(g_(t))return L.resolve(null);let r=Kt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Cf(t,null,"F"),r=Kt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const s=ne(...o);return this.Ji.getDocuments(e,s).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(t,a);return this.ns(t,c,s,l.readTime)?this.Yi(e,Cf(t,null,"F")):this.rs(e,c,t,l)}))})))}Zi(e,t,r,i){return g_(t)||i.isEqual(J.min())?L.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const s=this.ts(t,o);return this.ns(t,s,r,i)?L.resolve(null):(Ci()<=ae.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Si(t)),this.rs(e,s,t,hV(i,-1)).next(a=>a))})}ts(e,t){let r=new pe(UI(e));return t.forEach((i,o)=>{aa(e,o)&&(r=r.add(o))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const o=e.limitType==="F"?t.last():t.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,t,r){return Ci()<=ae.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Si(t)),this.Ji.getDocumentsMatchingQuery(e,t,bt.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(t.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Se(ee),this._s=new Cr(o=>ei(o),sa),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ew(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function Cw(n,e,t,r){return new s2(n,e,t,r)}async function Sw(n,e){const t=j(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(o=>{const s=[],a=[];let l=ne();for(const c of i){s.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of o){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:s,addedBatchIds:a}))})})}function a2(n,e){const t=j(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const m=c.batch,g=m.keys();let _=L.resolve();return g.forEach(I=>{_=_.next(()=>h.getEntry(l,I)).next(x=>{const k=c.docVersions.get(I);Y(k!==null),x.version.compareTo(k)<0&&(m.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),h.addEntry(x)))})}),_.next(()=>a.mutationQueue.removeMutationBatch(l,m))}(t,r,e,o).next(()=>o.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=ne();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Aw(n){const e=j(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function l2(n,e){const t=j(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((h,m)=>{const g=i.get(m);if(!g)return;a.push(t.Ur.removeMatchingKeys(o,h.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(o,h.addedDocuments,m)));let _=g.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(m)!==null?_=_.withResumeToken(qe.EMPTY_BYTE_STRING,J.min()).withLastLimboFreeSnapshotVersion(J.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(m,_),function(x,k,w){return x.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(g,_,h)&&a.push(t.Ur.updateTargetData(o,_))});let l=Vt(),c=ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(o,h))}),a.push(u2(o,s,e.documentUpdates).next(h=>{l=h.Ps,c=h.Is})),!r.isEqual(J.min())){const h=t.Ur.getLastRemoteSnapshotVersion(o).next(m=>t.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));a.push(h)}return L.waitFor(a).next(()=>s.apply(o)).next(()=>t.localDocuments.getLocalViewOfDocuments(o,l,c)).next(()=>l)}).then(o=>(t.os=i,o))}function u2(n,e,t){let r=ne(),i=ne();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let s=Vt();return t.forEach((a,l)=>{const c=o.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(J.min())?(e.removeEntry(a,l.readTime),s=s.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),s=s.insert(a,l)):q("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:s,Is:i}})}function c2(n,e){const t=j(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function d2(n,e){const t=j(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(o=>o?(i=o,L.resolve(i)):t.Ur.allocateTargetId(r).next(s=>(i=new Sn(e,s,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function kf(n,e,t){const r=j(n),i=r.os.get(e),o=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!wr(s))throw s;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function K_(n,e,t){const r=j(n);let i=J.min(),o=ne();return r.persistence.runTransaction("Execute query","readwrite",s=>function(l,c,h){const m=j(l),g=m._s.get(h);return g!==void 0?L.resolve(m.os.get(g)):m.Ur.getTargetData(c,h)}(r,s,Kt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,a.targetId).next(l=>{o=l})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,t?i:J.min(),t?o:ne())).next(a=>(f2(r,jV(e),a),{documents:a,Ts:o})))}function f2(n,e,t){let r=n.us.get(e)||J.min();t.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),n.us.set(e,r)}class H_{constructor(){this.activeTargetIds=iM()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Rw{constructor(){this.so=new H_,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new H_,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let il=null;function nd(){return il===null?il=function(){return 268435456+Math.round(2147483648*Math.random())}():il++,"0x"+il.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const at="WebChannelConnection";class g2 extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(t,r,i,o,s){const a=nd(),l=this.xo(t,r.toUriEncodedString());q("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,o,s),this.No(t,l,c,i).then(h=>(q("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw Xr("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",i),h})}Lo(t,r,i,o,s,a){return this.Mo(t,r,i,o,s)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yo}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>t[s]=o),i&&i.headers.forEach((o,s)=>t[s]=o)}xo(t,r){const i=p2[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const o=nd();return new Promise((s,a)=>{const l=new lI;l.setWithCredentials(!0),l.listenOnce(uI.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case El.NO_ERROR:const h=l.getResponseJson();q(at,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case El.TIMEOUT:q(at,`RPC '${e}' ${o} timed out`),a(new G(U.DEADLINE_EXCEEDED,"Request time out"));break;case El.HTTP_ERROR:const m=l.getStatus();if(q(at,`RPC '${e}' ${o} failed with status:`,m,"response text:",l.getResponseText()),m>0){let g=l.getResponseJson();Array.isArray(g)&&(g=g[0]);const _=g==null?void 0:g.error;if(_&&_.status&&_.message){const I=function(k){const w=k.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(w)>=0?w:U.UNKNOWN}(_.status);a(new G(I,_.message))}else a(new G(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new G(U.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{q(at,`RPC '${e}' ${o} completed.`)}});const c=JSON.stringify(i);q(at,`RPC '${e}' ${o} sending request:`,i),l.send(t,"POST",c,r,15)})}Bo(e,t,r){const i=nd(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=fI(),a=dI(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=o.join("");q(at,`Creating RPC '${e}' stream ${i}: ${h}`,l);const m=s.createWebChannel(h,l);let g=!1,_=!1;const I=new m2({Io:k=>{_?q(at,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(g||(q(at,`Opening RPC '${e}' stream ${i} transport.`),m.open(),g=!0),q(at,`RPC '${e}' stream ${i} sending:`,k),m.send(k))},To:()=>m.close()}),x=(k,w,E)=>{k.listen(w,S=>{try{E(S)}catch(N){setTimeout(()=>{throw N},0)}})};return x(m,es.EventType.OPEN,()=>{_||(q(at,`RPC '${e}' stream ${i} transport opened.`),I.yo())}),x(m,es.EventType.CLOSE,()=>{_||(_=!0,q(at,`RPC '${e}' stream ${i} transport closed`),I.So())}),x(m,es.EventType.ERROR,k=>{_||(_=!0,Xr(at,`RPC '${e}' stream ${i} transport errored:`,k),I.So(new G(U.UNAVAILABLE,"The operation could not be completed")))}),x(m,es.EventType.MESSAGE,k=>{var w;if(!_){const E=k.data[0];Y(!!E);const S=E,N=S.error||((w=S[0])===null||w===void 0?void 0:w.error);if(N){q(at,`RPC '${e}' stream ${i} received error:`,N);const O=N.status;let B=function(A){const R=Ue[A];if(R!==void 0)return XI(R)}(O),C=N.message;B===void 0&&(B=U.INTERNAL,C="Unknown error status: "+O+" with message "+N.message),_=!0,I.So(new G(B,C)),m.close()}else q(at,`RPC '${e}' stream ${i} received:`,E),I.bo(E)}}),x(a,cI.STAT_EVENT,k=>{k.stat===mf.PROXY?q(at,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===mf.NOPROXY&&q(at,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{I.wo()},0),I}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(){return typeof window<"u"?window:null}function xl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ku(n){return new vM(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,t,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,t,r,i,o,s,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new np(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(gt(t.toString()),gt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new G(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class _2 extends xw{constructor(e,t,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=wM(this.serializer,e),r=function(o){if(!("targetChange"in o))return J.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?J.min():s.readTime?Qe(s.readTime):J.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=Rf(this.serializer),t.addTarget=function(o,s){let a;const l=s.target;if(a=au(l)?{documents:ow(o,l)}:{query:sw(o,l)._t},a.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){a.resumeToken=ew(o,s.resumeToken);const c=Sf(o,s.expectedCount);c!==null&&(a.expectedCount=c)}else if(s.snapshotVersion.compareTo(J.min())>0){a.readTime=co(o,s.snapshotVersion.toTimestamp());const c=Sf(o,s.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=SM(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=Rf(this.serializer),t.removeTarget=e,this.a_(t)}}class v2 extends xw{constructor(e,t,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=CM(e.writeResults,e.commitTime),r=Qe(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=Rf(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Js(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T2 extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new G(U.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Af(t,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new G(U.UNKNOWN,o.toString())})}Lo(e,t,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Lo(e,Af(t,r),i,s,a,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new G(U.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class E2{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(gt(t),this.D_=!1):q("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I2{constructor(e,t,r,i,o){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(async()=>{fi(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=j(l);c.L_.add(4),await ca(c),c.q_.set("Unknown"),c.L_.delete(4),await Hu(c)}(this))})}),this.q_=new E2(r,i)}}async function Hu(n){if(fi(n))for(const e of n.B_)await e(!0)}async function ca(n){for(const e of n.B_)await e(!1)}function Pw(n,e){const t=j(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),sp(t)?op(t):To(t).r_()&&ip(t,e))}function rp(n,e){const t=j(n),r=To(t);t.N_.delete(e),r.r_()&&Dw(t,e),t.N_.size===0&&(r.r_()?r.o_():fi(t)&&t.q_.set("Unknown"))}function ip(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(J.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}To(n).A_(e)}function Dw(n,e){n.Q_.xe(e),To(n).R_(e)}function op(n){n.Q_=new mM({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),To(n).start(),n.q_.v_()}function sp(n){return fi(n)&&!To(n).n_()&&n.N_.size>0}function fi(n){return j(n).L_.size===0}function Nw(n){n.Q_=void 0}async function w2(n){n.q_.set("Online")}async function C2(n){n.N_.forEach((e,t)=>{ip(n,e)})}async function S2(n,e){Nw(n),sp(n)?(n.q_.M_(e),op(n)):n.q_.set("Unknown")}async function A2(n,e,t){if(n.q_.set("Online"),e instanceof ZI&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const a of o.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,s),i.N_.delete(a),i.Q_.removeTarget(a))}(n,e)}catch(r){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await fu(n,r)}else if(e instanceof Rl?n.Q_.Ke(e):e instanceof jI?n.Q_.He(e):n.Q_.We(e),!t.isEqual(J.min()))try{const r=await Aw(n.localStore);t.compareTo(r)>=0&&await function(o,s){const a=o.Q_.rt(s);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=o.N_.get(c);h&&o.N_.set(c,h.withResumeToken(l.resumeToken,s))}}),a.targetMismatches.forEach((l,c)=>{const h=o.N_.get(l);if(!h)return;o.N_.set(l,h.withResumeToken(qe.EMPTY_BYTE_STRING,h.snapshotVersion)),Dw(o,l);const m=new Sn(h.target,l,c,h.sequenceNumber);ip(o,m)}),o.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){q("RemoteStore","Failed to raise snapshot:",r),await fu(n,r)}}async function fu(n,e,t){if(!wr(e))throw e;n.L_.add(1),await ca(n),n.q_.set("Offline"),t||(t=()=>Aw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await Hu(n)})}function kw(n,e){return e().catch(t=>fu(n,t,e))}async function da(n){const e=j(n),t=mr(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;R2(e);)try{const i=await c2(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,x2(e,i)}catch(i){await fu(e,i)}Vw(e)&&Mw(e)}function R2(n){return fi(n)&&n.O_.length<10}function x2(n,e){n.O_.push(e);const t=mr(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Vw(n){return fi(n)&&!mr(n).n_()&&n.O_.length>0}function Mw(n){mr(n).start()}async function P2(n){mr(n).p_()}async function D2(n){const e=mr(n);for(const t of n.O_)e.m_(t.mutations)}async function N2(n,e,t){const r=n.O_.shift(),i=Wh.from(r,e,t);await kw(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await da(n)}async function k2(n,e){e&&mr(n).V_&&await async function(r,i){if(function(s){return JI(s)&&s!==U.ABORTED}(i.code)){const o=r.O_.shift();mr(r).s_(),await kw(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await da(r)}}(n,e),Vw(n)&&Mw(n)}async function Q_(n,e){const t=j(n);t.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const r=fi(t);t.L_.add(3),await ca(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await Hu(t)}async function V2(n,e){const t=j(n);e?(t.L_.delete(2),await Hu(t)):e||(t.L_.add(2),await ca(t),t.q_.set("Unknown"))}function To(n){return n.K_||(n.K_=function(t,r,i){const o=j(t);return o.w_(),new _2(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:w2.bind(null,n),Ro:C2.bind(null,n),mo:S2.bind(null,n),d_:A2.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),sp(n)?op(n):n.q_.set("Unknown")):(await n.K_.stop(),Nw(n))})),n.K_}function mr(n){return n.U_||(n.U_=function(t,r,i){const o=j(t);return o.w_(),new v2(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:P2.bind(null,n),mo:k2.bind(null,n),f_:D2.bind(null,n),g_:N2.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await da(n)):(await n.U_.stop(),n.O_.length>0&&(q("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t,r,i,o){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new fn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,o){const s=Date.now()+r,a=new ap(e,t,s,i,o);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new G(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function lp(n,e){if(gt("AsyncQueue",`${e}: ${n}`),wr(n))return new G(U.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e){this.comparator=e?(t,r)=>e(t,r)||K.comparator(t.key,r.key):(t,r)=>K.comparator(t.key,r.key),this.keyedMap=ts(),this.sortedSet=new Se(this.comparator)}static emptySet(e){return new Wi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Wi)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Wi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y_{constructor(){this.W_=new Se(K.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Q():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class fo{constructor(e,t,r,i,o,s,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,i,o){const s=[];return t.forEach(a=>{s.push({type:0,doc:a})}),new fo(e,t,Wi.emptySet(t),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Uu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M2{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class L2{constructor(){this.queries=J_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const i=j(t),o=i.queries;i.queries=J_(),o.forEach((s,a)=>{for(const l of a.j_)l.onError(r)})})(this,new G(U.ABORTED,"Firestore shutting down"))}}function J_(){return new Cr(n=>bI(n),Uu)}async function F2(n,e){const t=j(n);let r=3;const i=e.query;let o=t.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new M2,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await t.onListen(i,!0);break;case 1:o.z_=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(s){const a=lp(s,`Initialization of query '${Si(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,o),o.j_.push(e),e.Z_(t.onlineState),o.z_&&e.X_(o.z_)&&up(t)}async function b2(n,e){const t=j(n),r=e.query;let i=3;const o=t.queries.get(r);if(o){const s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function U2(n,e){const t=j(n);let r=!1;for(const i of e){const o=i.query,s=t.queries.get(o);if(s){for(const a of s.j_)a.X_(i)&&(r=!0);s.z_=i}}r&&up(t)}function O2(n,e,t){const r=j(n),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(t);r.queries.delete(e)}function up(n){n.Y_.forEach(e=>{e.next()})}var Vf,X_;(X_=Vf||(Vf={})).ea="default",X_.Cache="cache";class B2{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new fo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=fo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Vf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{constructor(e){this.key=e}}class Fw{constructor(e){this.key=e}}class q2{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ne(),this.mutatedKeys=ne(),this.Aa=UI(e),this.Ra=new Wi(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new Y_,i=t?t.Ra:this.Ra;let o=t?t.mutatedKeys:this.mutatedKeys,s=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,m)=>{const g=i.get(h),_=aa(this.query,m)?m:null,I=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let k=!1;g&&_?g.data.isEqual(_.data)?I!==x&&(r.track({type:3,doc:_}),k=!0):this.ga(g,_)||(r.track({type:2,doc:_}),k=!0,(l&&this.Aa(_,l)>0||c&&this.Aa(_,c)<0)&&(a=!0)):!g&&_?(r.track({type:0,doc:_}),k=!0):g&&!_&&(r.track({type:1,doc:g}),k=!0,(l||c)&&(a=!0)),k&&(_?(s=s.add(_),o=x?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:a,mutatedKeys:o}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((h,m)=>function(_,I){const x=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return x(_)-x(I)}(h.type,m.type)||this.Aa(h.doc,m.doc)),this.pa(r),i=i!=null&&i;const a=t&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,s.length!==0||c?{snapshot:new fo(this.query,e.Ra,o,s,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Y_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Fw(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Lw(r))}),t}ba(e){this.Ta=e.Ts,this.da=ne();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return fo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class z2{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class G2{constructor(e){this.key=e,this.va=!1}}class $2{constructor(e,t,r,i,o,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Cr(a=>bI(a),Uu),this.Ma=new Map,this.xa=new Set,this.Oa=new Se(K.comparator),this.Na=new Map,this.La=new Zh,this.Ba={},this.ka=new Map,this.qa=ri.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function K2(n,e,t=!0){const r=zw(n);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await bw(r,e,t,!0),i}async function H2(n,e){const t=zw(n);await bw(t,e,!0,!1)}async function bw(n,e,t,r){const i=await d2(n.localStore,Kt(e)),o=i.targetId,s=n.sharedClientState.addLocalQueryTarget(o,t);let a;return r&&(a=await W2(n,e,o,s==="current",i.resumeToken)),n.isPrimaryClient&&t&&Pw(n.remoteStore,i),a}async function W2(n,e,t,r,i){n.Ka=(m,g,_)=>async function(x,k,w,E){let S=k.view.ma(w);S.ns&&(S=await K_(x.localStore,k.query,!1).then(({documents:C})=>k.view.ma(C,S)));const N=E&&E.targetChanges.get(k.targetId),O=E&&E.targetMismatches.get(k.targetId)!=null,B=k.view.applyChanges(S,x.isPrimaryClient,N,O);return Z_(x,k.targetId,B.wa),B.snapshot}(n,m,g,_);const o=await K_(n.localStore,e,!0),s=new q2(e,o.Ts),a=s.ma(o.documents),l=ua.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),c=s.applyChanges(a,n.isPrimaryClient,l);Z_(n,t,c.wa);const h=new z2(e,t,s);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),c.snapshot}async function Q2(n,e,t){const r=j(n),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!Uu(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await kf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&rp(r.remoteStore,i.targetId),Mf(r,i.targetId)}).catch(ci)):(Mf(r,i.targetId),await kf(r.localStore,i.targetId,!0))}async function Y2(n,e){const t=j(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),rp(t.remoteStore,r.targetId))}async function J2(n,e,t){const r=Gw(n);try{const i=await function(s,a){const l=j(s),c=De.now(),h=a.reduce((_,I)=>_.add(I.key),ne());let m,g;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>{let I=Vt(),x=ne();return l.cs.getEntries(_,h).next(k=>{I=k,I.forEach((w,E)=>{E.isValidDocument()||(x=x.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(_,I)).next(k=>{m=k;const w=[];for(const E of a){const S=dM(E,m.get(E.key).overlayedDocument);S!=null&&w.push(new Fn(E.key,S,xI(S.value.mapValue),Be.exists(!0)))}return l.mutationQueue.addMutationBatch(_,c,w,a)}).next(k=>{g=k;const w=k.applyToLocalDocumentSet(m,x);return l.documentOverlayCache.saveOverlays(_,k.batchId,w)})}).then(()=>({batchId:g.batchId,changes:BI(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,a,l){let c=s.Ba[s.currentUser.toKey()];c||(c=new Se(ee)),c=c.insert(a,l),s.Ba[s.currentUser.toKey()]=c}(r,i.batchId,t),await fa(r,i.changes),await da(r.remoteStore)}catch(i){const o=lp(i,"Failed to persist write");t.reject(o)}}async function Uw(n,e){const t=j(n);try{const r=await l2(t.localStore,e);e.targetChanges.forEach((i,o)=>{const s=t.Na.get(o);s&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?Y(s.va):i.removedDocuments.size>0&&(Y(s.va),s.va=!1))}),await fa(t,r,e)}catch(r){await ci(r)}}function j_(n,e,t){const r=j(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.Fa.forEach((o,s)=>{const a=s.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(s,a){const l=j(s);l.onlineState=a;let c=!1;l.queries.forEach((h,m)=>{for(const g of m.j_)g.Z_(a)&&(c=!0)}),c&&up(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function X2(n,e,t){const r=j(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),o=i&&i.key;if(o){let s=new Se(K.comparator);s=s.insert(o,we.newNoDocument(o,J.min()));const a=ne().add(o),l=new qu(J.min(),new Map,new Se(ee),s,a);await Uw(r,l),r.Oa=r.Oa.remove(o),r.Na.delete(e),cp(r)}else await kf(r.localStore,e,!1).then(()=>Mf(r,e,t)).catch(ci)}async function j2(n,e){const t=j(n),r=e.batch.batchId;try{const i=await a2(t.localStore,e);Bw(t,r,null),Ow(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await fa(t,i)}catch(i){await ci(i)}}async function Z2(n,e,t){const r=j(n);try{const i=await function(s,a){const l=j(s);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(m=>(Y(m!==null),h=m.keys(),l.mutationQueue.removeMutationBatch(c,m))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,e);Bw(r,e,t),Ow(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await fa(r,i)}catch(i){await ci(i)}}function Ow(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Bw(n,e,t){const r=j(n);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(t?o.reject(t):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Mf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||qw(n,r)})}function qw(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(rp(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),cp(n))}function Z_(n,e,t){for(const r of t)r instanceof Lw?(n.La.addReference(r.key,e),eL(n,r)):r instanceof Fw?(q("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||qw(n,r.key)):Q()}function eL(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(q("SyncEngine","New document in limbo: "+t),n.xa.add(r),cp(n))}function cp(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new K(ce.fromString(e)),r=n.qa.next();n.Na.set(r,new G2(t)),n.Oa=n.Oa.insert(t,r),Pw(n.remoteStore,new Sn(Kt(Gh(t.path)),r,"TargetPurposeLimboResolution",Gt.oe))}}async function fa(n,e,t){const r=j(n),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{s.push(r.Ka(l,e,t).then(c=>{var h;if((c||t)&&r.isPrimaryClient){const m=c?!c.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,m?"current":"not-current")}if(c){i.push(c);const m=tp.Wi(l.targetId,c);o.push(m)}}))}),await Promise.all(s),r.Ca.d_(i),await async function(l,c){const h=j(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>L.forEach(c,g=>L.forEach(g.$i,_=>h.persistence.referenceDelegate.addReference(m,g.targetId,_)).next(()=>L.forEach(g.Ui,_=>h.persistence.referenceDelegate.removeReference(m,g.targetId,_)))))}catch(m){if(!wr(m))throw m;q("LocalStore","Failed to update sequence numbers: "+m)}for(const m of c){const g=m.targetId;if(!m.fromCache){const _=h.os.get(g),I=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(I);h.os=h.os.insert(g,x)}}}(r.localStore,o))}async function tL(n,e){const t=j(n);if(!t.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const r=await Sw(t.localStore,e);t.currentUser=e,function(o,s){o.ka.forEach(a=>{a.forEach(l=>{l.reject(new G(U.CANCELLED,s))})}),o.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fa(t,r.hs)}}function nL(n,e){const t=j(n),r=t.Na.get(e);if(r&&r.va)return ne().add(r.key);{let i=ne();const o=t.Ma.get(e);if(!o)return i;for(const s of o){const a=t.Fa.get(s);i=i.unionWith(a.view.Va)}return i}}function zw(n){const e=j(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Uw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=X2.bind(null,e),e.Ca.d_=U2.bind(null,e.eventManager),e.Ca.$a=O2.bind(null,e.eventManager),e}function Gw(n){const e=j(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=j2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z2.bind(null,e),e}class Xs{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ku(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return Cw(this.persistence,new ww,e.initialUser,this.serializer)}Ga(e){return new Iw($u.Zr,this.serializer)}Wa(e){return new Rw}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Xs.provider={build:()=>new Xs};class rL extends Xs{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Gw(this.Ja.syncEngine),await da(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return Cw(this.persistence,new ww,e.initialUser,this.serializer)}ja(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new zM(r,e.asyncQueue,t)}Ha(e,t){const r=new yV(t,this.persistence);return new gV(e.asyncQueue,r)}Ga(e){const t=i2(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Et.withCacheSize(this.cacheSizeBytes):Et.DEFAULT;return new ep(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,y2(),xl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Rw}}class hu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>j_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tL.bind(null,this.syncEngine),await V2(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new L2}()}createDatastore(e){const t=Ku(e.databaseInfo.databaseId),r=function(o){return new g2(o)}(e.databaseInfo);return function(o,s,a,l){return new T2(o,s,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,o,s,a){return new I2(r,i,o,s,a)}(this.localStore,this.datastore,e.asyncQueue,t=>j_(this.syncEngine,t,0),function(){return W_.D()?new W_:new h2}())}createSyncEngine(e,t){return function(i,o,s,a,l,c,h){const m=new $2(i,o,s,a,l,c);return h&&(m.Qa=!0),m}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const o=j(i);q("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await ca(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}hu.provider={build:()=>new hu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iL{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):gt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new G(U.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,o){const s=j(i),a={documents:o.map(m=>Ys(s.serializer,m))},l=await s.Lo("BatchGetDocuments",s.serializer.databaseId,ce.emptyPath(),a,o.length),c=new Map;l.forEach(m=>{const g=IM(s.serializer,m);c.set(g.key.toString(),g)});const h=[];return o.forEach(m=>{const g=c.get(m.toString());Y(!!g),h.push(g)}),h}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new la(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{const i=K.fromPath(r);this.mutations.push(new Kh(i,this.precondition(i)))}),await async function(r,i){const o=j(r),s={writes:i.map(a=>Js(o.serializer,a))};await o.Mo("Commit",o.serializer.databaseId,ce.emptyPath(),s)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Q();t=J.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new G(U.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(J.min())?Be.exists(!1):Be.updateTime(t):Be.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(J.min()))throw new G(U.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Be.updateTime(t)}return Be.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sL{constructor(e,t,r,i,o){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=o,this._u=r.maxAttempts,this.t_=new np(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new oL(this.datastore),t=this.cu(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const t=this.updateFunction(e);return!oa(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!JI(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aL{constructor(e,t,r,i,o){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Xe.UNAUTHENTICATED,this.clientId=pI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async s=>{q("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(q("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=lp(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function rd(n,e){n.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await Sw(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function ev(n,e){n.asyncQueue.verifyOperationInProgress();const t=await lL(n);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Q_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>Q_(e.remoteStore,i)),n._onlineComponents=e}async function lL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await rd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===U.FAILED_PRECONDITION||i.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Xr("Error using user provided cache. Falling back to memory cache: "+t),await rd(n,new Xs)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await rd(n,new Xs);return n._offlineComponents}async function dp(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await ev(n,n._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await ev(n,new hu))),n._onlineComponents}function uL(n){return dp(n).then(e=>e.syncEngine)}function cL(n){return dp(n).then(e=>e.datastore)}async function dL(n){const e=await dp(n),t=e.eventManager;return t.onListen=K2.bind(null,e.syncEngine),t.onUnlisten=Q2.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=H2.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Y2.bind(null,e.syncEngine),t}function fL(n,e,t={}){const r=new fn;return n.asyncQueue.enqueueAndForget(async()=>function(o,s,a,l,c){const h=new iL({next:g=>{h.Za(),s.enqueueAndForget(()=>b2(o,m)),g.fromCache&&l.source==="server"?c.reject(new G(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(g)},error:g=>c.reject(g)}),m=new B2(a,h,{includeMetadataChanges:!0,_a:!0});return F2(o,m)}(await dL(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kw(n,e,t){if(!t)throw new G(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hL(n,e,t,r){if(e===!0&&r===!0)throw new G(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function nv(n){if(!K.isDocumentKey(n))throw new G(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function rv(n){if(K.isDocumentKey(n))throw new G(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Wu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Q()}function Mn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new G(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Wu(n);throw new G(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new G(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new G(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$w((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new G(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new G(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new G(U.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Qu{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new G(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new G(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new iV;switch(r.type){case"firstParty":return new lV(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new G(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=tv.get(t);r&&(q("ComponentProvider","Removing Datastore"),tv.delete(t),r.terminate())}(this),Promise.resolve()}}function pL(n,e,t,r={}){var i;const o=(n=Mn(n,Qu))._getSettings(),s=`${e}:${t}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Xr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Xe.MOCK_USER;else{a=QE(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new G(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Xe(c)}n._authCredentials=new oV(new hI(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hi(this.firestore,e,this._query)}}class Pt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Pt(this.firestore,e,this._key)}}class cr extends hi{constructor(e,t,r){super(e,t,Gh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Pt(this.firestore,null,new K(e))}withConverter(e){return new cr(this.firestore,e,this._path)}}function Yu(n,e,...t){if(n=dt(n),Kw("collection","path",e),n instanceof Qu){const r=ce.fromString(e,...t);return rv(r),new cr(n,null,r)}{if(!(n instanceof Pt||n instanceof cr))throw new G(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return rv(r),new cr(n.firestore,null,r)}}function js(n,e,...t){if(n=dt(n),arguments.length===1&&(e=pI.newId()),Kw("doc","path",e),n instanceof Qu){const r=ce.fromString(e,...t);return nv(r),new Pt(n,null,new K(r))}{if(!(n instanceof Pt||n instanceof cr))throw new G(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ce.fromString(e,...t));return nv(r),new Pt(n.firestore,n instanceof cr?n.converter:null,new K(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new np(this,"async_queue_retry"),this.Vu=()=>{const r=xl();r&&q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=xl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=xl();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new fn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!wr(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(s){let a=s.message||"";return s.stack&&(a=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),a}(r);throw gt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=ap.createAndSchedule(this,e,t,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&Q()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}class pi extends Qu{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new ov,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ov(e),this._firestoreClient=void 0,await e}}}function mL(n,e){const t=typeof n=="object"?n:iI(),r=typeof n=="string"?n:"(default)",i=tI(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=HE("firestore");o&&pL(i,...o)}return i}function fp(n){if(n._terminated)throw new G(U.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Hw(n),n._firestoreClient}function Hw(n){var e,t,r;const i=n._freezeSettings(),o=function(a,l,c,h){return new OV(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,$w(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new aL(n._authCredentials,n._appCheckCredentials,n._queue,o,n._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(n._componentsProvider))}function gL(n,e){Xr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return yL(n,hu.provider,{build:r=>new rL(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function yL(n,e,t){if((n=Mn(n,pi))._firestoreClient||n._terminated)throw new G(U.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new G(U.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Hw(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ii(qe.fromBase64String(e))}catch(t){throw new G(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new ii(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new G(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new G(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new G(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _L=/^__.*__$/;class vL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Fn(e,this.data,this.fieldMask,t,this.fieldTransforms):new vo(e,this.data,t,this.fieldTransforms)}}class Ww{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Fn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Qw(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class mp{constructor(e,t,r,i,o,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new mp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return pu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Qw(this.Cu)&&_L.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class TL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ku(e)}Qu(e,t,r,i=!1){return new mp({Cu:e,methodName:t,qu:r,path:xe.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(n){const e=n._freezeSettings(),t=Ku(n._databaseId);return new TL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yw(n,e,t,r,i,o={}){const s=n.Qu(o.merge||o.mergeFields?2:0,e,t,i);yp("Data must be an object, but it was:",s,r);const a=jw(r,s);let l,c;if(o.merge)l=new St(s.fieldMask),c=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const m of o.mergeFields){const g=Lf(e,m,t);if(!s.contains(g))throw new G(U.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);e0(h,g)||h.push(g)}l=new St(h),c=s.fieldTransforms.filter(m=>l.covers(m.field))}else l=null,c=s.fieldTransforms;return new vL(new Ze(a),l,c)}class ju extends Ju{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ju}}class gp extends Ju{_toFieldTransform(e){return new WI(e.path,new ao)}isEqual(e){return e instanceof gp}}function Jw(n,e,t,r){const i=n.Qu(1,e,t);yp("Data must be an object, but it was:",i,r);const o=[],s=Ze.empty();di(r,(l,c)=>{const h=_p(e,l,t);c=dt(c);const m=i.Nu(h);if(c instanceof ju)o.push(h);else{const g=pa(c,m);g!=null&&(o.push(h),s.set(h,g))}});const a=new St(o);return new Ww(s,a,i.fieldTransforms)}function Xw(n,e,t,r,i,o){const s=n.Qu(1,e,t),a=[Lf(e,r,t)],l=[i];if(o.length%2!=0)throw new G(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<o.length;g+=2)a.push(Lf(e,o[g])),l.push(o[g+1]);const c=[],h=Ze.empty();for(let g=a.length-1;g>=0;--g)if(!e0(c,a[g])){const _=a[g];let I=l[g];I=dt(I);const x=s.Nu(_);if(I instanceof ju)c.push(_);else{const k=pa(I,x);k!=null&&(c.push(_),h.set(_,k))}}const m=new St(c);return new Ww(h,m,s.fieldTransforms)}function EL(n,e,t,r=!1){return pa(t,n.Qu(r?4:3,e))}function pa(n,e){if(Zw(n=dt(n)))return yp("Unsupported field value:",e,n),jw(n,e);if(n instanceof Ju)return function(r,i){if(!Qw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let s=0;for(const a of r){let l=pa(a,i.Lu(s));l==null&&(l={nullValue:"NULL_VALUE"}),o.push(l),s++}return{arrayValue:{values:o}}}(n,e)}return function(r,i){if((r=dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return oM(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=De.fromDate(r);return{timestampValue:co(i.serializer,o)}}if(r instanceof De){const o=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:co(i.serializer,o)}}if(r instanceof hp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ii)return{bytesValue:ew(i.serializer,r._byteString)};if(r instanceof Pt){const o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Jh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof pp)return function(s,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return $h(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Wu(r)}`)}(n,e)}function jw(n,e){const t={};return CI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):di(n,(r,i)=>{const o=pa(i,e.Mu(r));o!=null&&(t[r]=o)}),{mapValue:{fields:t}}}function Zw(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof De||n instanceof hp||n instanceof ii||n instanceof Pt||n instanceof Ju||n instanceof pp)}function yp(n,e,t){if(!Zw(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=Wu(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Lf(n,e,t){if((e=dt(e))instanceof ha)return e._internalPath;if(typeof e=="string")return _p(n,e);throw pu("Field path arguments must be of type string or ",n,!1,void 0,t)}const IL=new RegExp("[~\\*/\\[\\]]");function _p(n,e,t){if(e.search(IL)>=0)throw pu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ha(...e.split("."))._internalPath}catch{throw pu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function pu(n,e,t,r,i){const o=r&&!r.isEmpty(),s=i!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(o||s)&&(l+=" (found",o&&(l+=` in field ${r}`),s&&(l+=` in document ${i}`),l+=")"),new G(U.INVALID_ARGUMENT,a+n+l)}function e0(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,t,r,i,o){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new wL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(vp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class wL extends mu{data(){return super.data()}}function vp(n,e){return typeof e=="string"?_p(n,e):e instanceof ha?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new G(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Tp{}class t0 extends Tp{}function n0(n,e,...t){let r=[];e instanceof Tp&&r.push(e),r=r.concat(t),function(o){const s=o.filter(l=>l instanceof Ip).length,a=o.filter(l=>l instanceof Ep).length;if(s>1||s>0&&a>0)throw new G(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class Ep extends t0{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Ep(e,t,r)}_apply(e){const t=this._parse(e);return i0(e._query,t),new hi(e.firestore,e.converter,wf(e._query,t))}_parse(e){const t=Xu(e.firestore);return function(o,s,a,l,c,h,m){let g;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new G(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){av(m,h);const _=[];for(const I of m)_.push(sv(l,o,I));g={arrayValue:{values:_}}}else g=sv(l,o,m)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||av(m,h),g=EL(a,s,m,h==="in"||h==="not-in");return ie.create(c,h,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}class Ip extends Tp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ip(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:fe.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,o){let s=i;const a=o.getFlattenedFilters();for(const l of a)i0(s,l),s=wf(s,l)}(e._query,t),new hi(e.firestore,e.converter,wf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class wp extends t0{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wp(e,t)}_apply(e){const t=function(i,o,s){if(i.startAt!==null)throw new G(U.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new G(U.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ws(o,s)}(e._query,this._field,this._direction);return new hi(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new _o(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function r0(n,e="asc"){const t=e,r=vp("orderBy",n);return wp._create(r,t)}function sv(n,e,t){if(typeof(t=dt(t))=="string"){if(t==="")throw new G(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!FI(e)&&t.indexOf("/")!==-1)throw new G(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ce.fromString(t));if(!K.isDocumentKey(r))throw new G(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ks(n,new K(r))}if(t instanceof Pt)return Ks(n,t._key);throw new G(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wu(t)}.`)}function av(n,e){if(!Array.isArray(n)||n.length===0)throw new G(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function i0(n,e){const t=function(i,o){for(const s of i)for(const a of s.getFlattenedFilters())if(o.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new G(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new G(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class o0{convertValue(e,t="none"){switch(Zr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ee(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Q()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return di(e,(i,o)=>{r[i]=this.convertValue(o,t)}),r}convertVectorValue(e){var t,r,i;const o=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Ee(s.doubleValue));return new pp(o)}convertGeoPoint(e){return new hp(Ee(e.latitude),Ee(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=qh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Gs(e));default:return null}}convertTimestamp(e){const t=Vn(e);return new De(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ce.fromString(e);Y(cw(r));const i=new jr(r.get(1),r.get(3)),o=new K(r.popFirst(5));return i.isEqual(t)||gt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s0(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class SL extends o0{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class a0 extends mu{constructor(e,t,r,i,o,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Pl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(vp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Pl extends a0{data(e={}){return super.data(e)}}class AL{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new is(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Pl(this._firestore,this._userDataWriter,r.key,r,new is(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new G(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(a=>{const l=new Pl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new is(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>o||a.type!==3).map(a=>{const l=new Pl(i._firestore,i._userDataWriter,a.doc.key,a.doc,new is(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,h=-1;return a.type!==0&&(c=s.indexOf(a.doc.key),s=s.delete(a.doc.key)),a.type!==1&&(s=s.add(a.doc),h=s.indexOf(a.doc.key)),{type:RL(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function RL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}class l0 extends o0{constructor(e){super(),this.firestore=e}convertBytes(e){return new ii(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Pt(this.firestore,null,t)}}function u0(n){n=Mn(n,hi);const e=Mn(n.firestore,pi),t=fp(e),r=new l0(e);return CL(n._query),fL(t,n._query).then(i=>new AL(e,r,n,i))}function xL(n,e,t,...r){n=Mn(n,Pt);const i=Mn(n.firestore,pi),o=Xu(i);let s;return s=typeof(e=dt(e))=="string"||e instanceof ha?Xw(o,"updateDoc",n._key,e,t,r):Jw(o,"updateDoc",n._key,e),Cp(i,[s.toMutation(n._key,Be.exists(!0))])}function PL(n){return Cp(Mn(n.firestore,pi),[new la(n._key,Be.none())])}function DL(n,e){const t=Mn(n.firestore,pi),r=js(n),i=s0(n.converter,e);return Cp(t,[Yw(Xu(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Be.exists(!1))]).then(()=>r)}function Cp(n,e){return function(r,i){const o=new fn;return r.asyncQueue.enqueueAndForget(async()=>J2(await uL(r),i,o)),o.promise}(fp(n),e)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NL={maxAttempts:5};function Qo(n,e){if((n=dt(n)).firestore!==e)throw new G(U.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kL extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=Xu(t)}get(t){const r=Qo(t,this._firestore),i=new SL(this._firestore);return this._transaction.lookup([r._key]).then(o=>{if(!o||o.length!==1)return Q();const s=o[0];if(s.isFoundDocument())return new mu(this._firestore,i,s.key,s,r.converter);if(s.isNoDocument())return new mu(this._firestore,i,r._key,null,r.converter);throw Q()})}set(t,r,i){const o=Qo(t,this._firestore),s=s0(o.converter,r,i),a=Yw(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,i);return this._transaction.set(o._key,a),this}update(t,r,i,...o){const s=Qo(t,this._firestore);let a;return a=typeof(r=dt(r))=="string"||r instanceof ha?Xw(this._dataReader,"Transaction.update",s._key,r,i,o):Jw(this._dataReader,"Transaction.update",s._key,r),this._transaction.update(s._key,a),this}delete(t){const r=Qo(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Qo(e,this._firestore),r=new l0(this._firestore);return super.get(e).then(i=>new a0(this._firestore,r,t._key,i._document,new is(!1,!1),t.converter))}}function VL(n,e,t){n=Mn(n,pi);const r=Object.assign(Object.assign({},NL),t);return function(o){if(o.maxAttempts<1)throw new G(U.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(o,s,a){const l=new fn;return o.asyncQueue.enqueueAndForget(async()=>{const c=await cL(o);new sL(o.asyncQueue,c,a,s,l).au()}),l.promise}(fp(n),i=>e(new kL(n,i)),r)}function c0(){return new gp("serverTimestamp")}(function(e,t=!0){(function(i){yo=i})(nI),Us(new no("firestore",(r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),a=new pi(new sV(r.getProvider("auth-internal")),new cV(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new G(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jr(c.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:t},o),a._setSettings(o),a},"PUBLIC").setMultipleInstances(!0)),lr(e_,"4.7.3",e),lr(e_,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0="firebasestorage.googleapis.com",f0="storageBucket",ML=2*60*1e3,LL=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le extends ui{constructor(e,t,r=0){super(id(e),`Firebase Storage: ${t} (${id(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Le.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return id(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Me;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Me||(Me={}));function id(n){return"storage/"+n}function Sp(){const n="An unknown error occurred, please check the error payload for server response.";return new Le(Me.UNKNOWN,n)}function FL(n){return new Le(Me.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function bL(n){return new Le(Me.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function UL(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Le(Me.UNAUTHENTICATED,n)}function OL(){return new Le(Me.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function BL(n){return new Le(Me.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function qL(){return new Le(Me.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function zL(){return new Le(Me.CANCELED,"User canceled the upload/download.")}function GL(n){return new Le(Me.INVALID_URL,"Invalid URL '"+n+"'.")}function $L(n){return new Le(Me.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function KL(){return new Le(Me.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+f0+"' property when initializing the app?")}function HL(){return new Le(Me.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function WL(){return new Le(Me.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function QL(n){return new Le(Me.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Ff(n){return new Le(Me.INVALID_ARGUMENT,n)}function h0(){return new Le(Me.APP_DELETED,"The Firebase app was deleted.")}function YL(n){return new Le(Me.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function vs(n,e){return new Le(Me.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function Yo(n){throw new Le(Me.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=Mt.makeFromUrl(e,t)}catch{return new Mt(e,"")}if(r.path==="")return r;throw $L(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(N){N.path.charAt(N.path.length-1)==="/"&&(N.path_=N.path_.slice(0,-1))}const s="(/(.*))?$",a=new RegExp("^gs://"+i+s,"i"),l={bucket:1,path:3};function c(N){N.path_=decodeURIComponent(N.path)}const h="v[A-Za-z0-9_]+",m=t.replace(/[.]/g,"\\."),g="(/([^?#]*).*)?$",_=new RegExp(`^https?://${m}/${h}/b/${i}/o${g}`,"i"),I={bucket:1,path:3},x=t===d0?"(?:storage.googleapis.com|storage.cloud.google.com)":t,k="([^?#]*)",w=new RegExp(`^https?://${x}/${i}/${k}`,"i"),S=[{regex:a,indices:l,postModify:o},{regex:_,indices:I,postModify:c},{regex:w,indices:{bucket:1,path:2},postModify:c}];for(let N=0;N<S.length;N++){const O=S[N],B=O.regex.exec(e);if(B){const C=B[O.indices.bucket];let v=B[O.indices.path];v||(v=""),r=new Mt(C,v),O.postModify(r);break}}if(r==null)throw GL(e);return r}}class JL{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XL(n,e,t){let r=1,i=null,o=null,s=!1,a=0;function l(){return a===2}let c=!1;function h(...k){c||(c=!0,e.apply(null,k))}function m(k){i=setTimeout(()=>{i=null,n(_,l())},k)}function g(){o&&clearTimeout(o)}function _(k,...w){if(c){g();return}if(k){g(),h.call(null,k,...w);return}if(l()||s){g(),h.call(null,k,...w);return}r<64&&(r*=2);let S;a===1?(a=2,S=0):S=(r+Math.random())*1e3,m(S)}let I=!1;function x(k){I||(I=!0,g(),!c&&(i!==null?(k||(a=2),clearTimeout(i),m(0)):k||(a=1)))}return m(0),o=setTimeout(()=>{s=!0,x(!0)},t),x}function jL(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZL(n){return n!==void 0}function eF(n){return typeof n=="object"&&!Array.isArray(n)}function Ap(n){return typeof n=="string"||n instanceof String}function lv(n){return Rp()&&n instanceof Blob}function Rp(){return typeof Blob<"u"}function uv(n,e,t,r){if(r<e)throw Ff(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Ff(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function p0(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const i=e(r)+"="+e(n[r]);t=t+i+"&"}return t=t.slice(0,-1),t}var $r;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})($r||($r={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(n,e){const t=n>=500&&n<600,i=[408,429].indexOf(n)!==-1,o=e.indexOf(n)!==-1;return t||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nF{constructor(e,t,r,i,o,s,a,l,c,h,m,g=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=m,this.retry=g,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,I)=>{this.resolve_=_,this.reject_=I,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new ol(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const s=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;const a=o.getErrorCode()===$r.NO_ERROR,l=o.getStatus();if(!a||tF(l,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===$r.ABORT;r(!1,new ol(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new ol(c,o))})},t=(r,i)=>{const o=this.resolve_,s=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());ZL(l)?o(l):o()}catch(l){s(l)}else if(a!==null){const l=Sp();l.serverResponse=a.getErrorText(),this.errorCallback_?s(this.errorCallback_(a,l)):s(l)}else if(i.canceled){const l=this.appDelete_?h0():zL();s(l)}else{const l=qL();s(l)}};this.canceled_?t(!1,new ol(!1,null,!0)):this.backoffId_=XL(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&jL(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ol{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function rF(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function iF(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oF(n,e){e&&(n["X-Firebase-GMPID"]=e)}function sF(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function aF(n,e,t,r,i,o,s=!0){const a=p0(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return oF(c,e),rF(c,t),iF(c,o),sF(c,r),new nF(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lF(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function uF(...n){const e=lF();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(Rp())return new Blob(n);throw new Le(Me.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function cF(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dF(n){if(typeof atob>"u")throw QL("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const un={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class od{constructor(e,t){this.data=e,this.contentType=t||null}}function fF(n,e){switch(n){case un.RAW:return new od(m0(e));case un.BASE64:case un.BASE64URL:return new od(g0(n,e));case un.DATA_URL:return new od(pF(e),mF(e))}throw Sp()}function m0(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const o=r,s=n.charCodeAt(++t);r=65536|(o&1023)<<10|s&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function hF(n){let e;try{e=decodeURIComponent(n)}catch{throw vs(un.DATA_URL,"Malformed data URL.")}return m0(e)}function g0(n,e){switch(n){case un.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw vs(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case un.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw vs(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=dF(e)}catch(i){throw i.message.includes("polyfill")?i:vs(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class y0{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw vs(un.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=gF(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function pF(n){const e=new y0(n);return e.base64?g0(un.BASE64,e.rest):hF(e.rest)}function mF(n){return new y0(n).contentType}function gF(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qn{constructor(e,t){let r=0,i="";lv(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(lv(this.data_)){const r=this.data_,i=cF(r,e,t);return i===null?null:new Qn(i)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Qn(r,!0)}}static getBlob(...e){if(Rp()){const t=e.map(r=>r instanceof Qn?r.data_:r);return new Qn(uF.apply(null,t))}else{const t=e.map(s=>Ap(s)?fF(un.RAW,s).data:s.data_);let r=0;t.forEach(s=>{r+=s.byteLength});const i=new Uint8Array(r);let o=0;return t.forEach(s=>{for(let a=0;a<s.length;a++)i[o++]=s[a]}),new Qn(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){let e;try{e=JSON.parse(n)}catch{return null}return eF(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yF(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function _F(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function v0(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vF(n,e){return e}class pt{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||vF}}let sl=null;function TF(n){return!Ap(n)||n.length<2?n:v0(n)}function T0(){if(sl)return sl;const n=[];n.push(new pt("bucket")),n.push(new pt("generation")),n.push(new pt("metageneration")),n.push(new pt("name","fullPath",!0));function e(o,s){return TF(s)}const t=new pt("name");t.xform=e,n.push(t);function r(o,s){return s!==void 0?Number(s):s}const i=new pt("size");return i.xform=r,n.push(i),n.push(new pt("timeCreated")),n.push(new pt("updated")),n.push(new pt("md5Hash",null,!0)),n.push(new pt("cacheControl",null,!0)),n.push(new pt("contentDisposition",null,!0)),n.push(new pt("contentEncoding",null,!0)),n.push(new pt("contentLanguage",null,!0)),n.push(new pt("contentType",null,!0)),n.push(new pt("metadata","customMetadata",!0)),sl=n,sl}function EF(n,e){function t(){const r=n.bucket,i=n.fullPath,o=new Mt(r,i);return e._makeStorageReference(o)}Object.defineProperty(n,"ref",{get:t})}function IF(n,e,t){const r={};r.type="file";const i=t.length;for(let o=0;o<i;o++){const s=t[o];r[s.local]=s.xform(r,e[s.server])}return EF(r,n),r}function E0(n,e,t){const r=_0(e);return r===null?null:IF(n,r,t)}function wF(n,e,t,r){const i=_0(e);if(i===null||!Ap(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const s=encodeURIComponent;return o.split(",").map(c=>{const h=n.bucket,m=n.fullPath,g="/b/"+s(h)+"/o/"+s(m),_=Zu(g,t,r),I=p0({alt:"media",token:c});return _+I})[0]}function CF(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(t[o.server]=n[o.local])}return JSON.stringify(t)}class xp{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I0(n){if(!n)throw Sp()}function SF(n,e){function t(r,i){const o=E0(n,i,e);return I0(o!==null),o}return t}function AF(n,e){function t(r,i){const o=E0(n,i,e);return I0(o!==null),wF(o,i,n.host,n._protocol)}return t}function w0(n){function e(t,r){let i;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?i=OL():i=UL():t.getStatus()===402?i=bL(n.bucket):t.getStatus()===403?i=BL(n.path):i=r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}return e}function C0(n){const e=w0(n);function t(r,i){let o=e(r,i);return r.getStatus()===404&&(o=FL(n.path)),o.serverResponse=i.serverResponse,o}return t}function RF(n,e,t){const r=e.fullServerUrl(),i=Zu(r,n.host,n._protocol),o="GET",s=n.maxOperationRetryTime,a=new xp(i,o,AF(n,t),s);return a.errorHandler=C0(e),a}function xF(n,e){const t=e.fullServerUrl(),r=Zu(t,n.host,n._protocol),i="DELETE",o=n.maxOperationRetryTime;function s(l,c){}const a=new xp(r,i,s,o);return a.successCodes=[200,204],a.errorHandler=C0(e),a}function PF(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function DF(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=PF(null,e)),r}function NF(n,e,t,r,i){const o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};function a(){let S="";for(let N=0;N<2;N++)S=S+Math.random().toString().slice(2);return S}const l=a();s["Content-Type"]="multipart/related; boundary="+l;const c=DF(e,r,i),h=CF(c,t),m="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,g=`\r
--`+l+"--",_=Qn.getBlob(m,r,g);if(_===null)throw HL();const I={name:c.fullPath},x=Zu(o,n.host,n._protocol),k="POST",w=n.maxUploadRetryTime,E=new xp(x,k,SF(n,t),w);return E.urlParams=I,E.headers=s,E.body=_.uploadData(),E.errorHandler=w0(e),E}class kF{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=$r.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=$r.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=$r.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw Yo("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Yo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Yo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Yo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Yo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VF extends kF{initXhr(){this.xhr_.responseType="text"}}function Pp(){return new VF}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,t){this._service=e,t instanceof Mt?this._location=t:this._location=Mt.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new oi(e,t)}get root(){const e=new Mt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return v0(this._location.path)}get storage(){return this._service}get parent(){const e=yF(this._location.path);if(e===null)return null;const t=new Mt(this._location.bucket,e);return new oi(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw YL(e)}}function MF(n,e,t){n._throwIfRoot("uploadBytes");const r=NF(n.storage,n._location,T0(),new Qn(e,!0),t);return n.storage.makeRequestWithTokens(r,Pp).then(i=>({metadata:i,ref:n}))}function LF(n){n._throwIfRoot("getDownloadURL");const e=RF(n.storage,n._location,T0());return n.storage.makeRequestWithTokens(e,Pp).then(t=>{if(t===null)throw WL();return t})}function FF(n){n._throwIfRoot("deleteObject");const e=xF(n.storage,n._location);return n.storage.makeRequestWithTokens(e,Pp)}function bF(n,e){const t=_F(n._location.path,e),r=new Mt(n._location.bucket,t);return new oi(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UF(n){return/^[A-Za-z]+:\/\//.test(n)}function OF(n,e){return new oi(n,e)}function S0(n,e){if(n instanceof Dp){const t=n;if(t._bucket==null)throw KL();const r=new oi(t,t._bucket);return e!=null?S0(r,e):r}else return e!==void 0?bF(n,e):n}function BF(n,e){if(e&&UF(e)){if(n instanceof Dp)return OF(n,e);throw Ff("To use ref(service, url), the first argument must be a Storage instance.")}else return S0(n,e)}function cv(n,e){const t=e==null?void 0:e[f0];return t==null?null:Mt.makeFromBucketSpec(t,n)}function qF(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken=typeof i=="string"?i:QE(i,n.app.options.projectId))}class Dp{constructor(e,t,r,i,o){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=d0,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=ML,this._maxUploadRetryTime=LL,this._requests=new Set,i!=null?this._bucket=Mt.makeFromBucketSpec(i,this._host):this._bucket=cv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Mt.makeFromBucketSpec(this._url,e):this._bucket=cv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new oi(this,e)}_makeRequest(e,t,r,i,o=!0){if(this._deleted)return new JL(h0());{const s=aF(e,this._appId,r,i,t,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,i).getPromise()}}const dv="@firebase/storage",fv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A0="storage";function zF(n,e,t){return n=dt(n),MF(n,e,t)}function GF(n){return n=dt(n),LF(n)}function $F(n){return n=dt(n),FF(n)}function R0(n,e){return n=dt(n),BF(n,e)}function KF(n=iI(),e){n=dt(n);const r=tI(n,A0).getImmediate({identifier:e}),i=HE("storage");return i&&HF(r,...i),r}function HF(n,e,t,r={}){qF(n,e,t,r)}function WF(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new Dp(t,r,i,e,nI)}function QF(){Us(new no(A0,WF,"PUBLIC").setMultipleInstances(!0)),lr(dv,fv,""),lr(dv,fv,"esm2017")}QF();var YF="firebase",JF="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lr(YF,JF,"app");const XF={apiKey:"AIzaSyCVT2YuAJQoHE2m5nznwhhK0_jgMBQJzk0",authDomain:"math-fest-display.firebaseapp.com",databaseURL:"https://math-fest-display-default-rtdb.firebaseio.com",projectId:"math-fest-display",storageBucket:"math-fest-display.firebasestorage.app",messagingSenderId:"252365377355",appId:"1:252365377355:web:83772c179137b3de94e2ce"},x0=rI(XF),gr=mL(x0),P0=KF(x0);gL(gr).catch(n=>{n.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open."):n.code=="unimplemented"&&console.warn("Firestore persistence is not available in this browser.")});var hv={};const si="photos",D0="comments",pv=["PhotoFan","MemoryMaker","SunnyDays","Shutterbug","Wanderlust","Dreamer","Explorer_22","GoodVibesOnly"],jF=n=>new Promise((e,t)=>{fetch(n).then(r=>r.blob()).then(r=>{const i=new FileReader;i.readAsDataURL(r),i.onload=()=>e(i.result.split(",")[1]),i.onerror=o=>t(o)}).catch(r=>t(r))}),ZF=async(n,e,t)=>{if(!n)throw new Error("No file provided for upload.");const r=`${Date.now()}.${n.name.split(".").pop()}`,i=R0(P0,`${si}/${r}`);await zF(i,n);const o=await GF(i),s=await DL(Yu(gr,si),{imageUrl:o,description:e,tags:t,isFavorite:!1,commentCount:0,createdAt:c0()});if(hv.GEMINI_API_KEY)try{const l=new Vh(hv.GEMINI_API_KEY).getGenerativeModel({model:"gemini-pro-vision"}),h={inlineData:{data:await jF(o),mimeType:n.type}},I=(await(await l.generateContent(["You are a friendly and enthusiastic social media user. Look at this photo and write a short, positive, and complimentary comment, like you would on Instagram. Keep it under 15 words and include an emoji. For example: 'Wow, what a beautiful shot! ' or 'This looks like so much fun! '.",h])).response).text(),x=pv[Math.floor(Math.random()*pv.length)];I&&await N0(s.id,I,x,!1)}catch(a){console.error("Failed to generate automatic AI comment:",a)}},eb=async n=>{const e=Yu(gr,si,n,D0),t=n0(e,r0("createdAt","asc"));return(await u0(t)).docs.map(o=>o.data()).sort((o,s)=>o.isUserComment&&!s.isUserComment?-1:!o.isUserComment&&s.isUserComment?1:0)},N0=async(n,e,t,r=!0)=>{const i=js(gr,si,n),o=Yu(i,D0);await VL(gr,async s=>{const a=await s.get(i);if(!a.exists())throw"Photo does not exist!";const l=(a.data().commentCount||0)+1;s.update(i,{commentCount:l}),s.set(js(o),{text:e,username:t,isUserComment:r,createdAt:c0()})})},tb=async()=>{const n=n0(Yu(gr,si),r0("createdAt","desc"));return(await u0(n)).docs.map(t=>({id:t.id,...t.data(),isFavorite:t.data().isFavorite||!1}))},nb=async(n,e)=>{await xL(js(gr,si,n),{isFavorite:e})},rb=async n=>{if(!n||!n.id)throw new Error("Invalid photo data.");await PL(js(gr,si,n.id)),await $F(R0(P0,n.imageUrl))};var ib={};const ob=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e(r.result.split(",")[1]),r.onerror=i=>t(i)}),sb=({onClose:n,onUploadSuccess:e})=>{const[t,r]=oe.useState(null),[i,o]=oe.useState(null),[s,a]=oe.useState(""),[l,c]=oe.useState([]),[h,m]=oe.useState(""),[g,_]=oe.useState(!1),[I,x]=oe.useState(!1),[k,w]=oe.useState(null),E=v=>{var R;const A=(R=v.target.files)==null?void 0:R[0];if(A){if(A.size>10*1024*1024){w("File is too large. Maximum size is 10MB.");return}r(A),c([]),w(null);const D=new FileReader;D.onloadend=()=>{o(D.result)},D.readAsDataURL(A)}},S=oe.useCallback(async()=>{if(!t){w("Please select a photo first to generate tags.");return}x(!0),w(null);try{const v=new Vh({apiKey:ib.API_KEY}),R={inlineData:{data:await ob(t),mimeType:t.type}},D={text:"Analyze this image and generate 3 to 5 relevant, single-word, lowercase tags that describe the main subjects, setting, or mood. Separate the tags with commas. For example: 'nature, sunset, beach, ocean, serene'."},P=(await v.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[R,D]}})).text.split(",").map(de=>de.trim().toLowerCase().replace(/[^a-z0-9\s-]/gi,"")).filter(de=>de&&de.length>1&&de.length<20);c(de=>[...new Set([...de,...P])])}catch(v){console.error("Error generating tags with Gemini:",v),w("Failed to generate tags. Please check your API key or add tags manually.")}finally{x(!1)}},[t]),N=v=>{m(v.target.value)},O=v=>{if((v.key==="Enter"||v.key===",")&&h.trim()!==""){v.preventDefault();const A=h.split(",").map(R=>R.trim().toLowerCase()).filter(R=>R&&R.length>1);c([...new Set([...l,...A])]),m("")}},B=v=>{c(l.filter(A=>A!==v))},C=oe.useCallback(async()=>{if(!t){w("Please select a photo to upload.");return}if(!s.trim()){w("Please add a description for your memory.");return}_(!0),w(null);try{await ZF(t,s,l),e(),n()}catch(v){console.error("Upload error:",v),w("Upload failed. Please check the console and try again.")}finally{_(!1)}},[t,s,l,n,e]);return b.jsx("div",{className:"fixed inset-0 bg-primary-bg/80 backdrop-blur-lg flex justify-center items-center z-50 p-4 animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:n,children:b.jsxs("div",{className:"bg-secondary-bg rounded-xl shadow-gentle-lg w-full max-w-lg text-primary-text p-6 sm:p-8 border border-accent-soft/50 max-h-[90vh] overflow-y-auto",onClick:v=>v.stopPropagation(),children:[b.jsx("h2",{className:"text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400 mb-6",children:"Add a New Memory"}),b.jsxs("div",{className:"space-y-6",children:[b.jsxs("div",{children:[b.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-secondary-text mb-2",children:"Photo"}),b.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-accent-soft/60 border-dashed rounded-md bg-primary-bg",children:b.jsxs("div",{className:"space-y-2 text-center",children:[i?b.jsx("img",{src:i,alt:"Preview",className:"mx-auto h-40 w-auto rounded-md object-contain"}):b.jsx("svg",{className:"mx-auto h-12 w-12 text-accent-soft",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:b.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 4v.01M28 8L20 16m0 0h8m-8 0V8m12 12v12a4 4 0 01-4 4H12a4 4 0 01-4-4V12a4 4 0 014-4h8",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})}),b.jsxs("div",{className:"flex text-sm text-secondary-text justify-center",children:[b.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-accent hover:text-accent-hover focus-within:outline-none",children:[b.jsx("span",{children:t?"Change file":"Upload a file"}),b.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:E})]}),b.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),b.jsx("p",{className:"text-xs text-secondary-text/70",children:"PNG, JPG, GIF up to 10MB"})]})})]}),b.jsxs("div",{children:[b.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-text",children:"Description"}),b.jsx("textarea",{id:"description",rows:3,value:s,onChange:v=>a(v.target.value),className:"mt-1 block w-full bg-primary-bg border border-accent-soft/60 rounded-md shadow-sm focus:ring-accent focus:border-accent sm:text-sm p-2 text-primary-text placeholder-secondary-text/70 transition-colors",placeholder:"What's this memory about?"})]}),b.jsxs("div",{children:[b.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-secondary-text mb-1",children:"Tags"}),b.jsxs("div",{className:"flex gap-2 items-start",children:[b.jsxs("div",{className:"flex-grow",children:[b.jsx("input",{id:"tags",type:"text",value:h,onChange:N,onKeyDown:O,disabled:I,className:"block w-full bg-primary-bg border border-accent-soft/60 rounded-md shadow-sm focus:ring-accent focus:border-accent sm:text-sm p-2 text-primary-text placeholder-secondary-text/70 transition-colors",placeholder:"Add tags (e.g., vacation, family)"}),b.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:l.map(v=>b.jsxs("span",{className:"flex items-center bg-accent/20 text-accent text-xs font-medium px-2.5 py-1 rounded-full",children:[v,b.jsx("button",{onClick:()=>B(v),className:"ml-1.5 text-accent/70 hover:text-accent",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},v))})]}),b.jsxs("button",{type:"button",onClick:S,disabled:!t||I||g,className:"px-3 py-2 text-sm font-medium text-white bg-accent/80 rounded-md hover:bg-accent-hover disabled:bg-secondary-bg disabled:text-secondary-text disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center h-9 shadow-md disabled:shadow-none shrink-0",children:[I?b.jsx(bs,{}):b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M9.628 2.034a1 1 0 011.228.665l.876 3.722 3.723.876a1 1 0 01.665 1.228l-2.43 5.67a1 1 0 01-1.22.665l-3.723-.876-3.722-.876a1 1 0 01-.665-1.228l2.43-5.67zM10 18a8 8 0 100-16 8 8 0 000 16z",clipRule:"evenodd"})}),I?"":"AI Tags"]})]})]}),k&&b.jsx("p",{className:"text-sm text-red-400 bg-red-900/40 p-2 rounded-md",children:k})]}),b.jsxs("div",{className:"mt-8 flex justify-end items-center space-x-4",children:[b.jsx("button",{type:"button",onClick:n,disabled:g,className:"px-4 py-2 text-sm font-medium text-secondary-text rounded-md hover:bg-accent-soft/20 disabled:opacity-50 transition-colors",children:"Cancel"}),b.jsx("button",{type:"button",onClick:C,disabled:g||!t||I,className:"px-6 py-2 text-sm font-medium text-white bg-accent rounded-md hover:bg-accent-hover disabled:bg-secondary-bg disabled:text-secondary-text disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center min-w-[100px] h-9 shadow-lg shadow-accent/30",children:g?b.jsx(bs,{}):"Upload"})]})]})})};var ab={};const mv=ab.GEMINI_API_KEY,lb=({photo:n})=>{const[e,t]=oe.useState([]),[r,i]=oe.useState(""),[o,s]=oe.useState(!0),[a,l]=oe.useState(null),[c,h]=oe.useState(!1),[m,g]=oe.useState(!1);oe.useEffect(()=>{n.id&&eb(n.id).then(t).catch(()=>l("Could not load comments.")).finally(()=>s(!1))},[n.id]);const _=async x=>{if(x.preventDefault(),!(!r.trim()||c)){h(!0);try{await N0(n.id,r,"You",!0),t(k=>[{text:r,username:"You",createdAt:new Date,isUserComment:!0},...k]),i("")}catch{l("Failed to post comment.")}finally{h(!1)}}},I=oe.useCallback(async()=>{if(!mv){l("Gemini API key is not configured.");return}g(!0),l(null);try{const k=new Vh(mv).getGenerativeModel({model:"gemini-pro-vision"}),w=n.imageUrl,S=await(await fetch(w)).blob(),O={inlineData:{data:await new Promise((A,R)=>{const D=new FileReader;D.readAsDataURL(S),D.onload=()=>A(D.result.split(",")[1]),D.onerror=V=>R(V)}),mimeType:S.type}},v=await(await k.generateContent(["You are a friendly social media user. Write a short, positive, complimentary comment for this photo, under 15 words, with an emoji. Example: 'So beautiful! '",O])).response;i(v.text())}catch(x){console.error("Error generating comment:",x),l("AI failed to generate a comment.")}finally{g(!1)}},[n.imageUrl]);return b.jsxs("div",{className:"w-full max-w-lg mx-auto mt-4 pt-4 border-t border-accent-soft/50",children:[b.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Comments"}),b.jsxs("div",{className:"space-y-4 max-h-48 overflow-y-auto pr-2",children:[o&&b.jsx(bs,{}),a&&b.jsx("p",{className:"text-sm text-red-500",children:a}),!o&&e.length===0&&b.jsx("p",{className:"text-sm text-secondary-text",children:"No comments yet."}),e.map((x,k)=>b.jsx("div",{className:`p-3 rounded-lg ${x.isUserComment?"bg-accent/10":"bg-secondary-bg/50"}`,children:b.jsxs("div",{className:"flex items-start gap-3",children:[b.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0 ${x.isUserComment?"bg-accent text-white":"bg-accent-soft text-accent"}`,children:x.username.charAt(0)}),b.jsxs("div",{children:[b.jsx("p",{className:"font-semibold text-primary-text text-sm",children:x.username}),b.jsx("p",{className:"text-secondary-text text-sm",children:x.text})]})]})},k))]}),b.jsxs("form",{onSubmit:_,className:"mt-4 flex gap-2 items-start",children:[b.jsx("input",{type:"text",value:r,onChange:x=>i(x.target.value),placeholder:"Add your comment...",className:"flex-grow bg-primary-bg border border-accent-soft/60 rounded-full shadow-sm focus:ring-accent focus:border-accent text-sm p-2 px-4 text-primary-text placeholder-secondary-text/70 transition-colors",disabled:c||m}),b.jsx("button",{type:"button",onClick:I,disabled:m||c,className:"w-10 h-10 rounded-full flex items-center justify-center transition-colors duration-300 group bg-accent/20 hover:bg-accent/30 shrink-0","aria-label":"Generate AI comment",children:m?b.jsx(bs,{}):b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-accent",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{fillRule:"evenodd",d:"M9.628 2.034a1 1 0 011.228.665l.876 3.722 3.723.876a1 1 0 01.665 1.228l-2.43 5.67a1 1 0 01-1.22.665l-3.723-.876-3.722-.876a1 1 0 01-.665-1.228l2.43-5.67zM10 18a8 8 0 100-16 8 8 0 000 16z",clipRule:"evenodd"})})}),b.jsx("button",{type:"submit",disabled:!r.trim()||c||m,className:"w-10 h-10 bg-accent hover:bg-accent-hover text-white font-bold rounded-full flex items-center justify-center transition-all duration-300 shadow-lg shadow-accent/30 disabled:bg-secondary-bg disabled:text-secondary-text shrink-0",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:b.jsx("path",{d:"M10.894 2.553a1 1 0 00-1.788 0l-7 14a1 1 0 001.169 1.409l5-1.429A1 1 0 009 15.571V11a1 1 0 112 0v4.571a1 1 0 00.725.962l5 1.428a1 1 0 001.17-1.408l-7-14z"})})})]})]})},ub=({photo:n,onClose:e})=>{const t=r=>r!=null&&r.toDate?new Intl.DateTimeFormat("en-US",{dateStyle:"full",timeStyle:"short"}).format(r.toDate()):"Just now";return b.jsx("div",{className:"fixed inset-0 bg-primary-bg/80 backdrop-blur-lg flex justify-center items-center z-50 p-4 animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:e,children:b.jsxs("div",{className:"relative bg-white rounded-xl shadow-gentle-lg w-full max-w-4xl max-h-[90vh] flex flex-col md:flex-row overflow-hidden",onClick:r=>r.stopPropagation(),children:[b.jsx("button",{onClick:e,"aria-label":"Close lightbox",className:"absolute top-3 right-3 p-2 bg-white/50 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-all duration-200 z-20",children:b.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:b.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),b.jsx("div",{className:"w-full md:w-2/3 bg-primary-bg flex items-center justify-center p-2",children:b.jsx("img",{src:n.imageUrl,alt:n.description||"Photo diary entry",className:"max-w-full max-h-[80vh] object-contain rounded-lg"})}),b.jsxs("div",{className:"w-full md:w-1/3 p-6 flex flex-col justify-between overflow-y-auto",children:[b.jsxs("div",{children:[b.jsx("p",{className:"text-lg font-semibold text-primary-text",children:n.description}),b.jsx("p",{className:"text-sm text-secondary-text mt-1",children:t(n.createdAt)}),n.tags&&n.tags.length>0&&b.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:n.tags.map(r=>b.jsx("span",{className:"text-xs bg-accent/20 text-accent font-medium px-2.5 py-1 rounded-full",children:r},r))})]}),b.jsx(lb,{photo:n})]})]})})},cb=()=>{const[n,e]=oe.useState([]),[t,r]=oe.useState(!0),[i,o]=oe.useState(null),s=oe.useCallback(async()=>{try{r(!0),o(null);const h=await tb();e(h)}catch(h){console.error("Detailed error fetching photos:",h),o("Failed to load photos. This could be due to network issues or incorrect Firebase permissions. Check the console for more details.")}finally{r(!1)}},[]);oe.useEffect(()=>{s()},[]);const a=oe.useCallback((h,m)=>{e(g=>g.map(_=>_.id===h?{..._,...m}:_))},[]),l=oe.useCallback(async h=>{const m=!h.isFavorite;a(h.id,{isFavorite:m});try{await nb(h.id,m)}catch(g){console.error("Error updating favorite status:",g),a(h.id,{isFavorite:h.isFavorite}),alert("Failed to update favorite status. Please try again.")}},[a]),c=oe.useCallback(async h=>{try{await rb(h),e(m=>m.filter(g=>g.id!==h.id))}catch(m){console.error("Error deleting photo:",m),alert("Failed to delete photo. Please check your Firebase rules and try again.")}},[]);return{photos:n,loading:t,error:i,refetchPhotos:s,removePhoto:c,toggleFavorite:l}},db=n=>{if(!n||!n.toDate)return"";const e=n.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e)},fb=()=>{const[n,e]=oe.useState(!1),{photos:t,loading:r,error:i,refetchPhotos:o,removePhoto:s,toggleFavorite:a}=cb(),[l,c]=oe.useState(""),[h,m]=oe.useState(null),[g,_]=oe.useState(!1),I=oe.useCallback(()=>{o()},[o]),x=oe.useMemo(()=>{let k=t;if(g&&(k=k.filter(E=>E.isFavorite)),!l.trim())return k;const w=l.toLowerCase();return k.filter(E=>{var B;const S=E.description.toLowerCase().includes(w),N=db(E.createdAt).toLowerCase().includes(w),O=(B=E.tags)==null?void 0:B.some(C=>C.toLowerCase().includes(w));return S||N||O})},[t,l,g]);return b.jsxs("div",{className:"min-h-screen",children:[b.jsx(UA,{onAddPhotoClick:()=>e(!0),searchTerm:l,onSearchChange:c,isGridEmpty:t.length===0&&!r,onToggleFavorites:()=>_(!g),showFavorites:g}),b.jsx("main",{className:"container mx-auto p-4 md:p-8",children:b.jsx(qA,{photos:x,loading:r,error:i,onDeletePhoto:s,onFavoritePhoto:a,onPhotoClick:m})}),n&&b.jsx(sb,{onClose:()=>e(!1),onUploadSuccess:I}),h&&b.jsx(ub,{photo:h,onClose:()=>m(null)})]})},k0=document.getElementById("root");if(!k0)throw new Error("Could not find root element to mount to");const hb=sd.createRoot(k0);hb.render(b.jsx(AC.StrictMode,{children:b.jsx(fb,{})}));
