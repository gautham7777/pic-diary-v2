(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function H0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ov={exports:{}},Eu={},qv={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ol=Symbol.for("react.element"),K0=Symbol.for("react.portal"),W0=Symbol.for("react.fragment"),J0=Symbol.for("react.strict_mode"),Q0=Symbol.for("react.profiler"),Y0=Symbol.for("react.provider"),X0=Symbol.for("react.context"),Z0=Symbol.for("react.forward_ref"),j0=Symbol.for("react.suspense"),eS=Symbol.for("react.memo"),tS=Symbol.for("react.lazy"),Om=Symbol.iterator;function nS(t){return t===null||typeof t!="object"?null:(t=Om&&t[Om]||t["@@iterator"],typeof t=="function"?t:null)}var Gv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$v=Object.assign,zv={};function vo(t,e,n){this.props=t,this.context=e,this.refs=zv,this.updater=n||Gv}vo.prototype.isReactComponent={};vo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Hv(){}Hv.prototype=vo.prototype;function Hf(t,e,n){this.props=t,this.context=e,this.refs=zv,this.updater=n||Gv}var Kf=Hf.prototype=new Hv;Kf.constructor=Hf;$v(Kf,vo.prototype);Kf.isPureReactComponent=!0;var qm=Array.isArray,Kv=Object.prototype.hasOwnProperty,Wf={current:null},Wv={key:!0,ref:!0,__self:!0,__source:!0};function Jv(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Kv.call(e,r)&&!Wv.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:ol,type:t,key:o,ref:s,props:i,_owner:Wf.current}}function rS(t,e){return{$$typeof:ol,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jf(t){return typeof t=="object"&&t!==null&&t.$$typeof===ol}function iS(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Gm=/\/+/g;function Pc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?iS(""+t.key):e.toString(36)}function da(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ol:case K0:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Pc(s,0):r,qm(i)?(n="",t!=null&&(n=t.replace(Gm,"$&/")+"/"),da(i,e,n,"",function(d){return d})):i!=null&&(Jf(i)&&(i=rS(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Gm,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",qm(t))for(var u=0;u<t.length;u++){o=t[u];var c=r+Pc(o,u);s+=da(o,e,n,c,i)}else if(c=nS(t),typeof c=="function")for(t=c.call(t),u=0;!(o=t.next()).done;)o=o.value,c=r+Pc(o,u++),s+=da(o,e,n,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Ul(t,e,n){if(t==null)return t;var r=[],i=0;return da(t,r,"","",function(o){return e.call(n,o,i++)}),r}function oS(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Tt={current:null},fa={transition:null},sS={ReactCurrentDispatcher:Tt,ReactCurrentBatchConfig:fa,ReactCurrentOwner:Wf};function Qv(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:Ul,forEach:function(t,e,n){Ul(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ul(t,function(){e++}),e},toArray:function(t){return Ul(t,function(e){return e})||[]},only:function(t){if(!Jf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};re.Component=vo;re.Fragment=W0;re.Profiler=Q0;re.PureComponent=Hf;re.StrictMode=J0;re.Suspense=j0;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sS;re.act=Qv;re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=$v({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Wf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)Kv.call(e,c)&&!Wv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:ol,type:t.type,key:i,ref:o,props:r,_owner:s}};re.createContext=function(t){return t={$$typeof:X0,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Y0,_context:t},t.Consumer=t};re.createElement=Jv;re.createFactory=function(t){var e=Jv.bind(null,t);return e.type=t,e};re.createRef=function(){return{current:null}};re.forwardRef=function(t){return{$$typeof:Z0,render:t}};re.isValidElement=Jf;re.lazy=function(t){return{$$typeof:tS,_payload:{_status:-1,_result:t},_init:oS}};re.memo=function(t,e){return{$$typeof:eS,type:t,compare:e===void 0?null:e}};re.startTransition=function(t){var e=fa.transition;fa.transition={};try{t()}finally{fa.transition=e}};re.unstable_act=Qv;re.useCallback=function(t,e){return Tt.current.useCallback(t,e)};re.useContext=function(t){return Tt.current.useContext(t)};re.useDebugValue=function(){};re.useDeferredValue=function(t){return Tt.current.useDeferredValue(t)};re.useEffect=function(t,e){return Tt.current.useEffect(t,e)};re.useId=function(){return Tt.current.useId()};re.useImperativeHandle=function(t,e,n){return Tt.current.useImperativeHandle(t,e,n)};re.useInsertionEffect=function(t,e){return Tt.current.useInsertionEffect(t,e)};re.useLayoutEffect=function(t,e){return Tt.current.useLayoutEffect(t,e)};re.useMemo=function(t,e){return Tt.current.useMemo(t,e)};re.useReducer=function(t,e,n){return Tt.current.useReducer(t,e,n)};re.useRef=function(t){return Tt.current.useRef(t)};re.useState=function(t){return Tt.current.useState(t)};re.useSyncExternalStore=function(t,e,n){return Tt.current.useSyncExternalStore(t,e,n)};re.useTransition=function(){return Tt.current.useTransition()};re.version="18.3.1";qv.exports=re;var Te=qv.exports;const lS=H0(Te);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS=Te,uS=Symbol.for("react.element"),cS=Symbol.for("react.fragment"),dS=Object.prototype.hasOwnProperty,fS=aS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hS={key:!0,ref:!0,__self:!0,__source:!0};function Yv(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)dS.call(e,r)&&!hS.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:uS,type:t,key:o,ref:s,props:i,_owner:fS.current}}Eu.Fragment=cS;Eu.jsx=Yv;Eu.jsxs=Yv;Ov.exports=Eu;var O=Ov.exports,hd={},Xv={exports:{}},Bt={},Zv={exports:{}},jv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,Z){var te=K.length;K.push(Z);e:for(;0<te;){var Se=te-1>>>1,pe=K[Se];if(0<i(pe,Z))K[Se]=Z,K[te]=pe,te=Se;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var Z=K[0],te=K.pop();if(te!==Z){K[0]=te;e:for(var Se=0,pe=K.length,Fe=pe>>>1;Se<Fe;){var _n=2*(Se+1)-1,vn=K[_n],Tn=_n+1,En=K[Tn];if(0>i(vn,te))Tn<pe&&0>i(En,vn)?(K[Se]=En,K[Tn]=te,Se=Tn):(K[Se]=vn,K[_n]=te,Se=_n);else if(Tn<pe&&0>i(En,te))K[Se]=En,K[Tn]=te,Se=Tn;else break e}}return Z}function i(K,Z){var te=K.sortIndex-Z.sortIndex;return te!==0?te:K.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],d=[],h=1,p=null,m=3,_=!1,w=!1,R=!1,k=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(K){for(var Z=n(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=K)r(d),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=n(d)}}function D(K){if(R=!1,I(K),!w)if(n(c)!==null)w=!0,gn(F);else{var Z=n(d);Z!==null&&yn(D,Z.startTime-K)}}function F(K,Z){w=!1,R&&(R=!1,S(E),E=-1),_=!0;var te=m;try{for(I(Z),p=n(c);p!==null&&(!(p.expirationTime>Z)||K&&!M());){var Se=p.callback;if(typeof Se=="function"){p.callback=null,m=p.priorityLevel;var pe=Se(p.expirationTime<=Z);Z=t.unstable_now(),typeof pe=="function"?p.callback=pe:p===n(c)&&r(c),I(Z)}else r(c);p=n(c)}if(p!==null)var Fe=!0;else{var _n=n(d);_n!==null&&yn(D,_n.startTime-Z),Fe=!1}return Fe}finally{p=null,m=te,_=!1}}var U=!1,C=null,E=-1,A=5,P=-1;function M(){return!(t.unstable_now()-P<A)}function N(){if(C!==null){var K=t.unstable_now();P=K;var Z=!0;try{Z=C(!0,K)}finally{Z?x():(U=!1,C=null)}}else U=!1}var x;if(typeof v=="function")x=function(){v(N)};else if(typeof MessageChannel<"u"){var ct=new MessageChannel,We=ct.port2;ct.port1.onmessage=N,x=function(){We.postMessage(null)}}else x=function(){k(N,0)};function gn(K){C=K,U||(U=!0,x())}function yn(K,Z){E=k(function(){K(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){w||_||(w=!0,gn(F))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var te=m;m=Z;try{return K()}finally{m=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,Z){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var te=m;m=K;try{return Z()}finally{m=te}},t.unstable_scheduleCallback=function(K,Z,te){var Se=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Se+te:Se):te=Se,K){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=te+pe,K={id:h++,callback:Z,priorityLevel:K,startTime:te,expirationTime:pe,sortIndex:-1},te>Se?(K.sortIndex=te,e(d,K),n(c)===null&&K===n(d)&&(R?(S(E),E=-1):R=!0,yn(D,te-Se))):(K.sortIndex=pe,e(c,K),w||_||(w=!0,gn(F))),K},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(K){var Z=m;return function(){var te=m;m=Z;try{return K.apply(this,arguments)}finally{m=te}}}})(jv);Zv.exports=jv;var pS=Zv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mS=Te,Ut=pS;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var eT=new Set,xs={};function li(t,e){eo(t,e),eo(t+"Capture",e)}function eo(t,e){for(xs[t]=e,t=0;t<e.length;t++)eT.add(e[t])}var Dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pd=Object.prototype.hasOwnProperty,gS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$m={},zm={};function yS(t){return pd.call(zm,t)?!0:pd.call($m,t)?!1:gS.test(t)?zm[t]=!0:($m[t]=!0,!1)}function _S(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function vS(t,e,n,r){if(e===null||typeof e>"u"||_S(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var je={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){je[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];je[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){je[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){je[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){je[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){je[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){je[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){je[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){je[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Qf=/[\-:]([a-z])/g;function Yf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Qf,Yf);je[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Qf,Yf);je[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Qf,Yf);je[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){je[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});je.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){je[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function Xf(t,e,n,r){var i=je.hasOwnProperty(e)?je[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(vS(e,n,i,r)&&(n=null),r||i===null?yS(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Un=mS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bl=Symbol.for("react.element"),Di=Symbol.for("react.portal"),ki=Symbol.for("react.fragment"),Zf=Symbol.for("react.strict_mode"),md=Symbol.for("react.profiler"),tT=Symbol.for("react.provider"),nT=Symbol.for("react.context"),jf=Symbol.for("react.forward_ref"),gd=Symbol.for("react.suspense"),yd=Symbol.for("react.suspense_list"),eh=Symbol.for("react.memo"),Kn=Symbol.for("react.lazy"),rT=Symbol.for("react.offscreen"),Hm=Symbol.iterator;function zo(t){return t===null||typeof t!="object"?null:(t=Hm&&t[Hm]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Object.assign,xc;function os(t){if(xc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xc=e&&e[1]||""}return`
`+xc+t}var Mc=!1;function Dc(t,e){if(!t||Mc)return"";Mc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,u=o.length-1;1<=s&&0<=u&&i[s]!==o[u];)u--;for(;1<=s&&0<=u;s--,u--)if(i[s]!==o[u]){if(s!==1||u!==1)do if(s--,u--,0>u||i[s]!==o[u]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=u);break}}}finally{Mc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?os(t):""}function TS(t){switch(t.tag){case 5:return os(t.type);case 16:return os("Lazy");case 13:return os("Suspense");case 19:return os("SuspenseList");case 0:case 2:case 15:return t=Dc(t.type,!1),t;case 11:return t=Dc(t.type.render,!1),t;case 1:return t=Dc(t.type,!0),t;default:return""}}function _d(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ki:return"Fragment";case Di:return"Portal";case md:return"Profiler";case Zf:return"StrictMode";case gd:return"Suspense";case yd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case nT:return(t.displayName||"Context")+".Consumer";case tT:return(t._context.displayName||"Context")+".Provider";case jf:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case eh:return e=t.displayName||null,e!==null?e:_d(t.type)||"Memo";case Kn:e=t._payload,t=t._init;try{return _d(t(e))}catch{}}return null}function ES(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _d(e);case 8:return e===Zf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function iT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IS(t){var e=iT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Bl(t){t._valueTracker||(t._valueTracker=IS(t))}function oT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=iT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Va(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function vd(t,e){var n=e.checked;return Me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Km(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=pr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sT(t,e){e=e.checked,e!=null&&Xf(t,"checked",e,!1)}function Td(t,e){sT(t,e);var n=pr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ed(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ed(t,e.type,pr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Wm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ed(t,e,n){(e!=="number"||Va(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ss=Array.isArray;function zi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+pr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Id(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return Me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(ss(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:pr(n)}}function lT(t,e){var n=pr(e.value),r=pr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function aT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?aT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ol,uT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ol=Ol||document.createElement("div"),Ol.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ol.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ms(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CS=["Webkit","ms","Moz","O"];Object.keys(hs).forEach(function(t){CS.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hs[e]=hs[t]})});function cT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hs.hasOwnProperty(t)&&hs[t]?(""+e).trim():e+"px"}function dT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=cT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var wS=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wd(t,e){if(e){if(wS[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Sd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ad=null;function th(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rd=null,Hi=null,Ki=null;function Ym(t){if(t=al(t)){if(typeof Rd!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Au(e),Rd(t.stateNode,t.type,e))}}function fT(t){Hi?Ki?Ki.push(t):Ki=[t]:Hi=t}function hT(){if(Hi){var t=Hi,e=Ki;if(Ki=Hi=null,Ym(t),e)for(t=0;t<e.length;t++)Ym(e[t])}}function pT(t,e){return t(e)}function mT(){}var kc=!1;function gT(t,e,n){if(kc)return t(e,n);kc=!0;try{return pT(t,e,n)}finally{kc=!1,(Hi!==null||Ki!==null)&&(mT(),hT())}}function Ds(t,e){var n=t.stateNode;if(n===null)return null;var r=Au(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var Pd=!1;if(Dn)try{var Ho={};Object.defineProperty(Ho,"passive",{get:function(){Pd=!0}}),window.addEventListener("test",Ho,Ho),window.removeEventListener("test",Ho,Ho)}catch{Pd=!1}function SS(t,e,n,r,i,o,s,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ps=!1,La=null,Fa=!1,xd=null,AS={onError:function(t){ps=!0,La=t}};function RS(t,e,n,r,i,o,s,u,c){ps=!1,La=null,SS.apply(AS,arguments)}function PS(t,e,n,r,i,o,s,u,c){if(RS.apply(this,arguments),ps){if(ps){var d=La;ps=!1,La=null}else throw Error(G(198));Fa||(Fa=!0,xd=d)}}function ai(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function yT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Xm(t){if(ai(t)!==t)throw Error(G(188))}function xS(t){var e=t.alternate;if(!e){if(e=ai(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Xm(i),t;if(o===r)return Xm(i),e;o=o.sibling}throw Error(G(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function _T(t){return t=xS(t),t!==null?vT(t):null}function vT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vT(t);if(e!==null)return e;t=t.sibling}return null}var TT=Ut.unstable_scheduleCallback,Zm=Ut.unstable_cancelCallback,MS=Ut.unstable_shouldYield,DS=Ut.unstable_requestPaint,Ue=Ut.unstable_now,kS=Ut.unstable_getCurrentPriorityLevel,nh=Ut.unstable_ImmediatePriority,ET=Ut.unstable_UserBlockingPriority,Ua=Ut.unstable_NormalPriority,NS=Ut.unstable_LowPriority,IT=Ut.unstable_IdlePriority,Iu=null,hn=null;function VS(t){if(hn&&typeof hn.onCommitFiberRoot=="function")try{hn.onCommitFiberRoot(Iu,t,void 0,(t.current.flags&128)===128)}catch{}}var nn=Math.clz32?Math.clz32:US,LS=Math.log,FS=Math.LN2;function US(t){return t>>>=0,t===0?32:31-(LS(t)/FS|0)|0}var ql=64,Gl=4194304;function ls(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ba(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var u=s&~i;u!==0?r=ls(u):(o&=s,o!==0&&(r=ls(o)))}else s=n&~i,s!==0?r=ls(s):o!==0&&(r=ls(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-nn(e),i=1<<n,r|=t[n],e&=~i;return r}function bS(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BS(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-nn(o),u=1<<s,c=i[s];c===-1?(!(u&n)||u&r)&&(i[s]=bS(u,e)):c<=e&&(t.expiredLanes|=u),o&=~u}}function Md(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function CT(){var t=ql;return ql<<=1,!(ql&4194240)&&(ql=64),t}function Nc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function sl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-nn(e),t[e]=n}function OS(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-nn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function rh(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-nn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fe=0;function wT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ST,ih,AT,RT,PT,Dd=!1,$l=[],tr=null,nr=null,rr=null,ks=new Map,Ns=new Map,Jn=[],qS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jm(t,e){switch(t){case"focusin":case"focusout":tr=null;break;case"dragenter":case"dragleave":nr=null;break;case"mouseover":case"mouseout":rr=null;break;case"pointerover":case"pointerout":ks.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ns.delete(e.pointerId)}}function Ko(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=al(e),e!==null&&ih(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function GS(t,e,n,r,i){switch(e){case"focusin":return tr=Ko(tr,t,e,n,r,i),!0;case"dragenter":return nr=Ko(nr,t,e,n,r,i),!0;case"mouseover":return rr=Ko(rr,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ks.set(o,Ko(ks.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ns.set(o,Ko(Ns.get(o)||null,t,e,n,r,i)),!0}return!1}function xT(t){var e=br(t.target);if(e!==null){var n=ai(e);if(n!==null){if(e=n.tag,e===13){if(e=yT(n),e!==null){t.blockedOn=e,PT(t.priority,function(){AT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ha(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=kd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ad=r,n.target.dispatchEvent(r),Ad=null}else return e=al(n),e!==null&&ih(e),t.blockedOn=n,!1;e.shift()}return!0}function eg(t,e,n){ha(t)&&n.delete(e)}function $S(){Dd=!1,tr!==null&&ha(tr)&&(tr=null),nr!==null&&ha(nr)&&(nr=null),rr!==null&&ha(rr)&&(rr=null),ks.forEach(eg),Ns.forEach(eg)}function Wo(t,e){t.blockedOn===e&&(t.blockedOn=null,Dd||(Dd=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,$S)))}function Vs(t){function e(i){return Wo(i,t)}if(0<$l.length){Wo($l[0],t);for(var n=1;n<$l.length;n++){var r=$l[n];r.blockedOn===t&&(r.blockedOn=null)}}for(tr!==null&&Wo(tr,t),nr!==null&&Wo(nr,t),rr!==null&&Wo(rr,t),ks.forEach(e),Ns.forEach(e),n=0;n<Jn.length;n++)r=Jn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jn.length&&(n=Jn[0],n.blockedOn===null);)xT(n),n.blockedOn===null&&Jn.shift()}var Wi=Un.ReactCurrentBatchConfig,Ba=!0;function zS(t,e,n,r){var i=fe,o=Wi.transition;Wi.transition=null;try{fe=1,oh(t,e,n,r)}finally{fe=i,Wi.transition=o}}function HS(t,e,n,r){var i=fe,o=Wi.transition;Wi.transition=null;try{fe=4,oh(t,e,n,r)}finally{fe=i,Wi.transition=o}}function oh(t,e,n,r){if(Ba){var i=kd(t,e,n,r);if(i===null)$c(t,e,r,Oa,n),jm(t,r);else if(GS(i,t,e,n,r))r.stopPropagation();else if(jm(t,r),e&4&&-1<qS.indexOf(t)){for(;i!==null;){var o=al(i);if(o!==null&&ST(o),o=kd(t,e,n,r),o===null&&$c(t,e,r,Oa,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else $c(t,e,r,null,n)}}var Oa=null;function kd(t,e,n,r){if(Oa=null,t=th(r),t=br(t),t!==null)if(e=ai(t),e===null)t=null;else if(n=e.tag,n===13){if(t=yT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Oa=t,null}function MT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(kS()){case nh:return 1;case ET:return 4;case Ua:case NS:return 16;case IT:return 536870912;default:return 16}default:return 16}}var Zn=null,sh=null,pa=null;function DT(){if(pa)return pa;var t,e=sh,n=e.length,r,i="value"in Zn?Zn.value:Zn.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return pa=i.slice(t,1<r?1-r:void 0)}function ma(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zl(){return!0}function tg(){return!1}function Ot(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zl:tg,this.isPropagationStopped=tg,this}return Me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),e}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lh=Ot(To),ll=Me({},To,{view:0,detail:0}),KS=Ot(ll),Vc,Lc,Jo,Cu=Me({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ah,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jo&&(Jo&&t.type==="mousemove"?(Vc=t.screenX-Jo.screenX,Lc=t.screenY-Jo.screenY):Lc=Vc=0,Jo=t),Vc)},movementY:function(t){return"movementY"in t?t.movementY:Lc}}),ng=Ot(Cu),WS=Me({},Cu,{dataTransfer:0}),JS=Ot(WS),QS=Me({},ll,{relatedTarget:0}),Fc=Ot(QS),YS=Me({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),XS=Ot(YS),ZS=Me({},To,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jS=Ot(ZS),eA=Me({},To,{data:0}),rg=Ot(eA),tA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rA[t])?!!e[t]:!1}function ah(){return iA}var oA=Me({},ll,{key:function(t){if(t.key){var e=tA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ah,charCode:function(t){return t.type==="keypress"?ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sA=Ot(oA),lA=Me({},Cu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ig=Ot(lA),aA=Me({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ah}),uA=Ot(aA),cA=Me({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),dA=Ot(cA),fA=Me({},Cu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hA=Ot(fA),pA=[9,13,27,32],uh=Dn&&"CompositionEvent"in window,ms=null;Dn&&"documentMode"in document&&(ms=document.documentMode);var mA=Dn&&"TextEvent"in window&&!ms,kT=Dn&&(!uh||ms&&8<ms&&11>=ms),og=" ",sg=!1;function NT(t,e){switch(t){case"keyup":return pA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function VT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ni=!1;function gA(t,e){switch(t){case"compositionend":return VT(e);case"keypress":return e.which!==32?null:(sg=!0,og);case"textInput":return t=e.data,t===og&&sg?null:t;default:return null}}function yA(t,e){if(Ni)return t==="compositionend"||!uh&&NT(t,e)?(t=DT(),pa=sh=Zn=null,Ni=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kT&&e.locale!=="ko"?null:e.data;default:return null}}var _A={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_A[t.type]:e==="textarea"}function LT(t,e,n,r){fT(r),e=qa(e,"onChange"),0<e.length&&(n=new lh("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gs=null,Ls=null;function vA(t){KT(t,0)}function wu(t){var e=Fi(t);if(oT(e))return t}function TA(t,e){if(t==="change")return e}var FT=!1;if(Dn){var Uc;if(Dn){var bc="oninput"in document;if(!bc){var ag=document.createElement("div");ag.setAttribute("oninput","return;"),bc=typeof ag.oninput=="function"}Uc=bc}else Uc=!1;FT=Uc&&(!document.documentMode||9<document.documentMode)}function ug(){gs&&(gs.detachEvent("onpropertychange",UT),Ls=gs=null)}function UT(t){if(t.propertyName==="value"&&wu(Ls)){var e=[];LT(e,Ls,t,th(t)),gT(vA,e)}}function EA(t,e,n){t==="focusin"?(ug(),gs=e,Ls=n,gs.attachEvent("onpropertychange",UT)):t==="focusout"&&ug()}function IA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wu(Ls)}function CA(t,e){if(t==="click")return wu(e)}function wA(t,e){if(t==="input"||t==="change")return wu(e)}function SA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var on=typeof Object.is=="function"?Object.is:SA;function Fs(t,e){if(on(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!pd.call(e,i)||!on(t[i],e[i]))return!1}return!0}function cg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dg(t,e){var n=cg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cg(n)}}function bT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?bT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function BT(){for(var t=window,e=Va();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Va(t.document)}return e}function ch(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function AA(t){var e=BT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&bT(n.ownerDocument.documentElement,n)){if(r!==null&&ch(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=dg(n,o);var s=dg(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var RA=Dn&&"documentMode"in document&&11>=document.documentMode,Vi=null,Nd=null,ys=null,Vd=!1;function fg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vd||Vi==null||Vi!==Va(r)||(r=Vi,"selectionStart"in r&&ch(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ys&&Fs(ys,r)||(ys=r,r=qa(Nd,"onSelect"),0<r.length&&(e=new lh("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vi)))}function Hl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Li={animationend:Hl("Animation","AnimationEnd"),animationiteration:Hl("Animation","AnimationIteration"),animationstart:Hl("Animation","AnimationStart"),transitionend:Hl("Transition","TransitionEnd")},Bc={},OT={};Dn&&(OT=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Su(t){if(Bc[t])return Bc[t];if(!Li[t])return t;var e=Li[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in OT)return Bc[t]=e[n];return t}var qT=Su("animationend"),GT=Su("animationiteration"),$T=Su("animationstart"),zT=Su("transitionend"),HT=new Map,hg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(t,e){HT.set(t,e),li(e,[t])}for(var Oc=0;Oc<hg.length;Oc++){var qc=hg[Oc],PA=qc.toLowerCase(),xA=qc[0].toUpperCase()+qc.slice(1);Tr(PA,"on"+xA)}Tr(qT,"onAnimationEnd");Tr(GT,"onAnimationIteration");Tr($T,"onAnimationStart");Tr("dblclick","onDoubleClick");Tr("focusin","onFocus");Tr("focusout","onBlur");Tr(zT,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));li("onBeforeInput",["compositionend","keypress","textInput","paste"]);li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var as="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MA=new Set("cancel close invalid load scroll toggle".split(" ").concat(as));function pg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,PS(r,e,void 0,t),t.currentTarget=null}function KT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var u=r[s],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==o&&i.isPropagationStopped())break e;pg(i,u,d),o=c}else for(s=0;s<r.length;s++){if(u=r[s],c=u.instance,d=u.currentTarget,u=u.listener,c!==o&&i.isPropagationStopped())break e;pg(i,u,d),o=c}}}if(Fa)throw t=xd,Fa=!1,xd=null,t}function _e(t,e){var n=e[Bd];n===void 0&&(n=e[Bd]=new Set);var r=t+"__bubble";n.has(r)||(WT(e,t,2,!1),n.add(r))}function Gc(t,e,n){var r=0;e&&(r|=4),WT(n,t,r,e)}var Kl="_reactListening"+Math.random().toString(36).slice(2);function Us(t){if(!t[Kl]){t[Kl]=!0,eT.forEach(function(n){n!=="selectionchange"&&(MA.has(n)||Gc(n,!1,t),Gc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Kl]||(e[Kl]=!0,Gc("selectionchange",!1,e))}}function WT(t,e,n,r){switch(MT(e)){case 1:var i=zS;break;case 4:i=HS;break;default:i=oh}n=i.bind(null,e,n,t),i=void 0,!Pd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $c(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;u!==null;){if(s=br(u),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}u=u.parentNode}}r=r.return}gT(function(){var d=o,h=th(n),p=[];e:{var m=HT.get(t);if(m!==void 0){var _=lh,w=t;switch(t){case"keypress":if(ma(n)===0)break e;case"keydown":case"keyup":_=sA;break;case"focusin":w="focus",_=Fc;break;case"focusout":w="blur",_=Fc;break;case"beforeblur":case"afterblur":_=Fc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=ng;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=JS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=uA;break;case qT:case GT:case $T:_=XS;break;case zT:_=dA;break;case"scroll":_=KS;break;case"wheel":_=hA;break;case"copy":case"cut":case"paste":_=jS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=ig}var R=(e&4)!==0,k=!R&&t==="scroll",S=R?m!==null?m+"Capture":null:m;R=[];for(var v=d,I;v!==null;){I=v;var D=I.stateNode;if(I.tag===5&&D!==null&&(I=D,S!==null&&(D=Ds(v,S),D!=null&&R.push(bs(v,D,I)))),k)break;v=v.return}0<R.length&&(m=new _(m,w,null,n,h),p.push({event:m,listeners:R}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==Ad&&(w=n.relatedTarget||n.fromElement)&&(br(w)||w[kn]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(w=n.relatedTarget||n.toElement,_=d,w=w?br(w):null,w!==null&&(k=ai(w),w!==k||w.tag!==5&&w.tag!==6)&&(w=null)):(_=null,w=d),_!==w)){if(R=ng,D="onMouseLeave",S="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(R=ig,D="onPointerLeave",S="onPointerEnter",v="pointer"),k=_==null?m:Fi(_),I=w==null?m:Fi(w),m=new R(D,v+"leave",_,n,h),m.target=k,m.relatedTarget=I,D=null,br(h)===d&&(R=new R(S,v+"enter",w,n,h),R.target=I,R.relatedTarget=k,D=R),k=D,_&&w)t:{for(R=_,S=w,v=0,I=R;I;I=Ti(I))v++;for(I=0,D=S;D;D=Ti(D))I++;for(;0<v-I;)R=Ti(R),v--;for(;0<I-v;)S=Ti(S),I--;for(;v--;){if(R===S||S!==null&&R===S.alternate)break t;R=Ti(R),S=Ti(S)}R=null}else R=null;_!==null&&mg(p,m,_,R,!1),w!==null&&k!==null&&mg(p,k,w,R,!0)}}e:{if(m=d?Fi(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var F=TA;else if(lg(m))if(FT)F=wA;else{F=IA;var U=EA}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=CA);if(F&&(F=F(t,d))){LT(p,F,n,h);break e}U&&U(t,m,d),t==="focusout"&&(U=m._wrapperState)&&U.controlled&&m.type==="number"&&Ed(m,"number",m.value)}switch(U=d?Fi(d):window,t){case"focusin":(lg(U)||U.contentEditable==="true")&&(Vi=U,Nd=d,ys=null);break;case"focusout":ys=Nd=Vi=null;break;case"mousedown":Vd=!0;break;case"contextmenu":case"mouseup":case"dragend":Vd=!1,fg(p,n,h);break;case"selectionchange":if(RA)break;case"keydown":case"keyup":fg(p,n,h)}var C;if(uh)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Ni?NT(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(kT&&n.locale!=="ko"&&(Ni||E!=="onCompositionStart"?E==="onCompositionEnd"&&Ni&&(C=DT()):(Zn=h,sh="value"in Zn?Zn.value:Zn.textContent,Ni=!0)),U=qa(d,E),0<U.length&&(E=new rg(E,t,null,n,h),p.push({event:E,listeners:U}),C?E.data=C:(C=VT(n),C!==null&&(E.data=C)))),(C=mA?gA(t,n):yA(t,n))&&(d=qa(d,"onBeforeInput"),0<d.length&&(h=new rg("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=C))}KT(p,e)})}function bs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ds(t,n),o!=null&&r.unshift(bs(t,o,i)),o=Ds(t,e),o!=null&&r.push(bs(t,o,i))),t=t.return}return r}function Ti(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function mg(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var u=n,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,i?(c=Ds(n,o),c!=null&&s.unshift(bs(n,c,u))):i||(c=Ds(n,o),c!=null&&s.push(bs(n,c,u)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var DA=/\r\n?/g,kA=/\u0000|\uFFFD/g;function gg(t){return(typeof t=="string"?t:""+t).replace(DA,`
`).replace(kA,"")}function Wl(t,e,n){if(e=gg(e),gg(t)!==e&&n)throw Error(G(425))}function Ga(){}var Ld=null,Fd=null;function Ud(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bd=typeof setTimeout=="function"?setTimeout:void 0,NA=typeof clearTimeout=="function"?clearTimeout:void 0,yg=typeof Promise=="function"?Promise:void 0,VA=typeof queueMicrotask=="function"?queueMicrotask:typeof yg<"u"?function(t){return yg.resolve(null).then(t).catch(LA)}:bd;function LA(t){setTimeout(function(){throw t})}function zc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Vs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Vs(e)}function ir(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function _g(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eo=Math.random().toString(36).slice(2),un="__reactFiber$"+Eo,Bs="__reactProps$"+Eo,kn="__reactContainer$"+Eo,Bd="__reactEvents$"+Eo,FA="__reactListeners$"+Eo,UA="__reactHandles$"+Eo;function br(t){var e=t[un];if(e)return e;for(var n=t.parentNode;n;){if(e=n[kn]||n[un]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=_g(t);t!==null;){if(n=t[un])return n;t=_g(t)}return e}t=n,n=t.parentNode}return null}function al(t){return t=t[un]||t[kn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Au(t){return t[Bs]||null}var Od=[],Ui=-1;function Er(t){return{current:t}}function Ee(t){0>Ui||(t.current=Od[Ui],Od[Ui]=null,Ui--)}function ge(t,e){Ui++,Od[Ui]=t.current,t.current=e}var mr={},ut=Er(mr),At=Er(!1),Kr=mr;function to(t,e){var n=t.type.contextTypes;if(!n)return mr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(t){return t=t.childContextTypes,t!=null}function $a(){Ee(At),Ee(ut)}function vg(t,e,n){if(ut.current!==mr)throw Error(G(168));ge(ut,e),ge(At,n)}function JT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(G(108,ES(t)||"Unknown",i));return Me({},n,r)}function za(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||mr,Kr=ut.current,ge(ut,t),ge(At,At.current),!0}function Tg(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=JT(t,e,Kr),r.__reactInternalMemoizedMergedChildContext=t,Ee(At),Ee(ut),ge(ut,t)):Ee(At),ge(At,n)}var Sn=null,Ru=!1,Hc=!1;function QT(t){Sn===null?Sn=[t]:Sn.push(t)}function bA(t){Ru=!0,QT(t)}function Ir(){if(!Hc&&Sn!==null){Hc=!0;var t=0,e=fe;try{var n=Sn;for(fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Sn=null,Ru=!1}catch(i){throw Sn!==null&&(Sn=Sn.slice(t+1)),TT(nh,Ir),i}finally{fe=e,Hc=!1}}return null}var bi=[],Bi=0,Ha=null,Ka=0,qt=[],Gt=0,Wr=null,An=1,Rn="";function Mr(t,e){bi[Bi++]=Ka,bi[Bi++]=Ha,Ha=t,Ka=e}function YT(t,e,n){qt[Gt++]=An,qt[Gt++]=Rn,qt[Gt++]=Wr,Wr=t;var r=An;t=Rn;var i=32-nn(r)-1;r&=~(1<<i),n+=1;var o=32-nn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,An=1<<32-nn(e)+i|n<<i|r,Rn=o+t}else An=1<<o|n<<i|r,Rn=t}function dh(t){t.return!==null&&(Mr(t,1),YT(t,1,0))}function fh(t){for(;t===Ha;)Ha=bi[--Bi],bi[Bi]=null,Ka=bi[--Bi],bi[Bi]=null;for(;t===Wr;)Wr=qt[--Gt],qt[Gt]=null,Rn=qt[--Gt],qt[Gt]=null,An=qt[--Gt],qt[Gt]=null}var Lt=null,kt=null,Ce=!1,tn=null;function XT(t,e){var n=$t(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Eg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lt=t,kt=ir(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lt=t,kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Wr!==null?{id:An,overflow:Rn}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$t(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Lt=t,kt=null,!0):!1;default:return!1}}function qd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gd(t){if(Ce){var e=kt;if(e){var n=e;if(!Eg(t,e)){if(qd(t))throw Error(G(418));e=ir(n.nextSibling);var r=Lt;e&&Eg(t,e)?XT(r,n):(t.flags=t.flags&-4097|2,Ce=!1,Lt=t)}}else{if(qd(t))throw Error(G(418));t.flags=t.flags&-4097|2,Ce=!1,Lt=t}}}function Ig(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lt=t}function Jl(t){if(t!==Lt)return!1;if(!Ce)return Ig(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ud(t.type,t.memoizedProps)),e&&(e=kt)){if(qd(t))throw ZT(),Error(G(418));for(;e;)XT(t,e),e=ir(e.nextSibling)}if(Ig(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kt=ir(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kt=null}}else kt=Lt?ir(t.stateNode.nextSibling):null;return!0}function ZT(){for(var t=kt;t;)t=ir(t.nextSibling)}function no(){kt=Lt=null,Ce=!1}function hh(t){tn===null?tn=[t]:tn.push(t)}var BA=Un.ReactCurrentBatchConfig;function Qo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var u=i.refs;s===null?delete u[o]:u[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Ql(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Cg(t){var e=t._init;return e(t._payload)}function jT(t){function e(S,v){if(t){var I=S.deletions;I===null?(S.deletions=[v],S.flags|=16):I.push(v)}}function n(S,v){if(!t)return null;for(;v!==null;)e(S,v),v=v.sibling;return null}function r(S,v){for(S=new Map;v!==null;)v.key!==null?S.set(v.key,v):S.set(v.index,v),v=v.sibling;return S}function i(S,v){return S=ar(S,v),S.index=0,S.sibling=null,S}function o(S,v,I){return S.index=I,t?(I=S.alternate,I!==null?(I=I.index,I<v?(S.flags|=2,v):I):(S.flags|=2,v)):(S.flags|=1048576,v)}function s(S){return t&&S.alternate===null&&(S.flags|=2),S}function u(S,v,I,D){return v===null||v.tag!==6?(v=Zc(I,S.mode,D),v.return=S,v):(v=i(v,I),v.return=S,v)}function c(S,v,I,D){var F=I.type;return F===ki?h(S,v,I.props.children,D,I.key):v!==null&&(v.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Kn&&Cg(F)===v.type)?(D=i(v,I.props),D.ref=Qo(S,v,I),D.return=S,D):(D=Ia(I.type,I.key,I.props,null,S.mode,D),D.ref=Qo(S,v,I),D.return=S,D)}function d(S,v,I,D){return v===null||v.tag!==4||v.stateNode.containerInfo!==I.containerInfo||v.stateNode.implementation!==I.implementation?(v=jc(I,S.mode,D),v.return=S,v):(v=i(v,I.children||[]),v.return=S,v)}function h(S,v,I,D,F){return v===null||v.tag!==7?(v=Gr(I,S.mode,D,F),v.return=S,v):(v=i(v,I),v.return=S,v)}function p(S,v,I){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Zc(""+v,S.mode,I),v.return=S,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bl:return I=Ia(v.type,v.key,v.props,null,S.mode,I),I.ref=Qo(S,null,v),I.return=S,I;case Di:return v=jc(v,S.mode,I),v.return=S,v;case Kn:var D=v._init;return p(S,D(v._payload),I)}if(ss(v)||zo(v))return v=Gr(v,S.mode,I,null),v.return=S,v;Ql(S,v)}return null}function m(S,v,I,D){var F=v!==null?v.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return F!==null?null:u(S,v,""+I,D);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case bl:return I.key===F?c(S,v,I,D):null;case Di:return I.key===F?d(S,v,I,D):null;case Kn:return F=I._init,m(S,v,F(I._payload),D)}if(ss(I)||zo(I))return F!==null?null:h(S,v,I,D,null);Ql(S,I)}return null}function _(S,v,I,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return S=S.get(I)||null,u(v,S,""+D,F);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case bl:return S=S.get(D.key===null?I:D.key)||null,c(v,S,D,F);case Di:return S=S.get(D.key===null?I:D.key)||null,d(v,S,D,F);case Kn:var U=D._init;return _(S,v,I,U(D._payload),F)}if(ss(D)||zo(D))return S=S.get(I)||null,h(v,S,D,F,null);Ql(v,D)}return null}function w(S,v,I,D){for(var F=null,U=null,C=v,E=v=0,A=null;C!==null&&E<I.length;E++){C.index>E?(A=C,C=null):A=C.sibling;var P=m(S,C,I[E],D);if(P===null){C===null&&(C=A);break}t&&C&&P.alternate===null&&e(S,C),v=o(P,v,E),U===null?F=P:U.sibling=P,U=P,C=A}if(E===I.length)return n(S,C),Ce&&Mr(S,E),F;if(C===null){for(;E<I.length;E++)C=p(S,I[E],D),C!==null&&(v=o(C,v,E),U===null?F=C:U.sibling=C,U=C);return Ce&&Mr(S,E),F}for(C=r(S,C);E<I.length;E++)A=_(C,S,E,I[E],D),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?E:A.key),v=o(A,v,E),U===null?F=A:U.sibling=A,U=A);return t&&C.forEach(function(M){return e(S,M)}),Ce&&Mr(S,E),F}function R(S,v,I,D){var F=zo(I);if(typeof F!="function")throw Error(G(150));if(I=F.call(I),I==null)throw Error(G(151));for(var U=F=null,C=v,E=v=0,A=null,P=I.next();C!==null&&!P.done;E++,P=I.next()){C.index>E?(A=C,C=null):A=C.sibling;var M=m(S,C,P.value,D);if(M===null){C===null&&(C=A);break}t&&C&&M.alternate===null&&e(S,C),v=o(M,v,E),U===null?F=M:U.sibling=M,U=M,C=A}if(P.done)return n(S,C),Ce&&Mr(S,E),F;if(C===null){for(;!P.done;E++,P=I.next())P=p(S,P.value,D),P!==null&&(v=o(P,v,E),U===null?F=P:U.sibling=P,U=P);return Ce&&Mr(S,E),F}for(C=r(S,C);!P.done;E++,P=I.next())P=_(C,S,E,P.value,D),P!==null&&(t&&P.alternate!==null&&C.delete(P.key===null?E:P.key),v=o(P,v,E),U===null?F=P:U.sibling=P,U=P);return t&&C.forEach(function(N){return e(S,N)}),Ce&&Mr(S,E),F}function k(S,v,I,D){if(typeof I=="object"&&I!==null&&I.type===ki&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case bl:e:{for(var F=I.key,U=v;U!==null;){if(U.key===F){if(F=I.type,F===ki){if(U.tag===7){n(S,U.sibling),v=i(U,I.props.children),v.return=S,S=v;break e}}else if(U.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Kn&&Cg(F)===U.type){n(S,U.sibling),v=i(U,I.props),v.ref=Qo(S,U,I),v.return=S,S=v;break e}n(S,U);break}else e(S,U);U=U.sibling}I.type===ki?(v=Gr(I.props.children,S.mode,D,I.key),v.return=S,S=v):(D=Ia(I.type,I.key,I.props,null,S.mode,D),D.ref=Qo(S,v,I),D.return=S,S=D)}return s(S);case Di:e:{for(U=I.key;v!==null;){if(v.key===U)if(v.tag===4&&v.stateNode.containerInfo===I.containerInfo&&v.stateNode.implementation===I.implementation){n(S,v.sibling),v=i(v,I.children||[]),v.return=S,S=v;break e}else{n(S,v);break}else e(S,v);v=v.sibling}v=jc(I,S.mode,D),v.return=S,S=v}return s(S);case Kn:return U=I._init,k(S,v,U(I._payload),D)}if(ss(I))return w(S,v,I,D);if(zo(I))return R(S,v,I,D);Ql(S,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,v!==null&&v.tag===6?(n(S,v.sibling),v=i(v,I),v.return=S,S=v):(n(S,v),v=Zc(I,S.mode,D),v.return=S,S=v),s(S)):n(S,v)}return k}var ro=jT(!0),eE=jT(!1),Wa=Er(null),Ja=null,Oi=null,ph=null;function mh(){ph=Oi=Ja=null}function gh(t){var e=Wa.current;Ee(Wa),t._currentValue=e}function $d(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ji(t,e){Ja=t,ph=Oi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wt=!0),t.firstContext=null)}function Qt(t){var e=t._currentValue;if(ph!==t)if(t={context:t,memoizedValue:e,next:null},Oi===null){if(Ja===null)throw Error(G(308));Oi=t,Ja.dependencies={lanes:0,firstContext:t}}else Oi=Oi.next=t;return e}var Br=null;function yh(t){Br===null?Br=[t]:Br.push(t)}function tE(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,yh(e)):(n.next=i.next,i.next=n),e.interleaved=n,Nn(t,r)}function Nn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Wn=!1;function _h(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function or(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Nn(t,n)}return i=r.interleaved,i===null?(e.next=e,yh(r)):(e.next=i.next,i.next=e),r.interleaved=e,Nn(t,n)}function ga(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}function wg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qa(t,e,n,r){var i=t.updateQueue;Wn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,d=c.next;c.next=null,s===null?o=d:s.next=d,s=c;var h=t.alternate;h!==null&&(h=h.updateQueue,u=h.lastBaseUpdate,u!==s&&(u===null?h.firstBaseUpdate=d:u.next=d,h.lastBaseUpdate=c))}if(o!==null){var p=i.baseState;s=0,h=d=c=null,u=o;do{var m=u.lane,_=u.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var w=t,R=u;switch(m=e,_=n,R.tag){case 1:if(w=R.payload,typeof w=="function"){p=w.call(_,p,m);break e}p=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=R.payload,m=typeof w=="function"?w.call(_,p,m):w,m==null)break e;p=Me({},p,m);break e;case 2:Wn=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[u]:m.push(u))}else _={eventTime:_,lane:m,tag:u.tag,payload:u.payload,callback:u.callback,next:null},h===null?(d=h=_,c=p):h=h.next=_,s|=m;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;m=u,u=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Qr|=s,t.lanes=s,t.memoizedState=p}}function Sg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(G(191,i));i.call(r)}}}var ul={},pn=Er(ul),Os=Er(ul),qs=Er(ul);function Or(t){if(t===ul)throw Error(G(174));return t}function vh(t,e){switch(ge(qs,e),ge(Os,t),ge(pn,ul),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cd(e,t)}Ee(pn),ge(pn,e)}function io(){Ee(pn),Ee(Os),Ee(qs)}function rE(t){Or(qs.current);var e=Or(pn.current),n=Cd(e,t.type);e!==n&&(ge(Os,t),ge(pn,n))}function Th(t){Os.current===t&&(Ee(pn),Ee(Os))}var Ae=Er(0);function Ya(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Kc=[];function Eh(){for(var t=0;t<Kc.length;t++)Kc[t]._workInProgressVersionPrimary=null;Kc.length=0}var ya=Un.ReactCurrentDispatcher,Wc=Un.ReactCurrentBatchConfig,Jr=0,Pe=null,qe=null,He=null,Xa=!1,_s=!1,Gs=0,OA=0;function rt(){throw Error(G(321))}function Ih(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!on(t[n],e[n]))return!1;return!0}function Ch(t,e,n,r,i,o){if(Jr=o,Pe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ya.current=t===null||t.memoizedState===null?zA:HA,t=n(r,i),_s){o=0;do{if(_s=!1,Gs=0,25<=o)throw Error(G(301));o+=1,He=qe=null,e.updateQueue=null,ya.current=KA,t=n(r,i)}while(_s)}if(ya.current=Za,e=qe!==null&&qe.next!==null,Jr=0,He=qe=Pe=null,Xa=!1,e)throw Error(G(300));return t}function wh(){var t=Gs!==0;return Gs=0,t}function an(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return He===null?Pe.memoizedState=He=t:He=He.next=t,He}function Yt(){if(qe===null){var t=Pe.alternate;t=t!==null?t.memoizedState:null}else t=qe.next;var e=He===null?Pe.memoizedState:He.next;if(e!==null)He=e,qe=t;else{if(t===null)throw Error(G(310));qe=t,t={memoizedState:qe.memoizedState,baseState:qe.baseState,baseQueue:qe.baseQueue,queue:qe.queue,next:null},He===null?Pe.memoizedState=He=t:He=He.next=t}return He}function $s(t,e){return typeof e=="function"?e(t):e}function Jc(t){var e=Yt(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=qe,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var u=s=null,c=null,d=o;do{var h=d.lane;if((Jr&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=p,s=r):c=c.next=p,Pe.lanes|=h,Qr|=h}d=d.next}while(d!==null&&d!==o);c===null?s=r:c.next=u,on(r,e.memoizedState)||(wt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,Pe.lanes|=o,Qr|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Qc(t){var e=Yt(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);on(o,e.memoizedState)||(wt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function iE(){}function oE(t,e){var n=Pe,r=Yt(),i=e(),o=!on(r.memoizedState,i);if(o&&(r.memoizedState=i,wt=!0),r=r.queue,Sh(aE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||He!==null&&He.memoizedState.tag&1){if(n.flags|=2048,zs(9,lE.bind(null,n,r,i,e),void 0,null),Ke===null)throw Error(G(349));Jr&30||sE(n,e,i)}return i}function sE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function lE(t,e,n,r){e.value=n,e.getSnapshot=r,uE(e)&&cE(t)}function aE(t,e,n){return n(function(){uE(e)&&cE(t)})}function uE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!on(t,n)}catch{return!0}}function cE(t){var e=Nn(t,1);e!==null&&rn(e,t,1,-1)}function Ag(t){var e=an();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:t},e.queue=t,t=t.dispatch=$A.bind(null,Pe,t),[e.memoizedState,t]}function zs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Pe.updateQueue,e===null?(e={lastEffect:null,stores:null},Pe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function dE(){return Yt().memoizedState}function _a(t,e,n,r){var i=an();Pe.flags|=t,i.memoizedState=zs(1|e,n,void 0,r===void 0?null:r)}function Pu(t,e,n,r){var i=Yt();r=r===void 0?null:r;var o=void 0;if(qe!==null){var s=qe.memoizedState;if(o=s.destroy,r!==null&&Ih(r,s.deps)){i.memoizedState=zs(e,n,o,r);return}}Pe.flags|=t,i.memoizedState=zs(1|e,n,o,r)}function Rg(t,e){return _a(8390656,8,t,e)}function Sh(t,e){return Pu(2048,8,t,e)}function fE(t,e){return Pu(4,2,t,e)}function hE(t,e){return Pu(4,4,t,e)}function pE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function mE(t,e,n){return n=n!=null?n.concat([t]):null,Pu(4,4,pE.bind(null,e,t),n)}function Ah(){}function gE(t,e){var n=Yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ih(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function yE(t,e){var n=Yt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ih(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function _E(t,e,n){return Jr&21?(on(n,e)||(n=CT(),Pe.lanes|=n,Qr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wt=!0),t.memoizedState=n)}function qA(t,e){var n=fe;fe=n!==0&&4>n?n:4,t(!0);var r=Wc.transition;Wc.transition={};try{t(!1),e()}finally{fe=n,Wc.transition=r}}function vE(){return Yt().memoizedState}function GA(t,e,n){var r=lr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},TE(t))EE(e,n);else if(n=tE(t,e,n,r),n!==null){var i=yt();rn(n,t,r,i),IE(n,e,r)}}function $A(t,e,n){var r=lr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(TE(t))EE(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,u=o(s,n);if(i.hasEagerState=!0,i.eagerState=u,on(u,s)){var c=e.interleaved;c===null?(i.next=i,yh(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=tE(t,e,i,r),n!==null&&(i=yt(),rn(n,t,r,i),IE(n,e,r))}}function TE(t){var e=t.alternate;return t===Pe||e!==null&&e===Pe}function EE(t,e){_s=Xa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function IE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,rh(t,n)}}var Za={readContext:Qt,useCallback:rt,useContext:rt,useEffect:rt,useImperativeHandle:rt,useInsertionEffect:rt,useLayoutEffect:rt,useMemo:rt,useReducer:rt,useRef:rt,useState:rt,useDebugValue:rt,useDeferredValue:rt,useTransition:rt,useMutableSource:rt,useSyncExternalStore:rt,useId:rt,unstable_isNewReconciler:!1},zA={readContext:Qt,useCallback:function(t,e){return an().memoizedState=[t,e===void 0?null:e],t},useContext:Qt,useEffect:Rg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_a(4194308,4,pE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _a(4194308,4,t,e)},useInsertionEffect:function(t,e){return _a(4,2,t,e)},useMemo:function(t,e){var n=an();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=an();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=GA.bind(null,Pe,t),[r.memoizedState,t]},useRef:function(t){var e=an();return t={current:t},e.memoizedState=t},useState:Ag,useDebugValue:Ah,useDeferredValue:function(t){return an().memoizedState=t},useTransition:function(){var t=Ag(!1),e=t[0];return t=qA.bind(null,t[1]),an().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Pe,i=an();if(Ce){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Ke===null)throw Error(G(349));Jr&30||sE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Rg(aE.bind(null,r,o,t),[t]),r.flags|=2048,zs(9,lE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=an(),e=Ke.identifierPrefix;if(Ce){var n=Rn,r=An;n=(r&~(1<<32-nn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HA={readContext:Qt,useCallback:gE,useContext:Qt,useEffect:Sh,useImperativeHandle:mE,useInsertionEffect:fE,useLayoutEffect:hE,useMemo:yE,useReducer:Jc,useRef:dE,useState:function(){return Jc($s)},useDebugValue:Ah,useDeferredValue:function(t){var e=Yt();return _E(e,qe.memoizedState,t)},useTransition:function(){var t=Jc($s)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:iE,useSyncExternalStore:oE,useId:vE,unstable_isNewReconciler:!1},KA={readContext:Qt,useCallback:gE,useContext:Qt,useEffect:Sh,useImperativeHandle:mE,useInsertionEffect:fE,useLayoutEffect:hE,useMemo:yE,useReducer:Qc,useRef:dE,useState:function(){return Qc($s)},useDebugValue:Ah,useDeferredValue:function(t){var e=Yt();return qe===null?e.memoizedState=t:_E(e,qe.memoizedState,t)},useTransition:function(){var t=Qc($s)[0],e=Yt().memoizedState;return[t,e]},useMutableSource:iE,useSyncExternalStore:oE,useId:vE,unstable_isNewReconciler:!1};function jt(t,e){if(t&&t.defaultProps){e=Me({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Me({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xu={isMounted:function(t){return(t=t._reactInternals)?ai(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=yt(),i=lr(t),o=xn(r,i);o.payload=e,n!=null&&(o.callback=n),e=or(t,o,i),e!==null&&(rn(e,t,i,r),ga(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=yt(),i=lr(t),o=xn(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=or(t,o,i),e!==null&&(rn(e,t,i,r),ga(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=yt(),r=lr(t),i=xn(n,r);i.tag=2,e!=null&&(i.callback=e),e=or(t,i,r),e!==null&&(rn(e,t,r,n),ga(e,t,r))}};function Pg(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Fs(n,r)||!Fs(i,o):!0}function CE(t,e,n){var r=!1,i=mr,o=e.contextType;return typeof o=="object"&&o!==null?o=Qt(o):(i=Rt(e)?Kr:ut.current,r=e.contextTypes,o=(r=r!=null)?to(t,i):mr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function xg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xu.enqueueReplaceState(e,e.state,null)}function Hd(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},_h(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Qt(o):(o=Rt(e)?Kr:ut.current,i.context=to(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(zd(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&xu.enqueueReplaceState(i,i.state,null),Qa(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function oo(t,e){try{var n="",r=e;do n+=TS(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Yc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WA=typeof WeakMap=="function"?WeakMap:Map;function wE(t,e,n){n=xn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){eu||(eu=!0,nf=r),Kd(t,e)},n}function SE(t,e,n){n=xn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Kd(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Kd(t,e),typeof r!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Mg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=lR.bind(null,t,e,n),e.then(t,t))}function Dg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function kg(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xn(-1,1),e.tag=2,or(n,e,1))),n.lanes|=1),t)}var JA=Un.ReactCurrentOwner,wt=!1;function pt(t,e,n,r){e.child=t===null?eE(e,null,n,r):ro(e,t.child,n,r)}function Ng(t,e,n,r,i){n=n.render;var o=e.ref;return Ji(e,i),r=Ch(t,e,n,r,o,i),n=wh(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vn(t,e,i)):(Ce&&n&&dh(e),e.flags|=1,pt(t,e,r,i),e.child)}function Vg(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Vh(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,AE(t,e,o,r,i)):(t=Ia(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Fs,n(s,r)&&t.ref===e.ref)return Vn(t,e,i)}return e.flags|=1,t=ar(o,r),t.ref=e.ref,t.return=e,e.child=t}function AE(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Fs(o,r)&&t.ref===e.ref)if(wt=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(wt=!0);else return e.lanes=t.lanes,Vn(t,e,i)}return Wd(t,e,n,r,i)}function RE(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ge(Gi,Dt),Dt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ge(Gi,Dt),Dt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ge(Gi,Dt),Dt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ge(Gi,Dt),Dt|=r;return pt(t,e,i,n),e.child}function PE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wd(t,e,n,r,i){var o=Rt(n)?Kr:ut.current;return o=to(e,o),Ji(e,i),n=Ch(t,e,n,r,o,i),r=wh(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Vn(t,e,i)):(Ce&&r&&dh(e),e.flags|=1,pt(t,e,n,i),e.child)}function Lg(t,e,n,r,i){if(Rt(n)){var o=!0;za(e)}else o=!1;if(Ji(e,i),e.stateNode===null)va(t,e),CE(e,n,r),Hd(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,u=e.memoizedProps;s.props=u;var c=s.context,d=n.contextType;typeof d=="object"&&d!==null?d=Qt(d):(d=Rt(n)?Kr:ut.current,d=to(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==r||c!==d)&&xg(e,s,r,d),Wn=!1;var m=e.memoizedState;s.state=m,Qa(e,r,s,i),c=e.memoizedState,u!==r||m!==c||At.current||Wn?(typeof h=="function"&&(zd(e,n,h,r),c=e.memoizedState),(u=Wn||Pg(e,n,u,r,m,c,d))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=d,r=u):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,nE(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:jt(e.type,u),s.props=d,p=e.pendingProps,m=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=Qt(c):(c=Rt(n)?Kr:ut.current,c=to(e,c));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==p||m!==c)&&xg(e,s,r,c),Wn=!1,m=e.memoizedState,s.state=m,Qa(e,r,s,i);var w=e.memoizedState;u!==p||m!==w||At.current||Wn?(typeof _=="function"&&(zd(e,n,_,r),w=e.memoizedState),(d=Wn||Pg(e,n,d,r,m,w,c)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,w,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,w,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=w),s.props=r,s.state=w,s.context=c,r=d):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Jd(t,e,n,r,o,i)}function Jd(t,e,n,r,i,o){PE(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Tg(e,n,!1),Vn(t,e,o);r=e.stateNode,JA.current=e;var u=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ro(e,t.child,null,o),e.child=ro(e,null,u,o)):pt(t,e,u,o),e.memoizedState=r.state,i&&Tg(e,n,!0),e.child}function xE(t){var e=t.stateNode;e.pendingContext?vg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&vg(t,e.context,!1),vh(t,e.containerInfo)}function Fg(t,e,n,r,i){return no(),hh(i),e.flags|=256,pt(t,e,n,r),e.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function Yd(t){return{baseLanes:t,cachePool:null,transitions:null}}function ME(t,e,n){var r=e.pendingProps,i=Ae.current,o=!1,s=(e.flags&128)!==0,u;if((u=s)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ge(Ae,i&1),t===null)return Gd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ku(s,r,0,null),t=Gr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Yd(n),e.memoizedState=Qd,t):Rh(e,s));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return QA(t,e,s,r,u,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ar(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?o=ar(u,o):(o=Gr(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Yd(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Qd,r}return o=t.child,t=o.sibling,r=ar(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Rh(t,e){return e=ku({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yl(t,e,n,r){return r!==null&&hh(r),ro(e,t.child,null,n),t=Rh(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function QA(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Yc(Error(G(422))),Yl(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=ku({mode:"visible",children:r.children},i,0,null),o=Gr(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ro(e,t.child,null,s),e.child.memoizedState=Yd(s),e.memoizedState=Qd,o);if(!(e.mode&1))return Yl(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(G(419)),r=Yc(o,r,void 0),Yl(t,e,s,r)}if(u=(s&t.childLanes)!==0,wt||u){if(r=Ke,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Nn(t,i),rn(r,t,i,-1))}return Nh(),r=Yc(Error(G(421))),Yl(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aR.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,kt=ir(i.nextSibling),Lt=e,Ce=!0,tn=null,t!==null&&(qt[Gt++]=An,qt[Gt++]=Rn,qt[Gt++]=Wr,An=t.id,Rn=t.overflow,Wr=e),e=Rh(e,r.children),e.flags|=4096,e)}function Ug(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$d(t.return,e,n)}function Xc(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function DE(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(pt(t,e,r.children,n),r=Ae.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ug(t,n,e);else if(t.tag===19)Ug(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ge(Ae,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ya(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xc(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ya(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xc(e,!0,n,null,o);break;case"together":Xc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function va(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Vn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=ar(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ar(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function YA(t,e,n){switch(e.tag){case 3:xE(e),no();break;case 5:rE(e);break;case 1:Rt(e.type)&&za(e);break;case 4:vh(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ge(Wa,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ge(Ae,Ae.current&1),e.flags|=128,null):n&e.child.childLanes?ME(t,e,n):(ge(Ae,Ae.current&1),t=Vn(t,e,n),t!==null?t.sibling:null);ge(Ae,Ae.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return DE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ge(Ae,Ae.current),r)break;return null;case 22:case 23:return e.lanes=0,RE(t,e,n)}return Vn(t,e,n)}var kE,Xd,NE,VE;kE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xd=function(){};NE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Or(pn.current);var o=null;switch(n){case"input":i=vd(t,i),r=vd(t,r),o=[];break;case"select":i=Me({},i,{value:void 0}),r=Me({},r,{value:void 0}),o=[];break;case"textarea":i=Id(t,i),r=Id(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ga)}wd(n,r);var s;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xs.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xs.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&_e("scroll",t),o||u===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};VE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yo(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function it(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function XA(t,e,n){var r=e.pendingProps;switch(fh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return it(e),null;case 1:return Rt(e.type)&&$a(),it(e),null;case 3:return r=e.stateNode,io(),Ee(At),Ee(ut),Eh(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,tn!==null&&(sf(tn),tn=null))),Xd(t,e),it(e),null;case 5:Th(e);var i=Or(qs.current);if(n=e.type,t!==null&&e.stateNode!=null)NE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return it(e),null}if(t=Or(pn.current),Jl(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[un]=e,r[Bs]=o,t=(e.mode&1)!==0,n){case"dialog":_e("cancel",r),_e("close",r);break;case"iframe":case"object":case"embed":_e("load",r);break;case"video":case"audio":for(i=0;i<as.length;i++)_e(as[i],r);break;case"source":_e("error",r);break;case"img":case"image":case"link":_e("error",r),_e("load",r);break;case"details":_e("toggle",r);break;case"input":Km(r,o),_e("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},_e("invalid",r);break;case"textarea":Jm(r,o),_e("invalid",r)}wd(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var u=o[s];s==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&Wl(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&Wl(r.textContent,u,t),i=["children",""+u]):xs.hasOwnProperty(s)&&u!=null&&s==="onScroll"&&_e("scroll",r)}switch(n){case"input":Bl(r),Wm(r,o,!0);break;case"textarea":Bl(r),Qm(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ga)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=aT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[un]=e,t[Bs]=r,kE(t,e,!1,!1),e.stateNode=t;e:{switch(s=Sd(n,r),n){case"dialog":_e("cancel",t),_e("close",t),i=r;break;case"iframe":case"object":case"embed":_e("load",t),i=r;break;case"video":case"audio":for(i=0;i<as.length;i++)_e(as[i],t);i=r;break;case"source":_e("error",t),i=r;break;case"img":case"image":case"link":_e("error",t),_e("load",t),i=r;break;case"details":_e("toggle",t),i=r;break;case"input":Km(t,r),i=vd(t,r),_e("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Me({},r,{value:void 0}),_e("invalid",t);break;case"textarea":Jm(t,r),i=Id(t,r),_e("invalid",t);break;default:i=r}wd(n,i),u=i;for(o in u)if(u.hasOwnProperty(o)){var c=u[o];o==="style"?dT(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&uT(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ms(t,c):typeof c=="number"&&Ms(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xs.hasOwnProperty(o)?c!=null&&o==="onScroll"&&_e("scroll",t):c!=null&&Xf(t,o,c,s))}switch(n){case"input":Bl(t),Wm(t,r,!1);break;case"textarea":Bl(t),Qm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?zi(t,!!r.multiple,o,!1):r.defaultValue!=null&&zi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ga)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return it(e),null;case 6:if(t&&e.stateNode!=null)VE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=Or(qs.current),Or(pn.current),Jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[un]=e,(o=r.nodeValue!==n)&&(t=Lt,t!==null))switch(t.tag){case 3:Wl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[un]=e,e.stateNode=r}return it(e),null;case 13:if(Ee(Ae),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&kt!==null&&e.mode&1&&!(e.flags&128))ZT(),no(),e.flags|=98560,o=!1;else if(o=Jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(G(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[un]=e}else no(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;it(e),o=!1}else tn!==null&&(sf(tn),tn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ae.current&1?Ge===0&&(Ge=3):Nh())),e.updateQueue!==null&&(e.flags|=4),it(e),null);case 4:return io(),Xd(t,e),t===null&&Us(e.stateNode.containerInfo),it(e),null;case 10:return gh(e.type._context),it(e),null;case 17:return Rt(e.type)&&$a(),it(e),null;case 19:if(Ee(Ae),o=e.memoizedState,o===null)return it(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Yo(o,!1);else{if(Ge!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Ya(t),s!==null){for(e.flags|=128,Yo(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ge(Ae,Ae.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ue()>so&&(e.flags|=128,r=!0,Yo(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ya(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ce)return it(e),null}else 2*Ue()-o.renderingStartTime>so&&n!==1073741824&&(e.flags|=128,r=!0,Yo(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ue(),e.sibling=null,n=Ae.current,ge(Ae,r?n&1|2:n&1),e):(it(e),null);case 22:case 23:return kh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Dt&1073741824&&(it(e),e.subtreeFlags&6&&(e.flags|=8192)):it(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function ZA(t,e){switch(fh(e),e.tag){case 1:return Rt(e.type)&&$a(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return io(),Ee(At),Ee(ut),Eh(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Th(e),null;case 13:if(Ee(Ae),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));no()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ee(Ae),null;case 4:return io(),null;case 10:return gh(e.type._context),null;case 22:case 23:return kh(),null;case 24:return null;default:return null}}var Xl=!1,st=!1,jA=typeof WeakSet=="function"?WeakSet:Set,W=null;function qi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ke(t,e,r)}else n.current=null}function Zd(t,e,n){try{n()}catch(r){ke(t,e,r)}}var bg=!1;function eR(t,e){if(Ld=Ba,t=BT(),ch(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,u=-1,c=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var _;p!==n||i!==0&&p.nodeType!==3||(u=s+i),p!==o||r!==0&&p.nodeType!==3||(c=s+r),p.nodeType===3&&(s+=p.nodeValue.length),(_=p.firstChild)!==null;)m=p,p=_;for(;;){if(p===t)break t;if(m===n&&++d===i&&(u=s),m===o&&++h===r&&(c=s),(_=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=_}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fd={focusedElem:t,selectionRange:n},Ba=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var w=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var R=w.memoizedProps,k=w.memoizedState,S=e.stateNode,v=S.getSnapshotBeforeUpdate(e.elementType===e.type?R:jt(e.type,R),k);S.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(D){ke(e,e.return,D)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return w=bg,bg=!1,w}function vs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Zd(e,n,o)}i=i.next}while(i!==r)}}function Mu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function jd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function LE(t){var e=t.alternate;e!==null&&(t.alternate=null,LE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[un],delete e[Bs],delete e[Bd],delete e[FA],delete e[UA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FE(t){return t.tag===5||t.tag===3||t.tag===4}function Bg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ef(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ga));else if(r!==4&&(t=t.child,t!==null))for(ef(t,e,n),t=t.sibling;t!==null;)ef(t,e,n),t=t.sibling}function tf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(tf(t,e,n),t=t.sibling;t!==null;)tf(t,e,n),t=t.sibling}var Qe=null,en=!1;function $n(t,e,n){for(n=n.child;n!==null;)UE(t,e,n),n=n.sibling}function UE(t,e,n){if(hn&&typeof hn.onCommitFiberUnmount=="function")try{hn.onCommitFiberUnmount(Iu,n)}catch{}switch(n.tag){case 5:st||qi(n,e);case 6:var r=Qe,i=en;Qe=null,$n(t,e,n),Qe=r,en=i,Qe!==null&&(en?(t=Qe,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Qe.removeChild(n.stateNode));break;case 18:Qe!==null&&(en?(t=Qe,n=n.stateNode,t.nodeType===8?zc(t.parentNode,n):t.nodeType===1&&zc(t,n),Vs(t)):zc(Qe,n.stateNode));break;case 4:r=Qe,i=en,Qe=n.stateNode.containerInfo,en=!0,$n(t,e,n),Qe=r,en=i;break;case 0:case 11:case 14:case 15:if(!st&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Zd(n,e,s),i=i.next}while(i!==r)}$n(t,e,n);break;case 1:if(!st&&(qi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){ke(n,e,u)}$n(t,e,n);break;case 21:$n(t,e,n);break;case 22:n.mode&1?(st=(r=st)||n.memoizedState!==null,$n(t,e,n),st=r):$n(t,e,n);break;default:$n(t,e,n)}}function Og(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jA),e.forEach(function(r){var i=uR.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Zt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,u=s;e:for(;u!==null;){switch(u.tag){case 5:Qe=u.stateNode,en=!1;break e;case 3:Qe=u.stateNode.containerInfo,en=!0;break e;case 4:Qe=u.stateNode.containerInfo,en=!0;break e}u=u.return}if(Qe===null)throw Error(G(160));UE(o,s,i),Qe=null,en=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){ke(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)bE(e,t),e=e.sibling}function bE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Zt(e,t),ln(t),r&4){try{vs(3,t,t.return),Mu(3,t)}catch(R){ke(t,t.return,R)}try{vs(5,t,t.return)}catch(R){ke(t,t.return,R)}}break;case 1:Zt(e,t),ln(t),r&512&&n!==null&&qi(n,n.return);break;case 5:if(Zt(e,t),ln(t),r&512&&n!==null&&qi(n,n.return),t.flags&32){var i=t.stateNode;try{Ms(i,"")}catch(R){ke(t,t.return,R)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&sT(i,o),Sd(u,s);var d=Sd(u,o);for(s=0;s<c.length;s+=2){var h=c[s],p=c[s+1];h==="style"?dT(i,p):h==="dangerouslySetInnerHTML"?uT(i,p):h==="children"?Ms(i,p):Xf(i,h,p,d)}switch(u){case"input":Td(i,o);break;case"textarea":lT(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var _=o.value;_!=null?zi(i,!!o.multiple,_,!1):m!==!!o.multiple&&(o.defaultValue!=null?zi(i,!!o.multiple,o.defaultValue,!0):zi(i,!!o.multiple,o.multiple?[]:"",!1))}i[Bs]=o}catch(R){ke(t,t.return,R)}}break;case 6:if(Zt(e,t),ln(t),r&4){if(t.stateNode===null)throw Error(G(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(R){ke(t,t.return,R)}}break;case 3:if(Zt(e,t),ln(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vs(e.containerInfo)}catch(R){ke(t,t.return,R)}break;case 4:Zt(e,t),ln(t);break;case 13:Zt(e,t),ln(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Mh=Ue())),r&4&&Og(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(st=(d=st)||h,Zt(e,t),st=d):Zt(e,t),ln(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(p=W=h;W!==null;){switch(m=W,_=m.child,m.tag){case 0:case 11:case 14:case 15:vs(4,m,m.return);break;case 1:qi(m,m.return);var w=m.stateNode;if(typeof w.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,w.props=e.memoizedProps,w.state=e.memoizedState,w.componentWillUnmount()}catch(R){ke(r,n,R)}}break;case 5:qi(m,m.return);break;case 22:if(m.memoizedState!==null){Gg(p);continue}}_!==null?(_.return=m,W=_):Gg(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{i=p.stateNode,d?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=p.stateNode,c=p.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=cT("display",s))}catch(R){ke(t,t.return,R)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(R){ke(t,t.return,R)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Zt(e,t),ln(t),r&4&&Og(t);break;case 21:break;default:Zt(e,t),ln(t)}}function ln(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FE(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ms(i,""),r.flags&=-33);var o=Bg(t);tf(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,u=Bg(t);ef(t,u,s);break;default:throw Error(G(161))}}catch(c){ke(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tR(t,e,n){W=t,BE(t)}function BE(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Xl;if(!s){var u=i.alternate,c=u!==null&&u.memoizedState!==null||st;u=Xl;var d=st;if(Xl=s,(st=c)&&!d)for(W=i;W!==null;)s=W,c=s.child,s.tag===22&&s.memoizedState!==null?$g(i):c!==null?(c.return=s,W=c):$g(i);for(;o!==null;)W=o,BE(o),o=o.sibling;W=i,Xl=u,st=d}qg(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,W=o):qg(t)}}function qg(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:st||Mu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!st)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:jt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Sg(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Sg(e,s,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Vs(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}st||e.flags&512&&jd(e)}catch(m){ke(e,e.return,m)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function Gg(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function $g(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Mu(4,e)}catch(c){ke(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){ke(e,i,c)}}var o=e.return;try{jd(e)}catch(c){ke(e,o,c)}break;case 5:var s=e.return;try{jd(e)}catch(c){ke(e,s,c)}}}catch(c){ke(e,e.return,c)}if(e===t){W=null;break}var u=e.sibling;if(u!==null){u.return=e.return,W=u;break}W=e.return}}var nR=Math.ceil,ja=Un.ReactCurrentDispatcher,Ph=Un.ReactCurrentOwner,Kt=Un.ReactCurrentBatchConfig,le=0,Ke=null,Be=null,Ze=0,Dt=0,Gi=Er(0),Ge=0,Hs=null,Qr=0,Du=0,xh=0,Ts=null,Ct=null,Mh=0,so=1/0,wn=null,eu=!1,nf=null,sr=null,Zl=!1,jn=null,tu=0,Es=0,rf=null,Ta=-1,Ea=0;function yt(){return le&6?Ue():Ta!==-1?Ta:Ta=Ue()}function lr(t){return t.mode&1?le&2&&Ze!==0?Ze&-Ze:BA.transition!==null?(Ea===0&&(Ea=CT()),Ea):(t=fe,t!==0||(t=window.event,t=t===void 0?16:MT(t.type)),t):1}function rn(t,e,n,r){if(50<Es)throw Es=0,rf=null,Error(G(185));sl(t,n,r),(!(le&2)||t!==Ke)&&(t===Ke&&(!(le&2)&&(Du|=n),Ge===4&&Qn(t,Ze)),Pt(t,r),n===1&&le===0&&!(e.mode&1)&&(so=Ue()+500,Ru&&Ir()))}function Pt(t,e){var n=t.callbackNode;BS(t,e);var r=ba(t,t===Ke?Ze:0);if(r===0)n!==null&&Zm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Zm(n),e===1)t.tag===0?bA(zg.bind(null,t)):QT(zg.bind(null,t)),VA(function(){!(le&6)&&Ir()}),n=null;else{switch(wT(r)){case 1:n=nh;break;case 4:n=ET;break;case 16:n=Ua;break;case 536870912:n=IT;break;default:n=Ua}n=WE(n,OE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function OE(t,e){if(Ta=-1,Ea=0,le&6)throw Error(G(327));var n=t.callbackNode;if(Qi()&&t.callbackNode!==n)return null;var r=ba(t,t===Ke?Ze:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nu(t,r);else{e=r;var i=le;le|=2;var o=GE();(Ke!==t||Ze!==e)&&(wn=null,so=Ue()+500,qr(t,e));do try{oR();break}catch(u){qE(t,u)}while(!0);mh(),ja.current=o,le=i,Be!==null?e=0:(Ke=null,Ze=0,e=Ge)}if(e!==0){if(e===2&&(i=Md(t),i!==0&&(r=i,e=of(t,i))),e===1)throw n=Hs,qr(t,0),Qn(t,r),Pt(t,Ue()),n;if(e===6)Qn(t,r);else{if(i=t.current.alternate,!(r&30)&&!rR(i)&&(e=nu(t,r),e===2&&(o=Md(t),o!==0&&(r=o,e=of(t,o))),e===1))throw n=Hs,qr(t,0),Qn(t,r),Pt(t,Ue()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:Dr(t,Ct,wn);break;case 3:if(Qn(t,r),(r&130023424)===r&&(e=Mh+500-Ue(),10<e)){if(ba(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){yt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bd(Dr.bind(null,t,Ct,wn),e);break}Dr(t,Ct,wn);break;case 4:if(Qn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-nn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=Ue()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nR(r/1960))-r,10<r){t.timeoutHandle=bd(Dr.bind(null,t,Ct,wn),r);break}Dr(t,Ct,wn);break;case 5:Dr(t,Ct,wn);break;default:throw Error(G(329))}}}return Pt(t,Ue()),t.callbackNode===n?OE.bind(null,t):null}function of(t,e){var n=Ts;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=nu(t,e),t!==2&&(e=Ct,Ct=n,e!==null&&sf(e)),t}function sf(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function rR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!on(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Qn(t,e){for(e&=~xh,e&=~Du,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-nn(e),r=1<<n;t[n]=-1,e&=~r}}function zg(t){if(le&6)throw Error(G(327));Qi();var e=ba(t,0);if(!(e&1))return Pt(t,Ue()),null;var n=nu(t,e);if(t.tag!==0&&n===2){var r=Md(t);r!==0&&(e=r,n=of(t,r))}if(n===1)throw n=Hs,qr(t,0),Qn(t,e),Pt(t,Ue()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Dr(t,Ct,wn),Pt(t,Ue()),null}function Dh(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(so=Ue()+500,Ru&&Ir())}}function Yr(t){jn!==null&&jn.tag===0&&!(le&6)&&Qi();var e=le;le|=1;var n=Kt.transition,r=fe;try{if(Kt.transition=null,fe=1,t)return t()}finally{fe=r,Kt.transition=n,le=e,!(le&6)&&Ir()}}function kh(){Dt=Gi.current,Ee(Gi)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NA(n)),Be!==null)for(n=Be.return;n!==null;){var r=n;switch(fh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$a();break;case 3:io(),Ee(At),Ee(ut),Eh();break;case 5:Th(r);break;case 4:io();break;case 13:Ee(Ae);break;case 19:Ee(Ae);break;case 10:gh(r.type._context);break;case 22:case 23:kh()}n=n.return}if(Ke=t,Be=t=ar(t.current,null),Ze=Dt=e,Ge=0,Hs=null,xh=Du=Qr=0,Ct=Ts=null,Br!==null){for(e=0;e<Br.length;e++)if(n=Br[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Br=null}return t}function qE(t,e){do{var n=Be;try{if(mh(),ya.current=Za,Xa){for(var r=Pe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xa=!1}if(Jr=0,He=qe=Pe=null,_s=!1,Gs=0,Ph.current=null,n===null||n.return===null){Ge=1,Hs=e,Be=null;break}e:{var o=t,s=n.return,u=n,c=e;if(e=Ze,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=u,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=Dg(s);if(_!==null){_.flags&=-257,kg(_,s,u,o,e),_.mode&1&&Mg(o,d,e),e=_,c=d;var w=e.updateQueue;if(w===null){var R=new Set;R.add(c),e.updateQueue=R}else w.add(c);break e}else{if(!(e&1)){Mg(o,d,e),Nh();break e}c=Error(G(426))}}else if(Ce&&u.mode&1){var k=Dg(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),kg(k,s,u,o,e),hh(oo(c,u));break e}}o=c=oo(c,u),Ge!==4&&(Ge=2),Ts===null?Ts=[o]:Ts.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var S=wE(o,c,e);wg(o,S);break e;case 1:u=c;var v=o.type,I=o.stateNode;if(!(o.flags&128)&&(typeof v.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(sr===null||!sr.has(I)))){o.flags|=65536,e&=-e,o.lanes|=e;var D=SE(o,u,e);wg(o,D);break e}}o=o.return}while(o!==null)}zE(n)}catch(F){e=F,Be===n&&n!==null&&(Be=n=n.return);continue}break}while(!0)}function GE(){var t=ja.current;return ja.current=Za,t===null?Za:t}function Nh(){(Ge===0||Ge===3||Ge===2)&&(Ge=4),Ke===null||!(Qr&268435455)&&!(Du&268435455)||Qn(Ke,Ze)}function nu(t,e){var n=le;le|=2;var r=GE();(Ke!==t||Ze!==e)&&(wn=null,qr(t,e));do try{iR();break}catch(i){qE(t,i)}while(!0);if(mh(),le=n,ja.current=r,Be!==null)throw Error(G(261));return Ke=null,Ze=0,Ge}function iR(){for(;Be!==null;)$E(Be)}function oR(){for(;Be!==null&&!MS();)$E(Be)}function $E(t){var e=KE(t.alternate,t,Dt);t.memoizedProps=t.pendingProps,e===null?zE(t):Be=e,Ph.current=null}function zE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ZA(n,e),n!==null){n.flags&=32767,Be=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ge=6,Be=null;return}}else if(n=XA(n,e,Dt),n!==null){Be=n;return}if(e=e.sibling,e!==null){Be=e;return}Be=e=t}while(e!==null);Ge===0&&(Ge=5)}function Dr(t,e,n){var r=fe,i=Kt.transition;try{Kt.transition=null,fe=1,sR(t,e,n,r)}finally{Kt.transition=i,fe=r}return null}function sR(t,e,n,r){do Qi();while(jn!==null);if(le&6)throw Error(G(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(OS(t,o),t===Ke&&(Be=Ke=null,Ze=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zl||(Zl=!0,WE(Ua,function(){return Qi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Kt.transition,Kt.transition=null;var s=fe;fe=1;var u=le;le|=4,Ph.current=null,eR(t,n),bE(n,t),AA(Fd),Ba=!!Ld,Fd=Ld=null,t.current=n,tR(n),DS(),le=u,fe=s,Kt.transition=o}else t.current=n;if(Zl&&(Zl=!1,jn=t,tu=i),o=t.pendingLanes,o===0&&(sr=null),VS(n.stateNode),Pt(t,Ue()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(eu)throw eu=!1,t=nf,nf=null,t;return tu&1&&t.tag!==0&&Qi(),o=t.pendingLanes,o&1?t===rf?Es++:(Es=0,rf=t):Es=0,Ir(),null}function Qi(){if(jn!==null){var t=wT(tu),e=Kt.transition,n=fe;try{if(Kt.transition=null,fe=16>t?16:t,jn===null)var r=!1;else{if(t=jn,jn=null,tu=0,le&6)throw Error(G(331));var i=le;for(le|=4,W=t.current;W!==null;){var o=W,s=o.child;if(W.flags&16){var u=o.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(W=d;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:vs(8,h,o)}var p=h.child;if(p!==null)p.return=h,W=p;else for(;W!==null;){h=W;var m=h.sibling,_=h.return;if(LE(h),h===d){W=null;break}if(m!==null){m.return=_,W=m;break}W=_}}}var w=o.alternate;if(w!==null){var R=w.child;if(R!==null){w.child=null;do{var k=R.sibling;R.sibling=null,R=k}while(R!==null)}}W=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,W=s;else e:for(;W!==null;){if(o=W,o.flags&2048)switch(o.tag){case 0:case 11:case 15:vs(9,o,o.return)}var S=o.sibling;if(S!==null){S.return=o.return,W=S;break e}W=o.return}}var v=t.current;for(W=v;W!==null;){s=W;var I=s.child;if(s.subtreeFlags&2064&&I!==null)I.return=s,W=I;else e:for(s=v;W!==null;){if(u=W,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Mu(9,u)}}catch(F){ke(u,u.return,F)}if(u===s){W=null;break e}var D=u.sibling;if(D!==null){D.return=u.return,W=D;break e}W=u.return}}if(le=i,Ir(),hn&&typeof hn.onPostCommitFiberRoot=="function")try{hn.onPostCommitFiberRoot(Iu,t)}catch{}r=!0}return r}finally{fe=n,Kt.transition=e}}return!1}function Hg(t,e,n){e=oo(n,e),e=wE(t,e,1),t=or(t,e,1),e=yt(),t!==null&&(sl(t,1,e),Pt(t,e))}function ke(t,e,n){if(t.tag===3)Hg(t,t,n);else for(;e!==null;){if(e.tag===3){Hg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sr===null||!sr.has(r))){t=oo(n,t),t=SE(e,t,1),e=or(e,t,1),t=yt(),e!==null&&(sl(e,1,t),Pt(e,t));break}}e=e.return}}function lR(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=yt(),t.pingedLanes|=t.suspendedLanes&n,Ke===t&&(Ze&n)===n&&(Ge===4||Ge===3&&(Ze&130023424)===Ze&&500>Ue()-Mh?qr(t,0):xh|=n),Pt(t,e)}function HE(t,e){e===0&&(t.mode&1?(e=Gl,Gl<<=1,!(Gl&130023424)&&(Gl=4194304)):e=1);var n=yt();t=Nn(t,e),t!==null&&(sl(t,e,n),Pt(t,n))}function aR(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),HE(t,n)}function uR(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),HE(t,n)}var KE;KE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||At.current)wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wt=!1,YA(t,e,n);wt=!!(t.flags&131072)}else wt=!1,Ce&&e.flags&1048576&&YT(e,Ka,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;va(t,e),t=e.pendingProps;var i=to(e,ut.current);Ji(e,n),i=Ch(null,e,r,t,i,n);var o=wh();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(r)?(o=!0,za(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_h(e),i.updater=xu,e.stateNode=i,i._reactInternals=e,Hd(e,r,t,n),e=Jd(null,e,r,!0,o,n)):(e.tag=0,Ce&&o&&dh(e),pt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(va(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=dR(r),t=jt(r,t),i){case 0:e=Wd(null,e,r,t,n);break e;case 1:e=Lg(null,e,r,t,n);break e;case 11:e=Ng(null,e,r,t,n);break e;case 14:e=Vg(null,e,r,jt(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jt(r,i),Wd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jt(r,i),Lg(t,e,r,i,n);case 3:e:{if(xE(e),t===null)throw Error(G(387));r=e.pendingProps,o=e.memoizedState,i=o.element,nE(t,e),Qa(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=oo(Error(G(423)),e),e=Fg(t,e,r,n,i);break e}else if(r!==i){i=oo(Error(G(424)),e),e=Fg(t,e,r,n,i);break e}else for(kt=ir(e.stateNode.containerInfo.firstChild),Lt=e,Ce=!0,tn=null,n=eE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(no(),r===i){e=Vn(t,e,n);break e}pt(t,e,r,n)}e=e.child}return e;case 5:return rE(e),t===null&&Gd(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Ud(r,i)?s=null:o!==null&&Ud(r,o)&&(e.flags|=32),PE(t,e),pt(t,e,s,n),e.child;case 6:return t===null&&Gd(e),null;case 13:return ME(t,e,n);case 4:return vh(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ro(e,null,r,n):pt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jt(r,i),Ng(t,e,r,i,n);case 7:return pt(t,e,e.pendingProps,n),e.child;case 8:return pt(t,e,e.pendingProps.children,n),e.child;case 12:return pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ge(Wa,r._currentValue),r._currentValue=s,o!==null)if(on(o.value,s)){if(o.children===i.children&&!At.current){e=Vn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){s=o.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=xn(-1,n&-n),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),$d(o.return,n,e),u.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(G(341));s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),$d(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}pt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ji(e,n),i=Qt(i),r=r(i),e.flags|=1,pt(t,e,r,n),e.child;case 14:return r=e.type,i=jt(r,e.pendingProps),i=jt(r.type,i),Vg(t,e,r,i,n);case 15:return AE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:jt(r,i),va(t,e),e.tag=1,Rt(r)?(t=!0,za(e)):t=!1,Ji(e,n),CE(e,r,i),Hd(e,r,i,n),Jd(null,e,r,!0,t,n);case 19:return DE(t,e,n);case 22:return RE(t,e,n)}throw Error(G(156,e.tag))};function WE(t,e){return TT(t,e)}function cR(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(t,e,n,r){return new cR(t,e,n,r)}function Vh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dR(t){if(typeof t=="function")return Vh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===jf)return 11;if(t===eh)return 14}return 2}function ar(t,e){var n=t.alternate;return n===null?(n=$t(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ia(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Vh(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ki:return Gr(n.children,i,o,e);case Zf:s=8,i|=8;break;case md:return t=$t(12,n,e,i|2),t.elementType=md,t.lanes=o,t;case gd:return t=$t(13,n,e,i),t.elementType=gd,t.lanes=o,t;case yd:return t=$t(19,n,e,i),t.elementType=yd,t.lanes=o,t;case rT:return ku(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case tT:s=10;break e;case nT:s=9;break e;case jf:s=11;break e;case eh:s=14;break e;case Kn:s=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=$t(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Gr(t,e,n,r){return t=$t(7,t,r,e),t.lanes=n,t}function ku(t,e,n,r){return t=$t(22,t,r,e),t.elementType=rT,t.lanes=n,t.stateNode={isHidden:!1},t}function Zc(t,e,n){return t=$t(6,t,null,e),t.lanes=n,t}function jc(t,e,n){return e=$t(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fR(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nc(0),this.expirationTimes=Nc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Lh(t,e,n,r,i,o,s,u,c){return t=new fR(t,e,n,u,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=$t(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},_h(o),t}function hR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Di,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function JE(t){if(!t)return mr;t=t._reactInternals;e:{if(ai(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Rt(n))return JT(t,n,e)}return e}function QE(t,e,n,r,i,o,s,u,c){return t=Lh(n,r,!0,t,i,o,s,u,c),t.context=JE(null),n=t.current,r=yt(),i=lr(n),o=xn(r,i),o.callback=e??null,or(n,o,i),t.current.lanes=i,sl(t,i,r),Pt(t,r),t}function Nu(t,e,n,r){var i=e.current,o=yt(),s=lr(i);return n=JE(n),e.context===null?e.context=n:e.pendingContext=n,e=xn(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=or(i,e,s),t!==null&&(rn(t,i,s,o),ga(t,i,s)),s}function ru(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Kg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Fh(t,e){Kg(t,e),(t=t.alternate)&&Kg(t,e)}function pR(){return null}var YE=typeof reportError=="function"?reportError:function(t){console.error(t)};function Uh(t){this._internalRoot=t}Vu.prototype.render=Uh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Nu(t,e,null,null)};Vu.prototype.unmount=Uh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yr(function(){Nu(null,t,null,null)}),e[kn]=null}};function Vu(t){this._internalRoot=t}Vu.prototype.unstable_scheduleHydration=function(t){if(t){var e=RT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jn.length&&e!==0&&e<Jn[n].priority;n++);Jn.splice(n,0,t),n===0&&xT(t)}};function bh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Wg(){}function mR(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var d=ru(s);o.call(d)}}var s=QE(e,r,t,0,null,!1,!1,"",Wg);return t._reactRootContainer=s,t[kn]=s.current,Us(t.nodeType===8?t.parentNode:t),Yr(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=ru(c);u.call(d)}}var c=Lh(t,0,!1,null,null,!1,!1,"",Wg);return t._reactRootContainer=c,t[kn]=c.current,Us(t.nodeType===8?t.parentNode:t),Yr(function(){Nu(e,c,n,r)}),c}function Fu(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var u=i;i=function(){var c=ru(s);u.call(c)}}Nu(e,s,t,i)}else s=mR(n,e,t,i,r);return ru(s)}ST=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ls(e.pendingLanes);n!==0&&(rh(e,n|1),Pt(e,Ue()),!(le&6)&&(so=Ue()+500,Ir()))}break;case 13:Yr(function(){var r=Nn(t,1);if(r!==null){var i=yt();rn(r,t,1,i)}}),Fh(t,1)}};ih=function(t){if(t.tag===13){var e=Nn(t,134217728);if(e!==null){var n=yt();rn(e,t,134217728,n)}Fh(t,134217728)}};AT=function(t){if(t.tag===13){var e=lr(t),n=Nn(t,e);if(n!==null){var r=yt();rn(n,t,e,r)}Fh(t,e)}};RT=function(){return fe};PT=function(t,e){var n=fe;try{return fe=t,e()}finally{fe=n}};Rd=function(t,e,n){switch(e){case"input":if(Td(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Au(r);if(!i)throw Error(G(90));oT(r),Td(r,i)}}}break;case"textarea":lT(t,n);break;case"select":e=n.value,e!=null&&zi(t,!!n.multiple,e,!1)}};pT=Dh;mT=Yr;var gR={usingClientEntryPoint:!1,Events:[al,Fi,Au,fT,hT,Dh]},Xo={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yR={bundleType:Xo.bundleType,version:Xo.version,rendererPackageName:Xo.rendererPackageName,rendererConfig:Xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Un.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=_T(t),t===null?null:t.stateNode},findFiberByHostInstance:Xo.findFiberByHostInstance||pR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jl.isDisabled&&jl.supportsFiber)try{Iu=jl.inject(yR),hn=jl}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gR;Bt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!bh(e))throw Error(G(200));return hR(t,e,null,n)};Bt.createRoot=function(t,e){if(!bh(t))throw Error(G(299));var n=!1,r="",i=YE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Lh(t,1,!1,null,null,n,!1,r,i),t[kn]=e.current,Us(t.nodeType===8?t.parentNode:t),new Uh(e)};Bt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=_T(e),t=t===null?null:t.stateNode,t};Bt.flushSync=function(t){return Yr(t)};Bt.hydrate=function(t,e,n){if(!Lu(e))throw Error(G(200));return Fu(null,t,e,!0,n)};Bt.hydrateRoot=function(t,e,n){if(!bh(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=YE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=QE(e,null,t,1,n??null,i,!1,o,s),t[kn]=e.current,Us(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Vu(e)};Bt.render=function(t,e,n){if(!Lu(e))throw Error(G(200));return Fu(null,t,e,!1,n)};Bt.unmountComponentAtNode=function(t){if(!Lu(t))throw Error(G(40));return t._reactRootContainer?(Yr(function(){Fu(null,null,t,!1,function(){t._reactRootContainer=null,t[kn]=null})}),!0):!1};Bt.unstable_batchedUpdates=Dh;Bt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lu(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Fu(t,e,n,!1,r)};Bt.version="18.3.1-next-f1338f8080-20240426";function XE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(XE)}catch(t){console.error(t)}}XE(),Xv.exports=Bt;var _R=Xv.exports,Jg=_R;hd.createRoot=Jg.createRoot,hd.hydrateRoot=Jg.hydrateRoot;const vR=({onAddPhotoClick:t,searchTerm:e,onSearchChange:n,isGridEmpty:r,onToggleFavorites:i,showFavorites:o})=>O.jsx("header",{className:"sticky top-0 z-20 p-4 bg-primary-bg/80 backdrop-blur-lg border-b border-accent-soft/50",children:O.jsxs("div",{className:"container mx-auto flex justify-between items-center gap-2 sm:gap-4",children:[O.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7 text-accent",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),O.jsx("h1",{className:"text-xl font-semibold text-primary-text hidden md:block",children:"Our Photo Diary"})]}),O.jsx("div",{className:"flex-1 w-full max-w-lg",children:O.jsx("input",{type:"text",placeholder:"Search memories...",value:e,onChange:s=>n(s.target.value),className:"w-full px-5 py-2 bg-secondary-bg/70 border border-accent-soft/60 rounded-full text-primary-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-accent transition-all duration-300 shadow-inner shadow-accent-soft/20 text-sm"})}),O.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[O.jsx("button",{onClick:i,className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 group ${o?"bg-accent/20":"hover:bg-accent/10"}`,"aria-label":"Show favorites",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transition-all duration-300 ${o?"text-accent":"text-accent/70 group-hover:text-accent"}`,viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})})}),O.jsx("button",{onClick:t,className:`bg-accent hover:bg-accent-hover text-white font-bold w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 shadow-lg shadow-accent/30 hover:shadow-accent/50 transform hover:scale-110 shrink-0 ${r?"animate-soft-pulse":""}`,"aria-label":"Add new memory",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})})]})]})}),TR=({photo:t,onDelete:e,onFavorite:n,onClick:r,index:i})=>{const o=c=>{c.preventDefault(),c.stopPropagation(),window.confirm("Are you sure you want to delete this memory? This action cannot be undone.")&&e(t)},s=c=>{c.preventDefault(),c.stopPropagation(),n(t)},u=c=>{if(!c||!c.toDate)return"Just now";const d=c.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(d)};return O.jsxs("div",{className:"relative group overflow-hidden rounded-xl mb-4 break-inside-avoid shadow-gentle hover:shadow-gentle-lg transition-all duration-300 bg-secondary-bg cursor-pointer opacity-0 animate-fade-in-up",onClick:()=>r(t),style:{animationDelay:`${i*50}ms`},children:[O.jsx("img",{src:t.imageUrl,alt:t.description||"Photo diary entry",className:"w-full h-auto object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),O.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),O.jsxs("div",{className:"absolute bottom-0 left-0 p-4 w-full text-white transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300",children:[O.jsx("p",{className:"text-sm font-semibold opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100",children:t.description}),O.jsx("p",{className:"text-xs mt-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-200",children:u(t.createdAt)}),t.tags&&t.tags.length>0&&O.jsx("div",{className:"flex flex-wrap gap-1 mt-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-300",children:t.tags.map(c=>O.jsx("span",{className:"text-xs bg-white/20 backdrop-blur-sm px-2 py-0.5 rounded-full",children:c},c))})]}),O.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:[O.jsx("button",{onClick:s,"aria-label":"Favorite photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-colors duration-200",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",className:`transition-opacity ${t.isFavorite?"opacity-100 text-accent":"opacity-60"}`,clipRule:"evenodd"})})}),O.jsx("button",{onClick:o,"aria-label":"Delete photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-white hover:bg-red-500 focus:outline-none transition-colors duration-200",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})},ZE=()=>O.jsxs("div",{className:"flex justify-center items-center h-full",children:[O.jsx("svg",{className:"h-10 w-10 text-accent",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",style:{animation:"pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),O.jsx("style",{children:`
          @keyframes pulse {
            0%, 100% {
              opacity: 1;
              transform: scale(1);
            }
            50% {
              opacity: 0.7;
              transform: scale(0.9);
            }
          }
        `})]}),ER=({photos:t,loading:e,error:n,onDeletePhoto:r,onFavoritePhoto:i,onPhotoClick:o})=>e?O.jsx("div",{className:"mt-20",children:O.jsx(ZE,{})}):n?O.jsxs("div",{className:"text-center text-red-800 bg-red-100 border border-red-300 p-6 rounded-xl mt-10 max-w-2xl mx-auto shadow-gentle",children:[O.jsx("p",{className:"font-bold text-xl text-red-900",children:"Oh no, something went wrong!"}),O.jsx("p",{className:"text-sm mt-2",children:n})]}):t.length===0?O.jsxs("div",{className:"text-center text-secondary-text mt-20 bg-secondary-bg/50 p-10 rounded-xl max-w-md mx-auto border border-accent-soft/40 shadow-gentle flex flex-col items-center",children:[O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-20 w-20 text-accent-soft mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),O.jsx("h2",{className:"text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400",children:"Our Story Awaits"}),O.jsx("p",{className:"mt-2",children:"Click the pink '+' button to add our first memory!"})]}):O.jsx("div",{className:"w-full mx-auto columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-4 md:gap-6",children:t.map((s,u)=>O.jsx(TR,{photo:s,onDelete:r,onFavorite:i,onClick:o,index:u},s.id))});var Qg={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},IR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],s=t[n++],u=t[n++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const o=t[n++],s=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},eI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,u=s?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,h=o>>2,p=(o&3)<<4|u>>4;let m=(u&15)<<2|d>>6,_=d&63;c||(_=64,s||(m=64)),r.push(n[h],n[p],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):IR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||u==null||d==null||p==null)throw new CR;const m=o<<2|u>>4;if(r.push(m),d!==64){const _=u<<4&240|d>>2;if(r.push(_),p!==64){const w=d<<6&192|p;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wR=function(t){const e=jE(t);return eI.encodeByteArray(e,!0)},iu=function(t){return wR(t).replace(/\./g,"")},SR=function(t){try{return eI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR=()=>AR().__FIREBASE_DEFAULTS__,PR=()=>{if(typeof process>"u"||typeof Qg>"u")return;const t=Qg.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&SR(t[1]);return e&&JSON.parse(e)},Bh=()=>{try{return RR()||PR()||xR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},MR=t=>{var e,n;return(n=(e=Bh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},tI=t=>{const e=MR(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},nI=()=>{var t;return(t=Bh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[iu(JSON.stringify(n)),iu(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kR(){var t;const e=(t=Bh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iI(){return!kR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oI(){try{return typeof indexedDB=="object"}catch{return!1}}function NR(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VR="FirebaseError";class ui extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=VR,Object.setPrototypeOf(this,ui.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,sI.prototype.create)}}class sI{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?LR(o,r):"Error",u=`${this.serviceName}: ${s} (${i}).`;return new ui(i,u,r)}}function LR(t,e){return t.replace(FR,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FR=/\{\$([^}]+)}/g;function lf(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],s=e[i];if(Yg(o)&&Yg(s)){if(!lf(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Yg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t){return t&&t._delegate?t._delegate:t}class lo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new DR;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(BR(e))try{this.getOrInitializeService({instanceIdentifier:kr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kr){return this.instances.has(e)}getOptions(e=kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,s]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&s.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:bR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kr){return this.component?this.component.multipleInstances?e:kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function bR(t){return t===kr?void 0:t}function BR(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new UR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(se||(se={}));const qR={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},GR=se.INFO,$R={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},zR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=$R[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class lI{constructor(e){this.name=e,this._logLevel=GR,this._logHandler=zR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?qR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}}const HR=(t,e)=>e.some(n=>t instanceof n);let Xg,Zg;function KR(){return Xg||(Xg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function WR(){return Zg||(Zg=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const aI=new WeakMap,af=new WeakMap,uI=new WeakMap,ed=new WeakMap,Oh=new WeakMap;function JR(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(ur(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&aI.set(n,t)}).catch(()=>{}),Oh.set(e,t),e}function QR(t){if(af.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});af.set(t,e)}let uf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return af.get(t);if(e==="objectStoreNames")return t.objectStoreNames||uI.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ur(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function YR(t){uf=t(uf)}function XR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(td(this),e,...n);return uI.set(r,e.sort?e.sort():[e]),ur(r)}:WR().includes(t)?function(...e){return t.apply(td(this),e),ur(aI.get(this))}:function(...e){return ur(t.apply(td(this),e))}}function ZR(t){return typeof t=="function"?XR(t):(t instanceof IDBTransaction&&QR(t),HR(t,KR())?new Proxy(t,uf):t)}function ur(t){if(t instanceof IDBRequest)return JR(t);if(ed.has(t))return ed.get(t);const e=ZR(t);return e!==t&&(ed.set(t,e),Oh.set(e,t)),e}const td=t=>Oh.get(t);function jR(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),u=ur(s);return r&&s.addEventListener("upgradeneeded",c=>{r(ur(s.result),c.oldVersion,c.newVersion,ur(s.transaction),c)}),n&&s.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const eP=["get","getKey","getAll","getAllKeys","count"],tP=["put","add","delete","clear"],nd=new Map;function jg(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(nd.get(e))return nd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=tP.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||eP.includes(n)))return;const o=async function(s,...u){const c=this.transaction(s,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),i&&c.done]))[0]};return nd.set(e,o),o}YR(t=>({...t,get:(e,n,r)=>jg(e,n)||t.get(e,n,r),has:(e,n)=>!!jg(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(rP(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function rP(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const cf="@firebase/app",ey="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ln=new lI("@firebase/app"),iP="@firebase/app-compat",oP="@firebase/analytics-compat",sP="@firebase/analytics",lP="@firebase/app-check-compat",aP="@firebase/app-check",uP="@firebase/auth",cP="@firebase/auth-compat",dP="@firebase/database",fP="@firebase/data-connect",hP="@firebase/database-compat",pP="@firebase/functions",mP="@firebase/functions-compat",gP="@firebase/installations",yP="@firebase/installations-compat",_P="@firebase/messaging",vP="@firebase/messaging-compat",TP="@firebase/performance",EP="@firebase/performance-compat",IP="@firebase/remote-config",CP="@firebase/remote-config-compat",wP="@firebase/storage",SP="@firebase/storage-compat",AP="@firebase/firestore",RP="@firebase/vertexai-preview",PP="@firebase/firestore-compat",xP="firebase",MP="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df="[DEFAULT]",DP={[cf]:"fire-core",[iP]:"fire-core-compat",[sP]:"fire-analytics",[oP]:"fire-analytics-compat",[aP]:"fire-app-check",[lP]:"fire-app-check-compat",[uP]:"fire-auth",[cP]:"fire-auth-compat",[dP]:"fire-rtdb",[fP]:"fire-data-connect",[hP]:"fire-rtdb-compat",[pP]:"fire-fn",[mP]:"fire-fn-compat",[gP]:"fire-iid",[yP]:"fire-iid-compat",[_P]:"fire-fcm",[vP]:"fire-fcm-compat",[TP]:"fire-perf",[EP]:"fire-perf-compat",[IP]:"fire-rc",[CP]:"fire-rc-compat",[wP]:"fire-gcs",[SP]:"fire-gcs-compat",[AP]:"fire-fst",[PP]:"fire-fst-compat",[RP]:"fire-vertex","fire-js":"fire-js",[xP]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=new Map,kP=new Map,ff=new Map;function ty(t,e){try{t.container.addComponent(e)}catch(n){Ln.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ks(t){const e=t.name;if(ff.has(e))return Ln.debug(`There were multiple attempts to register component ${e}.`),!1;ff.set(e,t);for(const n of su.values())ty(n,t);for(const n of kP.values())ty(n,t);return!0}function cI(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NP={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cr=new sI("app","Firebase",NP);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VP{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dI=MP;function fI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:df,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw cr.create("bad-app-name",{appName:String(i)});if(n||(n=nI()),!n)throw cr.create("no-options");const o=su.get(i);if(o){if(lf(n,o.options)&&lf(r,o.config))return o;throw cr.create("duplicate-app",{appName:i})}const s=new OR(i);for(const c of ff.values())s.addComponent(c);const u=new VP(n,r,s);return su.set(i,u),u}function hI(t=df){const e=su.get(t);if(!e&&t===df&&nI())return fI();if(!e)throw cr.create("no-app",{appName:t});return e}function dr(t,e,n){var r;let i=(r=DP[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&u.push("and"),s&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ln.warn(u.join(" "));return}Ks(new lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LP="firebase-heartbeat-database",FP=1,Ws="firebase-heartbeat-store";let rd=null;function pI(){return rd||(rd=jR(LP,FP,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ws)}catch(n){console.warn(n)}}}}).catch(t=>{throw cr.create("idb-open",{originalErrorMessage:t.message})})),rd}async function UP(t){try{const n=(await pI()).transaction(Ws),r=await n.objectStore(Ws).get(mI(t));return await n.done,r}catch(e){if(e instanceof ui)Ln.warn(e.message);else{const n=cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ln.warn(n.message)}}}async function ny(t,e){try{const r=(await pI()).transaction(Ws,"readwrite");await r.objectStore(Ws).put(e,mI(t)),await r.done}catch(n){if(n instanceof ui)Ln.warn(n.message);else{const r=cr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ln.warn(r.message)}}}function mI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bP=1024,BP=30*24*60*60*1e3;class OP{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new GP(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=ry();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const u=new Date(s.date).valueOf();return Date.now()-u<=BP}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ln.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ry(),{heartbeatsToSend:r,unsentEntries:i}=qP(this._heartbeatsCache.heartbeats),o=iu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Ln.warn(n),""}}}function ry(){return new Date().toISOString().substring(0,10)}function qP(t,e=bP){const n=[];let r=t.slice();for(const i of t){const o=n.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),iy(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),iy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class GP{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oI()?NR().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await UP(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ny(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ny(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function iy(t){return iu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $P(t){Ks(new lo("platform-logger",e=>new nP(e),"PRIVATE")),Ks(new lo("heartbeat",e=>new OP(e),"PRIVATE")),dr(cf,ey,t),dr(cf,ey,"esm2017"),dr("fire-js","")}$P("");var oy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,gI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,E){function A(){}A.prototype=E.prototype,C.D=E.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(P,M,N){for(var x=Array(arguments.length-2),ct=2;ct<arguments.length;ct++)x[ct-2]=arguments[ct];return E.prototype[M].apply(P,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,E,A){A||(A=0);var P=Array(16);if(typeof E=="string")for(var M=0;16>M;++M)P[M]=E.charCodeAt(A++)|E.charCodeAt(A++)<<8|E.charCodeAt(A++)<<16|E.charCodeAt(A++)<<24;else for(M=0;16>M;++M)P[M]=E[A++]|E[A++]<<8|E[A++]<<16|E[A++]<<24;E=C.g[0],A=C.g[1],M=C.g[2];var N=C.g[3],x=E+(N^A&(M^N))+P[0]+3614090360&4294967295;E=A+(x<<7&4294967295|x>>>25),x=N+(M^E&(A^M))+P[1]+3905402710&4294967295,N=E+(x<<12&4294967295|x>>>20),x=M+(A^N&(E^A))+P[2]+606105819&4294967295,M=N+(x<<17&4294967295|x>>>15),x=A+(E^M&(N^E))+P[3]+3250441966&4294967295,A=M+(x<<22&4294967295|x>>>10),x=E+(N^A&(M^N))+P[4]+4118548399&4294967295,E=A+(x<<7&4294967295|x>>>25),x=N+(M^E&(A^M))+P[5]+1200080426&4294967295,N=E+(x<<12&4294967295|x>>>20),x=M+(A^N&(E^A))+P[6]+2821735955&4294967295,M=N+(x<<17&4294967295|x>>>15),x=A+(E^M&(N^E))+P[7]+4249261313&4294967295,A=M+(x<<22&4294967295|x>>>10),x=E+(N^A&(M^N))+P[8]+1770035416&4294967295,E=A+(x<<7&4294967295|x>>>25),x=N+(M^E&(A^M))+P[9]+2336552879&4294967295,N=E+(x<<12&4294967295|x>>>20),x=M+(A^N&(E^A))+P[10]+4294925233&4294967295,M=N+(x<<17&4294967295|x>>>15),x=A+(E^M&(N^E))+P[11]+2304563134&4294967295,A=M+(x<<22&4294967295|x>>>10),x=E+(N^A&(M^N))+P[12]+1804603682&4294967295,E=A+(x<<7&4294967295|x>>>25),x=N+(M^E&(A^M))+P[13]+4254626195&4294967295,N=E+(x<<12&4294967295|x>>>20),x=M+(A^N&(E^A))+P[14]+2792965006&4294967295,M=N+(x<<17&4294967295|x>>>15),x=A+(E^M&(N^E))+P[15]+1236535329&4294967295,A=M+(x<<22&4294967295|x>>>10),x=E+(M^N&(A^M))+P[1]+4129170786&4294967295,E=A+(x<<5&4294967295|x>>>27),x=N+(A^M&(E^A))+P[6]+3225465664&4294967295,N=E+(x<<9&4294967295|x>>>23),x=M+(E^A&(N^E))+P[11]+643717713&4294967295,M=N+(x<<14&4294967295|x>>>18),x=A+(N^E&(M^N))+P[0]+3921069994&4294967295,A=M+(x<<20&4294967295|x>>>12),x=E+(M^N&(A^M))+P[5]+3593408605&4294967295,E=A+(x<<5&4294967295|x>>>27),x=N+(A^M&(E^A))+P[10]+38016083&4294967295,N=E+(x<<9&4294967295|x>>>23),x=M+(E^A&(N^E))+P[15]+3634488961&4294967295,M=N+(x<<14&4294967295|x>>>18),x=A+(N^E&(M^N))+P[4]+3889429448&4294967295,A=M+(x<<20&4294967295|x>>>12),x=E+(M^N&(A^M))+P[9]+568446438&4294967295,E=A+(x<<5&4294967295|x>>>27),x=N+(A^M&(E^A))+P[14]+3275163606&4294967295,N=E+(x<<9&4294967295|x>>>23),x=M+(E^A&(N^E))+P[3]+4107603335&4294967295,M=N+(x<<14&4294967295|x>>>18),x=A+(N^E&(M^N))+P[8]+1163531501&4294967295,A=M+(x<<20&4294967295|x>>>12),x=E+(M^N&(A^M))+P[13]+2850285829&4294967295,E=A+(x<<5&4294967295|x>>>27),x=N+(A^M&(E^A))+P[2]+4243563512&4294967295,N=E+(x<<9&4294967295|x>>>23),x=M+(E^A&(N^E))+P[7]+1735328473&4294967295,M=N+(x<<14&4294967295|x>>>18),x=A+(N^E&(M^N))+P[12]+2368359562&4294967295,A=M+(x<<20&4294967295|x>>>12),x=E+(A^M^N)+P[5]+4294588738&4294967295,E=A+(x<<4&4294967295|x>>>28),x=N+(E^A^M)+P[8]+2272392833&4294967295,N=E+(x<<11&4294967295|x>>>21),x=M+(N^E^A)+P[11]+1839030562&4294967295,M=N+(x<<16&4294967295|x>>>16),x=A+(M^N^E)+P[14]+4259657740&4294967295,A=M+(x<<23&4294967295|x>>>9),x=E+(A^M^N)+P[1]+2763975236&4294967295,E=A+(x<<4&4294967295|x>>>28),x=N+(E^A^M)+P[4]+1272893353&4294967295,N=E+(x<<11&4294967295|x>>>21),x=M+(N^E^A)+P[7]+4139469664&4294967295,M=N+(x<<16&4294967295|x>>>16),x=A+(M^N^E)+P[10]+3200236656&4294967295,A=M+(x<<23&4294967295|x>>>9),x=E+(A^M^N)+P[13]+681279174&4294967295,E=A+(x<<4&4294967295|x>>>28),x=N+(E^A^M)+P[0]+3936430074&4294967295,N=E+(x<<11&4294967295|x>>>21),x=M+(N^E^A)+P[3]+3572445317&4294967295,M=N+(x<<16&4294967295|x>>>16),x=A+(M^N^E)+P[6]+76029189&4294967295,A=M+(x<<23&4294967295|x>>>9),x=E+(A^M^N)+P[9]+3654602809&4294967295,E=A+(x<<4&4294967295|x>>>28),x=N+(E^A^M)+P[12]+3873151461&4294967295,N=E+(x<<11&4294967295|x>>>21),x=M+(N^E^A)+P[15]+530742520&4294967295,M=N+(x<<16&4294967295|x>>>16),x=A+(M^N^E)+P[2]+3299628645&4294967295,A=M+(x<<23&4294967295|x>>>9),x=E+(M^(A|~N))+P[0]+4096336452&4294967295,E=A+(x<<6&4294967295|x>>>26),x=N+(A^(E|~M))+P[7]+1126891415&4294967295,N=E+(x<<10&4294967295|x>>>22),x=M+(E^(N|~A))+P[14]+2878612391&4294967295,M=N+(x<<15&4294967295|x>>>17),x=A+(N^(M|~E))+P[5]+4237533241&4294967295,A=M+(x<<21&4294967295|x>>>11),x=E+(M^(A|~N))+P[12]+1700485571&4294967295,E=A+(x<<6&4294967295|x>>>26),x=N+(A^(E|~M))+P[3]+2399980690&4294967295,N=E+(x<<10&4294967295|x>>>22),x=M+(E^(N|~A))+P[10]+4293915773&4294967295,M=N+(x<<15&4294967295|x>>>17),x=A+(N^(M|~E))+P[1]+2240044497&4294967295,A=M+(x<<21&4294967295|x>>>11),x=E+(M^(A|~N))+P[8]+1873313359&4294967295,E=A+(x<<6&4294967295|x>>>26),x=N+(A^(E|~M))+P[15]+4264355552&4294967295,N=E+(x<<10&4294967295|x>>>22),x=M+(E^(N|~A))+P[6]+2734768916&4294967295,M=N+(x<<15&4294967295|x>>>17),x=A+(N^(M|~E))+P[13]+1309151649&4294967295,A=M+(x<<21&4294967295|x>>>11),x=E+(M^(A|~N))+P[4]+4149444226&4294967295,E=A+(x<<6&4294967295|x>>>26),x=N+(A^(E|~M))+P[11]+3174756917&4294967295,N=E+(x<<10&4294967295|x>>>22),x=M+(E^(N|~A))+P[2]+718787259&4294967295,M=N+(x<<15&4294967295|x>>>17),x=A+(N^(M|~E))+P[9]+3951481745&4294967295,C.g[0]=C.g[0]+E&4294967295,C.g[1]=C.g[1]+(M+(x<<21&4294967295|x>>>11))&4294967295,C.g[2]=C.g[2]+M&4294967295,C.g[3]=C.g[3]+N&4294967295}r.prototype.u=function(C,E){E===void 0&&(E=C.length);for(var A=E-this.blockSize,P=this.B,M=this.h,N=0;N<E;){if(M==0)for(;N<=A;)i(this,C,N),N+=this.blockSize;if(typeof C=="string"){for(;N<E;)if(P[M++]=C.charCodeAt(N++),M==this.blockSize){i(this,P),M=0;break}}else for(;N<E;)if(P[M++]=C[N++],M==this.blockSize){i(this,P),M=0;break}}this.h=M,this.o+=E},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var E=1;E<C.length-8;++E)C[E]=0;var A=8*this.o;for(E=C.length-8;E<C.length;++E)C[E]=A&255,A/=256;for(this.u(C),C=Array(16),E=A=0;4>E;++E)for(var P=0;32>P;P+=8)C[A++]=this.g[E]>>>P&255;return C};function o(C,E){var A=u;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=E(C)}function s(C,E){this.h=E;for(var A=[],P=!0,M=C.length-1;0<=M;M--){var N=C[M]|0;P&&N==E||(A[M]=N,P=!1)}this.g=A}var u={};function c(C){return-128<=C&&128>C?o(C,function(E){return new s([E|0],0>E?-1:0)}):new s([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return p;if(0>C)return k(d(-C));for(var E=[],A=1,P=0;C>=A;P++)E[P]=C/A|0,A*=4294967296;return new s(E,0)}function h(C,E){if(C.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(C.charAt(0)=="-")return k(h(C.substring(1),E));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=d(Math.pow(E,8)),P=p,M=0;M<C.length;M+=8){var N=Math.min(8,C.length-M),x=parseInt(C.substring(M,M+N),E);8>N?(N=d(Math.pow(E,N)),P=P.j(N).add(d(x))):(P=P.j(A),P=P.add(d(x)))}return P}var p=c(0),m=c(1),_=c(16777216);t=s.prototype,t.m=function(){if(R(this))return-k(this).m();for(var C=0,E=1,A=0;A<this.g.length;A++){var P=this.i(A);C+=(0<=P?P:4294967296+P)*E,E*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(R(this))return"-"+k(this).toString(C);for(var E=d(Math.pow(C,6)),A=this,P="";;){var M=D(A,E).g;A=S(A,M.j(E));var N=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=M,w(A))return N+P;for(;6>N.length;)N="0"+N;P=N+P}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(var E=0;E<C.g.length;E++)if(C.g[E]!=0)return!1;return!0}function R(C){return C.h==-1}t.l=function(C){return C=S(this,C),R(C)?-1:w(C)?0:1};function k(C){for(var E=C.g.length,A=[],P=0;P<E;P++)A[P]=~C.g[P];return new s(A,~C.h).add(m)}t.abs=function(){return R(this)?k(this):this},t.add=function(C){for(var E=Math.max(this.g.length,C.g.length),A=[],P=0,M=0;M<=E;M++){var N=P+(this.i(M)&65535)+(C.i(M)&65535),x=(N>>>16)+(this.i(M)>>>16)+(C.i(M)>>>16);P=x>>>16,N&=65535,x&=65535,A[M]=x<<16|N}return new s(A,A[A.length-1]&-2147483648?-1:0)};function S(C,E){return C.add(k(E))}t.j=function(C){if(w(this)||w(C))return p;if(R(this))return R(C)?k(this).j(k(C)):k(k(this).j(C));if(R(C))return k(this.j(k(C)));if(0>this.l(_)&&0>C.l(_))return d(this.m()*C.m());for(var E=this.g.length+C.g.length,A=[],P=0;P<2*E;P++)A[P]=0;for(P=0;P<this.g.length;P++)for(var M=0;M<C.g.length;M++){var N=this.i(P)>>>16,x=this.i(P)&65535,ct=C.i(M)>>>16,We=C.i(M)&65535;A[2*P+2*M]+=x*We,v(A,2*P+2*M),A[2*P+2*M+1]+=N*We,v(A,2*P+2*M+1),A[2*P+2*M+1]+=x*ct,v(A,2*P+2*M+1),A[2*P+2*M+2]+=N*ct,v(A,2*P+2*M+2)}for(P=0;P<E;P++)A[P]=A[2*P+1]<<16|A[2*P];for(P=E;P<2*E;P++)A[P]=0;return new s(A,0)};function v(C,E){for(;(C[E]&65535)!=C[E];)C[E+1]+=C[E]>>>16,C[E]&=65535,E++}function I(C,E){this.g=C,this.h=E}function D(C,E){if(w(E))throw Error("division by zero");if(w(C))return new I(p,p);if(R(C))return E=D(k(C),E),new I(k(E.g),k(E.h));if(R(E))return E=D(C,k(E)),new I(k(E.g),E.h);if(30<C.g.length){if(R(C)||R(E))throw Error("slowDivide_ only works with positive integers.");for(var A=m,P=E;0>=P.l(C);)A=F(A),P=F(P);var M=U(A,1),N=U(P,1);for(P=U(P,2),A=U(A,2);!w(P);){var x=N.add(P);0>=x.l(C)&&(M=M.add(A),N=x),P=U(P,1),A=U(A,1)}return E=S(C,M.j(E)),new I(M,E)}for(M=p;0<=C.l(E);){for(A=Math.max(1,Math.floor(C.m()/E.m())),P=Math.ceil(Math.log(A)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),N=d(A),x=N.j(E);R(x)||0<x.l(C);)A-=P,N=d(A),x=N.j(E);w(N)&&(N=m),M=M.add(N),C=S(C,x)}return new I(M,C)}t.A=function(C){return D(this,C).h},t.and=function(C){for(var E=Math.max(this.g.length,C.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)&C.i(P);return new s(A,this.h&C.h)},t.or=function(C){for(var E=Math.max(this.g.length,C.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)|C.i(P);return new s(A,this.h|C.h)},t.xor=function(C){for(var E=Math.max(this.g.length,C.g.length),A=[],P=0;P<E;P++)A[P]=this.i(P)^C.i(P);return new s(A,this.h^C.h)};function F(C){for(var E=C.g.length+1,A=[],P=0;P<E;P++)A[P]=C.i(P)<<1|C.i(P-1)>>>31;return new s(A,C.h)}function U(C,E){var A=E>>5;E%=32;for(var P=C.g.length-A,M=[],N=0;N<P;N++)M[N]=0<E?C.i(N+A)>>>E|C.i(N+A+1)<<32-E:C.i(N+A);return new s(M,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,gI=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=h,$r=s}).apply(typeof oy<"u"?oy:typeof self<"u"?self:typeof window<"u"?window:{});var ea=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var yI,us,_I,Ca,hf,vI,TI,EI;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,g,y){return f==Array.prototype||f==Object.prototype||(f[g]=y.value),f};function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof ea=="object"&&ea];for(var g=0;g<f.length;++g){var y=f[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(f,g){if(g)e:{var y=r;f=f.split(".");for(var T=0;T<f.length-1;T++){var V=f[T];if(!(V in y))break e;y=y[V]}f=f[f.length-1],T=y[f],g=g(T),g!=T&&g!=null&&e(y,f,{configurable:!0,writable:!0,value:g})}}function o(f,g){f instanceof String&&(f+="");var y=0,T=!1,V={next:function(){if(!T&&y<f.length){var b=y++;return{value:g(b,f[b]),done:!1}}return T=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(f){return f||function(){return o(this,function(g,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},u=this||self;function c(f){var g=typeof f;return g=g!="object"?g:f?Array.isArray(f)?"array":g:"null",g=="array"||g=="object"&&typeof f.length=="number"}function d(f){var g=typeof f;return g=="object"&&f!=null||g=="function"}function h(f,g,y){return f.call.apply(f.bind,arguments)}function p(f,g,y){if(!f)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,T),f.apply(g,V)}}return function(){return f.apply(g,arguments)}}function m(f,g,y){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function _(f,g){var y=Array.prototype.slice.call(arguments,1);return function(){var T=y.slice();return T.push.apply(T,arguments),f.apply(this,T)}}function w(f,g){function y(){}y.prototype=g.prototype,f.aa=g.prototype,f.prototype=new y,f.prototype.constructor=f,f.Qb=function(T,V,b){for(var $=Array(arguments.length-2),me=2;me<arguments.length;me++)$[me-2]=arguments[me];return g.prototype[V].apply(T,$)}}function R(f){const g=f.length;if(0<g){const y=Array(g);for(let T=0;T<g;T++)y[T]=f[T];return y}return[]}function k(f,g){for(let y=1;y<arguments.length;y++){const T=arguments[y];if(c(T)){const V=f.length||0,b=T.length||0;f.length=V+b;for(let $=0;$<b;$++)f[V+$]=T[$]}else f.push(T)}}class S{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(f){return/^[\s\xa0]*$/.test(f)}function I(){var f=u.navigator;return f&&(f=f.userAgent)?f:""}function D(f){return D[" "](f),f}D[" "]=function(){};var F=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function U(f,g,y){for(const T in f)g.call(y,f[T],T,f)}function C(f,g){for(const y in f)g.call(void 0,f[y],y,f)}function E(f){const g={};for(const y in f)g[y]=f[y];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(f,g){let y,T;for(let V=1;V<arguments.length;V++){T=arguments[V];for(y in T)f[y]=T[y];for(let b=0;b<A.length;b++)y=A[b],Object.prototype.hasOwnProperty.call(T,y)&&(f[y]=T[y])}}function M(f){var g=1;f=f.split(":");const y=[];for(;0<g&&f.length;)y.push(f.shift()),g--;return f.length&&y.push(f.join(":")),y}function N(f){u.setTimeout(()=>{throw f},0)}function x(){var f=Z;let g=null;return f.g&&(g=f.g,f.g=f.g.next,f.g||(f.h=null),g.next=null),g}class ct{constructor(){this.h=this.g=null}add(g,y){const T=We.get();T.set(g,y),this.h?this.h.next=T:this.g=T,this.h=T}}var We=new S(()=>new gn,f=>f.reset());class gn{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let yn,K=!1,Z=new ct,te=()=>{const f=u.Promise.resolve(void 0);yn=()=>{f.then(Se)}};var Se=()=>{for(var f;f=x();){try{f.h.call(f.g)}catch(y){N(y)}var g=We;g.j(f),100>g.h&&(g.h++,f.next=g.g,g.g=f)}K=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Fe(f,g){this.type=f,this.g=this.target=g,this.defaultPrevented=!1}Fe.prototype.h=function(){this.defaultPrevented=!0};var _n=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,g=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const y=()=>{};u.addEventListener("test",y,g),u.removeEventListener("test",y,g)}catch{}return f}();function vn(f,g){if(Fe.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var y=this.type=f.type,T=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=g,g=f.relatedTarget){if(F){e:{try{D(g.nodeName);var V=!0;break e}catch{}V=!1}V||(g=null)}}else y=="mouseover"?g=f.fromElement:y=="mouseout"&&(g=f.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:Tn[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&vn.aa.h.call(this)}}w(vn,Fe);var Tn={2:"touch",3:"pen",4:"mouse"};vn.prototype.h=function(){vn.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var En="closure_listenable_"+(1e6*Math.random()|0),p0=0;function m0(f,g,y,T,V){this.listener=f,this.proxy=null,this.src=g,this.type=y,this.capture=!!T,this.ha=V,this.key=++p0,this.da=this.fa=!1}function vl(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Tl(f){this.src=f,this.g={},this.h=0}Tl.prototype.add=function(f,g,y,T,V){var b=f.toString();f=this.g[b],f||(f=this.g[b]=[],this.h++);var $=sc(f,g,T,V);return-1<$?(g=f[$],y||(g.fa=!1)):(g=new m0(g,this.src,b,!!T,V),g.fa=y,f.push(g)),g};function oc(f,g){var y=g.type;if(y in f.g){var T=f.g[y],V=Array.prototype.indexOf.call(T,g,void 0),b;(b=0<=V)&&Array.prototype.splice.call(T,V,1),b&&(vl(g),f.g[y].length==0&&(delete f.g[y],f.h--))}}function sc(f,g,y,T){for(var V=0;V<f.length;++V){var b=f[V];if(!b.da&&b.listener==g&&b.capture==!!y&&b.ha==T)return V}return-1}var lc="closure_lm_"+(1e6*Math.random()|0),ac={};function qp(f,g,y,T,V){if(Array.isArray(g)){for(var b=0;b<g.length;b++)qp(f,g[b],y,T,V);return null}return y=zp(y),f&&f[En]?f.K(g,y,d(T)?!!T.capture:!1,V):g0(f,g,y,!1,T,V)}function g0(f,g,y,T,V,b){if(!g)throw Error("Invalid event type");var $=d(V)?!!V.capture:!!V,me=cc(f);if(me||(f[lc]=me=new Tl(f)),y=me.add(g,y,T,$,b),y.proxy)return y;if(T=y0(),y.proxy=T,T.src=f,T.listener=y,f.addEventListener)_n||(V=$),V===void 0&&(V=!1),f.addEventListener(g.toString(),T,V);else if(f.attachEvent)f.attachEvent($p(g.toString()),T);else if(f.addListener&&f.removeListener)f.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return y}function y0(){function f(y){return g.call(f.src,f.listener,y)}const g=_0;return f}function Gp(f,g,y,T,V){if(Array.isArray(g))for(var b=0;b<g.length;b++)Gp(f,g[b],y,T,V);else T=d(T)?!!T.capture:!!T,y=zp(y),f&&f[En]?(f=f.i,g=String(g).toString(),g in f.g&&(b=f.g[g],y=sc(b,y,T,V),-1<y&&(vl(b[y]),Array.prototype.splice.call(b,y,1),b.length==0&&(delete f.g[g],f.h--)))):f&&(f=cc(f))&&(g=f.g[g.toString()],f=-1,g&&(f=sc(g,y,T,V)),(y=-1<f?g[f]:null)&&uc(y))}function uc(f){if(typeof f!="number"&&f&&!f.da){var g=f.src;if(g&&g[En])oc(g.i,f);else{var y=f.type,T=f.proxy;g.removeEventListener?g.removeEventListener(y,T,f.capture):g.detachEvent?g.detachEvent($p(y),T):g.addListener&&g.removeListener&&g.removeListener(T),(y=cc(g))?(oc(y,f),y.h==0&&(y.src=null,g[lc]=null)):vl(f)}}}function $p(f){return f in ac?ac[f]:ac[f]="on"+f}function _0(f,g){if(f.da)f=!0;else{g=new vn(g,this);var y=f.listener,T=f.ha||f.src;f.fa&&uc(f),f=y.call(T,g)}return f}function cc(f){return f=f[lc],f instanceof Tl?f:null}var dc="__closure_events_fn_"+(1e9*Math.random()>>>0);function zp(f){return typeof f=="function"?f:(f[dc]||(f[dc]=function(g){return f.handleEvent(g)}),f[dc])}function et(){pe.call(this),this.i=new Tl(this),this.M=this,this.F=null}w(et,pe),et.prototype[En]=!0,et.prototype.removeEventListener=function(f,g,y,T){Gp(this,f,g,y,T)};function dt(f,g){var y,T=f.F;if(T)for(y=[];T;T=T.F)y.push(T);if(f=f.M,T=g.type||g,typeof g=="string")g=new Fe(g,f);else if(g instanceof Fe)g.target=g.target||f;else{var V=g;g=new Fe(T,f),P(g,V)}if(V=!0,y)for(var b=y.length-1;0<=b;b--){var $=g.g=y[b];V=El($,T,!0,g)&&V}if($=g.g=f,V=El($,T,!0,g)&&V,V=El($,T,!1,g)&&V,y)for(b=0;b<y.length;b++)$=g.g=y[b],V=El($,T,!1,g)&&V}et.prototype.N=function(){if(et.aa.N.call(this),this.i){var f=this.i,g;for(g in f.g){for(var y=f.g[g],T=0;T<y.length;T++)vl(y[T]);delete f.g[g],f.h--}}this.F=null},et.prototype.K=function(f,g,y,T){return this.i.add(String(f),g,!1,y,T)},et.prototype.L=function(f,g,y,T){return this.i.add(String(f),g,!0,y,T)};function El(f,g,y,T){if(g=f.i.g[String(g)],!g)return!0;g=g.concat();for(var V=!0,b=0;b<g.length;++b){var $=g[b];if($&&!$.da&&$.capture==y){var me=$.listener,Je=$.ha||$.src;$.fa&&oc(f.i,$),V=me.call(Je,T)!==!1&&V}}return V&&!T.defaultPrevented}function Hp(f,g,y){if(typeof f=="function")y&&(f=m(f,y));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:u.setTimeout(f,g||0)}function Kp(f){f.g=Hp(()=>{f.g=null,f.i&&(f.i=!1,Kp(f))},f.l);const g=f.h;f.h=null,f.m.apply(null,g)}class v0 extends pe{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Kp(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Do(f){pe.call(this),this.h=f,this.g={}}w(Do,pe);var Wp=[];function Jp(f){U(f.g,function(g,y){this.g.hasOwnProperty(y)&&uc(g)},f),f.g={}}Do.prototype.N=function(){Do.aa.N.call(this),Jp(this)},Do.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fc=u.JSON.stringify,T0=u.JSON.parse,E0=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function hc(){}hc.prototype.h=null;function Qp(f){return f.h||(f.h=f.i())}function Yp(){}var ko={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pc(){Fe.call(this,"d")}w(pc,Fe);function mc(){Fe.call(this,"c")}w(mc,Fe);var Sr={},Xp=null;function Il(){return Xp=Xp||new et}Sr.La="serverreachability";function Zp(f){Fe.call(this,Sr.La,f)}w(Zp,Fe);function No(f){const g=Il();dt(g,new Zp(g))}Sr.STAT_EVENT="statevent";function jp(f,g){Fe.call(this,Sr.STAT_EVENT,f),this.stat=g}w(jp,Fe);function ft(f){const g=Il();dt(g,new jp(g,f))}Sr.Ma="timingevent";function em(f,g){Fe.call(this,Sr.Ma,f),this.size=g}w(em,Fe);function Vo(f,g){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},g)}function Lo(){this.g=!0}Lo.prototype.xa=function(){this.g=!1};function I0(f,g,y,T,V,b){f.info(function(){if(f.g)if(b)for(var $="",me=b.split("&"),Je=0;Je<me.length;Je++){var ae=me[Je].split("=");if(1<ae.length){var tt=ae[0];ae=ae[1];var nt=tt.split("_");$=2<=nt.length&&nt[1]=="type"?$+(tt+"="+ae+"&"):$+(tt+"=redacted&")}}else $=null;else $=b;return"XMLHTTP REQ ("+T+") [attempt "+V+"]: "+g+`
`+y+`
`+$})}function C0(f,g,y,T,V,b,$){f.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+V+"]: "+g+`
`+y+`
`+b+" "+$})}function gi(f,g,y,T){f.info(function(){return"XMLHTTP TEXT ("+g+"): "+S0(f,y)+(T?" "+T:"")})}function w0(f,g){f.info(function(){return"TIMEOUT: "+g})}Lo.prototype.info=function(){};function S0(f,g){if(!f.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(f=0;f<y.length;f++)if(Array.isArray(y[f])){var T=y[f];if(!(2>T.length)){var V=T[1];if(Array.isArray(V)&&!(1>V.length)){var b=V[0];if(b!="noop"&&b!="stop"&&b!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return fc(y)}catch{return g}}var Cl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},tm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gc;function wl(){}w(wl,hc),wl.prototype.g=function(){return new XMLHttpRequest},wl.prototype.i=function(){return{}},gc=new wl;function On(f,g,y,T){this.j=f,this.i=g,this.l=y,this.R=T||1,this.U=new Do(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new nm}function nm(){this.i=null,this.g="",this.h=!1}var rm={},yc={};function _c(f,g,y){f.L=1,f.v=Pl(In(g)),f.m=y,f.P=!0,im(f,null)}function im(f,g){f.F=Date.now(),Sl(f),f.A=In(f.v);var y=f.A,T=f.R;Array.isArray(T)||(T=[String(T)]),_m(y.i,"t",T),f.C=0,y=f.j.J,f.h=new nm,f.g=Fm(f.j,y?g:null,!f.m),0<f.O&&(f.M=new v0(m(f.Y,f,f.g),f.O)),g=f.U,y=f.g,T=f.ca;var V="readystatechange";Array.isArray(V)||(V&&(Wp[0]=V.toString()),V=Wp);for(var b=0;b<V.length;b++){var $=qp(y,V[b],T||g.handleEvent,!1,g.h||g);if(!$)break;g.g[$.key]=$}g=f.H?E(f.H):{},f.m?(f.u||(f.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,g)):(f.u="GET",f.g.ea(f.A,f.u,null,g)),No(),I0(f.i,f.u,f.A,f.l,f.R,f.m)}On.prototype.ca=function(f){f=f.target;const g=this.M;g&&Cn(f)==3?g.j():this.Y(f)},On.prototype.Y=function(f){try{if(f==this.g)e:{const nt=Cn(this.g);var g=this.g.Ba();const vi=this.g.Z();if(!(3>nt)&&(nt!=3||this.g&&(this.h.h||this.g.oa()||Sm(this.g)))){this.J||nt!=4||g==7||(g==8||0>=vi?No(3):No(2)),vc(this);var y=this.g.Z();this.X=y;t:if(om(this)){var T=Sm(this.g);f="";var V=T.length,b=Cn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ar(this),Fo(this);var $="";break t}this.h.i=new u.TextDecoder}for(g=0;g<V;g++)this.h.h=!0,f+=this.h.i.decode(T[g],{stream:!(b&&g==V-1)});T.length=0,this.h.g+=f,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=y==200,C0(this.i,this.u,this.A,this.l,this.R,nt,y),this.o){if(this.T&&!this.K){t:{if(this.g){var me,Je=this.g;if((me=Je.g?Je.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(me)){var ae=me;break t}}ae=null}if(y=ae)gi(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Tc(this,y);else{this.o=!1,this.s=3,ft(12),Ar(this),Fo(this);break e}}if(this.P){y=!0;let Xt;for(;!this.J&&this.C<$.length;)if(Xt=A0(this,$),Xt==yc){nt==4&&(this.s=4,ft(14),y=!1),gi(this.i,this.l,null,"[Incomplete Response]");break}else if(Xt==rm){this.s=4,ft(15),gi(this.i,this.l,$,"[Invalid Chunk]"),y=!1;break}else gi(this.i,this.l,Xt,null),Tc(this,Xt);if(om(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),nt!=4||$.length!=0||this.h.h||(this.s=1,ft(16),y=!1),this.o=this.o&&y,!y)gi(this.i,this.l,$,"[Invalid Chunked Response]"),Ar(this),Fo(this);else if(0<$.length&&!this.W){this.W=!0;var tt=this.j;tt.g==this&&tt.ba&&!tt.M&&(tt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ac(tt),tt.M=!0,ft(11))}}else gi(this.i,this.l,$,null),Tc(this,$);nt==4&&Ar(this),this.o&&!this.J&&(nt==4?km(this.j,this):(this.o=!1,Sl(this)))}else $0(this.g),y==400&&0<$.indexOf("Unknown SID")?(this.s=3,ft(12)):(this.s=0,ft(13)),Ar(this),Fo(this)}}}catch{}finally{}};function om(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function A0(f,g){var y=f.C,T=g.indexOf(`
`,y);return T==-1?yc:(y=Number(g.substring(y,T)),isNaN(y)?rm:(T+=1,T+y>g.length?yc:(g=g.slice(T,T+y),f.C=T+y,g)))}On.prototype.cancel=function(){this.J=!0,Ar(this)};function Sl(f){f.S=Date.now()+f.I,sm(f,f.I)}function sm(f,g){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Vo(m(f.ba,f),g)}function vc(f){f.B&&(u.clearTimeout(f.B),f.B=null)}On.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(w0(this.i,this.A),this.L!=2&&(No(),ft(17)),Ar(this),this.s=2,Fo(this)):sm(this,this.S-f)};function Fo(f){f.j.G==0||f.J||km(f.j,f)}function Ar(f){vc(f);var g=f.M;g&&typeof g.ma=="function"&&g.ma(),f.M=null,Jp(f.U),f.g&&(g=f.g,f.g=null,g.abort(),g.ma())}function Tc(f,g){try{var y=f.j;if(y.G!=0&&(y.g==f||Ec(y.h,f))){if(!f.K&&Ec(y.h,f)&&y.G==3){try{var T=y.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var V=T;if(V[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<f.F)Vl(y),kl(y);else break e;Sc(y),ft(18)}}else y.za=V[1],0<y.za-y.T&&37500>V[2]&&y.F&&y.v==0&&!y.C&&(y.C=Vo(m(y.Za,y),6e3));if(1>=um(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Pr(y,11)}else if((f.K||y.g==f)&&Vl(y),!v(g))for(V=y.Da.g.parse(g),g=0;g<V.length;g++){let ae=V[g];if(y.T=ae[0],ae=ae[1],y.G==2)if(ae[0]=="c"){y.K=ae[1],y.ia=ae[2];const tt=ae[3];tt!=null&&(y.la=tt,y.j.info("VER="+y.la));const nt=ae[4];nt!=null&&(y.Aa=nt,y.j.info("SVER="+y.Aa));const vi=ae[5];vi!=null&&typeof vi=="number"&&0<vi&&(T=1.5*vi,y.L=T,y.j.info("backChannelRequestTimeoutMs_="+T)),T=y;const Xt=f.g;if(Xt){const Fl=Xt.g?Xt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fl){var b=T.h;b.g||Fl.indexOf("spdy")==-1&&Fl.indexOf("quic")==-1&&Fl.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Ic(b,b.h),b.h=null))}if(T.D){const Rc=Xt.g?Xt.g.getResponseHeader("X-HTTP-Session-Id"):null;Rc&&(T.ya=Rc,ye(T.I,T.D,Rc))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-f.F,y.j.info("Handshake RTT: "+y.R+"ms")),T=y;var $=f;if(T.qa=Lm(T,T.J?T.ia:null,T.W),$.K){cm(T.h,$);var me=$,Je=T.L;Je&&(me.I=Je),me.B&&(vc(me),Sl(me)),T.g=$}else Mm(T);0<y.i.length&&Nl(y)}else ae[0]!="stop"&&ae[0]!="close"||Pr(y,7);else y.G==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?Pr(y,7):wc(y):ae[0]!="noop"&&y.l&&y.l.ta(ae),y.v=0)}}No(4)}catch{}}var R0=class{constructor(f,g){this.g=f,this.map=g}};function lm(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function am(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function um(f){return f.h?1:f.g?f.g.size:0}function Ec(f,g){return f.h?f.h==g:f.g?f.g.has(g):!1}function Ic(f,g){f.g?f.g.add(g):f.h=g}function cm(f,g){f.h&&f.h==g?f.h=null:f.g&&f.g.has(g)&&f.g.delete(g)}lm.prototype.cancel=function(){if(this.i=dm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function dm(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let g=f.i;for(const y of f.g.values())g=g.concat(y.D);return g}return R(f.i)}function P0(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var g=[],y=f.length,T=0;T<y;T++)g.push(f[T]);return g}g=[],y=0;for(T in f)g[y++]=f[T];return g}function x0(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var g=[];f=f.length;for(var y=0;y<f;y++)g.push(y);return g}g=[],y=0;for(const T in f)g[y++]=T;return g}}}function fm(f,g){if(f.forEach&&typeof f.forEach=="function")f.forEach(g,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,g,void 0);else for(var y=x0(f),T=P0(f),V=T.length,b=0;b<V;b++)g.call(void 0,T[b],y&&y[b],f)}var hm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function M0(f,g){if(f){f=f.split("&");for(var y=0;y<f.length;y++){var T=f[y].indexOf("="),V=null;if(0<=T){var b=f[y].substring(0,T);V=f[y].substring(T+1)}else b=f[y];g(b,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Rr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Rr){this.h=f.h,Al(this,f.j),this.o=f.o,this.g=f.g,Rl(this,f.s),this.l=f.l;var g=f.i,y=new Bo;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),pm(this,y),this.m=f.m}else f&&(g=String(f).match(hm))?(this.h=!1,Al(this,g[1]||"",!0),this.o=Uo(g[2]||""),this.g=Uo(g[3]||"",!0),Rl(this,g[4]),this.l=Uo(g[5]||"",!0),pm(this,g[6]||"",!0),this.m=Uo(g[7]||"")):(this.h=!1,this.i=new Bo(null,this.h))}Rr.prototype.toString=function(){var f=[],g=this.j;g&&f.push(bo(g,mm,!0),":");var y=this.g;return(y||g=="file")&&(f.push("//"),(g=this.o)&&f.push(bo(g,mm,!0),"@"),f.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&f.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&f.push("/"),f.push(bo(y,y.charAt(0)=="/"?N0:k0,!0))),(y=this.i.toString())&&f.push("?",y),(y=this.m)&&f.push("#",bo(y,L0)),f.join("")};function In(f){return new Rr(f)}function Al(f,g,y){f.j=y?Uo(g,!0):g,f.j&&(f.j=f.j.replace(/:$/,""))}function Rl(f,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);f.s=g}else f.s=null}function pm(f,g,y){g instanceof Bo?(f.i=g,F0(f.i,f.h)):(y||(g=bo(g,V0)),f.i=new Bo(g,f.h))}function ye(f,g,y){f.i.set(g,y)}function Pl(f){return ye(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Uo(f,g){return f?g?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function bo(f,g,y){return typeof f=="string"?(f=encodeURI(f).replace(g,D0),y&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function D0(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var mm=/[#\/\?@]/g,k0=/[#\?:]/g,N0=/[#\?]/g,V0=/[#\?@]/g,L0=/#/g;function Bo(f,g){this.h=this.g=null,this.i=f||null,this.j=!!g}function qn(f){f.g||(f.g=new Map,f.h=0,f.i&&M0(f.i,function(g,y){f.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=Bo.prototype,t.add=function(f,g){qn(this),this.i=null,f=yi(this,f);var y=this.g.get(f);return y||this.g.set(f,y=[]),y.push(g),this.h+=1,this};function gm(f,g){qn(f),g=yi(f,g),f.g.has(g)&&(f.i=null,f.h-=f.g.get(g).length,f.g.delete(g))}function ym(f,g){return qn(f),g=yi(f,g),f.g.has(g)}t.forEach=function(f,g){qn(this),this.g.forEach(function(y,T){y.forEach(function(V){f.call(g,V,T,this)},this)},this)},t.na=function(){qn(this);const f=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let T=0;T<g.length;T++){const V=f[T];for(let b=0;b<V.length;b++)y.push(g[T])}return y},t.V=function(f){qn(this);let g=[];if(typeof f=="string")ym(this,f)&&(g=g.concat(this.g.get(yi(this,f))));else{f=Array.from(this.g.values());for(let y=0;y<f.length;y++)g=g.concat(f[y])}return g},t.set=function(f,g){return qn(this),this.i=null,f=yi(this,f),ym(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[g]),this.h+=1,this},t.get=function(f,g){return f?(f=this.V(f),0<f.length?String(f[0]):g):g};function _m(f,g,y){gm(f,g),0<y.length&&(f.i=null,f.g.set(yi(f,g),R(y)),f.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var T=g[y];const b=encodeURIComponent(String(T)),$=this.V(T);for(T=0;T<$.length;T++){var V=b;$[T]!==""&&(V+="="+encodeURIComponent(String($[T]))),f.push(V)}}return this.i=f.join("&")};function yi(f,g){return g=String(g),f.j&&(g=g.toLowerCase()),g}function F0(f,g){g&&!f.j&&(qn(f),f.i=null,f.g.forEach(function(y,T){var V=T.toLowerCase();T!=V&&(gm(this,T),_m(this,V,y))},f)),f.j=g}function U0(f,g){const y=new Lo;if(u.Image){const T=new Image;T.onload=_(Gn,y,"TestLoadImage: loaded",!0,g,T),T.onerror=_(Gn,y,"TestLoadImage: error",!1,g,T),T.onabort=_(Gn,y,"TestLoadImage: abort",!1,g,T),T.ontimeout=_(Gn,y,"TestLoadImage: timeout",!1,g,T),u.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=f}else g(!1)}function b0(f,g){const y=new Lo,T=new AbortController,V=setTimeout(()=>{T.abort(),Gn(y,"TestPingServer: timeout",!1,g)},1e4);fetch(f,{signal:T.signal}).then(b=>{clearTimeout(V),b.ok?Gn(y,"TestPingServer: ok",!0,g):Gn(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(V),Gn(y,"TestPingServer: error",!1,g)})}function Gn(f,g,y,T,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),T(y)}catch{}}function B0(){this.g=new E0}function O0(f,g,y){const T=y||"";try{fm(f,function(V,b){let $=V;d(V)&&($=fc(V)),g.push(T+b+"="+encodeURIComponent($))})}catch(V){throw g.push(T+"type="+encodeURIComponent("_badmap")),V}}function xl(f){this.l=f.Ub||null,this.j=f.eb||!1}w(xl,hc),xl.prototype.g=function(){return new Ml(this.l,this.j)},xl.prototype.i=function(f){return function(){return f}}({});function Ml(f,g){et.call(this),this.D=f,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Ml,et),t=Ml.prototype,t.open=function(f,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=g,this.readyState=1,qo(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(g.body=f),(this.D||u).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Oo(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,qo(this)),this.g&&(this.readyState=3,qo(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vm(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function vm(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var g=f.value?f.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!f.done}))&&(this.response=this.responseText+=g)}f.done?Oo(this):qo(this),this.readyState==3&&vm(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Oo(this))},t.Qa=function(f){this.g&&(this.response=f,Oo(this))},t.ga=function(){this.g&&Oo(this)};function Oo(f){f.readyState=4,f.l=null,f.j=null,f.v=null,qo(f)}t.setRequestHeader=function(f,g){this.u.append(f,g)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,f.push(y[0]+": "+y[1]),y=g.next();return f.join(`\r
`)};function qo(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Ml.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Tm(f){let g="";return U(f,function(y,T){g+=T,g+=":",g+=y,g+=`\r
`}),g}function Cc(f,g,y){e:{for(T in y){var T=!1;break e}T=!0}T||(y=Tm(y),typeof f=="string"?y!=null&&encodeURIComponent(String(y)):ye(f,g,y))}function De(f){et.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(De,et);var q0=/^https?$/i,G0=["POST","PUT"];t=De.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,g,y,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);g=g?g.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gc.g(),this.v=this.o?Qp(this.o):Qp(gc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(g,String(f),!0),this.B=!1}catch(b){Em(this,b);return}if(f=y||"",y=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var V in T)y.set(V,T[V]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const b of T.keys())y.set(b,T.get(b));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(y.keys()).find(b=>b.toLowerCase()=="content-type"),V=u.FormData&&f instanceof u.FormData,!(0<=Array.prototype.indexOf.call(G0,g,void 0))||T||V||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[b,$]of y)this.g.setRequestHeader(b,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{wm(this),this.u=!0,this.g.send(f),this.u=!1}catch(b){Em(this,b)}};function Em(f,g){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=g,f.m=5,Im(f),Dl(f)}function Im(f){f.A||(f.A=!0,dt(f,"complete"),dt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,dt(this,"complete"),dt(this,"abort"),Dl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Dl(this,!0)),De.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Cm(this):this.bb())},t.bb=function(){Cm(this)};function Cm(f){if(f.h&&typeof s<"u"&&(!f.v[1]||Cn(f)!=4||f.Z()!=2)){if(f.u&&Cn(f)==4)Hp(f.Ea,0,f);else if(dt(f,"readystatechange"),Cn(f)==4){f.h=!1;try{const $=f.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var T;if(T=$===0){var V=String(f.D).match(hm)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),T=!q0.test(V?V.toLowerCase():"")}y=T}if(y)dt(f,"complete"),dt(f,"success");else{f.m=6;try{var b=2<Cn(f)?f.g.statusText:""}catch{b=""}f.l=b+" ["+f.Z()+"]",Im(f)}}finally{Dl(f)}}}}function Dl(f,g){if(f.g){wm(f);const y=f.g,T=f.v[0]?()=>{}:null;f.g=null,f.v=null,g||dt(f,"ready");try{y.onreadystatechange=T}catch{}}}function wm(f){f.I&&(u.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function Cn(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<Cn(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var g=this.g.responseText;return f&&g.indexOf(f)==0&&(g=g.substring(f.length)),T0(g)}};function Sm(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function $0(f){const g={};f=(f.g&&2<=Cn(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<f.length;T++){if(v(f[T]))continue;var y=M(f[T]);const V=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const b=g[V]||[];g[V]=b,b.push(y)}C(g,function(T){return T.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Go(f,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[f]||g}function Am(f){this.Aa=0,this.i=[],this.j=new Lo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Go("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Go("baseRetryDelayMs",5e3,f),this.cb=Go("retryDelaySeedMs",1e4,f),this.Wa=Go("forwardChannelMaxRetries",2,f),this.wa=Go("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new lm(f&&f.concurrentRequestLimit),this.Da=new B0,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Am.prototype,t.la=8,t.G=1,t.connect=function(f,g,y,T){ft(0),this.W=f,this.H=g||{},y&&T!==void 0&&(this.H.OSID=y,this.H.OAID=T),this.F=this.X,this.I=Lm(this,null,this.W),Nl(this)};function wc(f){if(Rm(f),f.G==3){var g=f.U++,y=In(f.I);if(ye(y,"SID",f.K),ye(y,"RID",g),ye(y,"TYPE","terminate"),$o(f,y),g=new On(f,f.j,g),g.L=2,g.v=Pl(In(y)),y=!1,u.navigator&&u.navigator.sendBeacon)try{y=u.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&u.Image&&(new Image().src=g.v,y=!0),y||(g.g=Fm(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Sl(g)}Vm(f)}function kl(f){f.g&&(Ac(f),f.g.cancel(),f.g=null)}function Rm(f){kl(f),f.u&&(u.clearTimeout(f.u),f.u=null),Vl(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&u.clearTimeout(f.s),f.s=null)}function Nl(f){if(!am(f.h)&&!f.s){f.s=!0;var g=f.Ga;yn||te(),K||(yn(),K=!0),Z.add(g,f),f.B=0}}function z0(f,g){return um(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=g.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Vo(m(f.Ga,f,g),Nm(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const V=new On(this,this.j,f);let b=this.o;if(this.S&&(b?(b=E(b),P(b,this.S)):b=this.S),this.m!==null||this.O||(V.H=b,b=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var T=this.i[y];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=xm(this,V,g),y=In(this.I),ye(y,"RID",f),ye(y,"CVER",22),this.D&&ye(y,"X-HTTP-Session-Id",this.D),$o(this,y),b&&(this.O?g="headers="+encodeURIComponent(String(Tm(b)))+"&"+g:this.m&&Cc(y,this.m,b)),Ic(this.h,V),this.Ua&&ye(y,"TYPE","init"),this.P?(ye(y,"$req",g),ye(y,"SID","null"),V.T=!0,_c(V,y,null)):_c(V,y,g),this.G=2}}else this.G==3&&(f?Pm(this,f):this.i.length==0||am(this.h)||Pm(this))};function Pm(f,g){var y;g?y=g.l:y=f.U++;const T=In(f.I);ye(T,"SID",f.K),ye(T,"RID",y),ye(T,"AID",f.T),$o(f,T),f.m&&f.o&&Cc(T,f.m,f.o),y=new On(f,f.j,y,f.B+1),f.m===null&&(y.H=f.o),g&&(f.i=g.D.concat(f.i)),g=xm(f,y,1e3),y.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ic(f.h,y),_c(y,T,g)}function $o(f,g){f.H&&U(f.H,function(y,T){ye(g,T,y)}),f.l&&fm({},function(y,T){ye(g,T,y)})}function xm(f,g,y){y=Math.min(f.i.length,y);var T=f.l?m(f.l.Na,f.l,f):null;e:{var V=f.i;let b=-1;for(;;){const $=["count="+y];b==-1?0<y?(b=V[0].g,$.push("ofs="+b)):b=0:$.push("ofs="+b);let me=!0;for(let Je=0;Je<y;Je++){let ae=V[Je].g;const tt=V[Je].map;if(ae-=b,0>ae)b=Math.max(0,V[Je].g-100),me=!1;else try{O0(tt,$,"req"+ae+"_")}catch{T&&T(tt)}}if(me){T=$.join("&");break e}}}return f=f.i.splice(0,y),g.D=f,T}function Mm(f){if(!f.g&&!f.u){f.Y=1;var g=f.Fa;yn||te(),K||(yn(),K=!0),Z.add(g,f),f.v=0}}function Sc(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Vo(m(f.Fa,f),Nm(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,Dm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Vo(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ft(10),kl(this),Dm(this))};function Ac(f){f.A!=null&&(u.clearTimeout(f.A),f.A=null)}function Dm(f){f.g=new On(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var g=In(f.qa);ye(g,"RID","rpc"),ye(g,"SID",f.K),ye(g,"AID",f.T),ye(g,"CI",f.F?"0":"1"),!f.F&&f.ja&&ye(g,"TO",f.ja),ye(g,"TYPE","xmlhttp"),$o(f,g),f.m&&f.o&&Cc(g,f.m,f.o),f.L&&(f.g.I=f.L);var y=f.g;f=f.ia,y.L=1,y.v=Pl(In(g)),y.m=null,y.P=!0,im(y,f)}t.Za=function(){this.C!=null&&(this.C=null,kl(this),Sc(this),ft(19))};function Vl(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function km(f,g){var y=null;if(f.g==g){Vl(f),Ac(f),f.g=null;var T=2}else if(Ec(f.h,g))y=g.D,cm(f.h,g),T=1;else return;if(f.G!=0){if(g.o)if(T==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var V=f.B;T=Il(),dt(T,new em(T,y)),Nl(f)}else Mm(f);else if(V=g.s,V==3||V==0&&0<g.X||!(T==1&&z0(f,g)||T==2&&Sc(f)))switch(y&&0<y.length&&(g=f.h,g.i=g.i.concat(y)),V){case 1:Pr(f,5);break;case 4:Pr(f,10);break;case 3:Pr(f,6);break;default:Pr(f,2)}}}function Nm(f,g){let y=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(y*=2),y*g}function Pr(f,g){if(f.j.info("Error code "+g),g==2){var y=m(f.fb,f),T=f.Xa;const V=!T;T=new Rr(T||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Al(T,"https"),Pl(T),V?U0(T.toString(),y):b0(T.toString(),y)}else ft(2);f.G=0,f.l&&f.l.sa(g),Vm(f),Rm(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function Vm(f){if(f.G=0,f.ka=[],f.l){const g=dm(f.h);(g.length!=0||f.i.length!=0)&&(k(f.ka,g),k(f.ka,f.i),f.h.i.length=0,R(f.i),f.i.length=0),f.l.ra()}}function Lm(f,g,y){var T=y instanceof Rr?In(y):new Rr(y);if(T.g!="")g&&(T.g=g+"."+T.g),Rl(T,T.s);else{var V=u.location;T=V.protocol,g=g?g+"."+V.hostname:V.hostname,V=+V.port;var b=new Rr(null);T&&Al(b,T),g&&(b.g=g),V&&Rl(b,V),y&&(b.l=y),T=b}return y=f.D,g=f.ya,y&&g&&ye(T,y,g),ye(T,"VER",f.la),$o(f,T),T}function Fm(f,g,y){if(g&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=f.Ca&&!f.pa?new De(new xl({eb:y})):new De(f.pa),g.Ha(f.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Um(){}t=Um.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ll(){}Ll.prototype.g=function(f,g){return new Mt(f,g)};function Mt(f,g){et.call(this),this.g=new Am(g),this.l=f,this.h=g&&g.messageUrlParams||null,f=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(f?f["X-WebChannel-Content-Type"]=g.messageContentType:f={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(f?f["X-WebChannel-Client-Profile"]=g.va:f={"X-WebChannel-Client-Profile":g.va}),this.g.S=f,(f=g&&g.Sb)&&!v(f)&&(this.g.m=f),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!v(g)&&(this.g.D=g,f=this.h,f!==null&&g in f&&(f=this.h,g in f&&delete f[g])),this.j=new _i(this)}w(Mt,et),Mt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Mt.prototype.close=function(){wc(this.g)},Mt.prototype.o=function(f){var g=this.g;if(typeof f=="string"){var y={};y.__data__=f,f=y}else this.u&&(y={},y.__data__=fc(f),f=y);g.i.push(new R0(g.Ya++,f)),g.G==3&&Nl(g)},Mt.prototype.N=function(){this.g.l=null,delete this.j,wc(this.g),delete this.g,Mt.aa.N.call(this)};function bm(f){pc.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var g=f.__sm__;if(g){e:{for(const y in g){f=y;break e}f=void 0}(this.i=f)&&(f=this.i,g=g!==null&&f in g?g[f]:void 0),this.data=g}else this.data=f}w(bm,pc);function Bm(){mc.call(this),this.status=1}w(Bm,mc);function _i(f){this.g=f}w(_i,Um),_i.prototype.ua=function(){dt(this.g,"a")},_i.prototype.ta=function(f){dt(this.g,new bm(f))},_i.prototype.sa=function(f){dt(this.g,new Bm)},_i.prototype.ra=function(){dt(this.g,"b")},Ll.prototype.createWebChannel=Ll.prototype.g,Mt.prototype.send=Mt.prototype.o,Mt.prototype.open=Mt.prototype.m,Mt.prototype.close=Mt.prototype.close,EI=function(){return new Ll},TI=function(){return Il()},vI=Sr,hf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cl.NO_ERROR=0,Cl.TIMEOUT=8,Cl.HTTP_ERROR=6,Ca=Cl,tm.COMPLETE="complete",_I=tm,Yp.EventType=ko,ko.OPEN="a",ko.CLOSE="b",ko.ERROR="c",ko.MESSAGE="d",et.prototype.listen=et.prototype.K,us=Yp,De.prototype.listenOnce=De.prototype.L,De.prototype.getLastError=De.prototype.Ka,De.prototype.getLastErrorCode=De.prototype.Ba,De.prototype.getStatus=De.prototype.Z,De.prototype.getResponseJson=De.prototype.Oa,De.prototype.getResponseText=De.prototype.oa,De.prototype.send=De.prototype.ea,De.prototype.setWithCredentials=De.prototype.Ha,yI=De}).apply(typeof ea<"u"?ea:typeof self<"u"?self:typeof window<"u"?window:{});const sy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ye.UNAUTHENTICATED=new Ye(null),Ye.GOOGLE_CREDENTIALS=new Ye("google-credentials-uid"),Ye.FIRST_PARTY=new Ye("first-party-uid"),Ye.MOCK_USER=new Ye("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Io="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xr=new lI("@firebase/firestore");function Si(){return Xr.logLevel}function q(t,...e){if(Xr.logLevel<=se.DEBUG){const n=e.map(qh);Xr.debug(`Firestore (${Io}): ${t}`,...n)}}function mt(t,...e){if(Xr.logLevel<=se.ERROR){const n=e.map(qh);Xr.error(`Firestore (${Io}): ${t}`,...n)}}function Zr(t,...e){if(Xr.logLevel<=se.WARN){const n=e.map(qh);Xr.warn(`Firestore (${Io}): ${t}`,...n)}}function qh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t="Unexpected state"){const e=`FIRESTORE (${Io}) INTERNAL ASSERTION FAILED: `+t;throw mt(e),new Error(e)}function Y(t,e){t||Q()}function j(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends ui{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class II{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class zP{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ye.UNAUTHENTICATED))}shutdown(){}}class HP{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class KP{constructor(e){this.t=e,this.currentUser=Ye.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Y(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let o=new Mn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Mn,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Mn)}},0),s()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new II(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new Ye(e)}}class WP{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ye.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class JP{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new WP(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ye.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class QP{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class YP{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Y(this.o===void 0);const r=o=>{o.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,q("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Y(typeof n.token=="string"),this.R=n.token,new QP(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XP(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CI{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=XP(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function ao(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function wI(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return xe.fromMillis(Date.now())}static fromDate(e){return xe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new xe(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new xe(0,0))}static max(){return new X(new xe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n,r){n===void 0?n=0:n>e.length&&Q(),r===void 0?r=e.length-n:r>e.length-n&&Q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Js.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Js?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),s=n.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ce extends Js{construct(e,n,r){return new ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new z(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ce(n)}static emptyPath(){return new ce([])}}const ZP=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Re extends Js{construct(e,n,r){return new Re(e,n,r)}static isValidIdentifier(e){return ZP.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Re.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Re(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new z(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let s=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new z(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new z(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(s=!s,i++):u!=="."||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new z(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Re(n)}static emptyPath(){return new Re([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ce.fromString(e))}static fromName(e){return new H(ce.fromString(e).popFirst(5))}static empty(){return new H(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function pf(t){return t.fields.find(e=>e.kind===2)}function Nr(t){return t.fields.filter(e=>e.kind!==2)}lu.UNKNOWN_ID=-1;class wa{constructor(e,n){this.fieldPath=e,this.kind=n}}class Qs{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Qs(0,bt.min())}}function jP(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=X.fromTimestamp(r===1e9?new xe(n+1,0):new xe(n,r));return new bt(i,H.empty(),e)}function SI(t){return new bt(t.readTime,t.key,-1)}class bt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bt(X.min(),H.empty(),-1)}static max(){return new bt(X.max(),H.empty(),-1)}}function Gh(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=H.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class RI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ci(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==AI)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let i=0,o=0,s=!1;e.forEach(u=>{++i,u.next(()=>{++o,s&&o===i&&n()},c=>r(c))}),s=!0,o===i&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new L((r,i)=>{const o=e.length,s=new Array(o);let u=0;for(let c=0;c<o;c++){const d=c;n(e[d]).next(h=>{s[d]=h,++u,u===o&&r(s)},h=>i(h))}})}static doWhile(e,n){return new L((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Mn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Is(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=$h(r.target.error);this.V.reject(new Is(e,i))}}static open(e,n,r,i){try{return new Uu(n,e.transaction(i,r))}catch(o){throw new Is(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new tx(n)}}class fr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,fr.S(ou())===12.2&&mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return q("SimpleDb","Removing database:",e),Vr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!oI())return!1;if(fr.v())return!0;const e=ou(),n=fr.S(e),r=0<n&&n<10,i=PI(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(q("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const s=o.target.result;n(s)},i.onblocked=()=>{r(new Is(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const s=o.target.error;s.name==="VersionError"?r(new z(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new z(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Is(e,s))},i.onupgradeneeded=o=>{q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let s=0;for(;;){++s;try{this.db=await this.M(e);const u=Uu.open(this.db,e,o?"readonly":"readwrite",r),c=i(u).next(d=>(u.g(),d)).catch(d=>(u.abort(d),L.reject(d))).toPromise();return c.catch(()=>{}),await u.m,c}catch(u){const c=u,d=c.name!=="FirebaseError"&&s<3;if(q("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function PI(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class ex{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Vr(this.B.delete())}}class Is extends z{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Cr(t){return t.name==="IndexedDbTransactionError"}class tx{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vr(r)}add(e){return q("SimpleDb","ADD",this.store.name,e,e),Vr(this.store.add(e))}get(e){return Vr(this.store.get(e)).next(n=>(n===void 0&&(n=null),q("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return q("SimpleDb","DELETE",this.store.name,e),Vr(this.store.delete(e))}count(){return q("SimpleDb","COUNT",this.store.name),Vr(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new L((s,u)=>{o.onerror=c=>{u(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{const o=this.cursor(r),s=[];return this.W(o,(u,c)=>{s.push(c)}).next(()=>s)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new L((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,n){q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,s,u)=>u.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new L((r,i)=>{n.onerror=o=>{const s=$h(o.target.error);i(s)},n.onsuccess=o=>{const s=o.target.result;s?e(s.primaryKey,s.value).next(u=>{u?s.continue():r()}):r()}})}W(e,n){const r=[];return new L((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{const u=s.target.result;if(!u)return void i();const c=new ex(u),d=n(u.primaryKey,u.value,c);if(d instanceof L){const h=d.catch(p=>(c.done(),L.reject(p)));r.push(h)}c.isDone?i():c.K===null?u.continue():u.continue(c.K)}}).next(()=>L.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Vr(t){return new L((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=$h(r.target.error);n(i)}})}let ly=!1;function $h(t){const e=fr.S(ou());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ly||(ly=!0,setTimeout(()=>{throw r},0)),r}}return t}class nx{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Cr(n)?q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ci(n)}await this.X(6e4)})}}class rx{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return L.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return q("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(u=>{i-=u,r.add(s)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(u=>(q("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>s.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const s=SI(o);Gh(s,r)>0&&(r=s)}),new bt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}zt.oe=-1;function bu(t){return t==null}function Ys(t){return t===0&&1/t==-1/0}function ix(t){return typeof t=="number"&&Number.isInteger(t)&&!Ys(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ay(e)),e=ox(t.get(n),e);return ay(e)}function ox(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function ay(t){return t+""}function cn(t){const e=t.length;if(Y(e>=2),e===2)return Y(t.charAt(0)===""&&t.charAt(1)===""),ce.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const s=t.indexOf("",o);switch((s<0||s>n)&&Q(),t.charAt(s+1)){case"":const u=t.substring(o,s);let c;i.length===0?c=u:(i+=u,c=i,i=""),r.push(c);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Q()}o=s+2}return new ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(t,e){return[t,_t(e)]}function xI(t,e,n){return[t,_t(e),n]}const sx={},lx=["prefixPath","collectionGroup","readTime","documentId"],ax=["prefixPath","collectionGroup","documentId"],ux=["collectionGroup","readTime","prefixPath","documentId"],cx=["canonicalId","targetId"],dx=["targetId","path"],fx=["path","targetId"],hx=["collectionId","parent"],px=["indexId","uid"],mx=["uid","sequenceNumber"],gx=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],yx=["indexId","uid","orderedDocumentKey"],_x=["userId","collectionPath","documentId"],vx=["userId","collectionPath","largestBatchId"],Tx=["userId","collectionGroup","largestBatchId"],MI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ex=[...MI,"documentOverlays"],DI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],kI=DI,zh=[...kI,"indexConfiguration","indexState","indexEntries"],Ix=zh,Cx=[...zh,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf extends RI{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function $e(t,e){const n=j(t);return fr.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function di(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function NI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e,n){this.comparator=e,this.root=n||Xe.EMPTY}insert(e,n){return new we(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Xe.BLACK,null,null))}remove(e){return new we(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Xe.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ta(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ta(this.root,e,this.comparator,!1)}getReverseIterator(){return new ta(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ta(this.root,e,this.comparator,!0)}}class ta{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Xe{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??Xe.RED,this.left=i??Xe.EMPTY,this.right=o??Xe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new Xe(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Xe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Xe.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Xe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Xe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}Xe.EMPTY=null,Xe.RED=!0,Xe.BLACK=!1;Xe.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(e,n,r,i,o){return this}insert(e,n,r){return new Xe(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.comparator=e,this.data=new we(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new dy(this.data.getIterator())}getIteratorFrom(e){return new dy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof he)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new he(this.comparator);return n.data=e,n}}class dy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ei(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.fields=e,e.sort(Re.comparator)}static empty(){return new St([])}unionWith(e){let n=new he(Re.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new St(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ao(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oe{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new VI("Invalid base64 string: "+o):o}}(e);return new Oe(n)}static fromUint8Array(e){const n=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new Oe(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Oe.EMPTY_BYTE_STRING=new Oe("");const wx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fn(t){if(Y(!!t),typeof t=="string"){let e=0;const n=wx.exec(t);if(Y(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ie(t.seconds),nanos:Ie(t.nanos)}}function Ie(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gr(t){return typeof t=="string"?Oe.fromBase64String(t):Oe.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Kh(t){const e=t.mapValue.fields.__previous_value__;return Hh(e)?Kh(e):e}function Xs(t){const e=Fn(t.mapValue.fields.__local_write_time__.timestampValue);return new xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e,n,r,i,o,s,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}}class jr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new jr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof jr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Aa={nullValue:"NULL_VALUE"};function ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Hh(t)?4:LI(t)?9007199254740991:Bu(t)?10:11:Q()}function mn(t,e){if(t===e)return!0;const n=ei(t);if(n!==ei(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xs(t).isEqual(Xs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Fn(i.timestampValue),u=Fn(o.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return gr(i.bytesValue).isEqual(gr(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Ie(i.geoPointValue.latitude)===Ie(o.geoPointValue.latitude)&&Ie(i.geoPointValue.longitude)===Ie(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Ie(i.integerValue)===Ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Ie(i.doubleValue),u=Ie(o.doubleValue);return s===u?Ys(s)===Ys(u):isNaN(s)&&isNaN(u)}return!1}(t,e);case 9:return ao(t.arrayValue.values||[],e.arrayValue.values||[],mn);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},u=o.mapValue.fields||{};if(cy(s)!==cy(u))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(u[c]===void 0||!mn(s[c],u[c])))return!1;return!0}(t,e);default:return Q()}}function Zs(t,e){return(t.values||[]).find(n=>mn(n,e))!==void 0}function yr(t,e){if(t===e)return 0;const n=ei(t),r=ei(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(o,s){const u=Ie(o.integerValue||o.doubleValue),c=Ie(s.integerValue||s.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return fy(t.timestampValue,e.timestampValue);case 4:return fy(Xs(t),Xs(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(o,s){const u=gr(o),c=gr(s);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const u=o.split("/"),c=s.split("/");for(let d=0;d<u.length&&d<c.length;d++){const h=ee(u[d],c[d]);if(h!==0)return h}return ee(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const u=ee(Ie(o.latitude),Ie(s.latitude));return u!==0?u:ee(Ie(o.longitude),Ie(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return hy(t.arrayValue,e.arrayValue);case 10:return function(o,s){var u,c,d,h;const p=o.fields||{},m=s.fields||{},_=(u=p.value)===null||u===void 0?void 0:u.arrayValue,w=(c=m.value)===null||c===void 0?void 0:c.arrayValue,R=ee(((d=_==null?void 0:_.values)===null||d===void 0?void 0:d.length)||0,((h=w==null?void 0:w.values)===null||h===void 0?void 0:h.length)||0);return R!==0?R:hy(_,w)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===er.mapValue&&s===er.mapValue)return 0;if(o===er.mapValue)return 1;if(s===er.mapValue)return-1;const u=o.fields||{},c=Object.keys(u),d=s.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=ee(c[p],h[p]);if(m!==0)return m;const _=yr(u[c[p]],d[h[p]]);if(_!==0)return _}return ee(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Q()}}function fy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=Fn(t),r=Fn(e),i=ee(n.seconds,r.seconds);return i!==0?i:ee(n.nanos,r.nanos)}function hy(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=yr(n[i],r[i]);if(o)return o}return ee(n.length,r.length)}function uo(t){return gf(t)}function gf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fn(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return H.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=gf(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${gf(n.fields[s])}`;return i+"}"}(t.mapValue):Q()}function js(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function yf(t){return!!t&&"integerValue"in t}function el(t){return!!t&&"arrayValue"in t}function py(t){return!!t&&"nullValue"in t}function my(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ra(t){return!!t&&"mapValue"in t}function Bu(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Cs(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return di(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Cs(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cs(t.arrayValue.values[n]);return e}return Object.assign({},t)}function LI(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const FI={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Ax(t){return"nullValue"in t?Aa:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?js(jr.empty(),H.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Bu(t)?FI:{mapValue:{}}:Q()}function Rx(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?js(jr.empty(),H.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?FI:"mapValue"in t?Bu(t)?{mapValue:{}}:er:Q()}function gy(t,e){const n=yr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function yy(t,e){const n=yr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e){this.value=e}static empty(){return new lt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ra(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cs(n)}setAll(e){let n=Re.emptyPath(),r={},i=[];e.forEach((s,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}s?r[u.lastSegment()]=Cs(s):i.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());Ra(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return mn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Ra(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){di(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new lt(Cs(this.value))}}function UI(t){const e=[];return di(t.fields,(n,r)=>{const i=new Re([n]);if(Ra(r)){const o=UI(r.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new St(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n,r,i,o,s,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=u}static newInvalidDocument(e){return new Ne(e,0,X.min(),X.min(),X.min(),lt.empty(),0)}static newFoundDocument(e,n,r,i){return new Ne(e,1,n,X.min(),r,i,0)}static newNoDocument(e,n){return new Ne(e,2,n,X.min(),X.min(),lt.empty(),0)}static newUnknownDocument(e,n){return new Ne(e,3,n,X.min(),X.min(),lt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ne&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ne(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n){this.position=e,this.inclusive=n}}function _y(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?r=H.comparator(H.fromName(s.referenceValue),n.key):r=yr(s,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function vy(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!mn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n="asc"){this.field=e,this.dir=n}}function Px(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{}class ie extends bI{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new xx(e,n,r):n==="array-contains"?new kx(e,r):n==="in"?new zI(e,r):n==="not-in"?new Nx(e,r):n==="array-contains-any"?new Vx(e,r):new ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Mx(e,r):new Dx(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(yr(n,this.value)):n!==null&&ei(this.value)===ei(n)&&this.matchesComparison(yr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class de extends bI{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new de(e,n)}matches(e){return fo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fo(t){return t.op==="and"}function _f(t){return t.op==="or"}function Wh(t){return BI(t)&&fo(t)}function BI(t){for(const e of t.filters)if(e instanceof de)return!1;return!0}function vf(t){if(t instanceof ie)return t.field.canonicalString()+t.op.toString()+uo(t.value);if(Wh(t))return t.filters.map(e=>vf(e)).join(",");{const e=t.filters.map(n=>vf(n)).join(",");return`${t.op}(${e})`}}function OI(t,e){return t instanceof ie?function(r,i){return i instanceof ie&&r.op===i.op&&r.field.isEqual(i.field)&&mn(r.value,i.value)}(t,e):t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,u)=>o&&OI(s,i.filters[u]),!0):!1}(t,e):void Q()}function qI(t,e){const n=t.filters.concat(e);return de.create(n,t.op)}function GI(t){return t instanceof ie?function(n){return`${n.field.canonicalString()} ${n.op} ${uo(n.value)}`}(t):t instanceof de?function(n){return n.op.toString()+" {"+n.getFilters().map(GI).join(" ,")+"}"}(t):"Filter"}class xx extends ie{constructor(e,n,r){super(e,n,r),this.key=H.fromName(r.referenceValue)}matches(e){const n=H.comparator(e.key,this.key);return this.matchesComparison(n)}}class Mx extends ie{constructor(e,n){super(e,"in",n),this.keys=$I("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Dx extends ie{constructor(e,n){super(e,"not-in",n),this.keys=$I("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function $I(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>H.fromName(r.referenceValue))}class kx extends ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return el(n)&&Zs(n.arrayValue,this.value)}}class zI extends ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zs(this.value.arrayValue,n)}}class Nx extends ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Zs(this.value.arrayValue,n)}}class Vx extends ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!el(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zs(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e,n=null,r=[],i=[],o=null,s=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=u,this.ue=null}}function Tf(t,e=null,n=[],r=[],i=null,o=null,s=null){return new Lx(t,e,n,r,i,o,s)}function ti(t){const e=j(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),bu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>uo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>uo(r)).join(",")),e.ue=n}return e.ue}function cl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Px(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!OI(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!vy(t.startAt,e.startAt)&&vy(t.endAt,e.endAt)}function au(t){return H.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function uu(t,e){return t.filters.filter(n=>n instanceof ie&&n.field.isEqual(e))}function Ty(t,e,n){let r=Aa,i=!0;for(const o of uu(t,e)){let s=Aa,u=!0;switch(o.op){case"<":case"<=":s=Ax(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,u=!1;break;case"!=":case"not-in":s=Aa}gy({value:r,inclusive:i},{value:s,inclusive:u})<0&&(r=s,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const s=n.position[o];gy({value:r,inclusive:i},{value:s,inclusive:n.inclusive})<0&&(r=s,i=n.inclusive);break}}return{value:r,inclusive:i}}function Ey(t,e,n){let r=er,i=!0;for(const o of uu(t,e)){let s=er,u=!0;switch(o.op){case">=":case">":s=Rx(o.value),u=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,u=!1;break;case"!=":case"not-in":s=er}yy({value:r,inclusive:i},{value:s,inclusive:u})>0&&(r=s,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const s=n.position[o];yy({value:r,inclusive:i},{value:s,inclusive:n.inclusive})>0&&(r=s,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n=null,r=[],i=[],o=null,s="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Fx(t,e,n,r,i,o,s,u){return new Co(t,e,n,r,i,o,s,u)}function Jh(t){return new Co(t)}function Iy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function HI(t){return t.collectionGroup!==null}function ws(t){const e=j(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let u=new he(Re.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new tl(o,r))}),n.has(Re.keyField().canonicalString())||e.ce.push(new tl(Re.keyField(),r))}return e.ce}function Wt(t){const e=j(t);return e.le||(e.le=Ux(e,ws(t))),e.le}function Ux(t,e){if(t.limitType==="F")return Tf(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new tl(i.field,o)});const n=t.endAt?new co(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new co(t.startAt.position,t.startAt.inclusive):null;return Tf(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Ef(t,e){const n=t.filters.concat([e]);return new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function If(t,e,n){return new Co(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ou(t,e){return cl(Wt(t),Wt(e))&&t.limitType===e.limitType}function KI(t){return`${ti(Wt(t))}|lt:${t.limitType}`}function Ai(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>GI(i)).join(", ")}]`),bu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>uo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>uo(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function dl(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):H.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of ws(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(s,u,c){const d=_y(s,u,c);return s.inclusive?d<=0:d<0}(r.startAt,ws(r),i)||r.endAt&&!function(s,u,c){const d=_y(s,u,c);return s.inclusive?d>=0:d>0}(r.endAt,ws(r),i))}(t,e)}function bx(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function WI(t){return(e,n)=>{let r=!1;for(const i of ws(t)){const o=Bx(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function Bx(t,e,n){const r=t.field.isKeyField()?H.comparator(e.key,n.key):function(o,s,u){const c=s.data.field(o),d=u.data.field(o);return c!==null&&d!==null?yr(c,d):Q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){di(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return NI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox=new we(H.comparator);function Nt(){return Ox}const JI=new we(H.comparator);function cs(...t){let e=JI;for(const n of t)e=e.insert(n.key,n);return e}function QI(t){let e=JI;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function dn(){return Ss()}function YI(){return Ss()}function Ss(){return new wr(t=>t.toString(),(t,e)=>t.isEqual(e))}const qx=new we(H.comparator),Gx=new he(H.comparator);function ne(...t){let e=Gx;for(const n of t)e=e.add(n);return e}const $x=new he(ee);function zx(){return $x}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qh(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ys(e)?"-0":e}}function XI(t){return{integerValue:""+t}}function Hx(t,e){return ix(e)?XI(e):Qh(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(){this._=void 0}}function Kx(t,e,n){return t instanceof ho?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&Hh(o)&&(o=Kh(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(n,e):t instanceof po?jI(t,e):t instanceof mo?eC(t,e):function(i,o){const s=ZI(i,o),u=Cy(s)+Cy(i.Pe);return yf(s)&&yf(i.Pe)?XI(u):Qh(i.serializer,u)}(t,e)}function Wx(t,e,n){return t instanceof po?jI(t,e):t instanceof mo?eC(t,e):n}function ZI(t,e){return t instanceof nl?function(r){return yf(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class ho extends qu{}class po extends qu{constructor(e){super(),this.elements=e}}function jI(t,e){const n=tC(e);for(const r of t.elements)n.some(i=>mn(i,r))||n.push(r);return{arrayValue:{values:n}}}class mo extends qu{constructor(e){super(),this.elements=e}}function eC(t,e){let n=tC(e);for(const r of t.elements)n=n.filter(i=>!mn(i,r));return{arrayValue:{values:n}}}class nl extends qu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Cy(t){return Ie(t.integerValue||t.doubleValue)}function tC(t){return el(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,n){this.field=e,this.transform=n}}function Jx(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof po&&i instanceof po||r instanceof mo&&i instanceof mo?ao(r.elements,i.elements,mn):r instanceof nl&&i instanceof nl?mn(r.Pe,i.Pe):r instanceof ho&&i instanceof ho}(t.transform,e.transform)}class Qx{constructor(e,n){this.version=e,this.transformResults=n}}class gt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gt}static exists(e){return new gt(void 0,e)}static updateTime(e){return new gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Pa(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Gu{}function rC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new $u(t.key,gt.none()):new wo(t.key,t.data,gt.none());{const n=t.data,r=lt.empty();let i=new he(Re.comparator);for(let o of e.fields)if(!i.has(o)){let s=n.field(o);s===null&&o.length>1&&(o=o.popLast(),s=n.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new bn(t.key,r,new St(i.toArray()),gt.none())}}function Yx(t,e,n){t instanceof wo?function(i,o,s){const u=i.value.clone(),c=Sy(i.fieldTransforms,o,s.transformResults);u.setAll(c),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(t,e,n):t instanceof bn?function(i,o,s){if(!Pa(i.precondition,o))return void o.convertToUnknownDocument(s.version);const u=Sy(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(iC(i)),c.setAll(u),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,n):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function As(t,e,n,r){return t instanceof wo?function(o,s,u,c){if(!Pa(o.precondition,s))return u;const d=o.value.clone(),h=Ay(o.fieldTransforms,c,s);return d.setAll(h),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof bn?function(o,s,u,c){if(!Pa(o.precondition,s))return u;const d=Ay(o.fieldTransforms,c,s),h=s.data;return h.setAll(iC(o)),h.setAll(d),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(o,s,u){return Pa(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):u}(t,e,n)}function Xx(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=ZI(r.transform,i||null);o!=null&&(n===null&&(n=lt.empty()),n.set(r.field,o))}return n||null}function wy(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ao(r,i,(o,s)=>Jx(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wo extends Gu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bn extends Gu{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function iC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Sy(t,e,n){const r=new Map;Y(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],s=o.transform,u=e.data.field(o.field);r.set(o.field,Wx(s,u,n[i]))}return r}function Ay(t,e,n){const r=new Map;for(const i of t){const o=i.transform,s=n.data.field(i.field);r.set(i.field,Kx(o,s,e))}return r}class $u extends Gu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oC extends Gu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&Yx(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=As(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=As(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=YI();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let u=this.applyToLocalView(s,o.mutatedFields);u=n.has(i.key)?null:u;const c=rC(s,u);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ne())}isEqual(e){return this.batchId===e.batchId&&ao(this.mutations,e.mutations,(n,r)=>wy(n,r))&&ao(this.baseMutations,e.baseMutations,(n,r)=>wy(n,r))}}class Xh{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Y(e.mutations.length===r.length);let i=function(){return qx}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new Xh(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zh{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be,oe;function jx(t){switch(t){default:return Q();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function sC(t){if(t===void 0)return mt("GRPC error has no .code"),B.UNKNOWN;switch(t){case be.OK:return B.OK;case be.CANCELLED:return B.CANCELLED;case be.UNKNOWN:return B.UNKNOWN;case be.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case be.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case be.INTERNAL:return B.INTERNAL;case be.UNAVAILABLE:return B.UNAVAILABLE;case be.UNAUTHENTICATED:return B.UNAUTHENTICATED;case be.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case be.NOT_FOUND:return B.NOT_FOUND;case be.ALREADY_EXISTS:return B.ALREADY_EXISTS;case be.PERMISSION_DENIED:return B.PERMISSION_DENIED;case be.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case be.ABORTED:return B.ABORTED;case be.OUT_OF_RANGE:return B.OUT_OF_RANGE;case be.UNIMPLEMENTED:return B.UNIMPLEMENTED;case be.DATA_LOSS:return B.DATA_LOSS;default:return Q()}}(oe=be||(be={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eM(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM=new $r([4294967295,4294967295],0);function Ry(t){const e=eM().encode(t),n=new gI;return n.update(e),new Uint8Array(n.digest())}function Py(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $r([n,r],0),new $r([i,o],0)]}class jh{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ds(`Invalid padding: ${n}`);if(r<0)throw new ds(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ds(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ds(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$r.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply($r.fromNumber(r)));return i.compare(tM)===1&&(i=new $r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Ry(e),[r,i]=Py(n);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new jh(o,i,n);return r.forEach(u=>s.insert(u)),s}insert(e){if(this.Ie===0)return;const n=Ry(e),[r,i]=Py(n);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ds extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,fl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new zu(X.min(),i,new we(ee),Nt(),ne())}}class fl{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fl(r,n,ne(),ne(),ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class lC{constructor(e,n){this.targetId=e,this.me=n}}class aC{constructor(e,n,r=Oe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class xy{constructor(){this.fe=0,this.ge=Dy(),this.pe=Oe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ne(),n=ne(),r=ne();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Q()}}),new fl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Dy()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class nM{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nt(),this.qe=My(),this.Qe=new we(ee)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(au(o))if(r===0){const s=new H(o.path);this.Ue(n,s,Ne.newNoDocument(s,X.min()))}else Y(r===1);else{const s=this.Ye(n);if(s!==r){const u=this.Ze(e),c=u?this.Xe(u,e,s):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let s,u;try{s=gr(r).toUint8Array()}catch(c){if(c instanceof VI)return Zr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new jh(s,i,o)}catch(c){return Zr(c instanceof ds?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const s=this.Le.tt(),u=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,s)=>{const u=this.Je(s);if(u){if(o.current&&au(u.target)){const c=new H(u.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,Ne.newNoDocument(c,e))}o.be&&(n.set(s,o.ve()),o.Ce())}});let r=ne();this.qe.forEach((o,s)=>{let u=!0;s.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));const i=new zu(e,n,this.Qe,this.ke,r);return this.ke=Nt(),this.qe=My(),this.Qe=new we(ee),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new xy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new he(ee),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new xy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function My(){return new we(H.comparator)}function Dy(){return new we(H.comparator)}const rM={asc:"ASCENDING",desc:"DESCENDING"},iM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},oM={and:"AND",or:"OR"};class sM{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Cf(t,e){return t.useProto3Json||bu(e)?e:{value:e}}function go(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function uC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function lM(t,e){return go(t,e.toTimestamp())}function vt(t){return Y(!!t),X.fromTimestamp(function(n){const r=Fn(n);return new xe(r.seconds,r.nanos)}(t))}function ep(t,e){return wf(t,e).canonicalString()}function wf(t,e){const n=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function cC(t){const e=ce.fromString(t);return Y(vC(e)),e}function cu(t,e){return ep(t.databaseId,e.path)}function zr(t,e){const n=cC(e);if(n.get(1)!==t.databaseId.projectId)throw new z(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new z(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new H(hC(n))}function dC(t,e){return ep(t.databaseId,e)}function fC(t){const e=cC(t);return e.length===4?ce.emptyPath():hC(e)}function Sf(t){return new ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function hC(t){return Y(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ky(t,e,n){return{name:cu(t,e),fields:n.value.mapValue.fields}}function aM(t,e,n){const r=zr(t,e.name),i=vt(e.updateTime),o=e.createTime?vt(e.createTime):X.min(),s=new lt({mapValue:{fields:e.fields}}),u=Ne.newFoundDocument(r,i,o,s);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function uM(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,h){return d.useProto3Json?(Y(h===void 0||typeof h=="string"),Oe.fromBase64String(h||"")):(Y(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Oe.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(d){const h=d.code===void 0?B.UNKNOWN:sC(d.code);return new z(h,d.message||"")}(s);n=new aC(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=zr(t,r.document.name),o=vt(r.document.updateTime),s=r.document.createTime?vt(r.document.createTime):X.min(),u=new lt({mapValue:{fields:r.document.fields}}),c=Ne.newFoundDocument(i,o,s,u),d=r.targetIds||[],h=r.removedTargetIds||[];n=new xa(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=zr(t,r.document),o=r.readTime?vt(r.readTime):X.min(),s=Ne.newNoDocument(i,o),u=r.removedTargetIds||[];n=new xa([],u,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=zr(t,r.document),o=r.removedTargetIds||[];n=new xa([],o,i,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new Zx(i,o),u=r.targetId;n=new lC(u,s)}}return n}function du(t,e){let n;if(e instanceof wo)n={update:ky(t,e.key,e.value)};else if(e instanceof $u)n={delete:cu(t,e.key)};else if(e instanceof bn)n={update:ky(t,e.key,e.data),updateMask:mM(e.fieldMask)};else{if(!(e instanceof oC))return Q();n={verify:cu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,s){const u=s.transform;if(u instanceof ho)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof po)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof mo)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof nl)return{fieldPath:s.field.canonicalString(),increment:u.Pe};throw Q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:lM(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Q()}(t,e.precondition)),n}function Af(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?gt.updateTime(vt(o.updateTime)):o.exists!==void 0?gt.exists(o.exists):gt.none()}(e.currentDocument):gt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,u){let c=null;if("setToServerValue"in u)Y(u.setToServerValue==="REQUEST_TIME"),c=new ho;else if("appendMissingElements"in u){const h=u.appendMissingElements.values||[];c=new po(h)}else if("removeAllFromArray"in u){const h=u.removeAllFromArray.values||[];c=new mo(h)}else"increment"in u?c=new nl(s,u.increment):Q();const d=Re.fromServerFormat(u.fieldPath);return new nC(d,c)}(t,i)):[];if(e.update){e.update.name;const i=zr(t,e.update.name),o=new lt({mapValue:{fields:e.update.fields}});if(e.updateMask){const s=function(c){const d=c.fieldPaths||[];return new St(d.map(h=>Re.fromServerFormat(h)))}(e.updateMask);return new bn(i,o,s,n,r)}return new wo(i,o,n,r)}if(e.delete){const i=zr(t,e.delete);return new $u(i,n)}if(e.verify){const i=zr(t,e.verify);return new oC(i,n)}return Q()}function cM(t,e){return t&&t.length>0?(Y(e!==void 0),t.map(n=>function(i,o){let s=i.updateTime?vt(i.updateTime):vt(o);return s.isEqual(X.min())&&(s=vt(o)),new Qx(s,i.transformResults||[])}(n,e))):[]}function pC(t,e){return{documents:[dC(t,e.path)]}}function mC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=dC(t,i);const o=function(d){if(d.length!==0)return _C(de.create(d,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const s=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Ri(m.field),direction:fM(m.dir)}}(h))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const u=Cf(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:i}}function gC(t){let e=fC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Y(r===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];n.where&&(o=function(p){const m=yC(p);return m instanceof de&&Wh(m)?m.getFilters():[m]}(n.where));let s=[];n.orderBy&&(s=function(p){return p.map(m=>function(w){return new tl(Pi(w.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(m))}(n.orderBy));let u=null;n.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,bu(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(p){const m=!!p.before,_=p.values||[];return new co(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,_=p.values||[];return new co(_,m)}(n.endAt)),Fx(e,i,s,o,u,"F",c,d)}function dM(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function yC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Pi(n.unaryFilter.field);return ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Pi(n.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Pi(n.unaryFilter.field);return ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Pi(n.unaryFilter.field);return ie.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(t):t.fieldFilter!==void 0?function(n){return ie.create(Pi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return de.create(n.compositeFilter.filters.map(r=>yC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Q()}}(n.compositeFilter.op))}(t):Q()}function fM(t){return rM[t]}function hM(t){return iM[t]}function pM(t){return oM[t]}function Ri(t){return{fieldPath:t.canonicalString()}}function Pi(t){return Re.fromServerFormat(t.fieldPath)}function _C(t){return t instanceof ie?function(n){if(n.op==="=="){if(my(n.value))return{unaryFilter:{field:Ri(n.field),op:"IS_NAN"}};if(py(n.value))return{unaryFilter:{field:Ri(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(my(n.value))return{unaryFilter:{field:Ri(n.field),op:"IS_NOT_NAN"}};if(py(n.value))return{unaryFilter:{field:Ri(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ri(n.field),op:hM(n.op),value:n.value}}}(t):t instanceof de?function(n){const r=n.getFilters().map(i=>_C(i));return r.length===1?r[0]:{compositeFilter:{op:pM(n.op),filters:r}}}(t):Q()}function mM(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function vC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,n,r,i,o=X.min(),s=X.min(),u=Oe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new Pn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Pn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(e){this.ct=e}}function gM(t,e){let n;if(e.document)n=aM(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=H.fromSegments(e.noDocument.path),i=ri(e.noDocument.readTime);n=Ne.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const r=H.fromSegments(e.unknownDocument.path),i=ri(e.unknownDocument.version);n=Ne.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new xe(i[0],i[1]);return X.fromTimestamp(o)}(e.readTime)),n}function Ny(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:fu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:cu(o,s.key),fields:s.data.value.mapValue.fields,updateTime:go(o,s.version.toTimestamp()),createTime:go(o,s.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ni(e.version)};else{if(!e.isUnknownDocument())return Q();r.unknownDocument={path:n.path.toArray(),version:ni(e.version)}}return r}function fu(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ni(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ri(t){const e=new xe(t.seconds,t.nanoseconds);return X.fromTimestamp(e)}function Lr(t,e){const n=(e.baseMutations||[]).map(o=>Af(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];s.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>Af(t.ct,o)),i=xe.fromMillis(e.localWriteTimeMs);return new Yh(e.batchId,i,n,r)}function fs(t){const e=ri(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ri(t.lastLimboFreeSnapshotVersion):X.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return Y(o.documents.length===1),Wt(Jh(fC(o.documents[0])))}(t.query):function(o){return Wt(gC(o))}(t.query),new Pn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Oe.fromBase64String(t.resumeToken))}function EC(t,e){const n=ni(e.snapshotVersion),r=ni(e.lastLimboFreeSnapshotVersion);let i;i=au(e.target)?pC(t.ct,e.target):mC(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ti(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function IC(t){const e=gC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?If(e,e.limit,"L"):e}function id(t,e){return new Zh(e.largestBatchId,Af(t.ct,e.overlayMutation))}function Vy(t,e){const n=e.path.lastSegment();return[t,_t(e.path.popLast()),n]}function Ly(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ni(r.readTime),documentKey:_t(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yM{getBundleMetadata(e,n){return Fy(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ri(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return Fy(e).put(function(i){return{bundleId:i.id,createTime:ni(vt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return Uy(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:IC(o.bundledQuery),readTime:ri(o.readTime)}}(r)})}saveNamedQuery(e,n){return Uy(e).put(function(i){return{name:i.name,readTime:ni(vt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Fy(t){return $e(t,"bundles")}function Uy(t){return $e(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Hu(e,r)}getOverlay(e,n){return Zo(e).get(Vy(this.userId,n)).next(r=>r?id(this.serializer,r):null)}getOverlays(e,n){const r=dn();return L.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,s)=>{const u=new Zh(n,s);i.push(this.ht(e,u))}),L.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(s=>i.add(_t(s.getCollectionPath())));const o=[];return i.forEach(s=>{const u=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(Zo(e).j("collectionPathOverlayIndex",u))}),L.waitFor(o)}getOverlaysForCollection(e,n,r){const i=dn(),o=_t(n),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return Zo(e).U("collectionPathOverlayIndex",s).next(u=>{for(const c of u){const d=id(this.serializer,c);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=dn();let s;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Zo(e).J({index:"collectionGroupOverlayIndex",range:u},(c,d,h)=>{const p=id(this.serializer,d);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,n){return Zo(e).put(function(i,o,s){const[u,c,d]=Vy(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:du(i.ct,s.mutation)}}(this.serializer,this.userId,n))}}function Zo(t){return $e(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _M{Pt(e){return $e(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Oe.fromUint8Array(r):Oe.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Ie(e.integerValue));else if("doubleValue"in e){const r=Ie(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Ys(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Fn(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(gr(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?LI(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Bu(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Q()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const s="value",u=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(Ie(u)),this.Vt(s,n),this.Tt(o[s],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),H.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Fr.vt=new Fr;function vM(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function by(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const s=vM(255&r[o]);if(i+=s,s!==8)break}return i}(t);return Math.ceil(e/8)}class TM{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=by(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=by(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class EM{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class IM{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class jo{constructor(){this.jt=new TM,this.Ht=new EM(this.jt),this.Jt=new IM(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ur(this.indexId,this.documentKey,this.arrayValue,r)}}function zn(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=By(t.arrayValue,e.arrayValue),n!==0?n:(n=By(t.directionalValue,e.directionalValue),n!==0?n:H.comparator(t.documentKey,e.documentKey)))}function By(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e){this.Xt=new he((n,r)=>Re.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Y(e.collectionGroup===this.collectionId),this.nn)return!1;const n=pf(e);if(n!==void 0&&!this.sn(n))return!1;const r=Nr(e);let i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const c=r[o];if(!this.on(u,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){const u=r[o];if(s>=this.en.length||!this._n(this.en[s++],u))return!1}return!0}an(){if(this.nn)return null;let e=new he(Re.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new wa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new wa(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new wa(r.field,r.dir==="asc"?0:1)));return new lu(lu.UNKNOWN_ID,this.collectionId,n,Qs.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(t){var e,n;if(Y(t instanceof ie||t instanceof de),t instanceof ie){if(t instanceof zI){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>ie.create(t.field,"==",o)))||[];return de.create(i,"or")}return t}const r=t.filters.map(i=>CC(i));return de.create(r,t.op)}function CM(t){if(t.getFilters().length===0)return[];const e=xf(CC(t));return Y(wC(e)),Rf(e)||Pf(e)?[e]:e.getFilters()}function Rf(t){return t instanceof ie}function Pf(t){return t instanceof de&&Wh(t)}function wC(t){return Rf(t)||Pf(t)||function(n){if(n instanceof de&&_f(n)){for(const r of n.getFilters())if(!Rf(r)&&!Pf(r))return!1;return!0}return!1}(t)}function xf(t){if(Y(t instanceof ie||t instanceof de),t instanceof ie)return t;if(t.filters.length===1)return xf(t.filters[0]);const e=t.filters.map(r=>xf(r));let n=de.create(e,t.op);return n=hu(n),wC(n)?n:(Y(n instanceof de),Y(fo(n)),Y(n.filters.length>1),n.filters.reduce((r,i)=>tp(r,i)))}function tp(t,e){let n;return Y(t instanceof ie||t instanceof de),Y(e instanceof ie||e instanceof de),n=t instanceof ie?e instanceof ie?function(i,o){return de.create([i,o],"and")}(t,e):qy(t,e):e instanceof ie?qy(e,t):function(i,o){if(Y(i.filters.length>0&&o.filters.length>0),fo(i)&&fo(o))return qI(i,o.getFilters());const s=_f(i)?i:o,u=_f(i)?o:i,c=s.filters.map(d=>tp(d,u));return de.create(c,"or")}(t,e),hu(n)}function qy(t,e){if(fo(e))return qI(e,t.getFilters());{const n=e.filters.map(r=>tp(t,r));return de.create(n,"or")}}function hu(t){if(Y(t instanceof ie||t instanceof de),t instanceof ie)return t;const e=t.getFilters();if(e.length===1)return hu(e[0]);if(BI(t))return t;const n=e.map(i=>hu(i)),r=[];return n.forEach(i=>{i instanceof ie?r.push(i):i instanceof de&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:de.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(){this.un=new np}addToCollectionParentIndex(e,n){return this.un.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(bt.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class np{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new he(ce.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new he(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const na=new Uint8Array(0);class SM{constructor(e,n){this.databaseId=n,this.cn=new np,this.ln=new wr(r=>ti(r),(r,i)=>cl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:_t(i)};return Gy(e).put(o)}return L.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[wI(n),""],!1,!0);return Gy(e).U(i).next(o=>{for(const s of o){if(s.collectionId!==n)break;r.push(cn(s.parent))}return r})}addFieldIndex(e,n){const r=es(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const s=Ci(e);return o.next(u=>{s.put(Ly(u,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=es(e),i=Ci(e),o=Ii(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=es(e),r=Ii(e),i=Ci(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return L.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new Oy(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=Ii(e);let i=!0;const o=new Map;return L.forEach(this.hn(n),s=>this.Pn(e,s).next(u=>{i&&(i=!!u),o.set(s,u)})).next(()=>{if(i){let s=ne();const u=[];return L.forEach(o,(c,d)=>{q("IndexedDbIndexManager",`Using index ${function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(D=>`${D.fieldPath}:${D.kind}`).join(",")}`}(c)} to execute ${ti(n)}`);const h=function(I,D){const F=pf(D);if(F===void 0)return null;for(const U of uu(I,F.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(d,c),p=function(I,D){const F=new Map;for(const U of Nr(D))for(const C of uu(I,U.fieldPath))switch(C.op){case"==":case"in":F.set(U.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return F.set(U.fieldPath.canonicalString(),C.value),Array.from(F.values())}return null}(d,c),m=function(I,D){const F=[];let U=!0;for(const C of Nr(D)){const E=C.kind===0?Ty(I,C.fieldPath,I.startAt):Ey(I,C.fieldPath,I.startAt);F.push(E.value),U&&(U=E.inclusive)}return new co(F,U)}(d,c),_=function(I,D){const F=[];let U=!0;for(const C of Nr(D)){const E=C.kind===0?Ey(I,C.fieldPath,I.endAt):Ty(I,C.fieldPath,I.endAt);F.push(E.value),U&&(U=E.inclusive)}return new co(F,U)}(d,c),w=this.In(c,d,m),R=this.In(c,d,_),k=this.Tn(c,d,p),S=this.En(c.indexId,h,w,m.inclusive,R,_.inclusive,k);return L.forEach(S,v=>r.G(v,n.limit).next(I=>{I.forEach(D=>{const F=H.fromSegments(D.documentKey);s.has(F)||(s=s.add(F),u.push(F))})}))}).next(()=>u)}return L.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=CM(de.create(e.filters,"and")).map(r=>Tf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,s,u){const c=(n!=null?n.length:1)*Math.max(r.length,o.length),d=c/(n!=null?n.length:1),h=[];for(let p=0;p<c;++p){const m=n?this.dn(n[p/d]):na,_=this.An(e,m,r[p%d],i),w=this.Rn(e,m,o[p%d],s),R=u.map(k=>this.An(e,m,k,!0));h.push(...this.createRange(_,w,R))}return h}An(e,n,r,i){const o=new Ur(e,H.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Ur(e,H.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new Oy(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(const u of o)r.rn(u)&&(!s||u.fields.length>s.fields.length)&&(s=u);return s})}getIndexType(e,n){let r=2;const i=this.hn(n);return L.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let d=new he(Re.comparator),h=!1;for(const p of c.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of c.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new jo;for(const i of Nr(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const s=r.Yt(i.kind);Fr.vt.It(o,s)}return r.zt()}dn(e){const n=new jo;return Fr.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new jo;return Fr.vt.It(js(this.databaseId,n),r.Yt(function(o){const s=Nr(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new jo);let o=0;for(const s of Nr(e)){const u=r[o++];for(const c of i)if(this.fn(n,s.fieldPath)&&el(u))i=this.gn(i,s,u);else{const d=c.Yt(s.kind);Fr.vt.It(u,d)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const s of r.arrayValue.values||[])for(const u of i){const c=new jo;c.seed(u.zt()),Fr.vt.It(s,c.Yt(n.kind)),o.push(c)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=es(e),i=Ci(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const s=[];return L.forEach(o,u=>i.get([u.indexId,this.uid]).next(c=>{s.push(function(h,p){const m=p?new Qs(p.sequenceNumber,new bt(ri(p.readTime),new H(cn(p.documentKey)),p.largestBatchId)):Qs.empty(),_=h.fields.map(([w,R])=>new wa(Re.fromServerFormat(w),R));return new lu(h.indexId,h.collectionGroup,_,m)}(u,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=es(e),o=Ci(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>L.forEach(u,c=>o.put(Ly(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,n){const r=new Map;return L.forEach(n,(i,o)=>{const s=r.get(i.collectionGroup);return(s?L.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),L.forEach(u,c=>this.wn(e,i,c).next(d=>{const h=this.Sn(o,c);return d.isEqual(h)?L.resolve():this.bn(e,o,c,d,h)}))))})}Dn(e,n,r,i){return Ii(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Ii(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Ii(e);let o=new he(zn);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(s,u)=>{o=o.add(new Ur(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>o)}Sn(e,n){let r=new he(zn);const i=this.Vn(n,e);if(i==null)return r;const o=pf(n);if(o!=null){const s=e.data.field(o.fieldPath);if(el(s))for(const u of s.arrayValue.values||[])r=r.add(new Ur(n.indexId,e.key,this.dn(u),i))}else r=r.add(new Ur(n.indexId,e.key,na,i));return r}bn(e,n,r,i,o){q("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const s=[];return function(c,d,h,p,m){const _=c.getIterator(),w=d.getIterator();let R=Ei(_),k=Ei(w);for(;R||k;){let S=!1,v=!1;if(R&&k){const I=h(R,k);I<0?v=!0:I>0&&(S=!0)}else R!=null?v=!0:S=!0;S?(p(k),k=Ei(w)):v?(m(R),R=Ei(_)):(R=Ei(_),k=Ei(w))}}(i,o,zn,u=>{s.push(this.Dn(e,n,r,u))},u=>{s.push(this.vn(e,n,r,u))}),L.waitFor(s)}yn(e){let n=1;return Ci(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((s,u)=>zn(s,u)).filter((s,u,c)=>!u||zn(s,c[u-1])!==0);const i=[];i.push(e);for(const s of r){const u=zn(s,e),c=zn(s,n);if(u===0)i[0]=e.Zt();else if(u>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(n);const o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];const u=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,na,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,na,[]];o.push(IDBKeyRange.bound(u,c))}return o}Cn(e,n){return zn(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next($y)}getMinOffset(e,n){return L.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||Q())).next($y)}}function Gy(t){return $e(t,"collectionParents")}function Ii(t){return $e(t,"indexEntries")}function es(t){return $e(t,"indexConfiguration")}function Ci(t){return $e(t,"indexState")}function $y(t){Y(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Gh(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new bt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class It{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new It(e,It.DEFAULT_COLLECTION_PERCENTILE,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],s=IDBKeyRange.only(n.batchId);let u=0;const c=r.J({range:s},(h,p,m)=>(u++,m.delete()));o.push(c.next(()=>{Y(u===1)}));const d=[];for(const h of n.mutations){const p=xI(e,h.key.path,n.batchId);o.push(i.delete(p)),d.push(h.key)}return L.waitFor(o).next(()=>d)}function pu(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */It.DEFAULT_COLLECTION_PERCENTILE=10,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,It.DEFAULT=new It(41943040,It.DEFAULT_COLLECTION_PERCENTILE,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),It.DISABLED=new It(-1,0,0);class Ku{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){Y(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new Ku(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hn(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{n=!1,s.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=xi(e),s=Hn(e);return s.add({}).next(u=>{Y(typeof u=="number");const c=new Yh(u,n,r,i),d=function(_,w,R){const k=R.baseMutations.map(v=>du(_.ct,v)),S=R.mutations.map(v=>du(_.ct,v));return{userId:w,batchId:R.batchId,localWriteTimeMs:R.localWriteTime.toMillis(),baseMutations:k,mutations:S}}(this.serializer,this.userId,c),h=[];let p=new he((m,_)=>ee(m.canonicalString(),_.canonicalString()));for(const m of i){const _=xI(this.userId,m.key.path,u);p=p.add(m.key.path.popLast()),h.push(s.put(d)),h.push(o.put(_,sx))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[u]=c.keys()}),L.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return Hn(e).get(n).next(r=>r?(Y(r.userId===this.userId),Lr(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?L.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return Hn(e).J({index:"userMutationsIndex",range:i},(s,u,c)=>{u.userId===this.userId&&(Y(u.batchId>=r),o=Lr(this.serializer,u)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Hn(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Hn(e).U("userMutationsIndex",n).next(r=>r.map(i=>Lr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Sa(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return xi(e).J({range:i},(s,u,c)=>{const[d,h,p]=s,m=cn(h);if(d===this.userId&&n.path.isEqual(m))return Hn(e).get(p).next(_=>{if(!_)throw Q();Y(_.userId===this.userId),o.push(Lr(this.serializer,_))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new he(ee);const i=[];return n.forEach(o=>{const s=Sa(this.userId,o.path),u=IDBKeyRange.lowerBound(s),c=xi(e).J({range:u},(d,h,p)=>{const[m,_,w]=d,R=cn(_);m===this.userId&&o.path.isEqual(R)?r=r.add(w):p.done()});i.push(c)}),L.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=Sa(this.userId,r),s=IDBKeyRange.lowerBound(o);let u=new he(ee);return xi(e).J({range:s},(c,d,h)=>{const[p,m,_]=c,w=cn(m);p===this.userId&&r.isPrefixOf(w)?w.length===i&&(u=u.add(_)):h.done()}).next(()=>this.xn(e,u))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(Hn(e).get(o).next(s=>{if(s===null)throw Q();Y(s.userId===this.userId),r.push(Lr(this.serializer,s))}))}),L.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return SC(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),L.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return L.resolve();const r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return xi(e).J({range:r},(o,s,u)=>{if(o[0]===this.userId){const c=cn(o[1]);i.push(c)}else u.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,n){return AC(e,this.userId,n)}Nn(e){return RC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function AC(t,e,n){const r=Sa(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let s=!1;return xi(t).J({range:o,H:!0},(u,c,d)=>{const[h,p,m]=u;h===e&&p===i&&(s=!0),d.done()}).next(()=>s)}function Hn(t){return $e(t,"mutations")}function xi(t){return $e(t,"documentMutations")}function RC(t){return $e(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ii(0)}static kn(){return new ii(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AM{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ii(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>X.fromTimestamp(new xe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>wi(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return wi(e).J((s,u)=>{const c=fs(u);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>L.waitFor(o)).next(()=>i)}forEachTarget(e,n){return wi(e).J((r,i)=>{const o=fs(i);n(o)})}qn(e){return Hy(e).get("targetGlobalKey").next(n=>(Y(n!==null),n))}Qn(e,n){return Hy(e).put("targetGlobalKey",n)}Kn(e,n){return wi(e).put(EC(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ti(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return wi(e).J({range:i,index:"queryTargetsIndex"},(s,u,c)=>{const d=fs(u);cl(n,d.target)&&(o=d,c.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=Yn(e);return n.forEach(s=>{const u=_t(s.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,s))}),L.waitFor(i)}removeMatchingKeys(e,n,r){const i=Yn(e);return L.forEach(n,o=>{const s=_t(o.path);return L.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=Yn(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Yn(e);let o=ne();return i.J({range:r,H:!0},(s,u,c)=>{const d=cn(s[1]),h=new H(d);o=o.add(h)}).next(()=>o)}containsKey(e,n){const r=_t(n.path),i=IDBKeyRange.bound([r],[wI(r)],!1,!0);let o=0;return Yn(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,u],c,d)=>{s!==0&&(o++,d.done())}).next(()=>o>0)}ot(e,n){return wi(e).get(n).next(r=>r?fs(r):null)}}function wi(t){return $e(t,"targets")}function Hy(t){return $e(t,"targetGlobal")}function Yn(t){return $e(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ky([t,e],[n,r]){const i=ee(t,n);return i===0?ee(e,r):i}class RM{constructor(e){this.Un=e,this.buffer=new he(Ky),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Ky(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class PM{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Cr(n)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ci(n)}await this.Hn(3e5)})}}class xM{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(zt.oe);const r=new RM(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(zy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zy):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,s,u,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,u=Date.now(),this.removeTargets(e,r,n))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Si()<=se.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(u-s)+`ms
	Removed ${o} targets in `+(c-u)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function MM(t,e){return new xM(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DM{constructor(e,n){this.db=e,this.garbageCollector=MM(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return ra(e,r)}removeReference(e,n,r){return ra(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ra(e,n)}nr(e,n){return function(i,o){let s=!1;return RC(i).Y(u=>AC(i,u,o).next(c=>(c&&(s=!0),L.resolve(!c)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(s,u)=>{if(u<=n){const c=this.nr(e,s).next(d=>{if(!d)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,X.min()),Yn(e).delete(function(p){return[0,_t(p.path)]}(s))))});i.push(c)}}).next(()=>L.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ra(e,n)}tr(e,n){const r=Yn(e);let i,o=zt.oe;return r.J({index:"documentTargetsIndex"},([s,u],{path:c,sequenceNumber:d})=>{s===0?(o!==zt.oe&&n(new H(cn(i)),o),o=d,i=c):o=zt.oe}).next(()=>{o!==zt.oe&&n(new H(cn(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ra(t,e){return Yn(t).put(function(r,i){return{targetId:0,path:_t(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.changes=new wr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ne.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xr(e).put(r)}removeEntry(e,n,r){return xr(e).delete(function(o,s){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],fu(s),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Ne.newInvalidDocument(n);return xr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ts(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:Ne.newInvalidDocument(n)};return xr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ts(n))},(i,o)=>{r={document:this.ir(n,o),size:pu(o)}}).next(()=>r)}getEntries(e,n){let r=Nt();return this._r(e,n,(i,o)=>{const s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,n){let r=Nt(),i=new we(H.comparator);return this._r(e,n,(o,s)=>{const u=this.ir(o,s);r=r.insert(o,u),i=i.insert(o,pu(s))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return L.resolve();let i=new he(Qy);n.forEach(c=>i=i.add(c));const o=IDBKeyRange.bound(ts(i.first()),ts(i.last())),s=i.getIterator();let u=s.getNext();return xr(e).J({index:"documentKeyIndex",range:o},(c,d,h)=>{const p=H.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;u&&Qy(u,p)<0;)r(u,null),u=s.getNext();u&&u.isEqual(p)&&(r(u,d),u=s.hasNext()?s.getNext():null),u?h.$(ts(u)):h.done()}).next(()=>{for(;u;)r(u,null),u=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const s=n.path,u=[s.popLast().toArray(),s.lastSegment(),fu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xr(e).U(IDBKeyRange.bound(u,c,!0)).next(d=>{o==null||o.incrementDocumentReadCount(d.length);let h=Nt();for(const p of d){const m=this.ir(H.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(dl(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let o=Nt();const s=Jy(n,r),u=Jy(n,bt.max());return xr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,u,!0)},(c,d,h)=>{const p=this.ir(H.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new NM(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Wy(e).get("remoteDocumentGlobalKey").next(n=>(Y(!!n),n))}rr(e,n){return Wy(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=gM(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return Ne.newInvalidDocument(e)}}function xC(t){return new kM(t)}class NM extends PC{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new wr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new he((o,s)=>ee(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{const u=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,u.readTime)),s.isValidDocument()){const c=Ny(this.cr.serializer,s);i=i.add(o.path.popLast());const d=pu(c);r+=d-u.size,n.push(this.cr.addEntry(e,o,c))}else if(r-=u.size,this.trackRemovals){const c=Ny(this.cr.serializer,s.convertToNoDocument(X.min()));n.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),L.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}}function Wy(t){return $e(t,"remoteDocumentGlobal")}function xr(t){return $e(t,"remoteDocumentsV14")}function ts(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Jy(t,e){const n=e.documentKey.path.toArray();return[t,fu(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Qy(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=ee(n[o],r[o]),i)return i;return i=ee(n.length,r.length),i||(i=ee(n[n.length-2],r[r.length-2]),i||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VM{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&As(r.mutation,i,St.empty(),xe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ne()){const i=dn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let s=cs();return o.forEach((u,c)=>{s=s.insert(u,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,n){const r=dn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ne()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,u)=>{n.set(s,u)})})}computeViews(e,n,r,i){let o=Nt();const s=Ss(),u=function(){return Ss()}();return n.forEach((c,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof bn)?o=o.insert(d.key,d):h!==void 0?(s.set(d.key,h.mutation.getFieldMask()),As(h.mutation,d,h.mutation.getFieldMask(),xe.now())):s.set(d.key,St.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((d,h)=>s.set(d,h)),n.forEach((d,h)=>{var p;return u.set(d,new VM(h,(p=s.get(d))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(e,n){const r=Ss();let i=new we((s,u)=>s-u),o=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(s=>{for(const u of s)u.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||St.empty();h=u.applyToLocalView(d,h),r.set(c,h);const p=(i.get(u.batchId)||ne()).add(c);i=i.insert(u.batchId,p)})}).next(()=>{const s=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,h=c.value,p=YI();h.forEach(m=>{if(!o.has(m)){const _=rC(n.get(m),r.get(m));_!==null&&p.set(m,_),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,d,p))}return L.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(s){return H.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):HI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):L.resolve(dn());let u=-1,c=o;return s.next(d=>L.forEach(d,(h,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),o.get(h)?L.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,c,d,ne())).next(h=>({batchId:u,changes:QI(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new H(n)).next(r=>{let i=cs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let s=cs();return this.indexManager.getCollectionParents(e,o).next(u=>L.forEach(u,c=>{const d=function(p,m){return new Co(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(s=>{o.forEach((c,d)=>{const h=d.getKey();s.get(h)===null&&(s=s.insert(h,Ne.newInvalidDocument(h)))});let u=cs();return s.forEach((c,d)=>{const h=o.get(c);h!==void 0&&As(h.mutation,d,St.empty(),xe.now()),dl(n,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LM{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return L.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:vt(i.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:IC(i.bundledQuery),readTime:vt(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(){this.overlays=new we(H.comparator),this.Ir=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=dn();return L.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const i=dn(),o=n.length+1,s=new H(n.child("")),u=this.overlays.getIteratorFrom(s);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new we((d,h)=>d-h);const s=this.overlays.getIterator();for(;s.hasNext();){const d=s.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=o.get(d.largestBatchId);h===null&&(h=dn(),o=o.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const u=dn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>u.set(d,h)),!(u.size()>=i)););return L.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new Zh(n,r));let o=this.Ir.get(n);o===void 0&&(o=ne(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UM{constructor(){this.sessionToken=Oe.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this.Tr=new he(ze.Er),this.dr=new he(ze.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ze(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ze(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new H(new ce([])),r=new ze(n,e),i=new ze(n,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new H(new ce([])),r=new ze(n,e),i=new ze(n,e+1);let o=ne();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){const n=new ze(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ze{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return H.comparator(e.key,n.key)||ee(e.wr,n.wr)}static Ar(e,n){return ee(e.wr,n.wr)||H.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bM{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new he(ze.Er)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Yh(o,n,r,i);this.mutationQueue.push(s);for(const u of i)this.br=this.br.add(new ze(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return L.resolve(s)}lookupMutationBatch(e,n){return L.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return L.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ze(n,0),i=new ze(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{const u=this.Dr(s.wr);o.push(u)}),L.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new he(ee);return n.forEach(i=>{const o=new ze(i,0),s=new ze(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],u=>{r=r.add(u.wr)})}),L.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;H.isDocumentKey(o)||(o=o.child(""));const s=new ze(new H(o),0);let u=new he(ee);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},s),L.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Y(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return L.forEach(n.mutations,i=>{const o=new ze(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ze(n,0),i=this.br.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BM{constructor(e){this.Mr=e,this.docs=function(){return new we(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Ne.newInvalidDocument(n))}getEntries(e,n){let r=Nt();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ne.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=Nt();const s=n.path,u=new H(s.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||Gh(SI(h),r)<=0||(i.has(h.key)||dl(n,h))&&(o=o.insert(h.key,h.mutableCopy()))}return L.resolve(o)}getAllFromCollectionGroup(e,n,r,i){Q()}Or(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new OM(this)}getSize(e){return L.resolve(this.size)}}class OM extends PC{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qM{constructor(e){this.persistence=e,this.Nr=new wr(n=>ti(n),cl),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Lr=0,this.Br=new rp,this.targetCount=0,this.kr=ii.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),L.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ii(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Kn(n),L.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((s,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),L.waitFor(o).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),L.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,n){this.qr={},this.overlays={},this.Qr=new zt(0),this.Kr=!1,this.Kr=!0,this.$r=new UM,this.referenceDelegate=e(this),this.Ur=new qM(this),this.indexManager=new wM,this.remoteDocumentCache=function(i){return new BM(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new TC(n),this.Gr=new LM(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new FM,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new bM(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const i=new GM(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return L.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class GM extends RI{constructor(e){super(),this.currentSequenceNumber=e}}class Wu{constructor(e){this.persistence=e,this.Jr=new rp,this.Yr=null}static Zr(e){return new Wu(e)}get Xr(){if(this.Yr)return this.Yr;throw Q()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),L.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.Xr,r=>{const i=H.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,X.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return L.or([()=>L.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $M{constructor(e){this.serializer=e}O(e,n,r,i){const o=new Uu("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uy,{unique:!0}),c.createObjectStore("documentMutations")}(e),Yy(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=L.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Yy(e)),s=s.next(()=>function(c){const d=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,d){return d.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uy,{unique:!0});const p=d.store("mutations"),m=h.map(_=>p.put(_));return L.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:_x});d.createIndex("collectionPathOverlayIndex",vx,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",Tx,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:lx});d.createIndex("documentKeyIndex",ax),d.createIndex("collectionGroupIndex",ux)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:px}).createIndex("sequenceNumberIndex",mx,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:gx}).createIndex("documentKeyIndex",yx,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=pu(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>L.forEach(i,o=>{const s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(u=>L.forEach(u,c=>{Y(c.userId===o.userId);const d=Lr(this.serializer,c);return SC(e,o.userId,d).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((s,u)=>{const c=new ce(s),d=function(p){return[0,_t(p)]}(c);o.push(n.get(d).next(h=>h?L.resolve():(p=>n.put({targetId:0,path:_t(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>L.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:hx});const r=n.store("collectionParents"),i=new np,o=s=>{if(i.add(s)){const u=s.lastSegment(),c=s.popLast();return r.put({collectionId:u,parent:_t(c)})}};return n.store("remoteDocuments").J({H:!0},(s,u)=>{const c=new ce(s);return o(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([s,u,c],d)=>{const h=cn(u);return o(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=fs(i),s=EC(this.serializer,o);return n.put(s)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,s)=>{const u=n.store("remoteDocumentsV14"),c=function(p){return p.document?new H(ce.fromString(p.document.name).popFirst(5)):p.noDocument?H.fromSegments(p.noDocument.path):p.unknownDocument?H.fromSegments(p.unknownDocument.path):Q()}(s).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(u.put(d))}).next(()=>L.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=xC(this.serializer),o=new DC(Wu.Zr,this.serializer.ct);return r.U().next(s=>{const u=new Map;return s.forEach(c=>{var d;let h=(d=u.get(c.userId))!==null&&d!==void 0?d:ne();Lr(this.serializer,c).keys().forEach(p=>h=h.add(p)),u.set(c.userId,h)}),L.forEach(u,(c,d)=>{const h=new Ye(d),p=Hu.lt(this.serializer,h),m=o.getIndexManager(h),_=Ku.lt(h,this.serializer,m,o.referenceDelegate);return new MC(i,_,p,m).recalculateAndSaveOverlaysForDocumentKeys(new mf(n,zt.oe),c).next()})})}}function Yy(t){t.createObjectStore("targetDocuments",{keyPath:dx}).createIndex("documentTargetsIndex",fx,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",cx,{unique:!0}),t.createObjectStore("targetGlobal")}const od="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ip{constructor(e,n,r,i,o,s,u,c,d,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=s,this.document=u,this.ci=d,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!ip.D())throw new z(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new DM(this,i),this.Ai=n+"main",this.serializer=new TC(c),this.Ri=new fr(this.Ai,this.hi,new $M(this.serializer)),this.$r=new _M,this.Ur=new AM(this.referenceDelegate,this.serializer),this.remoteDocumentCache=xC(this.serializer),this.Gr=new yM,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&mt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new z(B.FAILED_PRECONDITION,od);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new zt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ia(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Cr(e))return q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ns(e).get("owner").next(n=>L.resolve(this.vi(n)))}Ci(e){return ia(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=$e(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),s=i.filter(u=>o.indexOf(u)===-1);return L.forEach(s,u=>r.delete(u.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?L.resolve(!0):ns(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new z(B.FAILED_PRECONDITION,od);return!1}}return!(!this.networkEnabled||!this.inForeground)||ia(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||s&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new mf(e,zt.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ia(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Ku.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new SM(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Hu.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){q("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(c){return c===17?Cx:c===16?Ix:c===15?zh:c===14?kI:c===13?DI:c===12?Ex:c===11?MI:void Q()}(this.hi);let s;return this.Ri.runTransaction(e,i,o,u=>(s=new mf(u,this.Qr?this.Qr.next():zt.oe),n==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new z(B.FAILED_PRECONDITION,AI);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(u=>(s.raiseOnCommittedEvent(),u))}Ki(e){return ns(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new z(B.FAILED_PRECONDITION,od)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ns(e).put("owner",n)}static D(){return fr.D()}bi(e){const n=ns(e);return n.get("owner").next(r=>this.vi(r)?(q("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):L.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;iI()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){mt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ns(t){return $e(t,"owner")}function ia(t){return $e(t,"clientMetadata")}function zM(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ne(),i=ne();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new op(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return iI()?8:PI(ou())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new HM;return this.Xi(e,n,s).next(u=>{if(o.result=u,this.zi)return this.es(e,n,s,u.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Si()<=se.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Ai(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),L.resolve()):(Si()<=se.DEBUG&&q("QueryEngine","Query:",Ai(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Si()<=se.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Ai(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):L.resolve())}Yi(e,n){if(Iy(n))return L.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=If(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const s=ne(...o);return this.Ji.getDocuments(e,s).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,u);return this.ns(n,d,s,c.readTime)?this.Yi(e,If(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,i){return Iy(n)||i.isEqual(X.min())?L.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const s=this.ts(n,o);return this.ns(n,s,r,i)?L.resolve(null):(Si()<=se.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ai(n)),this.rs(e,s,n,jP(i,-1)).next(u=>u))})}ts(e,n){let r=new he(WI(e));return n.forEach((i,o)=>{dl(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return Si()<=se.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Ai(n)),this.Ji.getDocumentsMatchingQuery(e,n,bt.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new we(ee),this._s=new wr(o=>ti(o),cl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function NC(t,e,n,r){return new KM(t,e,n,r)}async function VC(t,e){const n=j(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const s=[],u=[];let c=ne();for(const d of i){s.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of o){u.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:s,addedBatchIds:u}))})})}function WM(t,e){const n=j(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,h){const p=d.batch,m=p.keys();let _=L.resolve();return m.forEach(w=>{_=_.next(()=>h.getEntry(c,w)).next(R=>{const k=d.docVersions.get(w);Y(k!==null),R.version.compareTo(k)<0&&(p.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),h.addEntry(R)))})}),_.next(()=>u.mutationQueue.removeMutationBatch(c,p))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=ne();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function LC(t){const e=j(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function JM(t,e){const n=j(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((h,p)=>{const m=i.get(p);if(!m)return;u.push(n.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(o,h.addedDocuments,p)));let _=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(Oe.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(p,_),function(R,k,S){return R.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(m,_,h)&&u.push(n.Ur.updateTargetData(o,_))});let c=Nt(),d=ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,h))}),u.push(QM(o,s,e.documentUpdates).next(h=>{c=h.Ps,d=h.Is})),!r.isEqual(X.min())){const h=n.Ur.getLastRemoteSnapshotVersion(o).next(p=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>s.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,c,d)).next(()=>c)}).then(o=>(n.os=i,o))}function QM(t,e,n){let r=ne(),i=ne();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let s=Nt();return n.forEach((u,c)=>{const d=o.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(X.min())?(e.removeEntry(u,c.readTime),s=s.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),s=s.insert(u,c)):q("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function YM(t,e){const n=j(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function XM(t,e){const n=j(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,L.resolve(i)):n.Ur.allocateTargetId(r).next(s=>(i=new Pn(e,s,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Mf(t,e,n){const r=j(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Cr(s))throw s;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Xy(t,e,n){const r=j(t);let i=X.min(),o=ne();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,d,h){const p=j(c),m=p._s.get(h);return m!==void 0?L.resolve(p.os.get(m)):p.Ur.getTargetData(d,h)}(r,s,Wt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,u.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,n?i:X.min(),n?o:ne())).next(u=>(ZM(r,bx(e),u),{documents:u,Ts:o})))}function ZM(t,e,n){let r=t.us.get(e)||X.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}class Zy{constructor(){this.activeTargetIds=zx()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class FC{constructor(){this.so=new Zy,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Zy,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jy{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oa=null;function sd(){return oa===null?oa=function(){return 268435456+Math.round(2147483648*Math.random())}():oa++,"0x"+oa.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tD{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ot="WebChannelConnection";class nD extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,s){const u=sd(),c=this.xo(n,r.toUriEncodedString());q("RestConnection",`Sending RPC '${n}' ${u}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,s),this.No(n,c,d,i).then(h=>(q("RestConnection",`Received RPC '${n}' ${u}: `,h),h),h=>{throw Zr("RestConnection",`RPC '${n}' ${u} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(n,r,i,o,s,u){return this.Mo(n,r,i,o,s)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Io}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>n[s]=o),i&&i.headers.forEach((o,s)=>n[s]=o)}xo(n,r){const i=eD[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=sd();return new Promise((s,u)=>{const c=new yI;c.setWithCredentials(!0),c.listenOnce(_I.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ca.NO_ERROR:const h=c.getResponseJson();q(ot,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Ca.TIMEOUT:q(ot,`RPC '${e}' ${o} timed out`),u(new z(B.DEADLINE_EXCEEDED,"Request time out"));break;case Ca.HTTP_ERROR:const p=c.getStatus();if(q(ot,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const w=function(k){const S=k.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(S)>=0?S:B.UNKNOWN}(_.status);u(new z(w,_.message))}else u(new z(B.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new z(B.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{q(ot,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);q(ot,`RPC '${e}' ${o} sending request:`,i),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const i=sd(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=EI(),u=TI(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=o.join("");q(ot,`Creating RPC '${e}' stream ${i}: ${h}`,c);const p=s.createWebChannel(h,c);let m=!1,_=!1;const w=new tD({Io:k=>{_?q(ot,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(m||(q(ot,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),q(ot,`RPC '${e}' stream ${i} sending:`,k),p.send(k))},To:()=>p.close()}),R=(k,S,v)=>{k.listen(S,I=>{try{v(I)}catch(D){setTimeout(()=>{throw D},0)}})};return R(p,us.EventType.OPEN,()=>{_||(q(ot,`RPC '${e}' stream ${i} transport opened.`),w.yo())}),R(p,us.EventType.CLOSE,()=>{_||(_=!0,q(ot,`RPC '${e}' stream ${i} transport closed`),w.So())}),R(p,us.EventType.ERROR,k=>{_||(_=!0,Zr(ot,`RPC '${e}' stream ${i} transport errored:`,k),w.So(new z(B.UNAVAILABLE,"The operation could not be completed")))}),R(p,us.EventType.MESSAGE,k=>{var S;if(!_){const v=k.data[0];Y(!!v);const I=v,D=I.error||((S=I[0])===null||S===void 0?void 0:S.error);if(D){q(ot,`RPC '${e}' stream ${i} received error:`,D);const F=D.status;let U=function(A){const P=be[A];if(P!==void 0)return sC(P)}(F),C=D.message;U===void 0&&(U=B.INTERNAL,C="Unknown error status: "+F+" with message "+D.message),_=!0,w.So(new z(U,C)),p.close()}else q(ot,`RPC '${e}' stream ${i} received:`,v),w.bo(v)}}),R(u,vI.STAT_EVENT,k=>{k.stat===hf.PROXY?q(ot,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===hf.NOPROXY&&q(ot,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.wo()},0),w}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rD(){return typeof window<"u"?window:null}function Ma(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(t){return new sM(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bC{constructor(e,n,r,i,o,s,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new UC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(mt(n.toString()),mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new z(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class iD extends bC{constructor(e,n,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,s),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=uM(this.serializer,e),r=function(o){if(!("targetChange"in o))return X.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?X.min():s.readTime?vt(s.readTime):X.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Sf(this.serializer),n.addTarget=function(o,s){let u;const c=s.target;if(u=au(c)?{documents:pC(o,c)}:{query:mC(o,c)._t},u.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){u.resumeToken=uC(o,s.resumeToken);const d=Cf(o,s.expectedCount);d!==null&&(u.expectedCount=d)}else if(s.snapshotVersion.compareTo(X.min())>0){u.readTime=go(o,s.snapshotVersion.toTimestamp());const d=Cf(o,s.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=dM(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Sf(this.serializer),n.removeTarget=e,this.a_(n)}}class oD extends bC{constructor(e,n,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=cM(e.writeResults,e.commitTime),r=vt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Sf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>du(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new z(B.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,wf(n,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(B.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,u])=>this.connection.Lo(e,wf(n,r),i,s,u,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(B.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lD{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(mt(n),this.D_=!1):q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aD{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(async()=>{fi(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=j(c);d.L_.add(4),await hl(d),d.q_.set("Unknown"),d.L_.delete(4),await Qu(d)}(this))})}),this.q_=new lD(r,i)}}async function Qu(t){if(fi(t))for(const e of t.B_)await e(!0)}async function hl(t){for(const e of t.B_)await e(!1)}function BC(t,e){const n=j(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),up(n)?ap(n):So(n).r_()&&lp(n,e))}function sp(t,e){const n=j(t),r=So(n);n.N_.delete(e),r.r_()&&OC(n,e),n.N_.size===0&&(r.r_()?r.o_():fi(n)&&n.q_.set("Unknown"))}function lp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}So(t).A_(e)}function OC(t,e){t.Q_.xe(e),So(t).R_(e)}function ap(t){t.Q_=new nM({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),So(t).start(),t.q_.v_()}function up(t){return fi(t)&&!So(t).n_()&&t.N_.size>0}function fi(t){return j(t).L_.size===0}function qC(t){t.Q_=void 0}async function uD(t){t.q_.set("Online")}async function cD(t){t.N_.forEach((e,n)=>{lp(t,e)})}async function dD(t,e){qC(t),up(t)?(t.q_.M_(e),ap(t)):t.q_.set("Unknown")}async function fD(t,e,n){if(t.q_.set("Online"),e instanceof aC&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const u of o.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,s),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await mu(t,r)}else if(e instanceof xa?t.Q_.Ke(e):e instanceof lC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(X.min()))try{const r=await LC(t.localStore);n.compareTo(r)>=0&&await function(o,s){const u=o.Q_.rt(s);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.N_.get(d);h&&o.N_.set(d,h.withResumeToken(c.resumeToken,s))}}),u.targetMismatches.forEach((c,d)=>{const h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken(Oe.EMPTY_BYTE_STRING,h.snapshotVersion)),OC(o,c);const p=new Pn(h.target,c,d,h.sequenceNumber);lp(o,p)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){q("RemoteStore","Failed to raise snapshot:",r),await mu(t,r)}}async function mu(t,e,n){if(!Cr(e))throw e;t.L_.add(1),await hl(t),t.q_.set("Offline"),n||(n=()=>LC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Qu(t)})}function GC(t,e){return e().catch(n=>mu(t,n,e))}async function pl(t){const e=j(t),n=_r(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;hD(e);)try{const i=await YM(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,pD(e,i)}catch(i){await mu(e,i)}$C(e)&&zC(e)}function hD(t){return fi(t)&&t.O_.length<10}function pD(t,e){t.O_.push(e);const n=_r(t);n.r_()&&n.V_&&n.m_(e.mutations)}function $C(t){return fi(t)&&!_r(t).n_()&&t.O_.length>0}function zC(t){_r(t).start()}async function mD(t){_r(t).p_()}async function gD(t){const e=_r(t);for(const n of t.O_)e.m_(n.mutations)}async function yD(t,e,n){const r=t.O_.shift(),i=Xh.from(r,e,n);await GC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await pl(t)}async function _D(t,e){e&&_r(t).V_&&await async function(r,i){if(function(s){return jx(s)&&s!==B.ABORTED}(i.code)){const o=r.O_.shift();_r(r).s_(),await GC(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await pl(r)}}(t,e),$C(t)&&zC(t)}async function e_(t,e){const n=j(t);n.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const r=fi(n);n.L_.add(3),await hl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Qu(n)}async function vD(t,e){const n=j(t);e?(n.L_.delete(2),await Qu(n)):e||(n.L_.add(2),await hl(n),n.q_.set("Unknown"))}function So(t){return t.K_||(t.K_=function(n,r,i){const o=j(n);return o.w_(),new iD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:uD.bind(null,t),Ro:cD.bind(null,t),mo:dD.bind(null,t),d_:fD.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),up(t)?ap(t):t.q_.set("Unknown")):(await t.K_.stop(),qC(t))})),t.K_}function _r(t){return t.U_||(t.U_=function(n,r,i){const o=j(n);return o.w_(),new oD(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mD.bind(null,t),mo:_D.bind(null,t),f_:gD.bind(null,t),g_:yD.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await pl(t)):(await t.U_.stop(),t.O_.length>0&&(q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cp{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new Mn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const s=Date.now()+r,u=new cp(e,n,s,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function dp(t,e){if(mt("AsyncQueue",`${e}: ${t}`),Cr(t))return new z(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this.comparator=e?(n,r)=>e(n,r)||H.comparator(n.key,r.key):(n,r)=>H.comparator(n.key,r.key),this.keyedMap=cs(),this.sortedSet=new we(this.comparator)}static emptySet(e){return new Yi(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Yi)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Yi;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t_{constructor(){this.W_=new we(H.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Q():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class yo{constructor(e,n,r,i,o,s,u,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,o){const s=[];return n.forEach(u=>{s.push({type:0,doc:u})}),new yo(e,n,Yi.emptySet(n),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ou(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TD{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class ED{constructor(){this.queries=n_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=j(n),o=i.queries;i.queries=n_(),o.forEach((s,u)=>{for(const c of u.j_)c.onError(r)})})(this,new z(B.ABORTED,"Firestore shutting down"))}}function n_(){return new wr(t=>KI(t),Ou)}async function ID(t,e){const n=j(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new TD,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(s){const u=dp(s,`Initialization of query '${Ai(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&fp(n)}async function CD(t,e){const n=j(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wD(t,e){const n=j(t);let r=!1;for(const i of e){const o=i.query,s=n.queries.get(o);if(s){for(const u of s.j_)u.X_(i)&&(r=!0);s.z_=i}}r&&fp(n)}function SD(t,e,n){const r=j(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function fp(t){t.Y_.forEach(e=>{e.next()})}var Df,r_;(r_=Df||(Df={})).ea="default",r_.Cache="cache";class AD{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new yo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Df.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.key=e}}class KC{constructor(e){this.key=e}}class RD{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ne(),this.mutatedKeys=ne(),this.Aa=WI(e),this.Ra=new Yi(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new t_,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,s=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{const m=i.get(h),_=dl(this.query,p)?p:null,w=!!m&&this.mutatedKeys.has(m.key),R=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let k=!1;m&&_?m.data.isEqual(_.data)?w!==R&&(r.track({type:3,doc:_}),k=!0):this.ga(m,_)||(r.track({type:2,doc:_}),k=!0,(c&&this.Aa(_,c)>0||d&&this.Aa(_,d)<0)&&(u=!0)):!m&&_?(r.track({type:0,doc:_}),k=!0):m&&!_&&(r.track({type:1,doc:m}),k=!0,(c||d)&&(u=!0)),k&&(_?(s=s.add(_),o=R?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((h,p)=>function(_,w){const R=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return R(_)-R(w)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,s.length!==0||d?{snapshot:new yo(this.query,e.Ra,o,s,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new t_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new KC(r))}),this.da.forEach(r=>{e.has(r)||n.push(new HC(r))}),n}ba(e){this.Ta=e.Ts,this.da=ne();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return yo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class PD{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class xD{constructor(e){this.key=e,this.va=!1}}class MD{constructor(e,n,r,i,o,s){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new wr(u=>KI(u),Ou),this.Ma=new Map,this.xa=new Set,this.Oa=new we(H.comparator),this.Na=new Map,this.La=new rp,this.Ba={},this.ka=new Map,this.qa=ii.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function DD(t,e,n=!0){const r=ZC(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await WC(r,e,n,!0),i}async function kD(t,e){const n=ZC(t);await WC(n,e,!0,!1)}async function WC(t,e,n,r){const i=await XM(t.localStore,Wt(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,n);let u;return r&&(u=await ND(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&n&&BC(t.remoteStore,i),u}async function ND(t,e,n,r,i){t.Ka=(p,m,_)=>async function(R,k,S,v){let I=k.view.ma(S);I.ns&&(I=await Xy(R.localStore,k.query,!1).then(({documents:C})=>k.view.ma(C,I)));const D=v&&v.targetChanges.get(k.targetId),F=v&&v.targetMismatches.get(k.targetId)!=null,U=k.view.applyChanges(I,R.isPrimaryClient,D,F);return o_(R,k.targetId,U.wa),U.snapshot}(t,p,m,_);const o=await Xy(t.localStore,e,!0),s=new RD(e,o.Ts),u=s.ma(o.documents),c=fl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=s.applyChanges(u,t.isPrimaryClient,c);o_(t,n,d.wa);const h=new PD(e,n,s);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function VD(t,e,n){const r=j(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!Ou(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Mf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&sp(r.remoteStore,i.targetId),kf(r,i.targetId)}).catch(ci)):(kf(r,i.targetId),await Mf(r.localStore,i.targetId,!0))}async function LD(t,e){const n=j(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),sp(n.remoteStore,r.targetId))}async function FD(t,e,n){const r=jC(t);try{const i=await function(s,u){const c=j(s),d=xe.now(),h=u.reduce((_,w)=>_.add(w.key),ne());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let w=Nt(),R=ne();return c.cs.getEntries(_,h).next(k=>{w=k,w.forEach((S,v)=>{v.isValidDocument()||(R=R.add(S))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,w)).next(k=>{p=k;const S=[];for(const v of u){const I=Xx(v,p.get(v.key).overlayedDocument);I!=null&&S.push(new bn(v.key,I,UI(I.value.mapValue),gt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,d,S,u)}).next(k=>{m=k;const S=k.applyToLocalDocumentSet(p,R);return c.documentOverlayCache.saveOverlays(_,k.batchId,S)})}).then(()=>({batchId:m.batchId,changes:QI(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,u,c){let d=s.Ba[s.currentUser.toKey()];d||(d=new we(ee)),d=d.insert(u,c),s.Ba[s.currentUser.toKey()]=d}(r,i.batchId,n),await ml(r,i.changes),await pl(r.remoteStore)}catch(i){const o=dp(i,"Failed to persist write");n.reject(o)}}async function JC(t,e){const n=j(t);try{const r=await JM(n.localStore,e);e.targetChanges.forEach((i,o)=>{const s=n.Na.get(o);s&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?Y(s.va):i.removedDocuments.size>0&&(Y(s.va),s.va=!1))}),await ml(n,r,e)}catch(r){await ci(r)}}function i_(t,e,n){const r=j(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,s)=>{const u=s.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(s,u){const c=j(s);c.onlineState=u;let d=!1;c.queries.forEach((h,p)=>{for(const m of p.j_)m.Z_(u)&&(d=!0)}),d&&fp(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function UD(t,e,n){const r=j(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let s=new we(H.comparator);s=s.insert(o,Ne.newNoDocument(o,X.min()));const u=ne().add(o),c=new zu(X.min(),new Map,new we(ee),s,u);await JC(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),hp(r)}else await Mf(r.localStore,e,!1).then(()=>kf(r,e,n)).catch(ci)}async function bD(t,e){const n=j(t),r=e.batch.batchId;try{const i=await WM(n.localStore,e);YC(n,r,null),QC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ml(n,i)}catch(i){await ci(i)}}async function BD(t,e,n){const r=j(t);try{const i=await function(s,u){const c=j(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,u).next(p=>(Y(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);YC(r,e,n),QC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ml(r,i)}catch(i){await ci(i)}}function QC(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function YC(t,e,n){const r=j(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function kf(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||XC(t,r)})}function XC(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(sp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),hp(t))}function o_(t,e,n){for(const r of n)r instanceof HC?(t.La.addReference(r.key,e),OD(t,r)):r instanceof KC?(q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||XC(t,r.key)):Q()}function OD(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(q("SyncEngine","New document in limbo: "+n),t.xa.add(r),hp(t))}function hp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new H(ce.fromString(e)),r=t.qa.next();t.Na.set(r,new xD(n)),t.Oa=t.Oa.insert(n,r),BC(t.remoteStore,new Pn(Wt(Jh(n.path)),r,"TargetPurposeLimboResolution",zt.oe))}}async function ml(t,e,n){const r=j(t),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{s.push(r.Ka(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(d){i.push(d);const p=op.Wi(c.targetId,d);o.push(p)}}))}),await Promise.all(s),r.Ca.d_(i),await async function(c,d){const h=j(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>L.forEach(d,m=>L.forEach(m.$i,_=>h.persistence.referenceDelegate.addReference(p,m.targetId,_)).next(()=>L.forEach(m.Ui,_=>h.persistence.referenceDelegate.removeReference(p,m.targetId,_)))))}catch(p){if(!Cr(p))throw p;q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const _=h.os.get(m),w=_.snapshotVersion,R=_.withLastLimboFreeSnapshotVersion(w);h.os=h.os.insert(m,R)}}}(r.localStore,o))}async function qD(t,e){const n=j(t);if(!n.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const r=await VC(n.localStore,e);n.currentUser=e,function(o,s){o.ka.forEach(u=>{u.forEach(c=>{c.reject(new z(B.CANCELLED,s))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ml(n,r.hs)}}function GD(t,e){const n=j(t),r=n.Na.get(e);if(r&&r.va)return ne().add(r.key);{let i=ne();const o=n.Ma.get(e);if(!o)return i;for(const s of o){const u=n.Fa.get(s);i=i.unionWith(u.view.Va)}return i}}function ZC(t){const e=j(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=JC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=GD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=UD.bind(null,e),e.Ca.d_=wD.bind(null,e.eventManager),e.Ca.$a=SD.bind(null,e.eventManager),e}function jC(t){const e=j(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=bD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=BD.bind(null,e),e}class rl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ju(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return NC(this.persistence,new kC,e.initialUser,this.serializer)}Ga(e){return new DC(Wu.Zr,this.serializer)}Wa(e){return new FC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rl.provider={build:()=>new rl};class $D extends rl{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await jC(this.Ja.syncEngine),await pl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return NC(this.persistence,new kC,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new PM(r,e.asyncQueue,n)}Ha(e,n){const r=new rx(n,this.persistence);return new nx(e.asyncQueue,r)}Ga(e){const n=zM(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?It.withCacheSize(this.cacheSizeBytes):It.DEFAULT;return new ip(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,rD(),Ma(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new FC}}class gu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>i_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=qD.bind(null,this.syncEngine),await vD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new ED}()}createDatastore(e){const n=Ju(e.databaseInfo.databaseId),r=function(o){return new nD(o)}(e.databaseInfo);return function(o,s,u,c){return new sD(o,s,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,s,u){return new aD(r,i,o,s,u)}(this.localStore,this.datastore,e.asyncQueue,n=>i_(this.syncEngine,n,0),function(){return jy.D()?new jy:new jM}())}createSyncEngine(e,n){return function(i,o,s,u,c,d,h){const p=new MD(i,o,s,u,c,d);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=j(i);q("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await hl(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}gu.provider={build:()=>new gu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Ye.UNAUTHENTICATED,this.clientId=CI.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async s=>{q("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(q("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Mn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=dp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function ld(t,e){t.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await VC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function s_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await KD(t);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>e_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>e_(e.remoteStore,i)),t._onlineComponents=e}async function KD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await ld(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Zr("Error using user provided cache. Falling back to memory cache: "+n),await ld(t,new rl)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await ld(t,new rl);return t._offlineComponents}async function ew(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await s_(t,t._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await s_(t,new gu))),t._onlineComponents}function WD(t){return ew(t).then(e=>e.syncEngine)}async function JD(t){const e=await ew(t),n=e.eventManager;return n.onListen=DD.bind(null,e.syncEngine),n.onUnlisten=VD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=kD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=LD.bind(null,e.syncEngine),n}function QD(t,e,n={}){const r=new Mn;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,u,c,d){const h=new zD({next:m=>{h.Za(),s.enqueueAndForget(()=>CD(o,p)),m.fromCache&&c.source==="server"?d.reject(new z(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new AD(u,h,{includeMetadataChanges:!0,_a:!0});return ID(o,p)}(await JD(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nw(t,e,n){if(!n)throw new z(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function YD(t,e,n,r){if(e===!0&&r===!0)throw new z(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function a_(t){if(!H.isDocumentKey(t))throw new z(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function u_(t){if(H.isDocumentKey(t))throw new z(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Yu(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q()}function vr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new z(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Yu(t);throw new z(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new z(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}YD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Xu{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new z(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new zP;switch(r.type){case"firstParty":return new JP(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=l_.get(n);r&&(q("ComponentProvider","Removing Datastore"),l_.delete(n),r.terminate())}(this),Promise.resolve()}}function XD(t,e,n,r={}){var i;const o=(t=vr(t,Xu))._getSettings(),s=`${e}:${n}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&Zr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Ye.MOCK_USER;else{u=rI(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new z(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ye(d)}t._authCredentials=new HP(new II(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new hi(this.firestore,e,this._query)}}class Ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}}class hr extends hi{constructor(e,n,r){super(e,n,Jh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new H(e))}withConverter(e){return new hr(this.firestore,e,this._path)}}function rw(t,e,...n){if(t=xt(t),nw("collection","path",e),t instanceof Xu){const r=ce.fromString(e,...n);return u_(r),new hr(t,null,r)}{if(!(t instanceof Ft||t instanceof hr))throw new z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return u_(r),new hr(t.firestore,null,r)}}function pp(t,e,...n){if(t=xt(t),arguments.length===1&&(e=CI.newId()),nw("doc","path",e),t instanceof Xu){const r=ce.fromString(e,...n);return a_(r),new Ft(t,null,new H(r))}{if(!(t instanceof Ft||t instanceof hr))throw new z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return a_(r),new Ft(t.firestore,t instanceof hr?t.converter:null,new H(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new UC(this,"async_queue_retry"),this.Vu=()=>{const r=Ma();r&&q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ma();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ma();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Mn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cr(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(s){let u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),u}(r);throw mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=cp.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&Q()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ao extends Xu{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new d_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d_(e),this._firestoreClient=void 0,await e}}}function ZD(t,e){const n=typeof t=="object"?t:hI(),r=typeof t=="string"?t:"(default)",i=cI(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=tI("firestore");o&&XD(i,...o)}return i}function iw(t){if(t._terminated)throw new z(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||ow(t),t._firestoreClient}function ow(t){var e,n,r;const i=t._freezeSettings(),o=function(u,c,d,h){return new Sx(u,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,tw(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new HD(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}function jD(t,e){Zr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return ek(t,gu.provider,{build:r=>new $D(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function ek(t,e,n){if((t=vr(t,Ao))._firestoreClient||t._terminated)throw new z(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new z(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},ow(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _o(Oe.fromBase64String(e))}catch(n){throw new z(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _o(Oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new z(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Re(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new z(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new z(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk=/^__.*__$/;class nk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bn(e,this.data,this.fieldMask,n,this.fieldTransforms):new wo(e,this.data,n,this.fieldTransforms)}}class sw{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bn(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function lw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class yp{constructor(e,n,r,i,o,s){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new yp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(lw(this.Cu)&&tk.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class rk{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Ju(e)}Qu(e,n,r,i=!1){return new yp({Cu:e,methodName:n,qu:r,path:Re.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _p(t){const e=t._freezeSettings(),n=Ju(t._databaseId);return new rk(t._databaseId,!!e.ignoreUndefinedProperties,n)}function ik(t,e,n,r,i,o={}){const s=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);Tp("Data must be an object, but it was:",s,r);const u=aw(r,s);let c,d;if(o.merge)c=new St(s.fieldMask),d=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const p of o.mergeFields){const m=Nf(e,p,n);if(!s.contains(m))throw new z(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);cw(h,m)||h.push(m)}c=new St(h),d=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=s.fieldTransforms;return new nk(new lt(u),c,d)}class ec extends ju{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof ec}}class vp extends ju{_toFieldTransform(e){return new nC(e.path,new ho)}isEqual(e){return e instanceof vp}}function ok(t,e,n,r){const i=t.Qu(1,e,n);Tp("Data must be an object, but it was:",i,r);const o=[],s=lt.empty();di(r,(c,d)=>{const h=Ep(e,c,n);d=xt(d);const p=i.Nu(h);if(d instanceof ec)o.push(h);else{const m=gl(d,p);m!=null&&(o.push(h),s.set(h,m))}});const u=new St(o);return new sw(s,u,i.fieldTransforms)}function sk(t,e,n,r,i,o){const s=t.Qu(1,e,n),u=[Nf(e,r,n)],c=[i];if(o.length%2!=0)throw new z(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)u.push(Nf(e,o[m])),c.push(o[m+1]);const d=[],h=lt.empty();for(let m=u.length-1;m>=0;--m)if(!cw(d,u[m])){const _=u[m];let w=c[m];w=xt(w);const R=s.Nu(_);if(w instanceof ec)d.push(_);else{const k=gl(w,R);k!=null&&(d.push(_),h.set(_,k))}}const p=new St(d);return new sw(h,p,s.fieldTransforms)}function lk(t,e,n,r=!1){return gl(n,t.Qu(r?4:3,e))}function gl(t,e){if(uw(t=xt(t)))return Tp("Unsupported field value:",e,t),aw(t,e);if(t instanceof ju)return function(r,i){if(!lw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let s=0;for(const u of r){let c=gl(u,i.Lu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=xt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Hx(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=xe.fromDate(r);return{timestampValue:go(i.serializer,o)}}if(r instanceof xe){const o=new xe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:go(i.serializer,o)}}if(r instanceof mp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _o)return{bytesValue:uC(i.serializer,r._byteString)};if(r instanceof Ft){const o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ep(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof gp)return function(s,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return Qh(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Yu(r)}`)}(t,e)}function aw(t,e){const n={};return NI(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):di(t,(r,i)=>{const o=gl(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function uw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xe||t instanceof mp||t instanceof _o||t instanceof Ft||t instanceof ju||t instanceof gp)}function Tp(t,e,n){if(!uw(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Yu(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Nf(t,e,n){if((e=xt(e))instanceof Zu)return e._internalPath;if(typeof e=="string")return Ep(t,e);throw yu("Field path arguments must be of type string or ",t,!1,void 0,n)}const ak=new RegExp("[~\\*/\\[\\]]");function Ep(t,e,n){if(e.search(ak)>=0)throw yu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Zu(...e.split("."))._internalPath}catch{throw yu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function yu(t,e,n,r,i){const o=r&&!r.isEmpty(),s=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new z(B.INVALID_ARGUMENT,u+t+c)}function cw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new uk(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Ip("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class uk extends dw{data(){return super.data()}}function Ip(t,e){return typeof e=="string"?Ep(t,e):e instanceof Zu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ck(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new z(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Cp{}class fw extends Cp{}function dk(t,e,...n){let r=[];e instanceof Cp&&r.push(e),r=r.concat(n),function(o){const s=o.filter(c=>c instanceof Sp).length,u=o.filter(c=>c instanceof wp).length;if(s>1||s>0&&u>0)throw new z(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class wp extends fw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new wp(e,n,r)}_apply(e){const n=this._parse(e);return hw(e._query,n),new hi(e.firestore,e.converter,Ef(e._query,n))}_parse(e){const n=_p(e.firestore);return function(o,s,u,c,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new z(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){h_(p,h);const _=[];for(const w of p)_.push(f_(c,o,w));m={arrayValue:{values:_}}}else m=f_(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||h_(p,h),m=lk(u,s,p,h==="in"||h==="not-in");return ie.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Sp extends Cp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Sp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:de.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let s=i;const u=o.getFlattenedFilters();for(const c of u)hw(s,c),s=Ef(s,c)}(e._query,n),new hi(e.firestore,e.converter,Ef(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ap extends fw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ap(e,n)}_apply(e){const n=function(i,o,s){if(i.startAt!==null)throw new z(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new z(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tl(o,s)}(e._query,this._field,this._direction);return new hi(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Co(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function fk(t,e="asc"){const n=e,r=Ip("orderBy",t);return Ap._create(r,n)}function f_(t,e,n){if(typeof(n=xt(n))=="string"){if(n==="")throw new z(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!HI(e)&&n.indexOf("/")!==-1)throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ce.fromString(n));if(!H.isDocumentKey(r))throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return js(t,new H(r))}if(n instanceof Ft)return js(t,n._key);throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yu(n)}.`)}function h_(t,e){if(!Array.isArray(t)||t.length===0)throw new z(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function hw(t,e){const n=function(i,o){for(const s of i)for(const u of s.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new z(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new z(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class hk{convertValue(e,n="none"){switch(ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return di(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Ie(s.doubleValue));return new gp(o)}convertGeoPoint(e){return new mp(Ie(e.latitude),Ie(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Kh(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xs(e));default:return null}}convertTimestamp(e){const n=Fn(e);return new xe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ce.fromString(e);Y(vC(r));const i=new jr(r.get(1),r.get(3)),o=new H(r.popFirst(5));return i.isEqual(n)||mt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class mk extends dw{constructor(e,n,r,i,o,s){super(e,n,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Da(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Ip("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Da extends mk{data(e={}){return super.data(e)}}class gk{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new sa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Da(this._firestore,this._userDataWriter,r.key,r,new sa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new z(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(u=>{const c=new Da(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const c=new Da(i._firestore,i._userDataWriter,u.doc.key,u.doc,new sa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return u.type!==0&&(d=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),u.type!==1&&(s=s.add(u.doc),h=s.indexOf(u.doc.key)),{type:yk(u.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function yk(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}class _k extends hk{constructor(e){super(),this.firestore=e}convertBytes(e){return new _o(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,n)}}function vk(t){t=vr(t,hi);const e=vr(t.firestore,Ao),n=iw(e),r=new _k(e);return ck(t._query),QD(n,t._query).then(i=>new gk(e,r,t,i))}function Tk(t,e,n,...r){t=vr(t,Ft);const i=vr(t.firestore,Ao),o=_p(i);let s;return s=typeof(e=xt(e))=="string"||e instanceof Zu?sk(o,"updateDoc",t._key,e,n,r):ok(o,"updateDoc",t._key,e),Rp(i,[s.toMutation(t._key,gt.exists(!0))])}function Ek(t){return Rp(vr(t.firestore,Ao),[new $u(t._key,gt.none())])}function Ik(t,e){const n=vr(t.firestore,Ao),r=pp(t),i=pk(t.converter,e);return Rp(n,[ik(_p(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,gt.exists(!1))]).then(()=>r)}function Rp(t,e){return function(r,i){const o=new Mn;return r.asyncQueue.enqueueAndForget(async()=>FD(await WD(r),i,o)),o.promise}(iw(t),e)}function Ck(){return new vp("serverTimestamp")}(function(e,n=!0){(function(i){Io=i})(dI),Ks(new lo("firestore",(r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),u=new Ao(new KP(r.getProvider("auth-internal")),new YP(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new z(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jr(d.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),dr(sy,"4.7.3",e),dr(sy,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw="firebasestorage.googleapis.com",mw="storageBucket",wk=2*60*1e3,Sk=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le extends ui{constructor(e,n,r=0){super(ad(e),`Firebase Storage: ${n} (${ad(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Le.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ad(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ve;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ve||(Ve={}));function ad(t){return"storage/"+t}function Pp(){const t="An unknown error occurred, please check the error payload for server response.";return new Le(Ve.UNKNOWN,t)}function Ak(t){return new Le(Ve.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Rk(t){return new Le(Ve.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Pk(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Le(Ve.UNAUTHENTICATED,t)}function xk(){return new Le(Ve.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Mk(t){return new Le(Ve.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Dk(){return new Le(Ve.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function kk(){return new Le(Ve.CANCELED,"User canceled the upload/download.")}function Nk(t){return new Le(Ve.INVALID_URL,"Invalid URL '"+t+"'.")}function Vk(t){return new Le(Ve.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Lk(){return new Le(Ve.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+mw+"' property when initializing the app?")}function Fk(){return new Le(Ve.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Uk(){return new Le(Ve.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function bk(t){return new Le(Ve.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Vf(t){return new Le(Ve.INVALID_ARGUMENT,t)}function gw(){return new Le(Ve.APP_DELETED,"The Firebase app was deleted.")}function Bk(t){return new Le(Ve.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Rs(t,e){return new Le(Ve.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function rs(t){throw new Le(Ve.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Vt.makeFromUrl(e,n)}catch{return new Vt(e,"")}if(r.path==="")return r;throw Vk(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(D){D.path.charAt(D.path.length-1)==="/"&&(D.path_=D.path_.slice(0,-1))}const s="(/(.*))?$",u=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function d(D){D.path_=decodeURIComponent(D.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${h}/b/${i}/o${m}`,"i"),w={bucket:1,path:3},R=n===pw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",S=new RegExp(`^https?://${R}/${i}/${k}`,"i"),I=[{regex:u,indices:c,postModify:o},{regex:_,indices:w,postModify:d},{regex:S,indices:{bucket:1,path:2},postModify:d}];for(let D=0;D<I.length;D++){const F=I[D],U=F.regex.exec(e);if(U){const C=U[F.indices.bucket];let E=U[F.indices.path];E||(E=""),r=new Vt(C,E),F.postModify(r);break}}if(r==null)throw Nk(e);return r}}class Ok{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(t,e,n){let r=1,i=null,o=null,s=!1,u=0;function c(){return u===2}let d=!1;function h(...k){d||(d=!0,e.apply(null,k))}function p(k){i=setTimeout(()=>{i=null,t(_,c())},k)}function m(){o&&clearTimeout(o)}function _(k,...S){if(d){m();return}if(k){m(),h.call(null,k,...S);return}if(c()||s){m(),h.call(null,k,...S);return}r<64&&(r*=2);let I;u===1?(u=2,I=0):I=(r+Math.random())*1e3,p(I)}let w=!1;function R(k){w||(w=!0,m(),!d&&(i!==null?(k||(u=2),clearTimeout(i),p(0)):k||(u=1)))}return p(0),o=setTimeout(()=>{s=!0,R(!0)},n),R}function Gk(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $k(t){return t!==void 0}function zk(t){return typeof t=="object"&&!Array.isArray(t)}function xp(t){return typeof t=="string"||t instanceof String}function p_(t){return Mp()&&t instanceof Blob}function Mp(){return typeof Blob<"u"}function m_(t,e,n,r){if(r<e)throw Vf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Vf(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tc(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function yw(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Hr;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hr||(Hr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hk(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kk{constructor(e,n,r,i,o,s,u,c,d,h,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=u,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,w)=>{this.resolve_=_,this.reject_=w,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new la(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const s=u=>{const c=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;const u=o.getErrorCode()===Hr.NO_ERROR,c=o.getStatus();if(!u||Hk(c,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===Hr.ABORT;r(!1,new la(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new la(d,o))})},n=(r,i)=>{const o=this.resolve_,s=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(u,u.getResponse());$k(c)?o(c):o()}catch(c){s(c)}else if(u!==null){const c=Pp();c.serverResponse=u.getErrorText(),this.errorCallback_?s(this.errorCallback_(u,c)):s(c)}else if(i.canceled){const c=this.appDelete_?gw():kk();s(c)}else{const c=Dk();s(c)}};this.canceled_?n(!1,new la(!1,null,!0)):this.backoffId_=qk(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Gk(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class la{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Wk(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Jk(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Qk(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Yk(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Xk(t,e,n,r,i,o,s=!0){const u=yw(t.urlParams),c=t.url+u,d=Object.assign({},t.headers);return Qk(d,e),Wk(d,n),Jk(d,o),Yk(d,r),new Kk(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zk(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function jk(...t){const e=Zk();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Mp())return new Blob(t);throw new Le(Ve.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function eN(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tN(t){if(typeof atob>"u")throw bk("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ud{constructor(e,n){this.data=e,this.contentType=n||null}}function nN(t,e){switch(t){case fn.RAW:return new ud(_w(e));case fn.BASE64:case fn.BASE64URL:return new ud(vw(t,e));case fn.DATA_URL:return new ud(iN(e),oN(e))}throw Pp()}function _w(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,s=t.charCodeAt(++n);r=65536|(o&1023)<<10|s&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function rN(t){let e;try{e=decodeURIComponent(t)}catch{throw Rs(fn.DATA_URL,"Malformed data URL.")}return _w(e)}function vw(t,e){switch(t){case fn.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Rs(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case fn.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Rs(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=tN(e)}catch(i){throw i.message.includes("polyfill")?i:Rs(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class Tw{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Rs(fn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=sN(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function iN(t){const e=new Tw(t);return e.base64?vw(fn.BASE64,e.rest):rN(e.rest)}function oN(t){return new Tw(t).contentType}function sN(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,n){let r=0,i="";p_(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(p_(this.data_)){const r=this.data_,i=eN(r,e,n);return i===null?null:new Xn(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Xn(r,!0)}}static getBlob(...e){if(Mp()){const n=e.map(r=>r instanceof Xn?r.data_:r);return new Xn(jk.apply(null,n))}else{const n=e.map(s=>xp(s)?nN(fn.RAW,s).data:s.data_);let r=0;n.forEach(s=>{r+=s.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(s=>{for(let u=0;u<s.length;u++)i[o++]=s[u]}),new Xn(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ew(t){let e;try{e=JSON.parse(t)}catch{return null}return zk(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function aN(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Iw(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(t,e){return e}class ht{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||uN}}let aa=null;function cN(t){return!xp(t)||t.length<2?t:Iw(t)}function Cw(){if(aa)return aa;const t=[];t.push(new ht("bucket")),t.push(new ht("generation")),t.push(new ht("metageneration")),t.push(new ht("name","fullPath",!0));function e(o,s){return cN(s)}const n=new ht("name");n.xform=e,t.push(n);function r(o,s){return s!==void 0?Number(s):s}const i=new ht("size");return i.xform=r,t.push(i),t.push(new ht("timeCreated")),t.push(new ht("updated")),t.push(new ht("md5Hash",null,!0)),t.push(new ht("cacheControl",null,!0)),t.push(new ht("contentDisposition",null,!0)),t.push(new ht("contentEncoding",null,!0)),t.push(new ht("contentLanguage",null,!0)),t.push(new ht("contentType",null,!0)),t.push(new ht("metadata","customMetadata",!0)),aa=t,aa}function dN(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new Vt(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function fN(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const s=n[o];r[s.local]=s.xform(r,e[s.server])}return dN(r,t),r}function ww(t,e,n){const r=Ew(e);return r===null?null:fN(t,r,n)}function hN(t,e,n,r){const i=Ew(e);if(i===null||!xp(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const s=encodeURIComponent;return o.split(",").map(d=>{const h=t.bucket,p=t.fullPath,m="/b/"+s(h)+"/o/"+s(p),_=tc(m,n,r),w=yw({alt:"media",token:d});return _+w})[0]}function pN(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class Dp{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sw(t){if(!t)throw Pp()}function mN(t,e){function n(r,i){const o=ww(t,i,e);return Sw(o!==null),o}return n}function gN(t,e){function n(r,i){const o=ww(t,i,e);return Sw(o!==null),hN(o,i,t.host,t._protocol)}return n}function Aw(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=xk():i=Pk():n.getStatus()===402?i=Rk(t.bucket):n.getStatus()===403?i=Mk(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function Rw(t){const e=Aw(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=Ak(t.path)),o.serverResponse=i.serverResponse,o}return n}function yN(t,e,n){const r=e.fullServerUrl(),i=tc(r,t.host,t._protocol),o="GET",s=t.maxOperationRetryTime,u=new Dp(i,o,gN(t,n),s);return u.errorHandler=Rw(e),u}function _N(t,e){const n=e.fullServerUrl(),r=tc(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function s(c,d){}const u=new Dp(r,i,s,o);return u.successCodes=[200,204],u.errorHandler=Rw(e),u}function vN(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function TN(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=vN(null,e)),r}function EN(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};function u(){let I="";for(let D=0;D<2;D++)I=I+Math.random().toString().slice(2);return I}const c=u();s["Content-Type"]="multipart/related; boundary="+c;const d=TN(e,r,i),h=pN(d,n),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+c+"--",_=Xn.getBlob(p,r,m);if(_===null)throw Fk();const w={name:d.fullPath},R=tc(o,t.host,t._protocol),k="POST",S=t.maxUploadRetryTime,v=new Dp(R,k,mN(t,n),S);return v.urlParams=w,v.headers=s,v.body=_.uploadData(),v.errorHandler=Aw(e),v}class IN{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw rs("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw rs("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw rs("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw rs("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw rs("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class CN extends IN{initXhr(){this.xhr_.responseType="text"}}function kp(){return new CN}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,n){this._service=e,n instanceof Vt?this._location=n:this._location=Vt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new oi(e,n)}get root(){const e=new Vt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Iw(this._location.path)}get storage(){return this._service}get parent(){const e=lN(this._location.path);if(e===null)return null;const n=new Vt(this._location.bucket,e);return new oi(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Bk(e)}}function wN(t,e,n){t._throwIfRoot("uploadBytes");const r=EN(t.storage,t._location,Cw(),new Xn(e,!0),n);return t.storage.makeRequestWithTokens(r,kp).then(i=>({metadata:i,ref:t}))}function SN(t){t._throwIfRoot("getDownloadURL");const e=yN(t.storage,t._location,Cw());return t.storage.makeRequestWithTokens(e,kp).then(n=>{if(n===null)throw Uk();return n})}function AN(t){t._throwIfRoot("deleteObject");const e=_N(t.storage,t._location);return t.storage.makeRequestWithTokens(e,kp)}function RN(t,e){const n=aN(t._location.path,e),r=new Vt(t._location.bucket,n);return new oi(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(t){return/^[A-Za-z]+:\/\//.test(t)}function xN(t,e){return new oi(t,e)}function Pw(t,e){if(t instanceof Np){const n=t;if(n._bucket==null)throw Lk();const r=new oi(n,n._bucket);return e!=null?Pw(r,e):r}else return e!==void 0?RN(t,e):t}function MN(t,e){if(e&&PN(e)){if(t instanceof Np)return xN(t,e);throw Vf("To use ref(service, url), the first argument must be a Storage instance.")}else return Pw(t,e)}function g_(t,e){const n=e==null?void 0:e[mw];return n==null?null:Vt.makeFromBucketSpec(n,t)}function DN(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:rI(i,t.app.options.projectId))}class Np{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=pw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=wk,this._maxUploadRetryTime=Sk,this._requests=new Set,i!=null?this._bucket=Vt.makeFromBucketSpec(i,this._host):this._bucket=g_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vt.makeFromBucketSpec(this._url,e):this._bucket=g_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){m_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){m_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new oi(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new Ok(gw());{const s=Xk(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const y_="@firebase/storage",__="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="storage";function kN(t,e,n){return t=xt(t),wN(t,e,n)}function NN(t){return t=xt(t),SN(t)}function VN(t){return t=xt(t),AN(t)}function Mw(t,e){return t=xt(t),MN(t,e)}function LN(t=hI(),e){t=xt(t);const r=cI(t,xw).getImmediate({identifier:e}),i=tI("storage");return i&&FN(r,...i),r}function FN(t,e,n,r={}){DN(t,e,n,r)}function UN(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Np(n,r,i,e,dI)}function bN(){Ks(new lo(xw,UN,"PUBLIC").setMultipleInstances(!0)),dr(y_,__,""),dr(y_,__,"esm2017")}bN();var BN="firebase",ON="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dr(BN,ON,"app");const qN={apiKey:"AIzaSyCVT2YuAJQoHE2m5nznwhhK0_jgMBQJzk0",authDomain:"math-fest-display.firebaseapp.com",databaseURL:"https://math-fest-display-default-rtdb.firebaseio.com",projectId:"math-fest-display",storageBucket:"math-fest-display.firebasestorage.app",messagingSenderId:"252365377355",appId:"1:252365377355:web:83772c179137b3de94e2ce"},Dw=fI(qN),yl=ZD(Dw),kw=LN(Dw);jD(yl).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open."):t.code=="unimplemented"&&console.warn("Firestore persistence is not available in this browser.")});const il="photos",GN=async()=>{const t=rw(yl,il),e=dk(t,fk("createdAt","desc"));return(await vk(e)).docs.map(r=>({id:r.id,...r.data(),isFavorite:r.data().isFavorite||!1}))},$N=async(t,e,n)=>{if(!t)throw new Error("No file provided for upload.");const r=t.name.split(".").pop(),i=`${Date.now()}.${r}`,o=Mw(kw,`${il}/${i}`);await kN(o,t);const s=await NN(o);await Ik(rw(yl,il),{imageUrl:s,description:e,tags:n,isFavorite:!1,createdAt:Ck()})},zN=async(t,e)=>{const n=pp(yl,il,t);await Tk(n,{isFavorite:e})},HN=async t=>{if(!t||!t.id||!t.imageUrl)throw new Error("Invalid photo data provided for deletion.");const e=pp(yl,il,t.id);await Ek(e);const n=Mw(kw,t.imageUrl);await VN(n)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let KN,WN;function JN(){return{geminiUrl:KN,vertexUrl:WN}}function QN(t,e,n,r){var i,o;if(!(t!=null&&t.baseUrl)){const s=JN();return e?(i=s.vertexUrl)!==null&&i!==void 0?i:n:(o=s.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class pi{}function J(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(t,e,n){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const u=s.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[u])){const c=t[u];if(Array.isArray(n))for(let d=0;d<c.length;d++){const h=c[d];a(h,e.slice(o+1),n[d])}else for(const d of c)a(d,e.slice(o+1),n)}return}else if(s.endsWith("[0]")){const u=s.slice(0,-3);u in t||(t[u]=[{}]);const c=t[u];a(c[0],e.slice(o+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function l(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in t){const o=t[i];return Array.isArray(o)?o.map(s=>l(s,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Vp(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YN(t){const e={},n=l(t,["operationName"]);n!=null&&a(e,["operationName"],n);const r=l(t,["resourceName"]);return r!=null&&a(e,["_url","resourceName"],r),e}function XN(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&a(e,["response"],jN(s)),e}function ZN(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response"]);return s!=null&&a(e,["response"],e1(s)),e}function jN(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>t1(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function e1(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>n1(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function t1(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],o1(n)),e}function n1(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],s1(n)),e}function r1(t){const e={},n=l(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function i1(t){const e={},n=l(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function o1(t){const e={},n=l(t,["video","uri"]);n!=null&&a(e,["uri"],n);const r=l(t,["video","encodedVideo"]);r!=null&&a(e,["videoBytes"],Vp(r));const i=l(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function s1(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["videoBytes"],Vp(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var v_;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(v_||(v_={}));var T_;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(T_||(T_={}));var Ht;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(Ht||(Ht={}));var E_;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(E_||(E_={}));var I_;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(I_||(I_={}));var C_;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(C_||(C_={}));var w_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(w_||(w_={}));var S_;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(S_||(S_={}));var A_;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(A_||(A_={}));var R_;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(R_||(R_={}));var P_;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(P_||(P_={}));var x_;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(x_||(x_={}));var M_;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(M_||(M_={}));var D_;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(D_||(D_={}));var k_;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(k_||(k_={}));var _u;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(_u||(_u={}));var N_;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(N_||(N_={}));var Lf;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Lf||(Lf={}));var V_;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(V_||(V_={}));var L_;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(L_||(L_={}));var F_;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(F_||(F_={}));var U_;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(U_||(U_={}));var b_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(b_||(b_={}));var B_;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(B_||(B_={}));var O_;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(O_||(O_={}));var q_;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(q_||(q_={}));var G_;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(G_||(G_={}));var $_;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})($_||($_={}));var z_;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(z_||(z_={}));var H_;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(H_||(H_={}));var K_;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(K_||(K_={}));var W_;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(W_||(W_={}));var J_;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(J_||(J_={}));var Q_;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Q_||(Q_={}));var Y_;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Y_||(Y_={}));var X_;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(X_||(X_={}));var Z_;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Z_||(Z_={}));var j_;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(j_||(j_={}));var ev;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(ev||(ev={}));var tv;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(tv||(tv={}));var nv;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(nv||(nv={}));var rv;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(rv||(rv={}));var iv;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(iv||(iv={}));var ov;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(ov||(ov={}));var sv;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(sv||(sv={}));var lv;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(lv||(lv={}));var av;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(av||(av={}));var $i;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})($i||($i={}));class Ff{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class is{get text(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const m of(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[_,w]of Object.entries(m))_!=="text"&&_!=="thought"&&(w!==null||w!==void 0)&&p.push(_);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;h=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,_]of Object.entries(p))m!=="inlineData"&&(_!==null||_!==void 0)&&h.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,r,i,o,s,u,c,d;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,r,i,o,s,u,c,d;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class uv{}class cv{}class l1{}class a1{}class u1{}class c1{}class dv{}class fv{}class hv{}class d1{}class vu{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new vu;let i;const o=e;return n?i=ZN(o):i=XN(o),Object.assign(r,i),r}}class pv{}class mv{}class gv{}class f1{}class h1{}class p1{}class yv{}class m1{get text(){var e,n,r;let i="",o=!1;const s=[];for(const u of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&s.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,i+=u.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,n,r;let i="";const o=[];for(const s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,c]of Object.entries(s))u!=="inlineData"&&c!==null&&o.push(u);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class g1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ue(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Nw(t,e){const n=ue(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function Vw(t){return Array.isArray(t)?t.map(e=>Tu(e)):[Tu(t)]}function Tu(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function Lw(t){const e=Tu(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Fw(t){const e=Tu(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function _v(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function Uw(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>_v(e)):[_v(t)]}function Uf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function vv(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Tv(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function at(t){if(t==null)throw new Error("ContentUnion is required");return Uf(t)?t:{role:"user",parts:Uw(t)}}function Lp(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=at(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=at(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>at(n)):[at(e)]}function Jt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(vv(t)||Tv(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[at(t)]}const e=[],n=[],r=Uf(t[0]);for(const i of t){const o=Uf(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(i);else{if(vv(i)||Tv(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:Uw(n)}),e}function y1(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(Ht).includes(n[0].toUpperCase())?n[0].toUpperCase():Ht.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(Ht).includes(r.toUpperCase())?r.toUpperCase():Ht.TYPE_UNSPECIFIED})}}function Xi(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&y1(t.type,e);for(const[s,u]of Object.entries(t))if(u!=null)if(s=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(Ht).includes(u.toUpperCase())?u.toUpperCase():Ht.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Xi(u);else if(r.includes(s)){const c=[];for(const d of u){if(d.type=="null"){e.nullable=!0;continue}c.push(Xi(d))}e[s]=c}else if(i.includes(s)){const c={};for(const[d,h]of Object.entries(u))c[d]=Xi(h);e[s]=c}else{if(s==="additionalProperties")continue;e[s]=u}return e}function Fp(t){return Xi(t)}function Up(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function bp(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Ro(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Xi(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Xi(e.response));return t}function Po(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function _1(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Bn(t,e){if(typeof e!="string")throw new Error("name must be a string");return _1(t,e,"cachedContents")}function bw(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function mi(t){return Vp(t)}function v1(t){return t!=null&&typeof t=="object"&&"name"in t}function T1(t){return t!=null&&typeof t=="object"&&"video"in t}function E1(t){return t!=null&&typeof t=="object"&&"uri"in t}function Bw(t){var e;let n;if(v1(t)&&(n=t.name),!(E1(t)&&(n=t.uri,n===void 0))&&!(T1(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Ow(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function qw(t){for(const e of["models","tunedModels","publisherModels"])if(I1(t,e))return t[e];return[]}function I1(t,e){return t!==null&&typeof t=="object"&&e in t}function C1(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function w1(t,e={}){const n=[],r=new Set;for(const i of t){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const s=C1(i,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function Gw(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function S1(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function $w(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let o=!1;for(const s of i){if(typeof s!="object"||s===null)continue;const c=s.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function xo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function zw(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A1(t){const e={},n=l(t,["responsesFile"]);n!=null&&a(e,["fileName"],n);const r=l(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>fV(s))),a(e,["inlinedResponses"],o)}const i=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>cV(s))),a(e,["inlinedEmbedContentResponses"],o)}return e}function R1(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&a(e,["format"],n);const r=l(t,["gcsDestination","outputUriPrefix"]);r!=null&&a(e,["gcsUri"],r);const i=l(t,["bigqueryDestination","outputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function P1(t){const e={},n=l(t,["format"]);n!=null&&a(e,["predictionsFormat"],n);const r=l(t,["gcsUri"]);r!=null&&a(e,["gcsDestination","outputUriPrefix"],r);const i=l(t,["bigqueryUri"]);if(i!=null&&a(e,["bigqueryDestination","outputUri"],i),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Mi(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata","displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["metadata","state"]);i!=null&&a(e,["state"],zw(i));const o=l(t,["metadata","createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["metadata","endTime"]);s!=null&&a(e,["endTime"],s);const u=l(t,["metadata","updateTime"]);u!=null&&a(e,["updateTime"],u);const c=l(t,["metadata","model"]);c!=null&&a(e,["model"],c);const d=l(t,["metadata","output"]);return d!=null&&a(e,["dest"],A1($w(d))),e}function bf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],zw(i));const o=l(t,["error"]);o!=null&&a(e,["error"],Kw(o));const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["startTime"]);u!=null&&a(e,["startTime"],u);const c=l(t,["endTime"]);c!=null&&a(e,["endTime"],c);const d=l(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const h=l(t,["model"]);h!=null&&a(e,["model"],h);const p=l(t,["inputConfig"]);p!=null&&a(e,["src"],x1(p));const m=l(t,["outputConfig"]);return m!=null&&a(e,["dest"],R1($w(m))),e}function x1(t){const e={},n=l(t,["instancesFormat"]);n!=null&&a(e,["format"],n);const r=l(t,["gcsSource","uris"]);r!=null&&a(e,["gcsUri"],r);const i=l(t,["bigquerySource","inputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function M1(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=l(e,["fileName"]);r!=null&&a(n,["fileName"],r);const i=l(e,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>dV(t,s))),a(n,["requests","requests"],o)}return n}function D1(t){const e={},n=l(t,["format"]);n!=null&&a(e,["instancesFormat"],n);const r=l(t,["gcsUri"]);r!=null&&a(e,["gcsSource","uris"],r);const i=l(t,["bigqueryUri"]);if(i!=null&&a(e,["bigquerySource","inputUri"],i),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function k1(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function N1(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function V1(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function L1(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function F1(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],B1(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],U1(r));const i=l(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],LV(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function U1(t){const e={},n=l(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function b1(t){const e={},n=l(t,["values"]);return n!=null&&a(e,["values"],n),e}function B1(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>IV(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Hw(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>CV(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function O1(t,e){const n={},r=l(t,["displayName"]);if(e!==void 0&&r!=null&&a(e,["batch","displayName"],r),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function q1(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["dest"]);return e!==void 0&&i!=null&&a(e,["outputConfig"],P1(S1(i))),n}function cd(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["batch","inputConfig"],M1(t,Gw(t,i)));const o=l(e,["config"]);return o!=null&&O1(o,n),n}function G1(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["inputConfig"],D1(Gw(t,i)));const o=l(e,["config"]);return o!=null&&q1(o,n),n}function $1(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&a(e,["batch","displayName"],r),n}function dd(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["batch","inputConfig"],X1(t,i));const o=l(e,["config"]);return o!=null&&$1(o,n),n}function z1(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function H1(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function K1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);return o!=null&&a(e,["error"],Bp(o)),e}function W1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);return o!=null&&a(e,["error"],Kw(o)),e}function J1(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function Q1(t,e){const n={},r=l(e,["contents"]);r!=null&&a(n,["requests[]","request","content"],Lp(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],Y1(i,n)),n}function Y1(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["requests[]","taskType"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&a(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function X1(t,e){const n={},r=l(e,["fileName"]);r!=null&&a(n,["file_name"],r);const i=l(e,["inlinedRequests"]);return i!=null&&a(n,["requests"],Q1(t,i)),n}function Z1(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function j1(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function eV(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function tV(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function nV(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function rV(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function iV(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],Hw(at(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const w=l(e,["frequencyPenalty"]);w!=null&&a(r,["frequencyPenalty"],w);const R=l(e,["seed"]);R!=null&&a(r,["seed"],R);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const S=l(e,["responseSchema"]);S!=null&&a(r,["responseSchema"],RV(Fp(S)));const v=l(e,["responseJsonSchema"]);if(v!=null&&a(r,["responseJsonSchema"],v),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let M=I;Array.isArray(M)&&(M=M.map(N=>AV(N))),a(n,["safetySettings"],M)}const D=l(e,["tools"]);if(n!==void 0&&D!=null){let M=Po(D);Array.isArray(M)&&(M=M.map(N=>VV(Ro(N)))),a(n,["tools"],M)}const F=l(e,["toolConfig"]);if(n!==void 0&&F!=null&&a(n,["toolConfig"],NV(F)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=l(e,["cachedContent"]);n!==void 0&&U!=null&&a(n,["cachedContent"],Bn(t,U));const C=l(e,["responseModalities"]);C!=null&&a(r,["responseModalities"],C);const E=l(e,["mediaResolution"]);E!=null&&a(r,["mediaResolution"],E);const A=l(e,["speechConfig"]);if(A!=null&&a(r,["speechConfig"],MV(Up(A))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);return P!=null&&a(r,["thinkingConfig"],DV(P)),r}function oV(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>F1(d))),a(e,["candidates"],c)}const i=l(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=l(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&a(e,["responseId"],s);const u=l(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function sV(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function lV(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],xo(t,r)),n}function aV(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],J1(n)),e}function uV(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],hV(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function cV(t){const e={},n=l(t,["response"]);n!=null&&a(e,["response"],PV(n));const r=l(t,["error"]);return r!=null&&a(e,["error"],Bp(r)),e}function dV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["request","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Jt(i);Array.isArray(s)&&(s=s.map(u=>Hw(u))),a(n,["request","contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["request","generationConfig"],iV(t,o,n)),n}function fV(t){const e={},n=l(t,["response"]);n!=null&&a(e,["response"],oV(n));const r=l(t,["error"]);return r!=null&&a(e,["error"],Bp(r)),e}function hV(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Bp(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["code"]);r!=null&&a(e,["code"],r);const i=l(t,["message"]);return i!=null&&a(e,["message"],i),e}function Kw(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["code"]);r!=null&&a(e,["code"],r);const i=l(t,["message"]);return i!=null&&a(e,["message"],i),e}function pV(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function mV(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);if(e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function gV(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function yV(t){const e={},n=l(t,["config"]);return n!=null&&mV(n,e),e}function _V(t){const e={},n=l(t,["config"]);return n!=null&&gV(n,e),e}function vV(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Mi(s))),a(e,["batchJobs"],o)}return e}function TV(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>bf(s))),a(e,["batchJobs"],o)}return e}function EV(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>xV(i))),a(e,["speakerVoiceConfigs"],r)}return e}function IV(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],bV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],k1(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],Z1(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],eV(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function CV(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],BV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],N1(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],j1(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],tV(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function wV(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function SV(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],pV(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function AV(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&a(e,["category"],n);const r=l(t,["threshold"]);return r!=null&&a(e,["threshold"],r),e}function RV(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const w=l(t,["minLength"]);w!=null&&a(e,["minLength"],w);const R=l(t,["minProperties"]);R!=null&&a(e,["minProperties"],R);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const S=l(t,["nullable"]);S!=null&&a(e,["nullable"],S);const v=l(t,["pattern"]);v!=null&&a(e,["pattern"],v);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const D=l(t,["propertyOrdering"]);D!=null&&a(e,["propertyOrdering"],D);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const U=l(t,["title"]);U!=null&&a(e,["title"],U);const C=l(t,["type"]);return C!=null&&a(e,["type"],C),e}function PV(t){const e={},n=l(t,["embedding"]);n!=null&&a(e,["embedding"],b1(n));const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function xV(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],Ww(r)),e}function MV(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],Ww(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],EV(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function DV(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function kV(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function NV(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],nV(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],SV(r)),e}function VV(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>rV(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],uV(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],aV(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],FV());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],kV(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function LV(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>UV(i))),a(e,["urlMetadata"],r)}return e}function FV(){return{}}function UV(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function bV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function BV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Ww(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],wV(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var si;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(si||(si={}));class _l{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class OV extends pi{constructor(e){super(),this.apiClient=e,this.create=async n=>{var r,i;if(this.apiClient.isVertexAI())return n.config=this.formatDestination(n.src,n.config),this.createInternal(n);const o=n.src;if(!(Array.isArray(n.src)||o.inlinedRequests!==void 0))return this.createInternal(n);const u=this.createInlinedGenerateContentRequest(n),c=u.path,d=u.body,h=cd(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=n.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()).then(m=>Mi(m))},this.createEmbeddings=async n=>{var r,i;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(n.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(n);const u=this.createInlinedEmbedContentRequest(n),c=u.path,d=u.body,h=dd(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=n.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()).then(m=>Mi(m))},this.list=async(n={})=>new _l(si.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=cd(this.apiClient,e),r=n._url,i=J("{model}:batchGenerateContent",r),u=n.batch.inputConfig.requests,c=u.requests,d=[];for(const h of c){const p=Object.assign({},h);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const _=p.request;_.systemInstruction=m,p.request=_}d.push(p)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:i,body:n}}createInlinedEmbedContentRequest(e){const n=dd(this.apiClient,e),r=n._url,i=J("{model}:asyncBatchEmbedContent",r),u=n.batch.inputConfig.requests,c=u.requests,d=[];delete u.config;for(const h of c){const p=Object.assign({},h),m=p.request;for(const _ in p)_!=="request"&&(m[_]=p[_],delete p[_]);d.push(p)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(s)r.dest=`${s}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=G1(this.apiClient,e);return u=J("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>bf(h))}else{const d=cd(this.apiClient,e);return u=J("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Mi(h))}}async createEmbeddingsInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=dd(this.apiClient,e);return o=J("{model}:asyncBatchEmbedContent",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>Mi(c))}}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=lV(this.apiClient,e);return u=J("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>bf(h))}else{const d=sV(this.apiClient,e);return u=J("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Mi(h))}}async cancel(e){var n,r,i,o;let s="",u={};if(this.apiClient.isVertexAI()){const c=L1(this.apiClient,e);s=J("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=V1(this.apiClient,e);s=J("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=_V(e);return u=J("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=TV(h),m=new yv;return Object.assign(m,p),m})}else{const d=yV(e);return u=J("batches",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=vV(h),m=new yv;return Object.assign(m,p),m})}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=H1(this.apiClient,e);return u=J("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>W1(h))}else{const d=z1(this.apiClient,e);return u=J("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>K1(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function qV(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function GV(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],qV(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function $V(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function zV(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function ka(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["model"]);i!=null&&a(e,["model"],i);const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&a(e,["updateTime"],s);const u=l(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function Na(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["model"]);i!=null&&a(e,["model"],i);const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&a(e,["updateTime"],s);const u=l(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function Ev(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>RL(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Iv(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>PL(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function HV(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const o=l(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let h=Jt(s);Array.isArray(h)&&(h=h.map(p=>Ev(p))),a(e,["contents"],h)}const u=l(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Ev(at(u)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>LL(p))),a(e,["tools"],h)}const d=l(t,["toolConfig"]);if(e!==void 0&&d!=null&&a(e,["toolConfig"],NL(d)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function KV(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const o=l(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let p=Jt(s);Array.isArray(p)&&(p=p.map(m=>Iv(m))),a(e,["contents"],p)}const u=l(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Iv(at(u)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>FL(m))),a(e,["tools"],p)}const d=l(t,["toolConfig"]);e!==void 0&&d!=null&&a(e,["toolConfig"],VL(d));const h=l(t,["kmsKeyName"]);return e!==void 0&&h!=null&&a(e,["encryption_spec","kmsKeyName"],h),n}function WV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],Nw(t,r));const i=l(e,["config"]);return i!=null&&HV(i,n),n}function JV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],Nw(t,r));const i=l(e,["config"]);return i!=null&&KV(i,n),n}function QV(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Bn(t,r)),n}function YV(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Bn(t,r)),n}function XV(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function ZV(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function jV(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function eL(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function tL(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function nL(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function rL(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function iL(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function oL(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function sL(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function lL(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function aL(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function uL(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function cL(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Bn(t,r)),n}function dL(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Bn(t,r)),n}function fL(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],GV(n)),e}function hL(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],jV(n)),e}function pL(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],eL(n)),e}function mL(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],yL(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function gL(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],_L(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function yL(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function _L(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function vL(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function TL(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function EL(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function IL(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function CL(t){const e={},n=l(t,["config"]);return n!=null&&EL(n,e),e}function wL(t){const e={},n=l(t,["config"]);return n!=null&&IL(n,e),e}function SL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>ka(s))),a(e,["cachedContents"],o)}return e}function AL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Na(s))),a(e,["cachedContents"],o)}return e}function RL(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],$L(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],$V(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],nL(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],iL(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function PL(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],zL(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],zV(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],rL(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],oL(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function xL(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],vL(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function ML(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],TL(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function DL(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function kL(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function NL(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],sL(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],xL(r)),e}function VL(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],lL(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],ML(r)),e}function LL(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>aL(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],mL(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],hL(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],qL());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],DL(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function FL(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>uL(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],gL(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],pL(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],tL(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],fL(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],GL());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],kL(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function UL(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function bL(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function BL(t,e){const n={},r=l(e,["name"]);r!=null&&a(n,["_url","name"],Bn(t,r));const i=l(e,["config"]);return i!=null&&UL(i,n),n}function OL(t,e){const n={},r=l(e,["name"]);r!=null&&a(n,["_url","name"],Bn(t,r));const i=l(e,["config"]);return i!=null&&bL(i,n),n}function qL(){return{}}function GL(){return{}}function $L(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function zL(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class HL extends pi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new _l(si.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=JV(this.apiClient,e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Na(h))}else{const d=WV(this.apiClient,e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>ka(h))}}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=dL(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Na(h))}else{const d=cL(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>ka(h))}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=YV(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=ZV(h),m=new mv;return Object.assign(m,p),m})}else{const d=QV(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=XV(h),m=new mv;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=OL(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Na(h))}else{const d=BL(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>ka(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=wL(e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=AL(h),m=new gv;return Object.assign(m,p),m})}else{const d=CL(e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=SL(h),m=new gv;return Object.assign(m,p),m})}}}function Cv(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ve(t){return this instanceof ve?(this.v=t,this):new ve(t)}function Zi(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(_){return function(w){return Promise.resolve(w).then(_,p)}}function u(_,w){r[_]&&(i[_]=function(R){return new Promise(function(k,S){o.push([_,R,k,S])>1||c(_,R)})},w&&(i[_]=w(i[_])))}function c(_,w){try{d(r[_](w))}catch(R){m(o[0][3],R)}}function d(_){_.value instanceof ve?Promise.resolve(_.value.v).then(h,p):m(o[0][2],_)}function h(_){c("next",_)}function p(_){c("throw",_)}function m(_,w){_(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Ps(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Cv=="function"?Cv(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(u,c){s=t[o](s),i(u,c,s.done,s.value)})}}function i(o,s,u,c){Promise.resolve(c).then(function(d){o({value:d,done:u})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KL(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:Jw(n)}function Jw(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function WL(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function wv(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!Jw(t[r])&&(o=!1),r++;o?e.push(...i):e.pop()}return e}class JL{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new QL(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class QL{constructor(e,n,r,i={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),WL(o)}async sendMessage(e){var n;await this.sendPromise;const r=at(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,u;const c=await i,d=(s=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];h!=null&&(m=(u=h.slice(p))!==null&&u!==void 0?u:[]);const _=d?[d]:[];this.recordHistory(r,_,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=at(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?wv(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return Zi(this,arguments,function*(){var s,u,c,d;const h=[];try{for(var p=!0,m=Ps(e),_;_=yield ve(m.next()),s=_.done,!s;p=!0){d=_.value,p=!1;const w=d;if(KL(w)){const R=(i=(r=w.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;R!==void 0&&h.push(R)}yield yield ve(w)}}catch(w){u={error:w}}finally{try{!p&&!s&&(c=m.return)&&(yield ve(c.call(m)))}finally{if(u)throw u.error}}this.recordHistory(n,h)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(o=>o.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...wv(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nc extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,nc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YL(t){const e={},n=l(t,["file"]);return n!=null&&a(e,["file"],nF(n)),e}function XL(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function ZL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","file"],Bw(n)),e}function jL(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Bf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=l(t,["sizeBytes"]);o!=null&&a(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["sha256Hash"]);d!=null&&a(e,["sha256Hash"],d);const h=l(t,["uri"]);h!=null&&a(e,["uri"],h);const p=l(t,["downloadUri"]);p!=null&&a(e,["downloadUri"],p);const m=l(t,["state"]);m!=null&&a(e,["state"],m);const _=l(t,["source"]);_!=null&&a(e,["source"],_);const w=l(t,["videoMetadata"]);w!=null&&a(e,["videoMetadata"],w);const R=l(t,["error"]);return R!=null&&a(e,["error"],eF(R)),e}function eF(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["message"]);r!=null&&a(e,["message"],r);const i=l(t,["code"]);return i!=null&&a(e,["code"],i),e}function tF(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["message"]);r!=null&&a(e,["message"],r);const i=l(t,["code"]);return i!=null&&a(e,["code"],i),e}function nF(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=l(t,["sizeBytes"]);o!=null&&a(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["sha256Hash"]);d!=null&&a(e,["sha256Hash"],d);const h=l(t,["uri"]);h!=null&&a(e,["uri"],h);const p=l(t,["downloadUri"]);p!=null&&a(e,["downloadUri"],p);const m=l(t,["state"]);m!=null&&a(e,["state"],m);const _=l(t,["source"]);_!=null&&a(e,["source"],_);const w=l(t,["videoMetadata"]);w!=null&&a(e,["videoMetadata"],w);const R=l(t,["error"]);return R!=null&&a(e,["error"],tF(R)),e}function rF(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","file"],Bw(n)),e}function iF(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function oF(t){const e={},n=l(t,["config"]);return n!=null&&iF(n,e),e}function sF(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Bf(s))),a(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lF extends pi{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new _l(si.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>Bf(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=oF(e);return o=J("files",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=sF(c),h=new f1;return Object.assign(h,d),h})}}async createInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=YL(e);return o=J("upload/v1beta/files",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=XL(c),h=new h1;return Object.assign(h,d),h})}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=rF(e);return o=J("files/{file}",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>Bf(c))}}async delete(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=ZL(e);return o=J("files/{file}",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=jL(c),h=new p1;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aF(){return{}}function uF(){return{}}function cF(){return{}}function dF(){return{}}function fF(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function hF(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);r!=null&&a(e,["mimeType"],r);const i=l(t,["sourceMetadata"]);return i!=null&&a(e,["sourceMetadata"],r2(i)),e}function Sv(){return{}}function Av(){return{}}function pF(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],fF(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function mF(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function gF(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function yF(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function _F(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function vF(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function TF(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function EF(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>E2(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function IF(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>I2(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function CF(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>C2(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function wF(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>w2(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function SF(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],N2(r)),e}function AF(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],V2(r)),e}function RF(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function PF(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function xF(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function MF(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function DF(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function kF(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function NF(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Qw(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function Yw(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function VF(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function LF(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function FF(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function UF(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function bF(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],pF(n)),e}function BF(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],RF(n)),e}function OF(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],PF(n)),e}function qF(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],$F(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function GF(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],zF(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function $F(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function zF(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function HF(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],F2(bp(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],CF(at(_)));const w=l(t,["tools"]);if(e!==void 0&&w!=null){let F=Po(w);Array.isArray(F)&&(F=F.map(U=>O2(Ro(U)))),a(e,["setup","tools"],F)}const R=l(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],D2(R));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],Sv());const S=l(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],Sv());const v=l(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&a(e,["setup","realtimeInputConfig"],x2(v));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],SF(I));const D=l(t,["proactivity"]);return e!==void 0&&D!=null&&a(e,["setup","proactivity"],R2(D)),n}function KF(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],U2(bp(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],wF(at(_)));const w=l(t,["tools"]);if(e!==void 0&&w!=null){let F=Po(w);Array.isArray(F)&&(F=F.map(U=>q2(Ro(U)))),a(e,["setup","tools"],F)}const R=l(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],k2(R));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],Av());const S=l(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],Av());const v=l(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&a(e,["setup","realtimeInputConfig"],M2(v));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],AF(I));const D=l(t,["proactivity"]);return e!==void 0&&D!=null&&a(e,["setup","proactivity"],P2(D)),n}function WF(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],HF(i,n)),n}function JF(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],KF(i,n)),n}function QF(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>j2(i))),a(e,["weightedPrompts"],r)}return e}function Xw(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>t0(i))),a(e,["weightedPrompts"],r)}return e}function Of(t){const e={},n=l(t,["setup"]);n!=null&&a(e,["setup"],Zw(n));const r=l(t,["clientContent"]);r!=null&&a(e,["clientContent"],Xw(r));const i=l(t,["musicGenerationConfig"]);i!=null&&a(e,["musicGenerationConfig"],jw(i));const o=l(t,["playbackControl"]);return o!=null&&a(e,["playbackControl"],o),e}function Zw(t){const e={},n=l(t,["model"]);return n!=null&&a(e,["model"],n),e}function YF(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["filteredReason"]);return r!=null&&a(e,["filteredReason"],r),e}function XF(t){const e={},n=l(t,["temperature"]);n!=null&&a(e,["temperature"],n);const r=l(t,["topK"]);r!=null&&a(e,["topK"],r);const i=l(t,["seed"]);i!=null&&a(e,["seed"],i);const o=l(t,["guidance"]);o!=null&&a(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&a(e,["bpm"],s);const u=l(t,["density"]);u!=null&&a(e,["density"],u);const c=l(t,["brightness"]);c!=null&&a(e,["brightness"],c);const d=l(t,["scale"]);d!=null&&a(e,["scale"],d);const h=l(t,["muteBass"]);h!=null&&a(e,["muteBass"],h);const p=l(t,["muteDrums"]);p!=null&&a(e,["muteDrums"],p);const m=l(t,["onlyBassAndDrums"]);m!=null&&a(e,["onlyBassAndDrums"],m);const _=l(t,["musicGenerationMode"]);return _!=null&&a(e,["musicGenerationMode"],_),e}function jw(t){const e={},n=l(t,["temperature"]);n!=null&&a(e,["temperature"],n);const r=l(t,["topK"]);r!=null&&a(e,["topK"],r);const i=l(t,["seed"]);i!=null&&a(e,["seed"],i);const o=l(t,["guidance"]);o!=null&&a(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&a(e,["bpm"],s);const u=l(t,["density"]);u!=null&&a(e,["density"],u);const c=l(t,["brightness"]);c!=null&&a(e,["brightness"],c);const d=l(t,["scale"]);d!=null&&a(e,["scale"],d);const h=l(t,["muteBass"]);h!=null&&a(e,["muteBass"],h);const p=l(t,["muteDrums"]);p!=null&&a(e,["muteDrums"],p);const m=l(t,["onlyBassAndDrums"]);m!=null&&a(e,["onlyBassAndDrums"],m);const _=l(t,["musicGenerationMode"]);return _!=null&&a(e,["musicGenerationMode"],_),e}function ZF(t){const e={},n=l(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>hF(i))),a(e,["audioChunks"],r)}return e}function jF(t){const e={};l(t,["setupComplete"])!=null&&a(e,["setupComplete"],e2());const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],ZF(r));const i=l(t,["filteredPrompt"]);return i!=null&&a(e,["filteredPrompt"],YF(i)),e}function e2(){return{}}function t2(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],jw(n)),e}function n2(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>t0(i))),a(e,["weightedPrompts"],r)}return e}function r2(t){const e={},n=l(t,["clientContent"]);n!=null&&a(e,["clientContent"],QF(n));const r=l(t,["musicGenerationConfig"]);return r!=null&&a(e,["musicGenerationConfig"],XF(r)),e}function i2(t){const e={},n=l(t,["media"]);if(n!=null){let d=Vw(n);Array.isArray(d)&&(d=d.map(h=>h)),a(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&a(e,["audio"],Fw(r));const i=l(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const o=l(t,["video"]);o!=null&&a(e,["video"],Lw(o));const s=l(t,["text"]);return s!=null&&a(e,["text"],s),l(t,["activityStart"])!=null&&a(e,["activityStart"],cF()),l(t,["activityEnd"])!=null&&a(e,["activityEnd"],aF()),e}function o2(t){const e={},n=l(t,["media"]);if(n!=null){let d=Vw(n);Array.isArray(d)&&(d=d.map(h=>h)),a(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&a(e,["audio"],Fw(r));const i=l(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const o=l(t,["video"]);o!=null&&a(e,["video"],Lw(o));const s=l(t,["text"]);return s!=null&&a(e,["text"],s),l(t,["activityStart"])!=null&&a(e,["activityStart"],dF()),l(t,["activityEnd"])!=null&&a(e,["activityEnd"],uF()),e}function s2(t){const e={},n=l(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],EF(n));const r=l(t,["turnComplete"]);r!=null&&a(e,["turnComplete"],r);const i=l(t,["interrupted"]);i!=null&&a(e,["interrupted"],i);const o=l(t,["groundingMetadata"]);o!=null&&a(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&a(e,["generationComplete"],s);const u=l(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Rv(u));const c=l(t,["outputTranscription"]);c!=null&&a(e,["outputTranscription"],Rv(c));const d=l(t,["urlContextMetadata"]);d!=null&&a(e,["urlContextMetadata"],G2(d));const h=l(t,["turnCompleteReason"]);h!=null&&a(e,["turnCompleteReason"],h);const p=l(t,["waitingForInput"]);return p!=null&&a(e,["waitingForInput"],p),e}function l2(t){const e={},n=l(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],IF(n));const r=l(t,["turnComplete"]);r!=null&&a(e,["turnComplete"],r);const i=l(t,["interrupted"]);i!=null&&a(e,["interrupted"],i);const o=l(t,["groundingMetadata"]);o!=null&&a(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&a(e,["generationComplete"],s);const u=l(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],Pv(u));const c=l(t,["outputTranscription"]);c!=null&&a(e,["outputTranscription"],Pv(c));const d=l(t,["turnCompleteReason"]);d!=null&&a(e,["turnCompleteReason"],d);const h=l(t,["waitingForInput"]);return h!=null&&a(e,["waitingForInput"],h),e}function a2(t){const e={},n=l(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function u2(t){const e={},n=l(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function c2(t){const e={};l(t,["setupComplete"])!=null&&a(e,["setupComplete"],p2());const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],s2(r));const i=l(t,["toolCall"]);i!=null&&a(e,["toolCall"],_2(i));const o=l(t,["toolCallCancellation"]);o!=null&&a(e,["toolCallCancellation"],g2(o));const s=l(t,["usageMetadata"]);s!=null&&a(e,["usageMetadata"],K2(s));const u=l(t,["goAway"]);u!=null&&a(e,["goAway"],a2(u));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&a(e,["sessionResumptionUpdate"],f2(c)),e}function d2(t){const e={},n=l(t,["setupComplete"]);n!=null&&a(e,["setupComplete"],m2(n));const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],l2(r));const i=l(t,["toolCall"]);i!=null&&a(e,["toolCall"],v2(i));const o=l(t,["toolCallCancellation"]);o!=null&&a(e,["toolCallCancellation"],y2(o));const s=l(t,["usageMetadata"]);s!=null&&a(e,["usageMetadata"],W2(s));const u=l(t,["goAway"]);u!=null&&a(e,["goAway"],u2(u));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&a(e,["sessionResumptionUpdate"],h2(c)),e}function f2(t){const e={},n=l(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const r=l(t,["resumable"]);r!=null&&a(e,["resumable"],r);const i=l(t,["lastConsumedClientMessageIndex"]);return i!=null&&a(e,["lastConsumedClientMessageIndex"],i),e}function h2(t){const e={},n=l(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const r=l(t,["resumable"]);r!=null&&a(e,["resumable"],r);const i=l(t,["lastConsumedClientMessageIndex"]);return i!=null&&a(e,["lastConsumedClientMessageIndex"],i),e}function p2(){return{}}function m2(t){const e={},n=l(t,["sessionId"]);return n!=null&&a(e,["sessionId"],n),e}function g2(t){const e={},n=l(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function y2(t){const e={},n=l(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function _2(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Qw(i))),a(e,["functionCalls"],r)}return e}function v2(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Yw(i))),a(e,["functionCalls"],r)}return e}function ua(t){const e={},n=l(t,["modality"]);n!=null&&a(e,["modality"],n);const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function ca(t){const e={},n=l(t,["modality"]);n!=null&&a(e,["modality"],n);const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function T2(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>L2(i))),a(e,["speakerVoiceConfigs"],r)}return e}function E2(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],J2(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],yF(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],MF(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],Qw(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function I2(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Q2(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],_F(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],DF(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],Yw(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function C2(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Y2(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],vF(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],kF(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],VF(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function w2(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],X2(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],TF(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],NF(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],LF(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function S2(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function A2(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function R2(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function P2(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function x2(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],mF(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function M2(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],gF(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function D2(t){const e={},n=l(t,["handle"]);if(n!=null&&a(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function k2(t){const e={},n=l(t,["handle"]);n!=null&&a(e,["handle"],n);const r=l(t,["transparent"]);return r!=null&&a(e,["transparent"],r),e}function N2(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function V2(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function L2(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],e0(r)),e}function F2(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],e0(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],T2(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function U2(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],Z2(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function b2(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function B2(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function O2(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>FF(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],qF(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],BF(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],$2());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],b2(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function q2(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>UF(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],GF(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],OF(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],xF(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],bF(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],z2());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],B2(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function Rv(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["finished"]);return r!=null&&a(e,["finished"],r),e}function Pv(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["finished"]);return r!=null&&a(e,["finished"],r),e}function G2(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>H2(i))),a(e,["urlMetadata"],r)}return e}function $2(){return{}}function z2(){return{}}function H2(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function K2(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&a(e,["cachedContentTokenCount"],r);const i=l(t,["responseTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&a(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&a(e,["thoughtsTokenCount"],s);const u=l(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const c=l(t,["promptTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(_=>ua(_))),a(e,["promptTokensDetails"],m)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(_=>ua(_))),a(e,["cacheTokensDetails"],m)}const h=l(t,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(_=>ua(_))),a(e,["responseTokensDetails"],m)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(_=>ua(_))),a(e,["toolUsePromptTokensDetails"],m)}return e}function W2(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&a(e,["cachedContentTokenCount"],r);const i=l(t,["candidatesTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&a(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&a(e,["thoughtsTokenCount"],s);const u=l(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const c=l(t,["promptTokensDetails"]);if(c!=null){let _=c;Array.isArray(_)&&(_=_.map(w=>ca(w))),a(e,["promptTokensDetails"],_)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(w=>ca(w))),a(e,["cacheTokensDetails"],_)}const h=l(t,["candidatesTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(w=>ca(w))),a(e,["responseTokensDetails"],_)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(w=>ca(w))),a(e,["toolUsePromptTokensDetails"],_)}const m=l(t,["trafficType"]);return m!=null&&a(e,["trafficType"],m),e}function J2(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Q2(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Y2(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function X2(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function e0(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],S2(n)),e}function Z2(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],A2(n)),e}function j2(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["weight"]);return r!=null&&a(e,["weight"],r),e}function t0(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["weight"]);return r!=null&&a(e,["weight"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eU(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function tU(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],eU(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function nU(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function rU(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function iU(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function oU(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function sU(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],gU(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],uU(r));const i=l(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],F4(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function lU(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],yU(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],cU(r));const i=l(t,["finishMessage"]);i!=null&&a(e,["finishMessage"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],U4(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function aU(t){const e={},n=l(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const r=l(t,["epoch"]);r!=null&&a(e,["epoch"],r);const i=l(t,["step"]);return i!=null&&a(e,["step"],i),e}function uU(t){const e={},n=l(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function cU(t){const e={},n=l(t,["citations"]);return n!=null&&a(e,["citations"],n),e}function dU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let o=Jt(i);Array.isArray(o)&&(o=o.map(s=>Mo(s))),a(n,["contents"],o)}return n}function fU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["tokensInfo"]);return r!=null&&a(e,["tokensInfo"],r),e}function hU(t){const e={},n=l(t,["values"]);return n!=null&&a(e,["values"],n),e}function pU(t){const e={},n=l(t,["values"]);n!=null&&a(e,["values"],n);const r=l(t,["statistics"]);return r!=null&&a(e,["statistics"],mU(r)),e}function mU(t){const e={},n=l(t,["truncated"]);n!=null&&a(e,["truncated"],n);const r=l(t,["token_count"]);return r!=null&&a(e,["tokenCount"],r),e}function gU(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Kb(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function yU(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Wb(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function rc(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Jb(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Mo(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>Qb(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function _U(t){const e={},n=l(t,["controlType"]);n!=null&&a(e,["controlType"],n);const r=l(t,["enableControlImageComputation"]);return r!=null&&a(e,["computeControl"],r),e}function vU(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function TU(t,e){const n={},r=l(t,["systemInstruction"]);e!==void 0&&r!=null&&a(e,["systemInstruction"],Mo(at(r)));const i=l(t,["tools"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(u=>s0(u))),a(e,["tools"],s)}const o=l(t,["generationConfig"]);return e!==void 0&&o!=null&&a(e,["generationConfig"],o),n}function EU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Jt(i);Array.isArray(s)&&(s=s.map(u=>rc(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&vU(o),n}function IU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Jt(i);Array.isArray(s)&&(s=s.map(u=>Mo(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&TU(o,n),n}function CU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);r!=null&&a(e,["totalTokens"],r);const i=l(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function wU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);return r!=null&&a(e,["totalTokens"],r),e}function SU(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function AU(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function RU(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function PU(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function xU(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function MU(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function DU(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&a(e,["parameters","aspectRatio"],s);const u=l(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const c=l(t,["seed"]);e!==void 0&&c!=null&&a(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&a(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const _=l(t,["language"]);e!==void 0&&_!=null&&a(e,["parameters","language"],_);const w=l(t,["outputMimeType"]);e!==void 0&&w!=null&&a(e,["parameters","outputOptions","mimeType"],w);const R=l(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&a(e,["parameters","outputOptions","compressionQuality"],R);const k=l(t,["addWatermark"]);e!==void 0&&k!=null&&a(e,["parameters","addWatermark"],k);const S=l(t,["editMode"]);e!==void 0&&S!=null&&a(e,["parameters","editMode"],S);const v=l(t,["baseSteps"]);return e!==void 0&&v!=null&&a(e,["parameters","editConfig","baseSteps"],v),n}function kU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>r4(c))),a(n,["instances[0]","referenceImages"],u)}const s=l(e,["config"]);return s!=null&&DU(s,n),n}function NU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ic(o))),a(e,["generatedImages"],i)}return e}function VU(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["requests[]","taskType"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&a(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function LU(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["instances[]","task_type"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["instances[]","title"],i);const o=l(t,["outputDimensionality"]);e!==void 0&&o!=null&&a(e,["parameters","outputDimensionality"],o);const s=l(t,["mimeType"]);e!==void 0&&s!=null&&a(e,["instances[]","mimeType"],s);const u=l(t,["autoTruncate"]);return e!==void 0&&u!=null&&a(e,["parameters","autoTruncate"],u),n}function FU(){return{}}function UU(t){const e={},n=l(t,["billableCharacterCount"]);return n!=null&&a(e,["billableCharacterCount"],n),e}function bU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);i!=null&&a(n,["requests[]","content"],Lp(t,i));const o=l(e,["config"]);o!=null&&VU(o,n);const s=l(e,["model"]);return s!==void 0&&a(n,["requests[]","model"],ue(t,s)),n}function BU(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);i!=null&&a(n,["instances[]","content"],Lp(t,i));const o=l(e,["config"]);return o!=null&&LU(o,n),n}function OU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>hU(s))),a(e,["embeddings"],o)}return l(t,["metadata"])!=null&&a(e,["metadata"],FU()),e}function qU(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>pU(s))),a(e,["embeddings"],o)}const i=l(t,["metadata"]);return i!=null&&a(e,["metadata"],UU(i)),e}function GU(t){const e={},n=l(t,["endpoint"]);n!=null&&a(e,["name"],n);const r=l(t,["deployedModelId"]);return r!=null&&a(e,["deployedModelId"],r),e}function $U(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function zU(t){const e={},n=l(t,["label"]);n!=null&&a(e,["label"],n);const r=l(t,["score"]);return r!=null&&a(e,["score"],r),e}function HU(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function KU(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function WU(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function JU(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function QU(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function YU(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function XU(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function ZU(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function jU(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function eb(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function tb(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function nb(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function rb(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],rc(at(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const w=l(e,["frequencyPenalty"]);w!=null&&a(r,["frequencyPenalty"],w);const R=l(e,["seed"]);R!=null&&a(r,["seed"],R);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const S=l(e,["responseSchema"]);S!=null&&a(r,["responseSchema"],a4(Fp(S)));const v=l(e,["responseJsonSchema"]);if(v!=null&&a(r,["responseJsonSchema"],v),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let M=I;Array.isArray(M)&&(M=M.map(N=>s4(N))),a(n,["safetySettings"],M)}const D=l(e,["tools"]);if(n!==void 0&&D!=null){let M=Po(D);Array.isArray(M)&&(M=M.map(N=>A4(Ro(N)))),a(n,["tools"],M)}const F=l(e,["toolConfig"]);if(n!==void 0&&F!=null&&a(n,["toolConfig"],w4(F)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const U=l(e,["cachedContent"]);n!==void 0&&U!=null&&a(n,["cachedContent"],Bn(t,U));const C=l(e,["responseModalities"]);C!=null&&a(r,["responseModalities"],C);const E=l(e,["mediaResolution"]);E!=null&&a(r,["mediaResolution"],E);const A=l(e,["speechConfig"]);if(A!=null&&a(r,["speechConfig"],g4(Up(A))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=l(e,["thinkingConfig"]);return P!=null&&a(r,["thinkingConfig"],T4(P)),r}function ib(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],Mo(at(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const w=l(e,["frequencyPenalty"]);w!=null&&a(r,["frequencyPenalty"],w);const R=l(e,["seed"]);R!=null&&a(r,["seed"],R);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const S=l(e,["responseSchema"]);S!=null&&a(r,["responseSchema"],u4(Fp(S)));const v=l(e,["responseJsonSchema"]);v!=null&&a(r,["responseJsonSchema"],v);const I=l(e,["routingConfig"]);I!=null&&a(r,["routingConfig"],I);const D=l(e,["modelSelectionConfig"]);D!=null&&a(r,["modelConfig"],zb(D));const F=l(e,["safetySettings"]);if(n!==void 0&&F!=null){let We=F;Array.isArray(We)&&(We=We.map(gn=>l4(gn))),a(n,["safetySettings"],We)}const U=l(e,["tools"]);if(n!==void 0&&U!=null){let We=Po(U);Array.isArray(We)&&(We=We.map(gn=>s0(Ro(gn)))),a(n,["tools"],We)}const C=l(e,["toolConfig"]);n!==void 0&&C!=null&&a(n,["toolConfig"],S4(C));const E=l(e,["labels"]);n!==void 0&&E!=null&&a(n,["labels"],E);const A=l(e,["cachedContent"]);n!==void 0&&A!=null&&a(n,["cachedContent"],Bn(t,A));const P=l(e,["responseModalities"]);P!=null&&a(r,["responseModalities"],P);const M=l(e,["mediaResolution"]);M!=null&&a(r,["mediaResolution"],M);const N=l(e,["speechConfig"]);N!=null&&a(r,["speechConfig"],y4(Up(N)));const x=l(e,["audioTimestamp"]);x!=null&&a(r,["audioTimestamp"],x);const ct=l(e,["thinkingConfig"]);return ct!=null&&a(r,["thinkingConfig"],E4(ct)),r}function xv(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Jt(i);Array.isArray(s)&&(s=s.map(u=>rc(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["generationConfig"],rb(t,o,n)),n}function Mv(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Jt(i);Array.isArray(s)&&(s=s.map(u=>Mo(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["generationConfig"],ib(t,o,n)),n}function Dv(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>sU(d))),a(e,["candidates"],c)}const i=l(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=l(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&a(e,["responseId"],s);const u=l(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function kv(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>lU(h))),a(e,["candidates"],d)}const i=l(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=l(t,["modelVersion"]);o!=null&&a(e,["modelVersion"],o);const s=l(t,["promptFeedback"]);s!=null&&a(e,["promptFeedback"],s);const u=l(t,["responseId"]);u!=null&&a(e,["responseId"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function ob(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["aspectRatio"]);e!==void 0&&i!=null&&a(e,["parameters","aspectRatio"],i);const o=l(t,["guidanceScale"]);if(e!==void 0&&o!=null&&a(e,["parameters","guidanceScale"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&a(e,["parameters","safetySetting"],s);const u=l(t,["personGeneration"]);e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u);const c=l(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&a(e,["parameters","includeSafetyAttributes"],c);const d=l(t,["includeRaiReason"]);e!==void 0&&d!=null&&a(e,["parameters","includeRaiReason"],d);const h=l(t,["language"]);e!==void 0&&h!=null&&a(e,["parameters","language"],h);const p=l(t,["outputMimeType"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","mimeType"],p);const m=l(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&a(e,["parameters","outputOptions","compressionQuality"],m),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const _=l(t,["imageSize"]);if(e!==void 0&&_!=null&&a(e,["parameters","sampleImageSize"],_),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function sb(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&a(e,["parameters","aspectRatio"],s);const u=l(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const c=l(t,["seed"]);e!==void 0&&c!=null&&a(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&a(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const _=l(t,["language"]);e!==void 0&&_!=null&&a(e,["parameters","language"],_);const w=l(t,["outputMimeType"]);e!==void 0&&w!=null&&a(e,["parameters","outputOptions","mimeType"],w);const R=l(t,["outputCompressionQuality"]);e!==void 0&&R!=null&&a(e,["parameters","outputOptions","compressionQuality"],R);const k=l(t,["addWatermark"]);e!==void 0&&k!=null&&a(e,["parameters","addWatermark"],k);const S=l(t,["imageSize"]);e!==void 0&&S!=null&&a(e,["parameters","sampleImageSize"],S);const v=l(t,["enhancePrompt"]);return e!==void 0&&v!=null&&a(e,["parameters","enhancePrompt"],v),n}function lb(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["config"]);return o!=null&&ob(o,n),n}function ab(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["config"]);return o!=null&&sb(o,n),n}function ub(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Eb(s))),a(e,["generatedImages"],o)}const i=l(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],i0(i)),e}function cb(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>ic(s))),a(e,["generatedImages"],o)}const i=l(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],o0(i)),e}function db(t,e){const n={},r=l(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=l(t,["durationSeconds"]);if(e!==void 0&&i!=null&&a(e,["parameters","durationSeconds"],i),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&a(e,["parameters","aspectRatio"],o);const s=l(t,["resolution"]);e!==void 0&&s!=null&&a(e,["parameters","resolution"],s);const u=l(t,["personGeneration"]);if(e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=l(t,["negativePrompt"]);e!==void 0&&c!=null&&a(e,["parameters","negativePrompt"],c);const d=l(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&a(e,["parameters","enhancePrompt"],d),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(l(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(l(t,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function fb(t,e){const n={},r=l(t,["numberOfVideos"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=l(t,["fps"]);e!==void 0&&o!=null&&a(e,["parameters","fps"],o);const s=l(t,["durationSeconds"]);e!==void 0&&s!=null&&a(e,["parameters","durationSeconds"],s);const u=l(t,["seed"]);e!==void 0&&u!=null&&a(e,["parameters","seed"],u);const c=l(t,["aspectRatio"]);e!==void 0&&c!=null&&a(e,["parameters","aspectRatio"],c);const d=l(t,["resolution"]);e!==void 0&&d!=null&&a(e,["parameters","resolution"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["pubsubTopic"]);e!==void 0&&p!=null&&a(e,["parameters","pubsubTopic"],p);const m=l(t,["negativePrompt"]);e!==void 0&&m!=null&&a(e,["parameters","negativePrompt"],m);const _=l(t,["enhancePrompt"]);e!==void 0&&_!=null&&a(e,["parameters","enhancePrompt"],_);const w=l(t,["generateAudio"]);e!==void 0&&w!=null&&a(e,["parameters","generateAudio"],w);const R=l(t,["lastFrame"]);e!==void 0&&R!=null&&a(e,["instances[0]","lastFrame"],sn(R));const k=l(t,["referenceImages"]);if(e!==void 0&&k!=null){let I=k;Array.isArray(I)&&(I=I.map(D=>H4(D))),a(e,["instances[0]","referenceImages"],I)}const S=l(t,["mask"]);e!==void 0&&S!=null&&a(e,["instances[0]","mask"],z4(S));const v=l(t,["compressionQuality"]);return e!==void 0&&v!=null&&a(e,["parameters","compressionQuality"],v),n}function hb(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&a(e,["response"],yb(s)),e}function pb(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response"]);return s!=null&&a(e,["response"],_b(s)),e}function mb(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["image"]);if(o!=null&&a(n,["instances[0]","image"],r0(o)),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const s=l(e,["source"]);s!=null&&vb(s,n);const u=l(e,["config"]);return u!=null&&db(u,n),n}function gb(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["image"]);o!=null&&a(n,["instances[0]","image"],sn(o));const s=l(e,["video"]);s!=null&&a(n,["instances[0]","video"],l0(s));const u=l(e,["source"]);u!=null&&Tb(u,n);const c=l(e,["config"]);return c!=null&&fb(c,n),n}function yb(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>Cb(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function _b(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>wb(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function vb(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);if(e!==void 0&&i!=null&&a(e,["instances[0]","image"],r0(i)),l(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");return n}function Tb(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],sn(i));const o=l(t,["video"]);return e!==void 0&&o!=null&&a(e,["instances[0]","video"],l0(o)),n}function Eb(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["image"],kb(n));const r=l(t,["raiFilteredReason"]);r!=null&&a(e,["raiFilteredReason"],r);const i=l(t,["_self"]);return i!=null&&a(e,["safetyAttributes"],i0(i)),e}function ic(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["image"],n0(n));const r=l(t,["raiFilteredReason"]);r!=null&&a(e,["raiFilteredReason"],r);const i=l(t,["_self"]);i!=null&&a(e,["safetyAttributes"],o0(i));const o=l(t,["prompt"]);return o!=null&&a(e,["enhancedPrompt"],o),e}function Ib(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["mask"],n0(n));const r=l(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>zU(o))),a(e,["labels"],i)}return e}function Cb(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],G4(n)),e}function wb(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],$4(n)),e}function Sb(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function Ab(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function Rb(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],tU(n)),e}function Pb(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],xU(n)),e}function xb(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],MU(n)),e}function Mb(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],Nb(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Db(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],Vb(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function kb(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],mi(n));const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function n0(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["imageBytes"],mi(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function r0(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],mi(n));const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function sn(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["imageBytes"]);r!=null&&a(e,["bytesBase64Encoded"],mi(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Nb(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Vb(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Lb(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function Fb(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function Ub(t,e,n){const r={},i=l(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&a(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&a(n,["_query","filter"],s);const u=l(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ow(t,u)),r}function bb(t,e,n){const r={},i=l(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&a(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&a(n,["_query","filter"],s);const u=l(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],Ow(t,u)),r}function Bb(t,e){const n={},r=l(e,["config"]);return r!=null&&Ub(t,r,n),n}function Ob(t,e){const n={},r=l(e,["config"]);return r!=null&&bb(t,r,n),n}function qb(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["_self"]);if(i!=null){let o=qw(i);Array.isArray(o)&&(o=o.map(s=>qf(s))),a(e,["models"],o)}return e}function Gb(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["_self"]);if(i!=null){let o=qw(i);Array.isArray(o)&&(o=o.map(s=>Gf(s))),a(e,["models"],o)}return e}function $b(t){const e={},n=l(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const r=l(t,["segmentationClasses"]);r!=null&&a(e,["maskClasses"],r);const i=l(t,["maskDilation"]);return i!=null&&a(e,["dilation"],i),e}function qf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["version"]);o!=null&&a(e,["version"],o);const s=l(t,["_self"]);s!=null&&a(e,["tunedModelInfo"],R4(s));const u=l(t,["inputTokenLimit"]);u!=null&&a(e,["inputTokenLimit"],u);const c=l(t,["outputTokenLimit"]);c!=null&&a(e,["outputTokenLimit"],c);const d=l(t,["supportedGenerationMethods"]);return d!=null&&a(e,["supportedActions"],d),e}function Gf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["versionId"]);o!=null&&a(e,["version"],o);const s=l(t,["deployedModels"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(m=>GU(m))),a(e,["endpoints"],p)}const u=l(t,["labels"]);u!=null&&a(e,["labels"],u);const c=l(t,["_self"]);c!=null&&a(e,["tunedModelInfo"],P4(c));const d=l(t,["defaultCheckpointId"]);d!=null&&a(e,["defaultCheckpointId"],d);const h=l(t,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>aU(m))),a(e,["checkpoints"],p)}return e}function zb(t){const e={},n=l(t,["featureSelectionPreference"]);return n!=null&&a(e,["featureSelectionPreference"],n),e}function Hb(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>m4(i))),a(e,["speakerVoiceConfigs"],r)}return e}function Kb(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],K4(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],nU(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],HU(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],QU(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function Wb(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],W4(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],rU(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],KU(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],YU(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function Jb(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],J4(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],iU(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],WU(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],XU(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function Qb(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Q4(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],oU(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],JU(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],ZU(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function Yb(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Xb(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function Zb(t){const e={},n=l(t,["productImage"]);return n!=null&&a(e,["image"],sn(n)),e}function jb(t,e){const n={},r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["baseSteps"]);e!==void 0&&i!=null&&a(e,["parameters","editConfig","baseSteps"],i);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const s=l(t,["seed"]);e!==void 0&&s!=null&&a(e,["parameters","seed"],s);const u=l(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&a(e,["parameters","safetySetting"],u);const c=l(t,["personGeneration"]);e!==void 0&&c!=null&&a(e,["parameters","personGeneration"],c);const d=l(t,["addWatermark"]);e!==void 0&&d!=null&&a(e,["parameters","addWatermark"],d);const h=l(t,["outputMimeType"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","mimeType"],h);const p=l(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","compressionQuality"],p);const m=l(t,["enhancePrompt"]);return e!==void 0&&m!=null&&a(e,["parameters","enhancePrompt"],m),n}function e4(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["source"]);i!=null&&n4(i,n);const o=l(e,["config"]);return o!=null&&jb(o,n),n}function t4(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>ic(i))),a(e,["generatedImages"],r)}return e}function n4(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["personImage"]);e!==void 0&&i!=null&&a(e,["instances[0]","personImage","image"],sn(i));const o=l(t,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(u=>Zb(u))),a(e,["instances[0]","productImages"],s)}return n}function r4(t){const e={},n=l(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],sn(n));const r=l(t,["referenceId"]);r!=null&&a(e,["referenceId"],r);const i=l(t,["referenceType"]);i!=null&&a(e,["referenceType"],i);const o=l(t,["maskImageConfig"]);o!=null&&a(e,["maskImageConfig"],$b(o));const s=l(t,["controlImageConfig"]);s!=null&&a(e,["controlImageConfig"],_U(s));const u=l(t,["styleImageConfig"]);u!=null&&a(e,["styleImageConfig"],_4(u));const c=l(t,["subjectImageConfig"]);return c!=null&&a(e,["subjectImageConfig"],v4(c)),e}function i4(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],Lb(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function o4(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],Fb(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function i0(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&a(e,["scores"],r);const i=l(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function o0(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&a(e,["scores"],r);const i=l(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function s4(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&a(e,["category"],n);const r=l(t,["threshold"]);return r!=null&&a(e,["threshold"],r),e}function l4(t){const e={},n=l(t,["method"]);n!=null&&a(e,["method"],n);const r=l(t,["category"]);r!=null&&a(e,["category"],r);const i=l(t,["threshold"]);return i!=null&&a(e,["threshold"],i),e}function a4(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const w=l(t,["minLength"]);w!=null&&a(e,["minLength"],w);const R=l(t,["minProperties"]);R!=null&&a(e,["minProperties"],R);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const S=l(t,["nullable"]);S!=null&&a(e,["nullable"],S);const v=l(t,["pattern"]);v!=null&&a(e,["pattern"],v);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const D=l(t,["propertyOrdering"]);D!=null&&a(e,["propertyOrdering"],D);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const U=l(t,["title"]);U!=null&&a(e,["title"],U);const C=l(t,["type"]);return C!=null&&a(e,["type"],C),e}function u4(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const w=l(t,["minLength"]);w!=null&&a(e,["minLength"],w);const R=l(t,["minProperties"]);R!=null&&a(e,["minProperties"],R);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const S=l(t,["nullable"]);S!=null&&a(e,["nullable"],S);const v=l(t,["pattern"]);v!=null&&a(e,["pattern"],v);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const D=l(t,["propertyOrdering"]);D!=null&&a(e,["propertyOrdering"],D);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const U=l(t,["title"]);U!=null&&a(e,["title"],U);const C=l(t,["type"]);return C!=null&&a(e,["type"],C),e}function c4(t){const e={},n=l(t,["image"]);return n!=null&&a(e,["image"],sn(n)),e}function d4(t,e){const n={},r=l(t,["mode"]);e!==void 0&&r!=null&&a(e,["parameters","mode"],r);const i=l(t,["maxPredictions"]);e!==void 0&&i!=null&&a(e,["parameters","maxPredictions"],i);const o=l(t,["confidenceThreshold"]);e!==void 0&&o!=null&&a(e,["parameters","confidenceThreshold"],o);const s=l(t,["maskDilation"]);e!==void 0&&s!=null&&a(e,["parameters","maskDilation"],s);const u=l(t,["binaryColorThreshold"]);return e!==void 0&&u!=null&&a(e,["parameters","binaryColorThreshold"],u),n}function f4(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["source"]);i!=null&&p4(i,n);const o=l(e,["config"]);return o!=null&&d4(o,n),n}function h4(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Ib(i))),a(e,["generatedMasks"],r)}return e}function p4(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],sn(i));const o=l(t,["scribbleImage"]);return e!==void 0&&o!=null&&a(e,["instances[0]","scribble"],c4(o)),n}function m4(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],a0(r)),e}function g4(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],a0(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],Hb(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function y4(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],Y4(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function _4(t){const e={},n=l(t,["styleDescription"]);return n!=null&&a(e,["styleDescription"],n),e}function v4(t){const e={},n=l(t,["subjectType"]);n!=null&&a(e,["subjectType"],n);const r=l(t,["subjectDescription"]);return r!=null&&a(e,["subjectDescription"],r),e}function T4(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function E4(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function I4(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function C4(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function w4(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],jU(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],i4(r)),e}function S4(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],eb(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],o4(r)),e}function A4(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>tb(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],Mb(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],Pb(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],b4());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],I4(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function s0(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>nb(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],Db(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],xb(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],$U(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],Rb(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],B4());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],C4(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function R4(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&a(e,["createTime"],r);const i=l(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function P4(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&a(e,["createTime"],r);const i=l(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function x4(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&a(e,["defaultCheckpointId"],o),n}function M4(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&a(e,["defaultCheckpointId"],o),n}function D4(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","name"],ue(t,r));const i=l(e,["config"]);return i!=null&&x4(i,n),n}function k4(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&M4(i,n),n}function N4(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["includeRaiReason"]);e!==void 0&&i!=null&&a(e,["parameters","includeRaiReason"],i);const o=l(t,["outputMimeType"]);e!==void 0&&o!=null&&a(e,["parameters","outputOptions","mimeType"],o);const s=l(t,["outputCompressionQuality"]);e!==void 0&&s!=null&&a(e,["parameters","outputOptions","compressionQuality"],s);const u=l(t,["enhanceInputImage"]);e!==void 0&&u!=null&&a(e,["parameters","upscaleConfig","enhanceInputImage"],u);const c=l(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&a(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=l(t,["numberOfImages"]);e!==void 0&&d!=null&&a(e,["parameters","sampleCount"],d);const h=l(t,["mode"]);return e!==void 0&&h!=null&&a(e,["parameters","mode"],h),n}function V4(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["image"]);i!=null&&a(n,["instances[0]","image"],sn(i));const o=l(e,["upscaleFactor"]);o!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=l(e,["config"]);return s!=null&&N4(s,n),n}function L4(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ic(o))),a(e,["generatedImages"],i)}return e}function F4(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>O4(i))),a(e,["urlMetadata"],r)}return e}function U4(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>q4(i))),a(e,["urlMetadata"],r)}return e}function b4(){return{}}function B4(){return{}}function O4(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function q4(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function G4(t){const e={},n=l(t,["video","uri"]);n!=null&&a(e,["uri"],n);const r=l(t,["video","encodedVideo"]);r!=null&&a(e,["videoBytes"],mi(r));const i=l(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function $4(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["videoBytes"],mi(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function z4(t){const e={},n=l(t,["image"]);n!=null&&a(e,["_self"],sn(n));const r=l(t,["maskMode"]);return r!=null&&a(e,["maskMode"],r),e}function H4(t){const e={},n=l(t,["image"]);n!=null&&a(e,["image"],sn(n));const r=l(t,["referenceType"]);return r!=null&&a(e,["referenceType"],r),e}function K4(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function W4(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function J4(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Q4(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function l0(t){const e={},n=l(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["videoBytes"]);r!=null&&a(e,["bytesBase64Encoded"],mi(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function a0(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],Yb(n)),e}function Y4(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],Xb(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const X4="Content-Type",Z4="X-Server-Timeout",j4="User-Agent",$f="x-goog-api-client",eB="1.21.0",tB=`google-genai-sdk/${eB}`,nB="v1beta1",rB="v1beta",Nv=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class iB{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:nB,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:rB,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[s,u]of Object.entries(e.queryParams))i.searchParams.append(s,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(n))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,o=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const s=setTimeout(()=>i.abort(),n.timeout);s&&typeof s.unref=="function"&&s.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=o}return n&&n.extraBody!==null&&oB(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Vv(i),new Ff(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await Vv(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return Zi(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";for(;;){const{done:u,value:c}=yield ve(i.read());if(u){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=o.decode(c,{stream:!0});try{const p=JSON.parse(d);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),_=m.status,w=m.code,R=`got status: ${_}. ${JSON.stringify(p)}`;if(w>=400&&w<600)throw new nc({message:R,status:w})}}catch(p){if(p.name==="ApiError")throw p}s+=d;let h=s.match(Nv);for(;h;){const p=h[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ve(new Ff(m)),s=s.slice(h[0].length),h=s.match(Nv)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=tB+" "+this.clientOptions.userAgentExtra;return e[j4]=n,e[$f]=n,e[X4]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(Z4,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);i.sizeBytes=String(s.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const c=await this.fetchUploadUrl(i,n);return o.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},s=await this.request({path:J("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:i});if(!s||!(s!=null&&s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=s==null?void 0:s.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function Vv(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new nc({message:i,status:n}):new Error(i)}}function oB(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,s){const u=Object.assign({},o);for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const d=s[c],h=u[c];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?u[c]=r(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),u[c]=d)}return u}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const sB="mcp_used/unknown";let lB=!1;function u0(t){for(const e of t)if(aB(e)||typeof e=="object"&&"inputSchema"in e)return!0;return lB}function c0(t){var e;const n=(e=t[$f])!==null&&e!==void 0?e:"";t[$f]=(n+` ${sB}`).trimStart()}function aB(t){return t!==null&&typeof t=="object"&&t instanceof Op}function uB(t,e=100){return Zi(this,arguments,function*(){let r,i=0;for(;i<e;){const o=yield ve(t.listTools({cursor:r}));for(const s of o.tools)yield yield ve(s),i++;if(!o.nextCursor)break;r=o.nextCursor}})}class Op{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Op(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const o={},s=[];for(const h of this.mcpClients)try{for(var u=!0,c=(n=void 0,Ps(uB(h))),d;d=await c.next(),e=d.done,!e;u=!0){i=d.value,u=!1;const p=i;s.push(p);const m=p.name;if(o[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);o[m]=h}}catch(p){n={error:p}}finally{try{!u&&!e&&(r=c.return)&&await r.call(c)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),w1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await i.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function cB(t,e,n){const r=new g1;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const o=jF(i);Object.assign(r,o),e(r)}class dB{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=pB(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let d=()=>{};const h=new Promise(I=>{d=I}),p=e.callbacks,m=function(){d({})},_=this.apiClient,w={onopen:m,onmessage:I=>{cB(_,p.onmessage,I)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(I){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(I){}},R=this.webSocketFactory.create(c,hB(s),w);R.connect(),await h;const k=ue(this.apiClient,e.model),S=Zw({model:k}),v=Of({setup:S});return R.send(JSON.stringify(v)),new fB(R,this.apiClient)}}class fB{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=n2(e),r=Xw(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=t2(e),r=Of(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=Of({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($i.PLAY)}pause(){this.sendPlaybackControl($i.PAUSE)}stop(){this.sendPlaybackControl($i.STOP)}resetContext(){this.sendPlaybackControl($i.RESET_CONTEXT)}close(){this.conn.close()}}function hB(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function pB(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mB="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function gB(t,e,n){const r=new m1;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const o=JSON.parse(i);if(t.isVertexAI()){const s=d2(o);Object.assign(r,s)}else{const s=c2(o);Object.assign(r,s)}e(r)}class yB{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new dB(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,o,s,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&u0(e.config.tools)&&c0(p);const m=EB(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const A=this.apiClient.getApiKey();let P="BidiGenerateContent",M="key";A!=null&&A.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",M="access_token"),h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${P}?${M}=${A}`}let _=()=>{};const w=new Promise(A=>{_=A}),R=e.callbacks,k=function(){var A;(A=R==null?void 0:R.onopen)===null||A===void 0||A.call(R),_({})},S=this.apiClient,v={onopen:k,onmessage:A=>{gB(S,R.onmessage,A)},onerror:(n=R==null?void 0:R.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=R==null?void 0:R.onclose)!==null&&r!==void 0?r:function(A){}},I=this.webSocketFactory.create(h,TB(m),v);I.connect(),await w;let D=ue(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const A=this.apiClient.getProject(),P=this.apiClient.getLocation();D=`projects/${A}/locations/${P}/`+D}let F={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[_u.AUDIO]}:e.config.responseModalities=[_u.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const U=(u=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[],C=[];for(const A of U)if(this.isCallableTool(A)){const P=A;C.push(await P.tool())}else C.push(A);C.length>0&&(e.config.tools=C);const E={model:D,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=JF(this.apiClient,E):F=WF(this.apiClient,E),delete F.config,I.send(JSON.stringify(F)),new vB(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const _B={turnComplete:!0};class vB{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Jt(n.turns),e.isVertexAI()?r=r.map(i=>Mo(i)):r=r.map(i=>rc(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(mB)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},_B),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:o2(e)}:n={realtimeInput:i2(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function TB(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function EB(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Lv=10;function Fv(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(ji(s)){i=!0;break}if(!i)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function ji(t){return"callTool"in t&&typeof t.callTool=="function"}function IB(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>ji(i)))!==null&&r!==void 0?r:!1}function CB(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!ji(i)))!==null&&r!==void 0?r:!1}function Uv(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class wB extends pi{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,o,s,u;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!IB(n)||Fv(n.config))return await this.generateContentInternal(c);if(CB(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,h;const p=Jt(c.contents),m=(o=(i=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:Lv;let _=0;for(;_<m&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const w=d.candidates[0].content,R=[];for(const k of(u=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[])if(ji(k)){const v=await k.callTool(d.functionCalls);R.push(...v)}_++,h={role:"user",parts:R},c.contents=Jt(c.contents),c.contents.push(w),c.contents.push(h),Uv(c.config)&&(p.push(w),p.push(h))}return Uv(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),Fv(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=c==null?void 0:c.safetyAttributes:s.push(c);let u;return o?u={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new _l(si.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const s=await Promise.all(o.map(async c=>ji(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(u.config.tools=s,e.config&&e.config.tools&&u0(e.config.tools)){const c=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),c0(d),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return u}async initAfcToolsMap(e){var n,r,i;const o=new Map;for(const s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(ji(s)){const u=s,c=await u.tool();for(const d of(i=c.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(o.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);o.set(d.name,u)}}return o}async processAfcStream(e){var n,r,i;const o=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:Lv;let s=!1,u=0;const c=await this.initAfcToolsMap(e);return function(d,h,p){var m,_;return Zi(this,arguments,function*(){for(var w,R,k,S;u<o;){s&&(u++,s=!1);const F=yield ve(d.processParamsMaybeAddMcpUsage(p)),U=yield ve(d.generateContentStreamInternal(F)),C=[],E=[];try{for(var v=!0,I=(R=void 0,Ps(U)),D;D=yield ve(I.next()),w=D.done,!w;v=!0){S=D.value,v=!1;const A=S;if(yield yield ve(A),A.candidates&&(!((m=A.candidates[0])===null||m===void 0)&&m.content)){E.push(A.candidates[0].content);for(const P of(_=A.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(u<o&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(P.functionCall.name)){const M=yield ve(h.get(P.functionCall.name).callTool([P.functionCall]));C.push(...M)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(A){R={error:A}}finally{try{!v&&!w&&(k=I.return)&&(yield ve(k.call(I)))}finally{if(R)throw R.error}}if(C.length>0){s=!0;const A=new is;A.candidates=[{content:{role:"user",parts:C}}],yield yield ve(A);const P=[];P.push(...E),P.push({role:"user",parts:C});const M=Jt(p.contents).concat(P);p.contents=M}else break}})}(this,c,e)}async generateContentInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Mv(this.apiClient,e);return u=J("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=kv(h),m=new is;return Object.assign(m,p),m})}else{const d=xv(this.apiClient,e);return u=J("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=Dv(h),m=new is;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Mv(this.apiClient,e);return u=J("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(p){return Zi(this,arguments,function*(){var m,_,w,R;try{for(var k=!0,S=Ps(p),v;v=yield ve(S.next()),m=v.done,!m;k=!0){R=v.value,k=!1;const I=R,D=kv(yield ve(I.json()));D.sdkHttpResponse={headers:I.headers};const F=new is;Object.assign(F,D),yield yield ve(F)}}catch(I){_={error:I}}finally{try{!k&&!m&&(w=S.return)&&(yield ve(w.call(S)))}finally{if(_)throw _.error}}})})}else{const d=xv(this.apiClient,e);return u=J("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(p){return Zi(this,arguments,function*(){var m,_,w,R;try{for(var k=!0,S=Ps(p),v;v=yield ve(S.next()),m=v.done,!m;k=!0){R=v.value,k=!1;const I=R,D=Dv(yield ve(I.json()));D.sdkHttpResponse={headers:I.headers};const F=new is;Object.assign(F,D),yield yield ve(F)}}catch(I){_={error:I}}finally{try{!k&&!m&&(w=S.return)&&(yield ve(w.call(S)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=BU(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=qU(h),m=new uv;return Object.assign(m,p),m})}else{const d=bU(this.apiClient,e);return u=J("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=OU(h),m=new uv;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=ab(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=cb(h),m=new cv;return Object.assign(m,p),m})}else{const d=lb(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=ub(h),m=new cv;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=kU(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=NU(c),h=new l1;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=V4(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=L4(c),h=new a1;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=e4(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=t4(c),h=new u1;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=f4(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=h4(c),h=new c1;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Ab(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Gf(h))}else{const d=Sb(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>qf(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Ob(this.apiClient,e);return u=J("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=Gb(h),m=new dv;return Object.assign(m,p),m})}else{const d=Bb(this.apiClient,e);return u=J("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=qb(h),m=new dv;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=k4(this.apiClient,e);return u=J("{model}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>Gf(h))}else{const d=D4(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>qf(h))}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=AU(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=PU(h),m=new fv;return Object.assign(m,p),m})}else{const d=SU(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=RU(h),m=new fv;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=IU(this.apiClient,e);return u=J("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=wU(h),m=new hv;return Object.assign(m,p),m})}else{const d=EU(this.apiClient,e);return u=J("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=CU(h),m=new hv;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=dU(this.apiClient,e);return o=J("{model}:computeTokens",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=fU(c),h=new d1;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=gb(this.apiClient,e);return u=J("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const p=pb(h),m=new vu;return Object.assign(m,p),m})}else{const d=mb(this.apiClient,e);return u=J("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const p=hb(h),m=new vu;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class SB extends pi{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=i1(e);return u=J("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s}else{const d=r1(e);return u=J("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=YN(e);return o=J("{resourceName}:fetchPredictOperation",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function bv(){return{}}function AB(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["name"],n),e}function RB(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function PB(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function xB(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>$B(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function MB(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],JB(r)),e}function DB(t,e,n){const r={},i=l(e,["expireTime"]);n!==void 0&&i!=null&&a(n,["expireTime"],i);const o=l(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&a(n,["newSessionExpireTime"],o);const s=l(e,["uses"]);n!==void 0&&s!=null&&a(n,["uses"],s);const u=l(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&a(n,["bidiGenerateContentSetup"],qB(t,u));const c=l(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&a(n,["fieldMask"],c),r}function kB(t,e){const n={},r=l(e,["config"]);return r!=null&&a(n,["config"],DB(t,r,n)),n}function NB(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function VB(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function LB(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function FB(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function UB(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],NB(n)),e}function bB(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],BB(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function BB(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function OB(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],YB(bp(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],xB(at(_)));const w=l(t,["tools"]);if(e!==void 0&&w!=null){let F=Po(w);Array.isArray(F)&&(F=F.map(U=>ZB(Ro(U)))),a(e,["setup","tools"],F)}const R=l(t,["sessionResumption"]);e!==void 0&&R!=null&&a(e,["setup","sessionResumption"],WB(R));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],bv());const S=l(t,["outputAudioTranscription"]);e!==void 0&&S!=null&&a(e,["setup","outputAudioTranscription"],bv());const v=l(t,["realtimeInputConfig"]);e!==void 0&&v!=null&&a(e,["setup","realtimeInputConfig"],KB(v));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],MB(I));const D=l(t,["proactivity"]);return e!==void 0&&D!=null&&a(e,["setup","proactivity"],HB(D)),n}function qB(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],OB(i,n)),n}function GB(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>QB(i))),a(e,["speakerVoiceConfigs"],r)}return e}function $B(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],eO(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],PB(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],VB(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],LB(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function zB(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function HB(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function KB(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],RB(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function WB(t){const e={},n=l(t,["handle"]);if(n!=null&&a(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function JB(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function QB(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],d0(r)),e}function YB(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],d0(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],GB(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function XB(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function ZB(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>FB(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],bB(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],UB(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],jB());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],XB(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function jB(){return{}}function eO(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function d0(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],zB(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tO(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${n}.${o}`);e.push(...i)}else e.push(n)}return e.join(",")}function nO(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const o=tO(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(d=>s.includes(d)?`generationConfig.${d}`:d));const c=[];o&&c.push(o),u.length>0&&c.push(...u),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class rO extends pi{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=kB(this.apiClient,e);o=J("auth_tokens",u._url),s=u._query,delete u.config,delete u._url,delete u._query;const c=nO(u,e.config);return i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>AB(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iO(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function oO(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function sO(t,e){const n={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=l(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&a(e,["displayName"],r),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=l(t,["epochCount"]);e!==void 0&&i!=null&&a(e,["tuningTask","hyperparameters","epochCount"],i);const o=l(t,["learningRateMultiplier"]);if(o!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],o),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const s=l(t,["batchSize"]);e!==void 0&&s!=null&&a(e,["tuningTask","hyperparameters","batchSize"],s);const u=l(t,["learningRate"]);if(e!==void 0&&u!=null&&a(e,["tuningTask","hyperparameters","learningRate"],u),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function lO(t,e){const n={},r=l(t,["validationDataset"]);e!==void 0&&r!=null&&a(e,["supervisedTuningSpec"],SO(r,n));const i=l(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&a(e,["tunedModelDisplayName"],i);const o=l(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const s=l(t,["epochCount"]);e!==void 0&&s!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],s);const u=l(t,["learningRateMultiplier"]);e!==void 0&&u!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const c=l(t,["exportLastCheckpointOnly"]);e!==void 0&&c!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const d=l(t,["adapterSize"]);if(e!==void 0&&d!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=l(t,["labels"]);return e!==void 0&&h!=null&&a(e,["labels"],h),n}function aO(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["preTunedModel"]);r!=null&&a(e,["preTunedModel"],r);const i=l(t,["trainingDataset"]);i!=null&&a(e,["tuningTask","trainingData"],EO(i));const o=l(t,["config"]);return o!=null&&sO(o,e),e}function uO(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["preTunedModel"]);r!=null&&a(e,["preTunedModel"],r);const i=l(t,["trainingDataset"]);i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],IO(i,e));const o=l(t,["config"]);return o!=null&&lO(o,e),e}function cO(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function dO(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function fO(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function hO(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function pO(t){const e={},n=l(t,["config"]);return n!=null&&fO(n,e),e}function mO(t){const e={},n=l(t,["config"]);return n!=null&&hO(n,e),e}function gO(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>f0(s))),a(e,["tuningJobs"],o)}return e}function yO(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>zf(s))),a(e,["tuningJobs"],o)}return e}function _O(t){const e={},n=l(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const r=l(t,["epoch"]);r!=null&&a(e,["epoch"],r);const i=l(t,["step"]);i!=null&&a(e,["step"],i);const o=l(t,["endpoint"]);return o!=null&&a(e,["endpoint"],o),e}function vO(t){const e={},n=l(t,["name"]);n!=null&&a(e,["model"],n);const r=l(t,["name"]);return r!=null&&a(e,["endpoint"],r),e}function TO(t){const e={},n=l(t,["model"]);n!=null&&a(e,["model"],n);const r=l(t,["endpoint"]);r!=null&&a(e,["endpoint"],r);const i=l(t,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>_O(s))),a(e,["checkpoints"],o)}return e}function EO(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=l(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>CO(i))),a(e,["examples","examples"],r)}return e}function IO(t,e){const n={},r=l(t,["gcsUri"]);e!==void 0&&r!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=l(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function CO(t){const e={},n=l(t,["textInput"]);n!=null&&a(e,["textInput"],n);const r=l(t,["output"]);return r!=null&&a(e,["output"],r),e}function f0(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],bw(i));const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["tuningTask","startTime"]);s!=null&&a(e,["startTime"],s);const u=l(t,["tuningTask","completeTime"]);u!=null&&a(e,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["description"]);d!=null&&a(e,["description"],d);const h=l(t,["baseModel"]);h!=null&&a(e,["baseModel"],h);const p=l(t,["_self"]);p!=null&&a(e,["tunedModel"],vO(p));const m=l(t,["customBaseModel"]);m!=null&&a(e,["customBaseModel"],m);const _=l(t,["experiment"]);_!=null&&a(e,["experiment"],_);const w=l(t,["labels"]);w!=null&&a(e,["labels"],w);const R=l(t,["outputUri"]);R!=null&&a(e,["outputUri"],R);const k=l(t,["pipelineJob"]);k!=null&&a(e,["pipelineJob"],k);const S=l(t,["serviceAccount"]);S!=null&&a(e,["serviceAccount"],S);const v=l(t,["tunedModelDisplayName"]);return v!=null&&a(e,["tunedModelDisplayName"],v),e}function zf(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],bw(i));const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["startTime"]);s!=null&&a(e,["startTime"],s);const u=l(t,["endTime"]);u!=null&&a(e,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["error"]);d!=null&&a(e,["error"],d);const h=l(t,["description"]);h!=null&&a(e,["description"],h);const p=l(t,["baseModel"]);p!=null&&a(e,["baseModel"],p);const m=l(t,["tunedModel"]);m!=null&&a(e,["tunedModel"],TO(m));const _=l(t,["preTunedModel"]);_!=null&&a(e,["preTunedModel"],_);const w=l(t,["supervisedTuningSpec"]);w!=null&&a(e,["supervisedTuningSpec"],w);const R=l(t,["tuningDataStats"]);R!=null&&a(e,["tuningDataStats"],R);const k=l(t,["encryptionSpec"]);k!=null&&a(e,["encryptionSpec"],k);const S=l(t,["partnerModelTuningSpec"]);S!=null&&a(e,["partnerModelTuningSpec"],S);const v=l(t,["customBaseModel"]);v!=null&&a(e,["customBaseModel"],v);const I=l(t,["experiment"]);I!=null&&a(e,["experiment"],I);const D=l(t,["labels"]);D!=null&&a(e,["labels"],D);const F=l(t,["outputUri"]);F!=null&&a(e,["outputUri"],F);const U=l(t,["pipelineJob"]);U!=null&&a(e,["pipelineJob"],U);const C=l(t,["serviceAccount"]);C!=null&&a(e,["serviceAccount"],C);const E=l(t,["tunedModelDisplayName"]);return E!=null&&a(e,["tunedModelDisplayName"],E),e}function wO(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=l(t,["done"]);o!=null&&a(e,["done"],o);const s=l(t,["error"]);return s!=null&&a(e,["error"],s),e}function SO(t,e){const n={},r=l(t,["gcsUri"]);r!=null&&a(n,["validationDatasetUri"],r);const i=l(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class AO extends pi{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new _l(si.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),o=await this.tuneMldevInternal(i);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:Lf.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=dO(e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>zf(h))}else{const d=cO(e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>f0(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=mO(e);return u=J("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=yO(h),m=new pv;return Object.assign(m,p),m})}else{const d=pO(e);return u=J("tunedModels",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=gO(h),m=new pv;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,o;let s="",u={};if(this.apiClient.isVertexAI()){const c=oO(e);s=J("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=iO(e);s=J("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=uO(e);return o=J("tuningJobs",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>zf(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=aO(e);return o=J("tunedModels",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>wO(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RO{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const PO=1024*1024*8,xO=3,MO=1e3,DO=2,fd="x-goog-upload-status";async function kO(t,e,n){var r,i,o;let s=0,u=0,c=new Ff(new Response),d="upload";for(s=t.size;u<s;){const p=Math.min(PO,s-u),m=t.slice(u,u+p);u+p>=s&&(d+=", finalize");let _=0,w=MO;for(;_<xO&&(c=await n.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[fd]));)_++,await VO(w),w=w*DO;if(u+=p,((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[fd])!=="active")break;if(s<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(c==null?void 0:c.json());if(((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[fd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function NO(t){return{size:t.size,type:t.type}}function VO(t){return new Promise(e=>setTimeout(e,t))}class LO{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await kO(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await NO(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FO{create(e,n,r){return new UO(e,n,r)}}class UO{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Bv="x-goog-api-key";class bO{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(Bv)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(Bv,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const BO="gl-node/";class OO{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=QN(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new bO(this.apiKey);this.apiClient=new iB({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:BO+"web",uploader:new LO,downloader:new RO}),this.models=new wB(this.apiClient),this.live=new yB(this.apiClient,i,new FO),this.batches=new OV(this.apiClient),this.chats=new JL(this.models,this.apiClient),this.caches=new HL(this.apiClient),this.files=new lF(this.apiClient),this.operations=new SB(this.apiClient),this.authTokens=new rO(this.apiClient),this.tunings=new AO(this.apiClient)}}var qO={};const GO=t=>new Promise((e,n)=>{const r=new FileReader;r.onloadend=()=>{const i=r.result.split(",")[1];e(i)},r.onerror=i=>{n(i)},r.readAsDataURL(t)}),$O=({onClose:t,onUploadSuccess:e})=>{const[n,r]=Te.useState(null),[i,o]=Te.useState(null),[s,u]=Te.useState(""),[c,d]=Te.useState([]),[h,p]=Te.useState(!1),[m,_]=Te.useState(!1),[w,R]=Te.useState(null),k=I=>{var F;const D=(F=I.target.files)==null?void 0:F[0];if(D){r(D);const U=new FileReader;U.onloadend=()=>{o(U.result)},U.readAsDataURL(D)}},S=async()=>{if(!n){R("Please select a photo first.");return}_(!0),R(null);try{const I=new OO({apiKey:qO.API_KEY}),D=await GO(n),F={inlineData:{mimeType:n.type,data:D}},U=await I.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[F,{text:"Suggest a short, romantic or cute caption for this photo, and 3-5 relevant tags."}]},config:{responseMimeType:"application/json",responseSchema:{type:Ht.OBJECT,properties:{caption:{type:Ht.STRING},tags:{type:Ht.ARRAY,items:{type:Ht.STRING}}}}}}),C=JSON.parse(U.text);C.caption&&u(C.caption),C.tags&&d(C.tags)}catch(I){console.error("AI suggestion failed:",I),R("Could not generate a suggestion. Please try again.")}finally{_(!1)}},v=Te.useCallback(async()=>{if(!n){R("Please choose a photo to share.");return}p(!0),R(null);try{await $N(n,s,c),e(),t()}catch(I){console.error(I),R("Upload failed. Please try again.")}finally{p(!1)}},[n,s,c,t,e]);return O.jsx("div",{className:"fixed inset-0 bg-primary-text/20 flex justify-center items-center z-50 p-4",onClick:t,children:O.jsxs("div",{className:"bg-white/50 backdrop-blur-xl rounded-xl shadow-gentle-lg w-full max-w-md text-primary-text p-6 sm:p-8 border border-white/30",onClick:I=>I.stopPropagation(),children:[O.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Add a New Memory"}),O.jsxs("div",{className:"space-y-6",children:[O.jsx("div",{children:O.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-accent-soft/80 border-dashed rounded-md bg-white/20",children:O.jsxs("div",{className:"space-y-1 text-center",children:[i?O.jsx("img",{src:i,alt:"Preview",className:"mx-auto h-32 w-auto rounded-md object-contain"}):O.jsx("svg",{className:"mx-auto h-12 w-12 text-accent-soft",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})}),O.jsx("div",{className:"flex text-sm text-secondary-text justify-center",children:O.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-accent hover:text-accent-hover focus-within:outline-none",children:[O.jsx("span",{children:"Choose a photo"}),O.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:k})]})}),O.jsx("p",{className:"text-xs text-secondary-text/70",children:"PNG, JPG, GIF"})]})})}),O.jsxs("div",{children:[O.jsxs("div",{className:"flex justify-between items-center mb-1",children:[O.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-primary-text",children:"Description"}),O.jsx("button",{onClick:S,disabled:m||!n,className:"text-xs text-accent hover:text-accent-hover disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-1",children:m?O.jsxs(O.Fragment,{children:[O.jsxs("svg",{className:"animate-spin h-3 w-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[O.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),O.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Thinking..."]}):O.jsxs(O.Fragment,{children:[O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),"Suggest Caption"]})})]}),O.jsx("textarea",{id:"description",rows:3,value:s,onChange:I=>u(I.target.value),className:"mt-1 block w-full bg-white/60 border border-accent-soft/60 rounded-md shadow-inner shadow-accent-soft/20 focus:ring-accent focus:border-accent sm:text-sm p-2 text-primary-text placeholder-secondary-text",placeholder:"What is this memory about?"})]}),w&&O.jsx("p",{className:"text-sm text-red-600",children:w})]}),O.jsxs("div",{className:"mt-8 flex justify-end items-center space-x-4",children:[O.jsx("button",{type:"button",onClick:t,disabled:h,className:"px-4 py-2 text-sm font-medium text-secondary-text rounded-md hover:bg-accent-soft/30 disabled:opacity-50 transition-colors",children:"Cancel"}),O.jsx("button",{type:"button",onClick:v,disabled:h||!n,className:"px-6 py-2 text-sm font-bold text-white bg-accent rounded-md hover:bg-accent-hover disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center min-w-[96px] h-9 shadow-lg shadow-accent/30",children:h?O.jsx(ZE,{}):"Share"})]})]})})},zO=({photo:t,onClose:e})=>{const n=r=>{if(!r||!r.toDate)return"Just now";const i=r.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}).format(i)};return O.jsx("div",{className:"fixed inset-0 bg-primary-bg/80 backdrop-blur-lg flex justify-center items-center z-50 p-4 animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:e,children:O.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full flex flex-col items-center",onClick:r=>r.stopPropagation(),children:[O.jsx("button",{onClick:e,"aria-label":"Close lightbox",className:"absolute -top-10 -right-2 sm:top-0 sm:-right-12 p-2 bg-white/50 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-all duration-200 z-10",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),O.jsx("div",{className:"bg-white rounded-xl shadow-gentle-lg p-3",children:O.jsx("img",{src:t.imageUrl,alt:t.description||"Photo diary entry",className:"max-w-full max-h-[70vh] object-contain rounded-lg"})}),O.jsxs("div",{className:"text-center mt-4 w-full max-w-2xl px-4",children:[O.jsx("p",{className:"text-lg font-medium text-primary-text",children:t.description}),O.jsx("p",{className:"text-sm text-secondary-text mt-1",children:n(t.createdAt)})]})]})})},HO=()=>{const[t,e]=Te.useState([]),[n,r]=Te.useState(!0),[i,o]=Te.useState(null),s=Te.useCallback(async()=>{try{r(!0),o(null);const h=await GN();e(h)}catch(h){console.error("Detailed error fetching photos:",h),o("Failed to load photos. This could be due to network issues or incorrect Firebase permissions. Check the console for more details.")}finally{r(!1)}},[]);Te.useEffect(()=>{s()},[]);const u=Te.useCallback((h,p)=>{e(m=>m.map(_=>_.id===h?{..._,...p}:_))},[]),c=Te.useCallback(async h=>{const p=!h.isFavorite;u(h.id,{isFavorite:p});try{await zN(h.id,p)}catch(m){console.error("Error updating favorite status:",m),u(h.id,{isFavorite:h.isFavorite}),alert("Failed to update favorite status. Please try again.")}},[u]),d=Te.useCallback(async h=>{try{await HN(h),e(p=>p.filter(m=>m.id!==h.id))}catch(p){console.error("Error deleting photo:",p),alert("Failed to delete photo. Please check your Firebase rules and try again.")}},[]);return{photos:t,loading:n,error:i,refetchPhotos:s,removePhoto:d,toggleFavorite:c}},KO=t=>{if(!t||!t.toDate)return"";const e=t.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e)},WO=()=>{const[t,e]=Te.useState(!1),{photos:n,loading:r,error:i,refetchPhotos:o,removePhoto:s,toggleFavorite:u}=HO(),[c,d]=Te.useState(""),[h,p]=Te.useState(null),[m,_]=Te.useState(!1),w=Te.useCallback(()=>{o()},[o]),R=Te.useMemo(()=>{let k=n;if(m&&(k=k.filter(v=>v.isFavorite)),!c.trim())return k;const S=c.toLowerCase();return k.filter(v=>{var U;const I=v.description.toLowerCase().includes(S),D=KO(v.createdAt).toLowerCase().includes(S),F=(U=v.tags)==null?void 0:U.some(C=>C.toLowerCase().includes(S));return I||D||F})},[n,c,m]);return O.jsxs("div",{className:"min-h-screen",children:[O.jsx(vR,{onAddPhotoClick:()=>e(!0),searchTerm:c,onSearchChange:d,isGridEmpty:n.length===0&&!r,onToggleFavorites:()=>_(!m),showFavorites:m}),O.jsx("main",{className:"container mx-auto p-4 md:p-8",children:O.jsx(ER,{photos:R,loading:r,error:i,onDeletePhoto:s,onFavoritePhoto:u,onPhotoClick:p})}),t&&O.jsx($O,{onClose:()=>e(!1),onUploadSuccess:w}),h&&O.jsx(zO,{photo:h,onClose:()=>p(null)})]})},h0=document.getElementById("root");if(!h0)throw new Error("Could not find root element to mount to");const JO=hd.createRoot(h0);JO.render(O.jsx(lS.StrictMode,{children:O.jsx(WO,{})}));
