(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function HS(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qv={exports:{}},Eu={},Gv={exports:{}},re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ol=Symbol.for("react.element"),KS=Symbol.for("react.portal"),WS=Symbol.for("react.fragment"),JS=Symbol.for("react.strict_mode"),QS=Symbol.for("react.profiler"),YS=Symbol.for("react.provider"),XS=Symbol.for("react.context"),ZS=Symbol.for("react.forward_ref"),jS=Symbol.for("react.suspense"),e0=Symbol.for("react.memo"),t0=Symbol.for("react.lazy"),qm=Symbol.iterator;function n0(t){return t===null||typeof t!="object"?null:(t=qm&&t[qm]||t["@@iterator"],typeof t=="function"?t:null)}var $v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},zv=Object.assign,Hv={};function vo(t,e,n){this.props=t,this.context=e,this.refs=Hv,this.updater=n||$v}vo.prototype.isReactComponent={};vo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Kv(){}Kv.prototype=vo.prototype;function Kf(t,e,n){this.props=t,this.context=e,this.refs=Hv,this.updater=n||$v}var Wf=Kf.prototype=new Kv;Wf.constructor=Kf;zv(Wf,vo.prototype);Wf.isPureReactComponent=!0;var Gm=Array.isArray,Wv=Object.prototype.hasOwnProperty,Jf={current:null},Jv={key:!0,ref:!0,__self:!0,__source:!0};function Qv(t,e,n){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)Wv.call(e,r)&&!Jv.hasOwnProperty(r)&&(i[r]=e[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var c=Array(u),d=0;d<u;d++)c[d]=arguments[d+2];i.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:ol,type:t,key:o,ref:s,props:i,_owner:Jf.current}}function r0(t,e){return{$$typeof:ol,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qf(t){return typeof t=="object"&&t!==null&&t.$$typeof===ol}function i0(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $m=/\/+/g;function Pc(t,e){return typeof t=="object"&&t!==null&&t.key!=null?i0(""+t.key):e.toString(36)}function da(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var s=!1;if(t===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(t.$$typeof){case ol:case KS:s=!0}}if(s)return s=t,i=i(s),t=r===""?"."+Pc(s,0):r,Gm(i)?(n="",t!=null&&(n=t.replace($m,"$&/")+"/"),da(i,e,n,"",function(d){return d})):i!=null&&(Qf(i)&&(i=r0(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace($m,"$&/")+"/")+t)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Gm(t))for(var u=0;u<t.length;u++){o=t[u];var c=r+Pc(o,u);s+=da(o,e,n,c,i)}else if(c=n0(t),typeof c=="function")for(t=c.call(t),u=0;!(o=t.next()).done;)o=o.value,c=r+Pc(o,u++),s+=da(o,e,n,c,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Ul(t,e,n){if(t==null)return t;var r=[],i=0;return da(t,r,"","",function(o){return e.call(n,o,i++)}),r}function o0(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Tt={current:null},fa={transition:null},s0={ReactCurrentDispatcher:Tt,ReactCurrentBatchConfig:fa,ReactCurrentOwner:Jf};function Yv(){throw Error("act(...) is not supported in production builds of React.")}re.Children={map:Ul,forEach:function(t,e,n){Ul(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ul(t,function(){e++}),e},toArray:function(t){return Ul(t,function(e){return e})||[]},only:function(t){if(!Qf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};re.Component=vo;re.Fragment=WS;re.Profiler=QS;re.PureComponent=Kf;re.StrictMode=JS;re.Suspense=jS;re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=s0;re.act=Yv;re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=zv({},t.props),i=t.key,o=t.ref,s=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=Jf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)Wv.call(e,c)&&!Jv.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var d=0;d<c;d++)u[d]=arguments[d+2];r.children=u}return{$$typeof:ol,type:t.type,key:i,ref:o,props:r,_owner:s}};re.createContext=function(t){return t={$$typeof:XS,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:YS,_context:t},t.Consumer=t};re.createElement=Qv;re.createFactory=function(t){var e=Qv.bind(null,t);return e.type=t,e};re.createRef=function(){return{current:null}};re.forwardRef=function(t){return{$$typeof:ZS,render:t}};re.isValidElement=Qf;re.lazy=function(t){return{$$typeof:t0,_payload:{_status:-1,_result:t},_init:o0}};re.memo=function(t,e){return{$$typeof:e0,type:t,compare:e===void 0?null:e}};re.startTransition=function(t){var e=fa.transition;fa.transition={};try{t()}finally{fa.transition=e}};re.unstable_act=Yv;re.useCallback=function(t,e){return Tt.current.useCallback(t,e)};re.useContext=function(t){return Tt.current.useContext(t)};re.useDebugValue=function(){};re.useDeferredValue=function(t){return Tt.current.useDeferredValue(t)};re.useEffect=function(t,e){return Tt.current.useEffect(t,e)};re.useId=function(){return Tt.current.useId()};re.useImperativeHandle=function(t,e,n){return Tt.current.useImperativeHandle(t,e,n)};re.useInsertionEffect=function(t,e){return Tt.current.useInsertionEffect(t,e)};re.useLayoutEffect=function(t,e){return Tt.current.useLayoutEffect(t,e)};re.useMemo=function(t,e){return Tt.current.useMemo(t,e)};re.useReducer=function(t,e,n){return Tt.current.useReducer(t,e,n)};re.useRef=function(t){return Tt.current.useRef(t)};re.useState=function(t){return Tt.current.useState(t)};re.useSyncExternalStore=function(t,e,n){return Tt.current.useSyncExternalStore(t,e,n)};re.useTransition=function(){return Tt.current.useTransition()};re.version="18.3.1";Gv.exports=re;var ge=Gv.exports;const l0=HS(ge);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a0=ge,u0=Symbol.for("react.element"),c0=Symbol.for("react.fragment"),d0=Object.prototype.hasOwnProperty,f0=a0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h0={key:!0,ref:!0,__self:!0,__source:!0};function Xv(t,e,n){var r,i={},o=null,s=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)d0.call(e,r)&&!h0.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:u0,type:t,key:o,ref:s,props:i,_owner:f0.current}}Eu.Fragment=c0;Eu.jsx=Xv;Eu.jsxs=Xv;qv.exports=Eu;var O=qv.exports,hd={},Zv={exports:{}},Bt={},jv={exports:{}},eT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,Z){var te=K.length;K.push(Z);e:for(;0<te;){var Ae=te-1>>>1,pe=K[Ae];if(0<i(pe,Z))K[Ae]=Z,K[te]=pe,te=Ae;else break e}}function n(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var Z=K[0],te=K.pop();if(te!==Z){K[0]=te;e:for(var Ae=0,pe=K.length,Ue=pe>>>1;Ae<Ue;){var yn=2*(Ae+1)-1,_n=K[yn],vn=yn+1,Tn=K[vn];if(0>i(_n,te))vn<pe&&0>i(Tn,_n)?(K[Ae]=Tn,K[vn]=te,Ae=vn):(K[Ae]=_n,K[yn]=te,Ae=yn);else if(vn<pe&&0>i(Tn,te))K[Ae]=Tn,K[vn]=te,Ae=vn;else break e}}return Z}function i(K,Z){var te=K.sortIndex-Z.sortIndex;return te!==0?te:K.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],d=[],h=1,p=null,m=3,_=!1,S=!1,P=!1,k=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function I(K){for(var Z=n(d);Z!==null;){if(Z.callback===null)r(d);else if(Z.startTime<=K)r(d),Z.sortIndex=Z.expirationTime,e(c,Z);else break;Z=n(d)}}function M(K){if(P=!1,I(K),!S)if(n(c)!==null)S=!0,mn(F);else{var Z=n(d);Z!==null&&gn(M,Z.startTime-K)}}function F(K,Z){S=!1,P&&(P=!1,C(v),v=-1),_=!0;var te=m;try{for(I(Z),p=n(c);p!==null&&(!(p.expirationTime>Z)||K&&!D());){var Ae=p.callback;if(typeof Ae=="function"){p.callback=null,m=p.priorityLevel;var pe=Ae(p.expirationTime<=Z);Z=t.unstable_now(),typeof pe=="function"?p.callback=pe:p===n(c)&&r(c),I(Z)}else r(c);p=n(c)}if(p!==null)var Ue=!0;else{var yn=n(d);yn!==null&&gn(M,yn.startTime-Z),Ue=!1}return Ue}finally{p=null,m=te,_=!1}}var b=!1,A=null,v=-1,w=5,R=-1;function D(){return!(t.unstable_now()-R<w)}function N(){if(A!==null){var K=t.unstable_now();R=K;var Z=!0;try{Z=A(!0,K)}finally{Z?x():(b=!1,A=null)}}else b=!1}var x;if(typeof T=="function")x=function(){T(N)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,Je=Se.port2;Se.port1.onmessage=N,x=function(){Je.postMessage(null)}}else x=function(){k(N,0)};function mn(K){A=K,b||(b=!0,x())}function gn(K,Z){v=k(function(){K(t.unstable_now())},Z)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){S||_||(S=!0,mn(F))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var Z=3;break;default:Z=m}var te=m;m=Z;try{return K()}finally{m=te}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,Z){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var te=m;m=K;try{return Z()}finally{m=te}},t.unstable_scheduleCallback=function(K,Z,te){var Ae=t.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Ae+te:Ae):te=Ae,K){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=te+pe,K={id:h++,callback:Z,priorityLevel:K,startTime:te,expirationTime:pe,sortIndex:-1},te>Ae?(K.sortIndex=te,e(d,K),n(c)===null&&K===n(d)&&(P?(C(v),v=-1):P=!0,gn(M,te-Ae))):(K.sortIndex=pe,e(c,K),S||_||(S=!0,mn(F))),K},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(K){var Z=m;return function(){var te=m;m=Z;try{return K.apply(this,arguments)}finally{m=te}}}})(eT);jv.exports=eT;var p0=jv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var m0=ge,Ut=p0;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tT=new Set,xs={};function li(t,e){eo(t,e),eo(t+"Capture",e)}function eo(t,e){for(xs[t]=e,t=0;t<e.length;t++)tT.add(e[t])}var Dn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pd=Object.prototype.hasOwnProperty,g0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zm={},Hm={};function y0(t){return pd.call(Hm,t)?!0:pd.call(zm,t)?!1:g0.test(t)?Hm[t]=!0:(zm[t]=!0,!1)}function _0(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function v0(t,e,n,r){if(e===null||typeof e>"u"||_0(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Et(t,e,n,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var et={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){et[t]=new Et(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];et[e]=new Et(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){et[t]=new Et(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){et[t]=new Et(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){et[t]=new Et(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){et[t]=new Et(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){et[t]=new Et(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){et[t]=new Et(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){et[t]=new Et(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yf=/[\-:]([a-z])/g;function Xf(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Yf,Xf);et[e]=new Et(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Yf,Xf);et[e]=new Et(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Yf,Xf);et[e]=new Et(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){et[t]=new Et(t,1,!1,t.toLowerCase(),null,!1,!1)});et.xlinkHref=new Et("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){et[t]=new Et(t,1,!1,t.toLowerCase(),null,!0,!0)});function Zf(t,e,n,r){var i=et.hasOwnProperty(e)?et[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(v0(e,n,i,r)&&(n=null),r||i===null?y0(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Fn=m0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bl=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),ki=Symbol.for("react.fragment"),jf=Symbol.for("react.strict_mode"),md=Symbol.for("react.profiler"),nT=Symbol.for("react.provider"),rT=Symbol.for("react.context"),eh=Symbol.for("react.forward_ref"),gd=Symbol.for("react.suspense"),yd=Symbol.for("react.suspense_list"),th=Symbol.for("react.memo"),Hn=Symbol.for("react.lazy"),iT=Symbol.for("react.offscreen"),Km=Symbol.iterator;function zo(t){return t===null||typeof t!="object"?null:(t=Km&&t[Km]||t["@@iterator"],typeof t=="function"?t:null)}var Me=Object.assign,xc;function os(t){if(xc===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);xc=e&&e[1]||""}return`
`+xc+t}var Dc=!1;function Mc(t,e){if(!t||Dc)return"";Dc=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,u=o.length-1;1<=s&&0<=u&&i[s]!==o[u];)u--;for(;1<=s&&0<=u;s--,u--)if(i[s]!==o[u]){if(s!==1||u!==1)do if(s--,u--,0>u||i[s]!==o[u]){var c=`
`+i[s].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=s&&0<=u);break}}}finally{Dc=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?os(t):""}function T0(t){switch(t.tag){case 5:return os(t.type);case 16:return os("Lazy");case 13:return os("Suspense");case 19:return os("SuspenseList");case 0:case 2:case 15:return t=Mc(t.type,!1),t;case 11:return t=Mc(t.type.render,!1),t;case 1:return t=Mc(t.type,!0),t;default:return""}}function _d(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ki:return"Fragment";case Mi:return"Portal";case md:return"Profiler";case jf:return"StrictMode";case gd:return"Suspense";case yd:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case rT:return(t.displayName||"Context")+".Consumer";case nT:return(t._context.displayName||"Context")+".Provider";case eh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case th:return e=t.displayName||null,e!==null?e:_d(t.type)||"Memo";case Hn:e=t._payload,t=t._init;try{return _d(t(e))}catch{}}return null}function E0(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return _d(e);case 8:return e===jf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function pr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function I0(t){var e=oT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Bl(t){t._valueTracker||(t._valueTracker=I0(t))}function sT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=oT(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Va(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function vd(t,e){var n=e.checked;return Me({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Wm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=pr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function lT(t,e){e=e.checked,e!=null&&Zf(t,"checked",e,!1)}function Td(t,e){lT(t,e);var n=pr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ed(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ed(t,e.type,pr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Jm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ed(t,e,n){(e!=="number"||Va(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ss=Array.isArray;function zi(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+pr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Id(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return Me({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Qm(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(ss(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:pr(n)}}function aT(t,e){var n=pr(e.value),r=pr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Ym(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function uT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Cd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?uT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ol,cT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ol=Ol||document.createElement("div"),Ol.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ol.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ds(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var hs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},C0=["Webkit","ms","Moz","O"];Object.keys(hs).forEach(function(t){C0.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),hs[e]=hs[t]})});function dT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||hs.hasOwnProperty(t)&&hs[t]?(""+e).trim():e+"px"}function fT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=dT(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var w0=Me({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function wd(t,e){if(e){if(w0[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function Sd(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ad=null;function nh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Rd=null,Hi=null,Ki=null;function Xm(t){if(t=al(t)){if(typeof Rd!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Au(e),Rd(t.stateNode,t.type,e))}}function hT(t){Hi?Ki?Ki.push(t):Ki=[t]:Hi=t}function pT(){if(Hi){var t=Hi,e=Ki;if(Ki=Hi=null,Xm(t),e)for(t=0;t<e.length;t++)Xm(e[t])}}function mT(t,e){return t(e)}function gT(){}var kc=!1;function yT(t,e,n){if(kc)return t(e,n);kc=!0;try{return mT(t,e,n)}finally{kc=!1,(Hi!==null||Ki!==null)&&(gT(),pT())}}function Ms(t,e){var n=t.stateNode;if(n===null)return null;var r=Au(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var Pd=!1;if(Dn)try{var Ho={};Object.defineProperty(Ho,"passive",{get:function(){Pd=!0}}),window.addEventListener("test",Ho,Ho),window.removeEventListener("test",Ho,Ho)}catch{Pd=!1}function S0(t,e,n,r,i,o,s,u,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ps=!1,La=null,Fa=!1,xd=null,A0={onError:function(t){ps=!0,La=t}};function R0(t,e,n,r,i,o,s,u,c){ps=!1,La=null,S0.apply(A0,arguments)}function P0(t,e,n,r,i,o,s,u,c){if(R0.apply(this,arguments),ps){if(ps){var d=La;ps=!1,La=null}else throw Error(G(198));Fa||(Fa=!0,xd=d)}}function ai(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function _T(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zm(t){if(ai(t)!==t)throw Error(G(188))}function x0(t){var e=t.alternate;if(!e){if(e=ai(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return Zm(i),t;if(o===r)return Zm(i),e;o=o.sibling}throw Error(G(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function vT(t){return t=x0(t),t!==null?TT(t):null}function TT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=TT(t);if(e!==null)return e;t=t.sibling}return null}var ET=Ut.unstable_scheduleCallback,jm=Ut.unstable_cancelCallback,D0=Ut.unstable_shouldYield,M0=Ut.unstable_requestPaint,be=Ut.unstable_now,k0=Ut.unstable_getCurrentPriorityLevel,rh=Ut.unstable_ImmediatePriority,IT=Ut.unstable_UserBlockingPriority,Ua=Ut.unstable_NormalPriority,N0=Ut.unstable_LowPriority,CT=Ut.unstable_IdlePriority,Iu=null,fn=null;function V0(t){if(fn&&typeof fn.onCommitFiberRoot=="function")try{fn.onCommitFiberRoot(Iu,t,void 0,(t.current.flags&128)===128)}catch{}}var tn=Math.clz32?Math.clz32:U0,L0=Math.log,F0=Math.LN2;function U0(t){return t>>>=0,t===0?32:31-(L0(t)/F0|0)|0}var ql=64,Gl=4194304;function ls(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ba(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,s=n&268435455;if(s!==0){var u=s&~i;u!==0?r=ls(u):(o&=s,o!==0&&(r=ls(o)))}else s=n&~i,s!==0?r=ls(s):o!==0&&(r=ls(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-tn(e),i=1<<n,r|=t[n],e&=~i;return r}function b0(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function B0(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-tn(o),u=1<<s,c=i[s];c===-1?(!(u&n)||u&r)&&(i[s]=b0(u,e)):c<=e&&(t.expiredLanes|=u),o&=~u}}function Dd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function wT(){var t=ql;return ql<<=1,!(ql&4194240)&&(ql=64),t}function Nc(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function sl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-tn(e),t[e]=n}function O0(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-tn(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function ih(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-tn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var fe=0;function ST(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var AT,oh,RT,PT,xT,Md=!1,$l=[],tr=null,nr=null,rr=null,ks=new Map,Ns=new Map,Wn=[],q0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function eg(t,e){switch(t){case"focusin":case"focusout":tr=null;break;case"dragenter":case"dragleave":nr=null;break;case"mouseover":case"mouseout":rr=null;break;case"pointerover":case"pointerout":ks.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ns.delete(e.pointerId)}}function Ko(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=al(e),e!==null&&oh(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function G0(t,e,n,r,i){switch(e){case"focusin":return tr=Ko(tr,t,e,n,r,i),!0;case"dragenter":return nr=Ko(nr,t,e,n,r,i),!0;case"mouseover":return rr=Ko(rr,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return ks.set(o,Ko(ks.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ns.set(o,Ko(Ns.get(o)||null,t,e,n,r,i)),!0}return!1}function DT(t){var e=br(t.target);if(e!==null){var n=ai(e);if(n!==null){if(e=n.tag,e===13){if(e=_T(n),e!==null){t.blockedOn=e,xT(t.priority,function(){RT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ha(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=kd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ad=r,n.target.dispatchEvent(r),Ad=null}else return e=al(n),e!==null&&oh(e),t.blockedOn=n,!1;e.shift()}return!0}function tg(t,e,n){ha(t)&&n.delete(e)}function $0(){Md=!1,tr!==null&&ha(tr)&&(tr=null),nr!==null&&ha(nr)&&(nr=null),rr!==null&&ha(rr)&&(rr=null),ks.forEach(tg),Ns.forEach(tg)}function Wo(t,e){t.blockedOn===e&&(t.blockedOn=null,Md||(Md=!0,Ut.unstable_scheduleCallback(Ut.unstable_NormalPriority,$0)))}function Vs(t){function e(i){return Wo(i,t)}if(0<$l.length){Wo($l[0],t);for(var n=1;n<$l.length;n++){var r=$l[n];r.blockedOn===t&&(r.blockedOn=null)}}for(tr!==null&&Wo(tr,t),nr!==null&&Wo(nr,t),rr!==null&&Wo(rr,t),ks.forEach(e),Ns.forEach(e),n=0;n<Wn.length;n++)r=Wn[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Wn.length&&(n=Wn[0],n.blockedOn===null);)DT(n),n.blockedOn===null&&Wn.shift()}var Wi=Fn.ReactCurrentBatchConfig,Ba=!0;function z0(t,e,n,r){var i=fe,o=Wi.transition;Wi.transition=null;try{fe=1,sh(t,e,n,r)}finally{fe=i,Wi.transition=o}}function H0(t,e,n,r){var i=fe,o=Wi.transition;Wi.transition=null;try{fe=4,sh(t,e,n,r)}finally{fe=i,Wi.transition=o}}function sh(t,e,n,r){if(Ba){var i=kd(t,e,n,r);if(i===null)$c(t,e,r,Oa,n),eg(t,r);else if(G0(i,t,e,n,r))r.stopPropagation();else if(eg(t,r),e&4&&-1<q0.indexOf(t)){for(;i!==null;){var o=al(i);if(o!==null&&AT(o),o=kd(t,e,n,r),o===null&&$c(t,e,r,Oa,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else $c(t,e,r,null,n)}}var Oa=null;function kd(t,e,n,r){if(Oa=null,t=nh(r),t=br(t),t!==null)if(e=ai(t),e===null)t=null;else if(n=e.tag,n===13){if(t=_T(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Oa=t,null}function MT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(k0()){case rh:return 1;case IT:return 4;case Ua:case N0:return 16;case CT:return 536870912;default:return 16}default:return 16}}var Xn=null,lh=null,pa=null;function kT(){if(pa)return pa;var t,e=lh,n=e.length,r,i="value"in Xn?Xn.value:Xn.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var s=n-t;for(r=1;r<=s&&e[n-r]===i[o-r];r++);return pa=i.slice(t,1<r?1-r:void 0)}function ma(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function zl(){return!0}function ng(){return!1}function Ot(t){function e(n,r,i,o,s){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(n=t[u],this[u]=n?n(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?zl:ng,this.isPropagationStopped=ng,this}return Me(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=zl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=zl)},persist:function(){},isPersistent:zl}),e}var To={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ah=Ot(To),ll=Me({},To,{view:0,detail:0}),K0=Ot(ll),Vc,Lc,Jo,Cu=Me({},ll,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jo&&(Jo&&t.type==="mousemove"?(Vc=t.screenX-Jo.screenX,Lc=t.screenY-Jo.screenY):Lc=Vc=0,Jo=t),Vc)},movementY:function(t){return"movementY"in t?t.movementY:Lc}}),rg=Ot(Cu),W0=Me({},Cu,{dataTransfer:0}),J0=Ot(W0),Q0=Me({},ll,{relatedTarget:0}),Fc=Ot(Q0),Y0=Me({},To,{animationName:0,elapsedTime:0,pseudoElement:0}),X0=Ot(Y0),Z0=Me({},To,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),j0=Ot(Z0),eA=Me({},To,{data:0}),ig=Ot(eA),tA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},rA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function iA(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=rA[t])?!!e[t]:!1}function uh(){return iA}var oA=Me({},ll,{key:function(t){if(t.key){var e=tA[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ma(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?nA[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uh,charCode:function(t){return t.type==="keypress"?ma(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ma(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sA=Ot(oA),lA=Me({},Cu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),og=Ot(lA),aA=Me({},ll,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uh}),uA=Ot(aA),cA=Me({},To,{propertyName:0,elapsedTime:0,pseudoElement:0}),dA=Ot(cA),fA=Me({},Cu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hA=Ot(fA),pA=[9,13,27,32],ch=Dn&&"CompositionEvent"in window,ms=null;Dn&&"documentMode"in document&&(ms=document.documentMode);var mA=Dn&&"TextEvent"in window&&!ms,NT=Dn&&(!ch||ms&&8<ms&&11>=ms),sg=" ",lg=!1;function VT(t,e){switch(t){case"keyup":return pA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ni=!1;function gA(t,e){switch(t){case"compositionend":return LT(e);case"keypress":return e.which!==32?null:(lg=!0,sg);case"textInput":return t=e.data,t===sg&&lg?null:t;default:return null}}function yA(t,e){if(Ni)return t==="compositionend"||!ch&&VT(t,e)?(t=kT(),pa=lh=Xn=null,Ni=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return NT&&e.locale!=="ko"?null:e.data;default:return null}}var _A={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ag(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!_A[t.type]:e==="textarea"}function FT(t,e,n,r){hT(r),e=qa(e,"onChange"),0<e.length&&(n=new ah("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var gs=null,Ls=null;function vA(t){WT(t,0)}function wu(t){var e=Fi(t);if(sT(e))return t}function TA(t,e){if(t==="change")return e}var UT=!1;if(Dn){var Uc;if(Dn){var bc="oninput"in document;if(!bc){var ug=document.createElement("div");ug.setAttribute("oninput","return;"),bc=typeof ug.oninput=="function"}Uc=bc}else Uc=!1;UT=Uc&&(!document.documentMode||9<document.documentMode)}function cg(){gs&&(gs.detachEvent("onpropertychange",bT),Ls=gs=null)}function bT(t){if(t.propertyName==="value"&&wu(Ls)){var e=[];FT(e,Ls,t,nh(t)),yT(vA,e)}}function EA(t,e,n){t==="focusin"?(cg(),gs=e,Ls=n,gs.attachEvent("onpropertychange",bT)):t==="focusout"&&cg()}function IA(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wu(Ls)}function CA(t,e){if(t==="click")return wu(e)}function wA(t,e){if(t==="input"||t==="change")return wu(e)}function SA(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var rn=typeof Object.is=="function"?Object.is:SA;function Fs(t,e){if(rn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!pd.call(e,i)||!rn(t[i],e[i]))return!1}return!0}function dg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fg(t,e){var n=dg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dg(n)}}function BT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?BT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function OT(){for(var t=window,e=Va();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Va(t.document)}return e}function dh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function AA(t){var e=OT(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&BT(n.ownerDocument.documentElement,n)){if(r!==null&&dh(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=fg(n,o);var s=fg(n,r);i&&s&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var RA=Dn&&"documentMode"in document&&11>=document.documentMode,Vi=null,Nd=null,ys=null,Vd=!1;function hg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vd||Vi==null||Vi!==Va(r)||(r=Vi,"selectionStart"in r&&dh(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ys&&Fs(ys,r)||(ys=r,r=qa(Nd,"onSelect"),0<r.length&&(e=new ah("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vi)))}function Hl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Li={animationend:Hl("Animation","AnimationEnd"),animationiteration:Hl("Animation","AnimationIteration"),animationstart:Hl("Animation","AnimationStart"),transitionend:Hl("Transition","TransitionEnd")},Bc={},qT={};Dn&&(qT=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Su(t){if(Bc[t])return Bc[t];if(!Li[t])return t;var e=Li[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in qT)return Bc[t]=e[n];return t}var GT=Su("animationend"),$T=Su("animationiteration"),zT=Su("animationstart"),HT=Su("transitionend"),KT=new Map,pg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Tr(t,e){KT.set(t,e),li(e,[t])}for(var Oc=0;Oc<pg.length;Oc++){var qc=pg[Oc],PA=qc.toLowerCase(),xA=qc[0].toUpperCase()+qc.slice(1);Tr(PA,"on"+xA)}Tr(GT,"onAnimationEnd");Tr($T,"onAnimationIteration");Tr(zT,"onAnimationStart");Tr("dblclick","onDoubleClick");Tr("focusin","onFocus");Tr("focusout","onBlur");Tr(HT,"onTransitionEnd");eo("onMouseEnter",["mouseout","mouseover"]);eo("onMouseLeave",["mouseout","mouseover"]);eo("onPointerEnter",["pointerout","pointerover"]);eo("onPointerLeave",["pointerout","pointerover"]);li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));li("onBeforeInput",["compositionend","keypress","textInput","paste"]);li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var as="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),DA=new Set("cancel close invalid load scroll toggle".split(" ").concat(as));function mg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,P0(r,e,void 0,t),t.currentTarget=null}function WT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var u=r[s],c=u.instance,d=u.currentTarget;if(u=u.listener,c!==o&&i.isPropagationStopped())break e;mg(i,u,d),o=c}else for(s=0;s<r.length;s++){if(u=r[s],c=u.instance,d=u.currentTarget,u=u.listener,c!==o&&i.isPropagationStopped())break e;mg(i,u,d),o=c}}}if(Fa)throw t=xd,Fa=!1,xd=null,t}function ve(t,e){var n=e[Bd];n===void 0&&(n=e[Bd]=new Set);var r=t+"__bubble";n.has(r)||(JT(e,t,2,!1),n.add(r))}function Gc(t,e,n){var r=0;e&&(r|=4),JT(n,t,r,e)}var Kl="_reactListening"+Math.random().toString(36).slice(2);function Us(t){if(!t[Kl]){t[Kl]=!0,tT.forEach(function(n){n!=="selectionchange"&&(DA.has(n)||Gc(n,!1,t),Gc(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Kl]||(e[Kl]=!0,Gc("selectionchange",!1,e))}}function JT(t,e,n,r){switch(MT(e)){case 1:var i=z0;break;case 4:i=H0;break;default:i=sh}n=i.bind(null,e,n,t),i=void 0,!Pd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function $c(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===i||c.nodeType===8&&c.parentNode===i))return;s=s.return}for(;u!==null;){if(s=br(u),s===null)return;if(c=s.tag,c===5||c===6){r=o=s;continue e}u=u.parentNode}}r=r.return}yT(function(){var d=o,h=nh(n),p=[];e:{var m=KT.get(t);if(m!==void 0){var _=ah,S=t;switch(t){case"keypress":if(ma(n)===0)break e;case"keydown":case"keyup":_=sA;break;case"focusin":S="focus",_=Fc;break;case"focusout":S="blur",_=Fc;break;case"beforeblur":case"afterblur":_=Fc;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_=rg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_=J0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_=uA;break;case GT:case $T:case zT:_=X0;break;case HT:_=dA;break;case"scroll":_=K0;break;case"wheel":_=hA;break;case"copy":case"cut":case"paste":_=j0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_=og}var P=(e&4)!==0,k=!P&&t==="scroll",C=P?m!==null?m+"Capture":null:m;P=[];for(var T=d,I;T!==null;){I=T;var M=I.stateNode;if(I.tag===5&&M!==null&&(I=M,C!==null&&(M=Ms(T,C),M!=null&&P.push(bs(T,M,I)))),k)break;T=T.return}0<P.length&&(m=new _(m,S,null,n,h),p.push({event:m,listeners:P}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",_=t==="mouseout"||t==="pointerout",m&&n!==Ad&&(S=n.relatedTarget||n.fromElement)&&(br(S)||S[Mn]))break e;if((_||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,_?(S=n.relatedTarget||n.toElement,_=d,S=S?br(S):null,S!==null&&(k=ai(S),S!==k||S.tag!==5&&S.tag!==6)&&(S=null)):(_=null,S=d),_!==S)){if(P=rg,M="onMouseLeave",C="onMouseEnter",T="mouse",(t==="pointerout"||t==="pointerover")&&(P=og,M="onPointerLeave",C="onPointerEnter",T="pointer"),k=_==null?m:Fi(_),I=S==null?m:Fi(S),m=new P(M,T+"leave",_,n,h),m.target=k,m.relatedTarget=I,M=null,br(h)===d&&(P=new P(C,T+"enter",S,n,h),P.target=I,P.relatedTarget=k,M=P),k=M,_&&S)t:{for(P=_,C=S,T=0,I=P;I;I=Ti(I))T++;for(I=0,M=C;M;M=Ti(M))I++;for(;0<T-I;)P=Ti(P),T--;for(;0<I-T;)C=Ti(C),I--;for(;T--;){if(P===C||C!==null&&P===C.alternate)break t;P=Ti(P),C=Ti(C)}P=null}else P=null;_!==null&&gg(p,m,_,P,!1),S!==null&&k!==null&&gg(p,k,S,P,!0)}}e:{if(m=d?Fi(d):window,_=m.nodeName&&m.nodeName.toLowerCase(),_==="select"||_==="input"&&m.type==="file")var F=TA;else if(ag(m))if(UT)F=wA;else{F=IA;var b=EA}else(_=m.nodeName)&&_.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(F=CA);if(F&&(F=F(t,d))){FT(p,F,n,h);break e}b&&b(t,m,d),t==="focusout"&&(b=m._wrapperState)&&b.controlled&&m.type==="number"&&Ed(m,"number",m.value)}switch(b=d?Fi(d):window,t){case"focusin":(ag(b)||b.contentEditable==="true")&&(Vi=b,Nd=d,ys=null);break;case"focusout":ys=Nd=Vi=null;break;case"mousedown":Vd=!0;break;case"contextmenu":case"mouseup":case"dragend":Vd=!1,hg(p,n,h);break;case"selectionchange":if(RA)break;case"keydown":case"keyup":hg(p,n,h)}var A;if(ch)e:{switch(t){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ni?VT(t,n)&&(v="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(v="onCompositionStart");v&&(NT&&n.locale!=="ko"&&(Ni||v!=="onCompositionStart"?v==="onCompositionEnd"&&Ni&&(A=kT()):(Xn=h,lh="value"in Xn?Xn.value:Xn.textContent,Ni=!0)),b=qa(d,v),0<b.length&&(v=new ig(v,t,null,n,h),p.push({event:v,listeners:b}),A?v.data=A:(A=LT(n),A!==null&&(v.data=A)))),(A=mA?gA(t,n):yA(t,n))&&(d=qa(d,"onBeforeInput"),0<d.length&&(h=new ig("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=A))}WT(p,e)})}function bs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function qa(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ms(t,n),o!=null&&r.unshift(bs(t,o,i)),o=Ms(t,e),o!=null&&r.push(bs(t,o,i))),t=t.return}return r}function Ti(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function gg(t,e,n,r,i){for(var o=e._reactName,s=[];n!==null&&n!==r;){var u=n,c=u.alternate,d=u.stateNode;if(c!==null&&c===r)break;u.tag===5&&d!==null&&(u=d,i?(c=Ms(n,o),c!=null&&s.unshift(bs(n,c,u))):i||(c=Ms(n,o),c!=null&&s.push(bs(n,c,u)))),n=n.return}s.length!==0&&t.push({event:e,listeners:s})}var MA=/\r\n?/g,kA=/\u0000|\uFFFD/g;function yg(t){return(typeof t=="string"?t:""+t).replace(MA,`
`).replace(kA,"")}function Wl(t,e,n){if(e=yg(e),yg(t)!==e&&n)throw Error(G(425))}function Ga(){}var Ld=null,Fd=null;function Ud(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bd=typeof setTimeout=="function"?setTimeout:void 0,NA=typeof clearTimeout=="function"?clearTimeout:void 0,_g=typeof Promise=="function"?Promise:void 0,VA=typeof queueMicrotask=="function"?queueMicrotask:typeof _g<"u"?function(t){return _g.resolve(null).then(t).catch(LA)}:bd;function LA(t){setTimeout(function(){throw t})}function zc(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Vs(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Vs(e)}function ir(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function vg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eo=Math.random().toString(36).slice(2),an="__reactFiber$"+Eo,Bs="__reactProps$"+Eo,Mn="__reactContainer$"+Eo,Bd="__reactEvents$"+Eo,FA="__reactListeners$"+Eo,UA="__reactHandles$"+Eo;function br(t){var e=t[an];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Mn]||n[an]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=vg(t);t!==null;){if(n=t[an])return n;t=vg(t)}return e}t=n,n=t.parentNode}return null}function al(t){return t=t[an]||t[Mn],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Fi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Au(t){return t[Bs]||null}var Od=[],Ui=-1;function Er(t){return{current:t}}function Ee(t){0>Ui||(t.current=Od[Ui],Od[Ui]=null,Ui--)}function ye(t,e){Ui++,Od[Ui]=t.current,t.current=e}var mr={},ct=Er(mr),At=Er(!1),Kr=mr;function to(t,e){var n=t.type.contextTypes;if(!n)return mr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Rt(t){return t=t.childContextTypes,t!=null}function $a(){Ee(At),Ee(ct)}function Tg(t,e,n){if(ct.current!==mr)throw Error(G(168));ye(ct,e),ye(At,n)}function QT(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(G(108,E0(t)||"Unknown",i));return Me({},n,r)}function za(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||mr,Kr=ct.current,ye(ct,t),ye(At,At.current),!0}function Eg(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=QT(t,e,Kr),r.__reactInternalMemoizedMergedChildContext=t,Ee(At),Ee(ct),ye(ct,t)):Ee(At),ye(At,n)}var wn=null,Ru=!1,Hc=!1;function YT(t){wn===null?wn=[t]:wn.push(t)}function bA(t){Ru=!0,YT(t)}function Ir(){if(!Hc&&wn!==null){Hc=!0;var t=0,e=fe;try{var n=wn;for(fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}wn=null,Ru=!1}catch(i){throw wn!==null&&(wn=wn.slice(t+1)),ET(rh,Ir),i}finally{fe=e,Hc=!1}}return null}var bi=[],Bi=0,Ha=null,Ka=0,qt=[],Gt=0,Wr=null,Sn=1,An="";function Dr(t,e){bi[Bi++]=Ka,bi[Bi++]=Ha,Ha=t,Ka=e}function XT(t,e,n){qt[Gt++]=Sn,qt[Gt++]=An,qt[Gt++]=Wr,Wr=t;var r=Sn;t=An;var i=32-tn(r)-1;r&=~(1<<i),n+=1;var o=32-tn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Sn=1<<32-tn(e)+i|n<<i|r,An=o+t}else Sn=1<<o|n<<i|r,An=t}function fh(t){t.return!==null&&(Dr(t,1),XT(t,1,0))}function hh(t){for(;t===Ha;)Ha=bi[--Bi],bi[Bi]=null,Ka=bi[--Bi],bi[Bi]=null;for(;t===Wr;)Wr=qt[--Gt],qt[Gt]=null,An=qt[--Gt],qt[Gt]=null,Sn=qt[--Gt],qt[Gt]=null}var Lt=null,kt=null,Ce=!1,en=null;function ZT(t,e){var n=$t(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ig(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Lt=t,kt=ir(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Lt=t,kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Wr!==null?{id:Sn,overflow:An}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$t(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Lt=t,kt=null,!0):!1;default:return!1}}function qd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Gd(t){if(Ce){var e=kt;if(e){var n=e;if(!Ig(t,e)){if(qd(t))throw Error(G(418));e=ir(n.nextSibling);var r=Lt;e&&Ig(t,e)?ZT(r,n):(t.flags=t.flags&-4097|2,Ce=!1,Lt=t)}}else{if(qd(t))throw Error(G(418));t.flags=t.flags&-4097|2,Ce=!1,Lt=t}}}function Cg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Lt=t}function Jl(t){if(t!==Lt)return!1;if(!Ce)return Cg(t),Ce=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ud(t.type,t.memoizedProps)),e&&(e=kt)){if(qd(t))throw jT(),Error(G(418));for(;e;)ZT(t,e),e=ir(e.nextSibling)}if(Cg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kt=ir(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kt=null}}else kt=Lt?ir(t.stateNode.nextSibling):null;return!0}function jT(){for(var t=kt;t;)t=ir(t.nextSibling)}function no(){kt=Lt=null,Ce=!1}function ph(t){en===null?en=[t]:en.push(t)}var BA=Fn.ReactCurrentBatchConfig;function Qo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var u=i.refs;s===null?delete u[o]:u[o]=s},e._stringRef=o,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Ql(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function wg(t){var e=t._init;return e(t._payload)}function eE(t){function e(C,T){if(t){var I=C.deletions;I===null?(C.deletions=[T],C.flags|=16):I.push(T)}}function n(C,T){if(!t)return null;for(;T!==null;)e(C,T),T=T.sibling;return null}function r(C,T){for(C=new Map;T!==null;)T.key!==null?C.set(T.key,T):C.set(T.index,T),T=T.sibling;return C}function i(C,T){return C=ar(C,T),C.index=0,C.sibling=null,C}function o(C,T,I){return C.index=I,t?(I=C.alternate,I!==null?(I=I.index,I<T?(C.flags|=2,T):I):(C.flags|=2,T)):(C.flags|=1048576,T)}function s(C){return t&&C.alternate===null&&(C.flags|=2),C}function u(C,T,I,M){return T===null||T.tag!==6?(T=Zc(I,C.mode,M),T.return=C,T):(T=i(T,I),T.return=C,T)}function c(C,T,I,M){var F=I.type;return F===ki?h(C,T,I.props.children,M,I.key):T!==null&&(T.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Hn&&wg(F)===T.type)?(M=i(T,I.props),M.ref=Qo(C,T,I),M.return=C,M):(M=Ia(I.type,I.key,I.props,null,C.mode,M),M.ref=Qo(C,T,I),M.return=C,M)}function d(C,T,I,M){return T===null||T.tag!==4||T.stateNode.containerInfo!==I.containerInfo||T.stateNode.implementation!==I.implementation?(T=jc(I,C.mode,M),T.return=C,T):(T=i(T,I.children||[]),T.return=C,T)}function h(C,T,I,M,F){return T===null||T.tag!==7?(T=Gr(I,C.mode,M,F),T.return=C,T):(T=i(T,I),T.return=C,T)}function p(C,T,I){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Zc(""+T,C.mode,I),T.return=C,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case bl:return I=Ia(T.type,T.key,T.props,null,C.mode,I),I.ref=Qo(C,null,T),I.return=C,I;case Mi:return T=jc(T,C.mode,I),T.return=C,T;case Hn:var M=T._init;return p(C,M(T._payload),I)}if(ss(T)||zo(T))return T=Gr(T,C.mode,I,null),T.return=C,T;Ql(C,T)}return null}function m(C,T,I,M){var F=T!==null?T.key:null;if(typeof I=="string"&&I!==""||typeof I=="number")return F!==null?null:u(C,T,""+I,M);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case bl:return I.key===F?c(C,T,I,M):null;case Mi:return I.key===F?d(C,T,I,M):null;case Hn:return F=I._init,m(C,T,F(I._payload),M)}if(ss(I)||zo(I))return F!==null?null:h(C,T,I,M,null);Ql(C,I)}return null}function _(C,T,I,M,F){if(typeof M=="string"&&M!==""||typeof M=="number")return C=C.get(I)||null,u(T,C,""+M,F);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case bl:return C=C.get(M.key===null?I:M.key)||null,c(T,C,M,F);case Mi:return C=C.get(M.key===null?I:M.key)||null,d(T,C,M,F);case Hn:var b=M._init;return _(C,T,I,b(M._payload),F)}if(ss(M)||zo(M))return C=C.get(I)||null,h(T,C,M,F,null);Ql(T,M)}return null}function S(C,T,I,M){for(var F=null,b=null,A=T,v=T=0,w=null;A!==null&&v<I.length;v++){A.index>v?(w=A,A=null):w=A.sibling;var R=m(C,A,I[v],M);if(R===null){A===null&&(A=w);break}t&&A&&R.alternate===null&&e(C,A),T=o(R,T,v),b===null?F=R:b.sibling=R,b=R,A=w}if(v===I.length)return n(C,A),Ce&&Dr(C,v),F;if(A===null){for(;v<I.length;v++)A=p(C,I[v],M),A!==null&&(T=o(A,T,v),b===null?F=A:b.sibling=A,b=A);return Ce&&Dr(C,v),F}for(A=r(C,A);v<I.length;v++)w=_(A,C,v,I[v],M),w!==null&&(t&&w.alternate!==null&&A.delete(w.key===null?v:w.key),T=o(w,T,v),b===null?F=w:b.sibling=w,b=w);return t&&A.forEach(function(D){return e(C,D)}),Ce&&Dr(C,v),F}function P(C,T,I,M){var F=zo(I);if(typeof F!="function")throw Error(G(150));if(I=F.call(I),I==null)throw Error(G(151));for(var b=F=null,A=T,v=T=0,w=null,R=I.next();A!==null&&!R.done;v++,R=I.next()){A.index>v?(w=A,A=null):w=A.sibling;var D=m(C,A,R.value,M);if(D===null){A===null&&(A=w);break}t&&A&&D.alternate===null&&e(C,A),T=o(D,T,v),b===null?F=D:b.sibling=D,b=D,A=w}if(R.done)return n(C,A),Ce&&Dr(C,v),F;if(A===null){for(;!R.done;v++,R=I.next())R=p(C,R.value,M),R!==null&&(T=o(R,T,v),b===null?F=R:b.sibling=R,b=R);return Ce&&Dr(C,v),F}for(A=r(C,A);!R.done;v++,R=I.next())R=_(A,C,v,R.value,M),R!==null&&(t&&R.alternate!==null&&A.delete(R.key===null?v:R.key),T=o(R,T,v),b===null?F=R:b.sibling=R,b=R);return t&&A.forEach(function(N){return e(C,N)}),Ce&&Dr(C,v),F}function k(C,T,I,M){if(typeof I=="object"&&I!==null&&I.type===ki&&I.key===null&&(I=I.props.children),typeof I=="object"&&I!==null){switch(I.$$typeof){case bl:e:{for(var F=I.key,b=T;b!==null;){if(b.key===F){if(F=I.type,F===ki){if(b.tag===7){n(C,b.sibling),T=i(b,I.props.children),T.return=C,C=T;break e}}else if(b.elementType===F||typeof F=="object"&&F!==null&&F.$$typeof===Hn&&wg(F)===b.type){n(C,b.sibling),T=i(b,I.props),T.ref=Qo(C,b,I),T.return=C,C=T;break e}n(C,b);break}else e(C,b);b=b.sibling}I.type===ki?(T=Gr(I.props.children,C.mode,M,I.key),T.return=C,C=T):(M=Ia(I.type,I.key,I.props,null,C.mode,M),M.ref=Qo(C,T,I),M.return=C,C=M)}return s(C);case Mi:e:{for(b=I.key;T!==null;){if(T.key===b)if(T.tag===4&&T.stateNode.containerInfo===I.containerInfo&&T.stateNode.implementation===I.implementation){n(C,T.sibling),T=i(T,I.children||[]),T.return=C,C=T;break e}else{n(C,T);break}else e(C,T);T=T.sibling}T=jc(I,C.mode,M),T.return=C,C=T}return s(C);case Hn:return b=I._init,k(C,T,b(I._payload),M)}if(ss(I))return S(C,T,I,M);if(zo(I))return P(C,T,I,M);Ql(C,I)}return typeof I=="string"&&I!==""||typeof I=="number"?(I=""+I,T!==null&&T.tag===6?(n(C,T.sibling),T=i(T,I),T.return=C,C=T):(n(C,T),T=Zc(I,C.mode,M),T.return=C,C=T),s(C)):n(C,T)}return k}var ro=eE(!0),tE=eE(!1),Wa=Er(null),Ja=null,Oi=null,mh=null;function gh(){mh=Oi=Ja=null}function yh(t){var e=Wa.current;Ee(Wa),t._currentValue=e}function $d(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ji(t,e){Ja=t,mh=Oi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wt=!0),t.firstContext=null)}function Jt(t){var e=t._currentValue;if(mh!==t)if(t={context:t,memoizedValue:e,next:null},Oi===null){if(Ja===null)throw Error(G(308));Oi=t,Ja.dependencies={lanes:0,firstContext:t}}else Oi=Oi.next=t;return e}var Br=null;function _h(t){Br===null?Br=[t]:Br.push(t)}function nE(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,_h(e)):(n.next=i.next,i.next=n),e.interleaved=n,kn(t,r)}function kn(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Kn=!1;function vh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function rE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Pn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function or(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,kn(t,n)}return i=r.interleaved,i===null?(e.next=e,_h(r)):(e.next=i.next,i.next=e),r.interleaved=e,kn(t,n)}function ga(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ih(t,n)}}function Sg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=s:o=o.next=s,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Qa(t,e,n,r){var i=t.updateQueue;Kn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var c=u,d=c.next;c.next=null,s===null?o=d:s.next=d,s=c;var h=t.alternate;h!==null&&(h=h.updateQueue,u=h.lastBaseUpdate,u!==s&&(u===null?h.firstBaseUpdate=d:u.next=d,h.lastBaseUpdate=c))}if(o!==null){var p=i.baseState;s=0,h=d=c=null,u=o;do{var m=u.lane,_=u.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:_,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var S=t,P=u;switch(m=e,_=n,P.tag){case 1:if(S=P.payload,typeof S=="function"){p=S.call(_,p,m);break e}p=S;break e;case 3:S.flags=S.flags&-65537|128;case 0:if(S=P.payload,m=typeof S=="function"?S.call(_,p,m):S,m==null)break e;p=Me({},p,m);break e;case 2:Kn=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[u]:m.push(u))}else _={eventTime:_,lane:m,tag:u.tag,payload:u.payload,callback:u.callback,next:null},h===null?(d=h=_,c=p):h=h.next=_,s|=m;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;m=u,u=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(h===null&&(c=p),i.baseState=c,i.firstBaseUpdate=d,i.lastBaseUpdate=h,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Qr|=s,t.lanes=s,t.memoizedState=p}}function Ag(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(G(191,i));i.call(r)}}}var ul={},hn=Er(ul),Os=Er(ul),qs=Er(ul);function Or(t){if(t===ul)throw Error(G(174));return t}function Th(t,e){switch(ye(qs,e),ye(Os,t),ye(hn,ul),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Cd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Cd(e,t)}Ee(hn),ye(hn,e)}function io(){Ee(hn),Ee(Os),Ee(qs)}function iE(t){Or(qs.current);var e=Or(hn.current),n=Cd(e,t.type);e!==n&&(ye(Os,t),ye(hn,n))}function Eh(t){Os.current===t&&(Ee(hn),Ee(Os))}var Re=Er(0);function Ya(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Kc=[];function Ih(){for(var t=0;t<Kc.length;t++)Kc[t]._workInProgressVersionPrimary=null;Kc.length=0}var ya=Fn.ReactCurrentDispatcher,Wc=Fn.ReactCurrentBatchConfig,Jr=0,xe=null,Ge=null,Ke=null,Xa=!1,_s=!1,Gs=0,OA=0;function it(){throw Error(G(321))}function Ch(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!rn(t[n],e[n]))return!1;return!0}function wh(t,e,n,r,i,o){if(Jr=o,xe=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ya.current=t===null||t.memoizedState===null?zA:HA,t=n(r,i),_s){o=0;do{if(_s=!1,Gs=0,25<=o)throw Error(G(301));o+=1,Ke=Ge=null,e.updateQueue=null,ya.current=KA,t=n(r,i)}while(_s)}if(ya.current=Za,e=Ge!==null&&Ge.next!==null,Jr=0,Ke=Ge=xe=null,Xa=!1,e)throw Error(G(300));return t}function Sh(){var t=Gs!==0;return Gs=0,t}function ln(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ke===null?xe.memoizedState=Ke=t:Ke=Ke.next=t,Ke}function Qt(){if(Ge===null){var t=xe.alternate;t=t!==null?t.memoizedState:null}else t=Ge.next;var e=Ke===null?xe.memoizedState:Ke.next;if(e!==null)Ke=e,Ge=t;else{if(t===null)throw Error(G(310));Ge=t,t={memoizedState:Ge.memoizedState,baseState:Ge.baseState,baseQueue:Ge.baseQueue,queue:Ge.queue,next:null},Ke===null?xe.memoizedState=Ke=t:Ke=Ke.next=t}return Ke}function $s(t,e){return typeof e=="function"?e(t):e}function Jc(t){var e=Qt(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Ge,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var u=s=null,c=null,d=o;do{var h=d.lane;if((Jr&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(u=c=p,s=r):c=c.next=p,xe.lanes|=h,Qr|=h}d=d.next}while(d!==null&&d!==o);c===null?s=r:c.next=u,rn(r,e.memoizedState)||(wt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,xe.lanes|=o,Qr|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Qc(t){var e=Qt(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var s=i=i.next;do o=t(o,s.action),s=s.next;while(s!==i);rn(o,e.memoizedState)||(wt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function oE(){}function sE(t,e){var n=xe,r=Qt(),i=e(),o=!rn(r.memoizedState,i);if(o&&(r.memoizedState=i,wt=!0),r=r.queue,Ah(uE.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Ke!==null&&Ke.memoizedState.tag&1){if(n.flags|=2048,zs(9,aE.bind(null,n,r,i,e),void 0,null),We===null)throw Error(G(349));Jr&30||lE(n,e,i)}return i}function lE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function aE(t,e,n,r){e.value=n,e.getSnapshot=r,cE(e)&&dE(t)}function uE(t,e,n){return n(function(){cE(e)&&dE(t)})}function cE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!rn(t,n)}catch{return!0}}function dE(t){var e=kn(t,1);e!==null&&nn(e,t,1,-1)}function Rg(t){var e=ln();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:t},e.queue=t,t=t.dispatch=$A.bind(null,xe,t),[e.memoizedState,t]}function zs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=xe.updateQueue,e===null?(e={lastEffect:null,stores:null},xe.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function fE(){return Qt().memoizedState}function _a(t,e,n,r){var i=ln();xe.flags|=t,i.memoizedState=zs(1|e,n,void 0,r===void 0?null:r)}function Pu(t,e,n,r){var i=Qt();r=r===void 0?null:r;var o=void 0;if(Ge!==null){var s=Ge.memoizedState;if(o=s.destroy,r!==null&&Ch(r,s.deps)){i.memoizedState=zs(e,n,o,r);return}}xe.flags|=t,i.memoizedState=zs(1|e,n,o,r)}function Pg(t,e){return _a(8390656,8,t,e)}function Ah(t,e){return Pu(2048,8,t,e)}function hE(t,e){return Pu(4,2,t,e)}function pE(t,e){return Pu(4,4,t,e)}function mE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function gE(t,e,n){return n=n!=null?n.concat([t]):null,Pu(4,4,mE.bind(null,e,t),n)}function Rh(){}function yE(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ch(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function _E(t,e){var n=Qt();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Ch(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function vE(t,e,n){return Jr&21?(rn(n,e)||(n=wT(),xe.lanes|=n,Qr|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wt=!0),t.memoizedState=n)}function qA(t,e){var n=fe;fe=n!==0&&4>n?n:4,t(!0);var r=Wc.transition;Wc.transition={};try{t(!1),e()}finally{fe=n,Wc.transition=r}}function TE(){return Qt().memoizedState}function GA(t,e,n){var r=lr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},EE(t))IE(e,n);else if(n=nE(t,e,n,r),n!==null){var i=yt();nn(n,t,r,i),CE(n,e,r)}}function $A(t,e,n){var r=lr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(EE(t))IE(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,u=o(s,n);if(i.hasEagerState=!0,i.eagerState=u,rn(u,s)){var c=e.interleaved;c===null?(i.next=i,_h(e)):(i.next=c.next,c.next=i),e.interleaved=i;return}}catch{}finally{}n=nE(t,e,i,r),n!==null&&(i=yt(),nn(n,t,r,i),CE(n,e,r))}}function EE(t){var e=t.alternate;return t===xe||e!==null&&e===xe}function IE(t,e){_s=Xa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function CE(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,ih(t,n)}}var Za={readContext:Jt,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useInsertionEffect:it,useLayoutEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useMutableSource:it,useSyncExternalStore:it,useId:it,unstable_isNewReconciler:!1},zA={readContext:Jt,useCallback:function(t,e){return ln().memoizedState=[t,e===void 0?null:e],t},useContext:Jt,useEffect:Pg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,_a(4194308,4,mE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return _a(4194308,4,t,e)},useInsertionEffect:function(t,e){return _a(4,2,t,e)},useMemo:function(t,e){var n=ln();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ln();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=GA.bind(null,xe,t),[r.memoizedState,t]},useRef:function(t){var e=ln();return t={current:t},e.memoizedState=t},useState:Rg,useDebugValue:Rh,useDeferredValue:function(t){return ln().memoizedState=t},useTransition:function(){var t=Rg(!1),e=t[0];return t=qA.bind(null,t[1]),ln().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=xe,i=ln();if(Ce){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),We===null)throw Error(G(349));Jr&30||lE(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,Pg(uE.bind(null,r,o,t),[t]),r.flags|=2048,zs(9,aE.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=ln(),e=We.identifierPrefix;if(Ce){var n=An,r=Sn;n=(r&~(1<<32-tn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OA++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},HA={readContext:Jt,useCallback:yE,useContext:Jt,useEffect:Ah,useImperativeHandle:gE,useInsertionEffect:hE,useLayoutEffect:pE,useMemo:_E,useReducer:Jc,useRef:fE,useState:function(){return Jc($s)},useDebugValue:Rh,useDeferredValue:function(t){var e=Qt();return vE(e,Ge.memoizedState,t)},useTransition:function(){var t=Jc($s)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:oE,useSyncExternalStore:sE,useId:TE,unstable_isNewReconciler:!1},KA={readContext:Jt,useCallback:yE,useContext:Jt,useEffect:Ah,useImperativeHandle:gE,useInsertionEffect:hE,useLayoutEffect:pE,useMemo:_E,useReducer:Qc,useRef:fE,useState:function(){return Qc($s)},useDebugValue:Rh,useDeferredValue:function(t){var e=Qt();return Ge===null?e.memoizedState=t:vE(e,Ge.memoizedState,t)},useTransition:function(){var t=Qc($s)[0],e=Qt().memoizedState;return[t,e]},useMutableSource:oE,useSyncExternalStore:sE,useId:TE,unstable_isNewReconciler:!1};function Zt(t,e){if(t&&t.defaultProps){e=Me({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function zd(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Me({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var xu={isMounted:function(t){return(t=t._reactInternals)?ai(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=yt(),i=lr(t),o=Pn(r,i);o.payload=e,n!=null&&(o.callback=n),e=or(t,o,i),e!==null&&(nn(e,t,i,r),ga(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=yt(),i=lr(t),o=Pn(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=or(t,o,i),e!==null&&(nn(e,t,i,r),ga(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=yt(),r=lr(t),i=Pn(n,r);i.tag=2,e!=null&&(i.callback=e),e=or(t,i,r),e!==null&&(nn(e,t,r,n),ga(e,t,r))}};function xg(t,e,n,r,i,o,s){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Fs(n,r)||!Fs(i,o):!0}function wE(t,e,n){var r=!1,i=mr,o=e.contextType;return typeof o=="object"&&o!==null?o=Jt(o):(i=Rt(e)?Kr:ct.current,r=e.contextTypes,o=(r=r!=null)?to(t,i):mr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xu,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function Dg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&xu.enqueueReplaceState(e,e.state,null)}function Hd(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},vh(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=Jt(o):(o=Rt(e)?Kr:ct.current,i.context=to(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(zd(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&xu.enqueueReplaceState(i,i.state,null),Qa(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function oo(t,e){try{var n="",r=e;do n+=T0(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function Yc(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Kd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WA=typeof WeakMap=="function"?WeakMap:Map;function SE(t,e,n){n=Pn(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){eu||(eu=!0,nf=r),Kd(t,e)},n}function AE(t,e,n){n=Pn(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Kd(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Kd(t,e),typeof r!="function"&&(sr===null?sr=new Set([this]):sr.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),n}function Mg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WA;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=lR.bind(null,t,e,n),e.then(t,t))}function kg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Ng(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Pn(-1,1),e.tag=2,or(n,e,1))),n.lanes|=1),t)}var JA=Fn.ReactCurrentOwner,wt=!1;function pt(t,e,n,r){e.child=t===null?tE(e,null,n,r):ro(e,t.child,n,r)}function Vg(t,e,n,r,i){n=n.render;var o=e.ref;return Ji(e,i),r=wh(t,e,n,r,o,i),n=Sh(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Nn(t,e,i)):(Ce&&n&&fh(e),e.flags|=1,pt(t,e,r,i),e.child)}function Lg(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Lh(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,RE(t,e,o,r,i)):(t=Ia(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var s=o.memoizedProps;if(n=n.compare,n=n!==null?n:Fs,n(s,r)&&t.ref===e.ref)return Nn(t,e,i)}return e.flags|=1,t=ar(o,r),t.ref=e.ref,t.return=e,e.child=t}function RE(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Fs(o,r)&&t.ref===e.ref)if(wt=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(wt=!0);else return e.lanes=t.lanes,Nn(t,e,i)}return Wd(t,e,n,r,i)}function PE(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ye(Gi,Mt),Mt|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ye(Gi,Mt),Mt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ye(Gi,Mt),Mt|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ye(Gi,Mt),Mt|=r;return pt(t,e,i,n),e.child}function xE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Wd(t,e,n,r,i){var o=Rt(n)?Kr:ct.current;return o=to(e,o),Ji(e,i),n=wh(t,e,n,r,o,i),r=Sh(),t!==null&&!wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Nn(t,e,i)):(Ce&&r&&fh(e),e.flags|=1,pt(t,e,n,i),e.child)}function Fg(t,e,n,r,i){if(Rt(n)){var o=!0;za(e)}else o=!1;if(Ji(e,i),e.stateNode===null)va(t,e),wE(e,n,r),Hd(e,n,r,i),r=!0;else if(t===null){var s=e.stateNode,u=e.memoizedProps;s.props=u;var c=s.context,d=n.contextType;typeof d=="object"&&d!==null?d=Jt(d):(d=Rt(n)?Kr:ct.current,d=to(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";p||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==r||c!==d)&&Dg(e,s,r,d),Kn=!1;var m=e.memoizedState;s.state=m,Qa(e,r,s,i),c=e.memoizedState,u!==r||m!==c||At.current||Kn?(typeof h=="function"&&(zd(e,n,h,r),c=e.memoizedState),(u=Kn||xg(e,n,u,r,m,c,d))?(p||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),s.props=r,s.state=c,s.context=d,r=u):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,rE(t,e),u=e.memoizedProps,d=e.type===e.elementType?u:Zt(e.type,u),s.props=d,p=e.pendingProps,m=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=Jt(c):(c=Rt(n)?Kr:ct.current,c=to(e,c));var _=n.getDerivedStateFromProps;(h=typeof _=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(u!==p||m!==c)&&Dg(e,s,r,c),Kn=!1,m=e.memoizedState,s.state=m,Qa(e,r,s,i);var S=e.memoizedState;u!==p||m!==S||At.current||Kn?(typeof _=="function"&&(zd(e,n,_,r),S=e.memoizedState),(d=Kn||xg(e,n,d,r,m,S,c)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,S,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,S,c)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=S),s.props=r,s.state=S,s.context=c,r=d):(typeof s.componentDidUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Jd(t,e,n,r,o,i)}function Jd(t,e,n,r,i,o){xE(t,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&Eg(e,n,!1),Nn(t,e,o);r=e.stateNode,JA.current=e;var u=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&s?(e.child=ro(e,t.child,null,o),e.child=ro(e,null,u,o)):pt(t,e,u,o),e.memoizedState=r.state,i&&Eg(e,n,!0),e.child}function DE(t){var e=t.stateNode;e.pendingContext?Tg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Tg(t,e.context,!1),Th(t,e.containerInfo)}function Ug(t,e,n,r,i){return no(),ph(i),e.flags|=256,pt(t,e,n,r),e.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function Yd(t){return{baseLanes:t,cachePool:null,transitions:null}}function ME(t,e,n){var r=e.pendingProps,i=Re.current,o=!1,s=(e.flags&128)!==0,u;if((u=s)||(u=t!==null&&t.memoizedState===null?!1:(i&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),ye(Re,i&1),t===null)return Gd(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=ku(s,r,0,null),t=Gr(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Yd(n),e.memoizedState=Qd,t):Ph(e,s));if(i=t.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return QA(t,e,s,r,u,i,n);if(o){o=r.fallback,s=e.mode,i=t.child,u=i.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=ar(i,c),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?o=ar(u,o):(o=Gr(o,s,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=t.child.memoizedState,s=s===null?Yd(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=t.childLanes&~n,e.memoizedState=Qd,r}return o=t.child,t=o.sibling,r=ar(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ph(t,e){return e=ku({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yl(t,e,n,r){return r!==null&&ph(r),ro(e,t.child,null,n),t=Ph(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function QA(t,e,n,r,i,o,s){if(n)return e.flags&256?(e.flags&=-257,r=Yc(Error(G(422))),Yl(t,e,s,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=ku({mode:"visible",children:r.children},i,0,null),o=Gr(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ro(e,t.child,null,s),e.child.memoizedState=Yd(s),e.memoizedState=Qd,o);if(!(e.mode&1))return Yl(t,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,o=Error(G(419)),r=Yc(o,r,void 0),Yl(t,e,s,r)}if(u=(s&t.childLanes)!==0,wt||u){if(r=We,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,kn(t,i),nn(r,t,i,-1))}return Vh(),r=Yc(Error(G(421))),Yl(t,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=aR.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,kt=ir(i.nextSibling),Lt=e,Ce=!0,en=null,t!==null&&(qt[Gt++]=Sn,qt[Gt++]=An,qt[Gt++]=Wr,Sn=t.id,An=t.overflow,Wr=e),e=Ph(e,r.children),e.flags|=4096,e)}function bg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),$d(t.return,e,n)}function Xc(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function kE(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(pt(t,e,r.children,n),r=Re.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&bg(t,n,e);else if(t.tag===19)bg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ye(Re,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&Ya(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Xc(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&Ya(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Xc(e,!0,n,null,o);break;case"together":Xc(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function va(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Nn(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Qr|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=ar(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ar(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function YA(t,e,n){switch(e.tag){case 3:DE(e),no();break;case 5:iE(e);break;case 1:Rt(e.type)&&za(e);break;case 4:Th(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;ye(Wa,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ye(Re,Re.current&1),e.flags|=128,null):n&e.child.childLanes?ME(t,e,n):(ye(Re,Re.current&1),t=Nn(t,e,n),t!==null?t.sibling:null);ye(Re,Re.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return kE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ye(Re,Re.current),r)break;return null;case 22:case 23:return e.lanes=0,PE(t,e,n)}return Nn(t,e,n)}var NE,Xd,VE,LE;NE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Xd=function(){};VE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Or(hn.current);var o=null;switch(n){case"input":i=vd(t,i),r=vd(t,r),o=[];break;case"select":i=Me({},i,{value:void 0}),r=Me({},r,{value:void 0}),o=[];break;case"textarea":i=Id(t,i),r=Id(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Ga)}wd(n,r);var s;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var u=i[d];for(s in u)u.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(xs.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var c=r[d];if(u=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&c!==u&&(c!=null||u!=null))if(d==="style")if(u){for(s in u)!u.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&u[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,u=u?u.__html:void 0,c!=null&&u!==c&&(o=o||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(o=o||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(xs.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&ve("scroll",t),o||u===c||(o=[])):(o=o||[]).push(d,c))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};LE=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yo(t,e){if(!Ce)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ot(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function XA(t,e,n){var r=e.pendingProps;switch(hh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ot(e),null;case 1:return Rt(e.type)&&$a(),ot(e),null;case 3:return r=e.stateNode,io(),Ee(At),Ee(ct),Ih(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Jl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,en!==null&&(sf(en),en=null))),Xd(t,e),ot(e),null;case 5:Eh(e);var i=Or(qs.current);if(n=e.type,t!==null&&e.stateNode!=null)VE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return ot(e),null}if(t=Or(hn.current),Jl(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[an]=e,r[Bs]=o,t=(e.mode&1)!==0,n){case"dialog":ve("cancel",r),ve("close",r);break;case"iframe":case"object":case"embed":ve("load",r);break;case"video":case"audio":for(i=0;i<as.length;i++)ve(as[i],r);break;case"source":ve("error",r);break;case"img":case"image":case"link":ve("error",r),ve("load",r);break;case"details":ve("toggle",r);break;case"input":Wm(r,o),ve("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},ve("invalid",r);break;case"textarea":Qm(r,o),ve("invalid",r)}wd(n,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var u=o[s];s==="children"?typeof u=="string"?r.textContent!==u&&(o.suppressHydrationWarning!==!0&&Wl(r.textContent,u,t),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&Wl(r.textContent,u,t),i=["children",""+u]):xs.hasOwnProperty(s)&&u!=null&&s==="onScroll"&&ve("scroll",r)}switch(n){case"input":Bl(r),Jm(r,o,!0);break;case"textarea":Bl(r),Ym(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=Ga)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=uT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=s.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=s.createElement(n,{is:r.is}):(t=s.createElement(n),n==="select"&&(s=t,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):t=s.createElementNS(t,n),t[an]=e,t[Bs]=r,NE(t,e,!1,!1),e.stateNode=t;e:{switch(s=Sd(n,r),n){case"dialog":ve("cancel",t),ve("close",t),i=r;break;case"iframe":case"object":case"embed":ve("load",t),i=r;break;case"video":case"audio":for(i=0;i<as.length;i++)ve(as[i],t);i=r;break;case"source":ve("error",t),i=r;break;case"img":case"image":case"link":ve("error",t),ve("load",t),i=r;break;case"details":ve("toggle",t),i=r;break;case"input":Wm(t,r),i=vd(t,r),ve("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Me({},r,{value:void 0}),ve("invalid",t);break;case"textarea":Qm(t,r),i=Id(t,r),ve("invalid",t);break;default:i=r}wd(n,i),u=i;for(o in u)if(u.hasOwnProperty(o)){var c=u[o];o==="style"?fT(t,c):o==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&cT(t,c)):o==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ds(t,c):typeof c=="number"&&Ds(t,""+c):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(xs.hasOwnProperty(o)?c!=null&&o==="onScroll"&&ve("scroll",t):c!=null&&Zf(t,o,c,s))}switch(n){case"input":Bl(t),Jm(t,r,!1);break;case"textarea":Bl(t),Ym(t);break;case"option":r.value!=null&&t.setAttribute("value",""+pr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?zi(t,!!r.multiple,o,!1):r.defaultValue!=null&&zi(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Ga)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ot(e),null;case 6:if(t&&e.stateNode!=null)LE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=Or(qs.current),Or(hn.current),Jl(e)){if(r=e.stateNode,n=e.memoizedProps,r[an]=e,(o=r.nodeValue!==n)&&(t=Lt,t!==null))switch(t.tag){case 3:Wl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Wl(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[an]=e,e.stateNode=r}return ot(e),null;case 13:if(Ee(Re),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Ce&&kt!==null&&e.mode&1&&!(e.flags&128))jT(),no(),e.flags|=98560,o=!1;else if(o=Jl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(G(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[an]=e}else no(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ot(e),o=!1}else en!==null&&(sf(en),en=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Re.current&1?$e===0&&($e=3):Vh())),e.updateQueue!==null&&(e.flags|=4),ot(e),null);case 4:return io(),Xd(t,e),t===null&&Us(e.stateNode.containerInfo),ot(e),null;case 10:return yh(e.type._context),ot(e),null;case 17:return Rt(e.type)&&$a(),ot(e),null;case 19:if(Ee(Re),o=e.memoizedState,o===null)return ot(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)Yo(o,!1);else{if($e!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(s=Ya(t),s!==null){for(e.flags|=128,Yo(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,t=s.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ye(Re,Re.current&1|2),e.child}t=t.sibling}o.tail!==null&&be()>so&&(e.flags|=128,r=!0,Yo(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ya(s),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Ce)return ot(e),null}else 2*be()-o.renderingStartTime>so&&n!==1073741824&&(e.flags|=128,r=!0,Yo(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(n=o.last,n!==null?n.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=be(),e.sibling=null,n=Re.current,ye(Re,r?n&1|2:n&1),e):(ot(e),null);case 22:case 23:return Nh(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mt&1073741824&&(ot(e),e.subtreeFlags&6&&(e.flags|=8192)):ot(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function ZA(t,e){switch(hh(e),e.tag){case 1:return Rt(e.type)&&$a(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return io(),Ee(At),Ee(ct),Ih(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Eh(e),null;case 13:if(Ee(Re),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));no()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ee(Re),null;case 4:return io(),null;case 10:return yh(e.type._context),null;case 22:case 23:return Nh(),null;case 24:return null;default:return null}}var Xl=!1,lt=!1,jA=typeof WeakSet=="function"?WeakSet:Set,W=null;function qi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ne(t,e,r)}else n.current=null}function Zd(t,e,n){try{n()}catch(r){Ne(t,e,r)}}var Bg=!1;function eR(t,e){if(Ld=Ba,t=OT(),dh(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var s=0,u=-1,c=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var _;p!==n||i!==0&&p.nodeType!==3||(u=s+i),p!==o||r!==0&&p.nodeType!==3||(c=s+r),p.nodeType===3&&(s+=p.nodeValue.length),(_=p.firstChild)!==null;)m=p,p=_;for(;;){if(p===t)break t;if(m===n&&++d===i&&(u=s),m===o&&++h===r&&(c=s),(_=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=_}n=u===-1||c===-1?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(Fd={focusedElem:t,selectionRange:n},Ba=!1,W=e;W!==null;)if(e=W,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,W=t;else for(;W!==null;){e=W;try{var S=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(S!==null){var P=S.memoizedProps,k=S.memoizedState,C=e.stateNode,T=C.getSnapshotBeforeUpdate(e.elementType===e.type?P:Zt(e.type,P),k);C.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var I=e.stateNode.containerInfo;I.nodeType===1?I.textContent="":I.nodeType===9&&I.documentElement&&I.removeChild(I.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(M){Ne(e,e.return,M)}if(t=e.sibling,t!==null){t.return=e.return,W=t;break}W=e.return}return S=Bg,Bg=!1,S}function vs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&Zd(e,n,o)}i=i.next}while(i!==r)}}function Du(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function jd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function FE(t){var e=t.alternate;e!==null&&(t.alternate=null,FE(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[an],delete e[Bs],delete e[Bd],delete e[FA],delete e[UA])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function UE(t){return t.tag===5||t.tag===3||t.tag===4}function Og(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||UE(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function ef(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ga));else if(r!==4&&(t=t.child,t!==null))for(ef(t,e,n),t=t.sibling;t!==null;)ef(t,e,n),t=t.sibling}function tf(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(tf(t,e,n),t=t.sibling;t!==null;)tf(t,e,n),t=t.sibling}var Ye=null,jt=!1;function Gn(t,e,n){for(n=n.child;n!==null;)bE(t,e,n),n=n.sibling}function bE(t,e,n){if(fn&&typeof fn.onCommitFiberUnmount=="function")try{fn.onCommitFiberUnmount(Iu,n)}catch{}switch(n.tag){case 5:lt||qi(n,e);case 6:var r=Ye,i=jt;Ye=null,Gn(t,e,n),Ye=r,jt=i,Ye!==null&&(jt?(t=Ye,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ye.removeChild(n.stateNode));break;case 18:Ye!==null&&(jt?(t=Ye,n=n.stateNode,t.nodeType===8?zc(t.parentNode,n):t.nodeType===1&&zc(t,n),Vs(t)):zc(Ye,n.stateNode));break;case 4:r=Ye,i=jt,Ye=n.stateNode.containerInfo,jt=!0,Gn(t,e,n),Ye=r,jt=i;break;case 0:case 11:case 14:case 15:if(!lt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&Zd(n,e,s),i=i.next}while(i!==r)}Gn(t,e,n);break;case 1:if(!lt&&(qi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){Ne(n,e,u)}Gn(t,e,n);break;case 21:Gn(t,e,n);break;case 22:n.mode&1?(lt=(r=lt)||n.memoizedState!==null,Gn(t,e,n),lt=r):Gn(t,e,n);break;default:Gn(t,e,n)}}function qg(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new jA),e.forEach(function(r){var i=uR.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Xt(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,s=e,u=s;e:for(;u!==null;){switch(u.tag){case 5:Ye=u.stateNode,jt=!1;break e;case 3:Ye=u.stateNode.containerInfo,jt=!0;break e;case 4:Ye=u.stateNode.containerInfo,jt=!0;break e}u=u.return}if(Ye===null)throw Error(G(160));bE(o,s,i),Ye=null,jt=!1;var c=i.alternate;c!==null&&(c.return=null),i.return=null}catch(d){Ne(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BE(e,t),e=e.sibling}function BE(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xt(e,t),sn(t),r&4){try{vs(3,t,t.return),Du(3,t)}catch(P){Ne(t,t.return,P)}try{vs(5,t,t.return)}catch(P){Ne(t,t.return,P)}}break;case 1:Xt(e,t),sn(t),r&512&&n!==null&&qi(n,n.return);break;case 5:if(Xt(e,t),sn(t),r&512&&n!==null&&qi(n,n.return),t.flags&32){var i=t.stateNode;try{Ds(i,"")}catch(P){Ne(t,t.return,P)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,s=n!==null?n.memoizedProps:o,u=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&lT(i,o),Sd(u,s);var d=Sd(u,o);for(s=0;s<c.length;s+=2){var h=c[s],p=c[s+1];h==="style"?fT(i,p):h==="dangerouslySetInnerHTML"?cT(i,p):h==="children"?Ds(i,p):Zf(i,h,p,d)}switch(u){case"input":Td(i,o);break;case"textarea":aT(i,o);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var _=o.value;_!=null?zi(i,!!o.multiple,_,!1):m!==!!o.multiple&&(o.defaultValue!=null?zi(i,!!o.multiple,o.defaultValue,!0):zi(i,!!o.multiple,o.multiple?[]:"",!1))}i[Bs]=o}catch(P){Ne(t,t.return,P)}}break;case 6:if(Xt(e,t),sn(t),r&4){if(t.stateNode===null)throw Error(G(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(P){Ne(t,t.return,P)}}break;case 3:if(Xt(e,t),sn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Vs(e.containerInfo)}catch(P){Ne(t,t.return,P)}break;case 4:Xt(e,t),sn(t);break;case 13:Xt(e,t),sn(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Mh=be())),r&4&&qg(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(lt=(d=lt)||h,Xt(e,t),lt=d):Xt(e,t),sn(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(W=t,h=t.child;h!==null;){for(p=W=h;W!==null;){switch(m=W,_=m.child,m.tag){case 0:case 11:case 14:case 15:vs(4,m,m.return);break;case 1:qi(m,m.return);var S=m.stateNode;if(typeof S.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,S.props=e.memoizedProps,S.state=e.memoizedState,S.componentWillUnmount()}catch(P){Ne(r,n,P)}}break;case 5:qi(m,m.return);break;case 22:if(m.memoizedState!==null){$g(p);continue}}_!==null?(_.return=m,W=_):$g(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{i=p.stateNode,d?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=p.stateNode,c=p.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,u.style.display=dT("display",s))}catch(P){Ne(t,t.return,P)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(P){Ne(t,t.return,P)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Xt(e,t),sn(t),r&4&&qg(t);break;case 21:break;default:Xt(e,t),sn(t)}}function sn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(UE(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ds(i,""),r.flags&=-33);var o=Og(t);tf(t,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,u=Og(t);ef(t,u,s);break;default:throw Error(G(161))}}catch(c){Ne(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function tR(t,e,n){W=t,OE(t)}function OE(t,e,n){for(var r=(t.mode&1)!==0;W!==null;){var i=W,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Xl;if(!s){var u=i.alternate,c=u!==null&&u.memoizedState!==null||lt;u=Xl;var d=lt;if(Xl=s,(lt=c)&&!d)for(W=i;W!==null;)s=W,c=s.child,s.tag===22&&s.memoizedState!==null?zg(i):c!==null?(c.return=s,W=c):zg(i);for(;o!==null;)W=o,OE(o),o=o.sibling;W=i,Xl=u,lt=d}Gg(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,W=o):Gg(t)}}function Gg(t){for(;W!==null;){var e=W;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:lt||Du(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!lt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Zt(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Ag(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Ag(e,s,n)}break;case 5:var u=e.stateNode;if(n===null&&e.flags&4){n=u;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&Vs(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}lt||e.flags&512&&jd(e)}catch(m){Ne(e,e.return,m)}}if(e===t){W=null;break}if(n=e.sibling,n!==null){n.return=e.return,W=n;break}W=e.return}}function $g(t){for(;W!==null;){var e=W;if(e===t){W=null;break}var n=e.sibling;if(n!==null){n.return=e.return,W=n;break}W=e.return}}function zg(t){for(;W!==null;){var e=W;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Du(4,e)}catch(c){Ne(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(c){Ne(e,i,c)}}var o=e.return;try{jd(e)}catch(c){Ne(e,o,c)}break;case 5:var s=e.return;try{jd(e)}catch(c){Ne(e,s,c)}}}catch(c){Ne(e,e.return,c)}if(e===t){W=null;break}var u=e.sibling;if(u!==null){u.return=e.return,W=u;break}W=e.return}}var nR=Math.ceil,ja=Fn.ReactCurrentDispatcher,xh=Fn.ReactCurrentOwner,Ht=Fn.ReactCurrentBatchConfig,le=0,We=null,Oe=null,je=0,Mt=0,Gi=Er(0),$e=0,Hs=null,Qr=0,Mu=0,Dh=0,Ts=null,Ct=null,Mh=0,so=1/0,Cn=null,eu=!1,nf=null,sr=null,Zl=!1,Zn=null,tu=0,Es=0,rf=null,Ta=-1,Ea=0;function yt(){return le&6?be():Ta!==-1?Ta:Ta=be()}function lr(t){return t.mode&1?le&2&&je!==0?je&-je:BA.transition!==null?(Ea===0&&(Ea=wT()),Ea):(t=fe,t!==0||(t=window.event,t=t===void 0?16:MT(t.type)),t):1}function nn(t,e,n,r){if(50<Es)throw Es=0,rf=null,Error(G(185));sl(t,n,r),(!(le&2)||t!==We)&&(t===We&&(!(le&2)&&(Mu|=n),$e===4&&Jn(t,je)),Pt(t,r),n===1&&le===0&&!(e.mode&1)&&(so=be()+500,Ru&&Ir()))}function Pt(t,e){var n=t.callbackNode;B0(t,e);var r=ba(t,t===We?je:0);if(r===0)n!==null&&jm(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&jm(n),e===1)t.tag===0?bA(Hg.bind(null,t)):YT(Hg.bind(null,t)),VA(function(){!(le&6)&&Ir()}),n=null;else{switch(ST(r)){case 1:n=rh;break;case 4:n=IT;break;case 16:n=Ua;break;case 536870912:n=CT;break;default:n=Ua}n=JE(n,qE.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function qE(t,e){if(Ta=-1,Ea=0,le&6)throw Error(G(327));var n=t.callbackNode;if(Qi()&&t.callbackNode!==n)return null;var r=ba(t,t===We?je:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=nu(t,r);else{e=r;var i=le;le|=2;var o=$E();(We!==t||je!==e)&&(Cn=null,so=be()+500,qr(t,e));do try{oR();break}catch(u){GE(t,u)}while(!0);gh(),ja.current=o,le=i,Oe!==null?e=0:(We=null,je=0,e=$e)}if(e!==0){if(e===2&&(i=Dd(t),i!==0&&(r=i,e=of(t,i))),e===1)throw n=Hs,qr(t,0),Jn(t,r),Pt(t,be()),n;if(e===6)Jn(t,r);else{if(i=t.current.alternate,!(r&30)&&!rR(i)&&(e=nu(t,r),e===2&&(o=Dd(t),o!==0&&(r=o,e=of(t,o))),e===1))throw n=Hs,qr(t,0),Jn(t,r),Pt(t,be()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:Mr(t,Ct,Cn);break;case 3:if(Jn(t,r),(r&130023424)===r&&(e=Mh+500-be(),10<e)){if(ba(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){yt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=bd(Mr.bind(null,t,Ct,Cn),e);break}Mr(t,Ct,Cn);break;case 4:if(Jn(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var s=31-tn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=be()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nR(r/1960))-r,10<r){t.timeoutHandle=bd(Mr.bind(null,t,Ct,Cn),r);break}Mr(t,Ct,Cn);break;case 5:Mr(t,Ct,Cn);break;default:throw Error(G(329))}}}return Pt(t,be()),t.callbackNode===n?qE.bind(null,t):null}function of(t,e){var n=Ts;return t.current.memoizedState.isDehydrated&&(qr(t,e).flags|=256),t=nu(t,e),t!==2&&(e=Ct,Ct=n,e!==null&&sf(e)),t}function sf(t){Ct===null?Ct=t:Ct.push.apply(Ct,t)}function rR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!rn(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jn(t,e){for(e&=~Dh,e&=~Mu,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-tn(e),r=1<<n;t[n]=-1,e&=~r}}function Hg(t){if(le&6)throw Error(G(327));Qi();var e=ba(t,0);if(!(e&1))return Pt(t,be()),null;var n=nu(t,e);if(t.tag!==0&&n===2){var r=Dd(t);r!==0&&(e=r,n=of(t,r))}if(n===1)throw n=Hs,qr(t,0),Jn(t,e),Pt(t,be()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Mr(t,Ct,Cn),Pt(t,be()),null}function kh(t,e){var n=le;le|=1;try{return t(e)}finally{le=n,le===0&&(so=be()+500,Ru&&Ir())}}function Yr(t){Zn!==null&&Zn.tag===0&&!(le&6)&&Qi();var e=le;le|=1;var n=Ht.transition,r=fe;try{if(Ht.transition=null,fe=1,t)return t()}finally{fe=r,Ht.transition=n,le=e,!(le&6)&&Ir()}}function Nh(){Mt=Gi.current,Ee(Gi)}function qr(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NA(n)),Oe!==null)for(n=Oe.return;n!==null;){var r=n;switch(hh(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&$a();break;case 3:io(),Ee(At),Ee(ct),Ih();break;case 5:Eh(r);break;case 4:io();break;case 13:Ee(Re);break;case 19:Ee(Re);break;case 10:yh(r.type._context);break;case 22:case 23:Nh()}n=n.return}if(We=t,Oe=t=ar(t.current,null),je=Mt=e,$e=0,Hs=null,Dh=Mu=Qr=0,Ct=Ts=null,Br!==null){for(e=0;e<Br.length;e++)if(n=Br[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}n.pending=r}Br=null}return t}function GE(t,e){do{var n=Oe;try{if(gh(),ya.current=Za,Xa){for(var r=xe.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Xa=!1}if(Jr=0,Ke=Ge=xe=null,_s=!1,Gs=0,xh.current=null,n===null||n.return===null){$e=1,Hs=e,Oe=null;break}e:{var o=t,s=n.return,u=n,c=e;if(e=je,u.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=u,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var _=kg(s);if(_!==null){_.flags&=-257,Ng(_,s,u,o,e),_.mode&1&&Mg(o,d,e),e=_,c=d;var S=e.updateQueue;if(S===null){var P=new Set;P.add(c),e.updateQueue=P}else S.add(c);break e}else{if(!(e&1)){Mg(o,d,e),Vh();break e}c=Error(G(426))}}else if(Ce&&u.mode&1){var k=kg(s);if(k!==null){!(k.flags&65536)&&(k.flags|=256),Ng(k,s,u,o,e),ph(oo(c,u));break e}}o=c=oo(c,u),$e!==4&&($e=2),Ts===null?Ts=[o]:Ts.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var C=SE(o,c,e);Sg(o,C);break e;case 1:u=c;var T=o.type,I=o.stateNode;if(!(o.flags&128)&&(typeof T.getDerivedStateFromError=="function"||I!==null&&typeof I.componentDidCatch=="function"&&(sr===null||!sr.has(I)))){o.flags|=65536,e&=-e,o.lanes|=e;var M=AE(o,u,e);Sg(o,M);break e}}o=o.return}while(o!==null)}HE(n)}catch(F){e=F,Oe===n&&n!==null&&(Oe=n=n.return);continue}break}while(!0)}function $E(){var t=ja.current;return ja.current=Za,t===null?Za:t}function Vh(){($e===0||$e===3||$e===2)&&($e=4),We===null||!(Qr&268435455)&&!(Mu&268435455)||Jn(We,je)}function nu(t,e){var n=le;le|=2;var r=$E();(We!==t||je!==e)&&(Cn=null,qr(t,e));do try{iR();break}catch(i){GE(t,i)}while(!0);if(gh(),le=n,ja.current=r,Oe!==null)throw Error(G(261));return We=null,je=0,$e}function iR(){for(;Oe!==null;)zE(Oe)}function oR(){for(;Oe!==null&&!D0();)zE(Oe)}function zE(t){var e=WE(t.alternate,t,Mt);t.memoizedProps=t.pendingProps,e===null?HE(t):Oe=e,xh.current=null}function HE(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=ZA(n,e),n!==null){n.flags&=32767,Oe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{$e=6,Oe=null;return}}else if(n=XA(n,e,Mt),n!==null){Oe=n;return}if(e=e.sibling,e!==null){Oe=e;return}Oe=e=t}while(e!==null);$e===0&&($e=5)}function Mr(t,e,n){var r=fe,i=Ht.transition;try{Ht.transition=null,fe=1,sR(t,e,n,r)}finally{Ht.transition=i,fe=r}return null}function sR(t,e,n,r){do Qi();while(Zn!==null);if(le&6)throw Error(G(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(O0(t,o),t===We&&(Oe=We=null,je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Zl||(Zl=!0,JE(Ua,function(){return Qi(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Ht.transition,Ht.transition=null;var s=fe;fe=1;var u=le;le|=4,xh.current=null,eR(t,n),BE(n,t),AA(Fd),Ba=!!Ld,Fd=Ld=null,t.current=n,tR(n),M0(),le=u,fe=s,Ht.transition=o}else t.current=n;if(Zl&&(Zl=!1,Zn=t,tu=i),o=t.pendingLanes,o===0&&(sr=null),V0(n.stateNode),Pt(t,be()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(eu)throw eu=!1,t=nf,nf=null,t;return tu&1&&t.tag!==0&&Qi(),o=t.pendingLanes,o&1?t===rf?Es++:(Es=0,rf=t):Es=0,Ir(),null}function Qi(){if(Zn!==null){var t=ST(tu),e=Ht.transition,n=fe;try{if(Ht.transition=null,fe=16>t?16:t,Zn===null)var r=!1;else{if(t=Zn,Zn=null,tu=0,le&6)throw Error(G(331));var i=le;for(le|=4,W=t.current;W!==null;){var o=W,s=o.child;if(W.flags&16){var u=o.deletions;if(u!==null){for(var c=0;c<u.length;c++){var d=u[c];for(W=d;W!==null;){var h=W;switch(h.tag){case 0:case 11:case 15:vs(8,h,o)}var p=h.child;if(p!==null)p.return=h,W=p;else for(;W!==null;){h=W;var m=h.sibling,_=h.return;if(FE(h),h===d){W=null;break}if(m!==null){m.return=_,W=m;break}W=_}}}var S=o.alternate;if(S!==null){var P=S.child;if(P!==null){S.child=null;do{var k=P.sibling;P.sibling=null,P=k}while(P!==null)}}W=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,W=s;else e:for(;W!==null;){if(o=W,o.flags&2048)switch(o.tag){case 0:case 11:case 15:vs(9,o,o.return)}var C=o.sibling;if(C!==null){C.return=o.return,W=C;break e}W=o.return}}var T=t.current;for(W=T;W!==null;){s=W;var I=s.child;if(s.subtreeFlags&2064&&I!==null)I.return=s,W=I;else e:for(s=T;W!==null;){if(u=W,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Du(9,u)}}catch(F){Ne(u,u.return,F)}if(u===s){W=null;break e}var M=u.sibling;if(M!==null){M.return=u.return,W=M;break e}W=u.return}}if(le=i,Ir(),fn&&typeof fn.onPostCommitFiberRoot=="function")try{fn.onPostCommitFiberRoot(Iu,t)}catch{}r=!0}return r}finally{fe=n,Ht.transition=e}}return!1}function Kg(t,e,n){e=oo(n,e),e=SE(t,e,1),t=or(t,e,1),e=yt(),t!==null&&(sl(t,1,e),Pt(t,e))}function Ne(t,e,n){if(t.tag===3)Kg(t,t,n);else for(;e!==null;){if(e.tag===3){Kg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sr===null||!sr.has(r))){t=oo(n,t),t=AE(e,t,1),e=or(e,t,1),t=yt(),e!==null&&(sl(e,1,t),Pt(e,t));break}}e=e.return}}function lR(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=yt(),t.pingedLanes|=t.suspendedLanes&n,We===t&&(je&n)===n&&($e===4||$e===3&&(je&130023424)===je&&500>be()-Mh?qr(t,0):Dh|=n),Pt(t,e)}function KE(t,e){e===0&&(t.mode&1?(e=Gl,Gl<<=1,!(Gl&130023424)&&(Gl=4194304)):e=1);var n=yt();t=kn(t,e),t!==null&&(sl(t,e,n),Pt(t,n))}function aR(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KE(t,n)}function uR(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),KE(t,n)}var WE;WE=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||At.current)wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wt=!1,YA(t,e,n);wt=!!(t.flags&131072)}else wt=!1,Ce&&e.flags&1048576&&XT(e,Ka,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;va(t,e),t=e.pendingProps;var i=to(e,ct.current);Ji(e,n),i=wh(null,e,r,t,i,n);var o=Sh();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Rt(r)?(o=!0,za(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,vh(e),i.updater=xu,e.stateNode=i,i._reactInternals=e,Hd(e,r,t,n),e=Jd(null,e,r,!0,o,n)):(e.tag=0,Ce&&o&&fh(e),pt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(va(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=dR(r),t=Zt(r,t),i){case 0:e=Wd(null,e,r,t,n);break e;case 1:e=Fg(null,e,r,t,n);break e;case 11:e=Vg(null,e,r,t,n);break e;case 14:e=Lg(null,e,r,Zt(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zt(r,i),Wd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zt(r,i),Fg(t,e,r,i,n);case 3:e:{if(DE(e),t===null)throw Error(G(387));r=e.pendingProps,o=e.memoizedState,i=o.element,rE(t,e),Qa(e,r,null,n);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=oo(Error(G(423)),e),e=Ug(t,e,r,n,i);break e}else if(r!==i){i=oo(Error(G(424)),e),e=Ug(t,e,r,n,i);break e}else for(kt=ir(e.stateNode.containerInfo.firstChild),Lt=e,Ce=!0,en=null,n=tE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(no(),r===i){e=Nn(t,e,n);break e}pt(t,e,r,n)}e=e.child}return e;case 5:return iE(e),t===null&&Gd(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,s=i.children,Ud(r,i)?s=null:o!==null&&Ud(r,o)&&(e.flags|=32),xE(t,e),pt(t,e,s,n),e.child;case 6:return t===null&&Gd(e),null;case 13:return ME(t,e,n);case 4:return Th(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ro(e,null,r,n):pt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zt(r,i),Vg(t,e,r,i,n);case 7:return pt(t,e,e.pendingProps,n),e.child;case 8:return pt(t,e,e.pendingProps.children,n),e.child;case 12:return pt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,ye(Wa,r._currentValue),r._currentValue=s,o!==null)if(rn(o.value,s)){if(o.children===i.children&&!At.current){e=Nn(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){s=o.child;for(var c=u.firstContext;c!==null;){if(c.context===r){if(o.tag===1){c=Pn(-1,n&-n),c.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),$d(o.return,n,e),u.lanes|=n;break}c=c.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(G(341));s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),$d(s,n,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}pt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Ji(e,n),i=Jt(i),r=r(i),e.flags|=1,pt(t,e,r,n),e.child;case 14:return r=e.type,i=Zt(r,e.pendingProps),i=Zt(r.type,i),Lg(t,e,r,i,n);case 15:return RE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Zt(r,i),va(t,e),e.tag=1,Rt(r)?(t=!0,za(e)):t=!1,Ji(e,n),wE(e,r,i),Hd(e,r,i,n),Jd(null,e,r,!0,t,n);case 19:return kE(t,e,n);case 22:return PE(t,e,n)}throw Error(G(156,e.tag))};function JE(t,e){return ET(t,e)}function cR(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $t(t,e,n,r){return new cR(t,e,n,r)}function Lh(t){return t=t.prototype,!(!t||!t.isReactComponent)}function dR(t){if(typeof t=="function")return Lh(t)?1:0;if(t!=null){if(t=t.$$typeof,t===eh)return 11;if(t===th)return 14}return 2}function ar(t,e){var n=t.alternate;return n===null?(n=$t(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Ia(t,e,n,r,i,o){var s=2;if(r=t,typeof t=="function")Lh(t)&&(s=1);else if(typeof t=="string")s=5;else e:switch(t){case ki:return Gr(n.children,i,o,e);case jf:s=8,i|=8;break;case md:return t=$t(12,n,e,i|2),t.elementType=md,t.lanes=o,t;case gd:return t=$t(13,n,e,i),t.elementType=gd,t.lanes=o,t;case yd:return t=$t(19,n,e,i),t.elementType=yd,t.lanes=o,t;case iT:return ku(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case nT:s=10;break e;case rT:s=9;break e;case eh:s=11;break e;case th:s=14;break e;case Hn:s=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=$t(s,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function Gr(t,e,n,r){return t=$t(7,t,r,e),t.lanes=n,t}function ku(t,e,n,r){return t=$t(22,t,r,e),t.elementType=iT,t.lanes=n,t.stateNode={isHidden:!1},t}function Zc(t,e,n){return t=$t(6,t,null,e),t.lanes=n,t}function jc(t,e,n){return e=$t(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function fR(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Nc(0),this.expirationTimes=Nc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Nc(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fh(t,e,n,r,i,o,s,u,c){return t=new fR(t,e,n,u,c),e===1?(e=1,o===!0&&(e|=8)):e=0,o=$t(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vh(o),t}function hR(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function QE(t){if(!t)return mr;t=t._reactInternals;e:{if(ai(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Rt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(Rt(n))return QT(t,n,e)}return e}function YE(t,e,n,r,i,o,s,u,c){return t=Fh(n,r,!0,t,i,o,s,u,c),t.context=QE(null),n=t.current,r=yt(),i=lr(n),o=Pn(r,i),o.callback=e??null,or(n,o,i),t.current.lanes=i,sl(t,i,r),Pt(t,r),t}function Nu(t,e,n,r){var i=e.current,o=yt(),s=lr(i);return n=QE(n),e.context===null?e.context=n:e.pendingContext=n,e=Pn(o,s),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=or(i,e,s),t!==null&&(nn(t,i,s,o),ga(t,i,s)),s}function ru(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Uh(t,e){Wg(t,e),(t=t.alternate)&&Wg(t,e)}function pR(){return null}var XE=typeof reportError=="function"?reportError:function(t){console.error(t)};function bh(t){this._internalRoot=t}Vu.prototype.render=bh.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Nu(t,e,null,null)};Vu.prototype.unmount=bh.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Yr(function(){Nu(null,t,null,null)}),e[Mn]=null}};function Vu(t){this._internalRoot=t}Vu.prototype.unstable_scheduleHydration=function(t){if(t){var e=PT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Wn.length&&e!==0&&e<Wn[n].priority;n++);Wn.splice(n,0,t),n===0&&DT(t)}};function Bh(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Lu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Jg(){}function mR(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var d=ru(s);o.call(d)}}var s=YE(e,r,t,0,null,!1,!1,"",Jg);return t._reactRootContainer=s,t[Mn]=s.current,Us(t.nodeType===8?t.parentNode:t),Yr(),s}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var d=ru(c);u.call(d)}}var c=Fh(t,0,!1,null,null,!1,!1,"",Jg);return t._reactRootContainer=c,t[Mn]=c.current,Us(t.nodeType===8?t.parentNode:t),Yr(function(){Nu(e,c,n,r)}),c}function Fu(t,e,n,r,i){var o=n._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var u=i;i=function(){var c=ru(s);u.call(c)}}Nu(e,s,t,i)}else s=mR(n,e,t,i,r);return ru(s)}AT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ls(e.pendingLanes);n!==0&&(ih(e,n|1),Pt(e,be()),!(le&6)&&(so=be()+500,Ir()))}break;case 13:Yr(function(){var r=kn(t,1);if(r!==null){var i=yt();nn(r,t,1,i)}}),Uh(t,1)}};oh=function(t){if(t.tag===13){var e=kn(t,134217728);if(e!==null){var n=yt();nn(e,t,134217728,n)}Uh(t,134217728)}};RT=function(t){if(t.tag===13){var e=lr(t),n=kn(t,e);if(n!==null){var r=yt();nn(n,t,e,r)}Uh(t,e)}};PT=function(){return fe};xT=function(t,e){var n=fe;try{return fe=t,e()}finally{fe=n}};Rd=function(t,e,n){switch(e){case"input":if(Td(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Au(r);if(!i)throw Error(G(90));sT(r),Td(r,i)}}}break;case"textarea":aT(t,n);break;case"select":e=n.value,e!=null&&zi(t,!!n.multiple,e,!1)}};mT=kh;gT=Yr;var gR={usingClientEntryPoint:!1,Events:[al,Fi,Au,hT,pT,kh]},Xo={findFiberByHostInstance:br,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yR={bundleType:Xo.bundleType,version:Xo.version,rendererPackageName:Xo.rendererPackageName,rendererConfig:Xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Fn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=vT(t),t===null?null:t.stateNode},findFiberByHostInstance:Xo.findFiberByHostInstance||pR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jl.isDisabled&&jl.supportsFiber)try{Iu=jl.inject(yR),fn=jl}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gR;Bt.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Bh(e))throw Error(G(200));return hR(t,e,null,n)};Bt.createRoot=function(t,e){if(!Bh(t))throw Error(G(299));var n=!1,r="",i=XE;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Fh(t,1,!1,null,null,n,!1,r,i),t[Mn]=e.current,Us(t.nodeType===8?t.parentNode:t),new bh(e)};Bt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=vT(e),t=t===null?null:t.stateNode,t};Bt.flushSync=function(t){return Yr(t)};Bt.hydrate=function(t,e,n){if(!Lu(e))throw Error(G(200));return Fu(null,t,e,!0,n)};Bt.hydrateRoot=function(t,e,n){if(!Bh(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",s=XE;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),e=YE(e,null,t,1,n??null,i,!1,o,s),t[Mn]=e.current,Us(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Vu(e)};Bt.render=function(t,e,n){if(!Lu(e))throw Error(G(200));return Fu(null,t,e,!1,n)};Bt.unmountComponentAtNode=function(t){if(!Lu(t))throw Error(G(40));return t._reactRootContainer?(Yr(function(){Fu(null,null,t,!1,function(){t._reactRootContainer=null,t[Mn]=null})}),!0):!1};Bt.unstable_batchedUpdates=kh;Bt.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Lu(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Fu(t,e,n,!1,r)};Bt.version="18.3.1-next-f1338f8080-20240426";function ZE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ZE)}catch(t){console.error(t)}}ZE(),Zv.exports=Bt;var _R=Zv.exports,Qg=_R;hd.createRoot=Qg.createRoot,hd.hydrateRoot=Qg.hydrateRoot;const vR=({onAddPhotoClick:t,searchTerm:e,onSearchChange:n,isGridEmpty:r,onToggleFavorites:i,showFavorites:o})=>O.jsx("header",{className:"sticky top-0 z-20 p-4 bg-primary-bg/80 backdrop-blur-lg border-b border-accent-soft/50",children:O.jsxs("div",{className:"container mx-auto flex justify-between items-center gap-2 sm:gap-4",children:[O.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-7 w-7 text-accent",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z",clipRule:"evenodd"})}),O.jsx("h1",{className:"text-xl font-semibold text-primary-text hidden md:block",children:"Our Photo Diary"})]}),O.jsx("div",{className:"flex-1 w-full max-w-lg",children:O.jsx("input",{type:"text",placeholder:"Search memories...",value:e,onChange:s=>n(s.target.value),className:"w-full px-5 py-2 bg-secondary-bg/70 border border-accent-soft/60 rounded-full text-primary-text placeholder-secondary-text focus:outline-none focus:ring-2 focus:ring-accent transition-all duration-300 shadow-inner shadow-accent-soft/20 text-sm"})}),O.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[O.jsx("button",{onClick:i,className:`w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 group ${o?"bg-accent/20":"hover:bg-accent/10"}`,"aria-label":"Show favorites",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transition-all duration-300 ${o?"text-accent":"text-accent/70 group-hover:text-accent"}`,viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"})})}),O.jsx("button",{onClick:t,className:`bg-accent hover:bg-accent-hover text-white font-bold w-10 h-10 rounded-full flex items-center justify-center transition-all duration-300 shadow-lg shadow-accent/30 hover:shadow-accent/50 transform hover:scale-110 shrink-0 ${r?"animate-soft-pulse":""}`,"aria-label":"Add new memory",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z",clipRule:"evenodd"})})})]})]})}),TR=({photo:t,onDelete:e,onFavorite:n,onClick:r,index:i})=>{const o=c=>{c.preventDefault(),c.stopPropagation(),window.confirm("Are you sure you want to delete this memory? This action cannot be undone.")&&e(t)},s=c=>{c.preventDefault(),c.stopPropagation(),n(t)},u=c=>{if(!c||!c.toDate)return"Just now";const d=c.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(d)};return O.jsxs("div",{className:"relative group overflow-hidden rounded-xl mb-4 break-inside-avoid shadow-gentle hover:shadow-gentle-lg transition-all duration-300 bg-secondary-bg cursor-pointer opacity-0 animate-fade-in-up",onClick:()=>r(t),style:{animationDelay:`${i*50}ms`},children:[O.jsx("img",{src:t.imageUrl,alt:t.description||"Photo diary entry",className:"w-full h-auto object-cover transition-transform duration-300 group-hover:scale-105",loading:"lazy"}),O.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),O.jsxs("div",{className:"absolute bottom-0 left-0 p-4 w-full text-white transform translate-y-4 group-hover:translate-y-0 transition-transform duration-300",children:[O.jsx("p",{className:"text-sm font-semibold opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-100",children:t.description}),O.jsx("p",{className:"text-xs mt-1 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-200",children:u(t.createdAt)}),t.tags&&t.tags.length>0&&O.jsx("div",{className:"flex flex-wrap gap-1 mt-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300 delay-300",children:t.tags.map(c=>O.jsx("span",{className:"text-xs bg-white/20 backdrop-blur-sm px-2 py-0.5 rounded-full",children:c},c))})]}),O.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-10",children:[O.jsx("button",{onClick:s,"aria-label":"Favorite photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-colors duration-200",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",className:`transition-opacity ${t.isFavorite?"opacity-100 text-accent":"opacity-60"}`,clipRule:"evenodd"})})}),O.jsx("button",{onClick:o,"aria-label":"Delete photo",className:"p-1.5 bg-white/40 backdrop-blur-sm rounded-full text-primary-text hover:text-white hover:bg-red-500 focus:outline-none transition-colors duration-200",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})},lf=()=>O.jsxs("div",{className:"flex justify-center items-center h-full",children:[O.jsx("svg",{className:"h-10 w-10 text-accent",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",style:{animation:"pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite"},children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),O.jsx("style",{children:`
          @keyframes pulse {
            0%, 100% {
              opacity: 1;
              transform: scale(1);
            }
            50% {
              opacity: 0.7;
              transform: scale(0.9);
            }
          }
        `})]}),ER=t=>{const e=new Date(t),n=e.getTimezoneOffset()*6e4,r=new Date(e.getTime()+n);return new Intl.DateTimeFormat("en-US",{dateStyle:"full"}).format(r)},IR=({photos:t,loading:e,error:n,onDeletePhoto:r,onFavoritePhoto:i,onPhotoClick:o})=>{if(e)return O.jsx("div",{className:"mt-20",children:O.jsx(lf,{})});if(n)return O.jsxs("div",{className:"text-center text-red-800 bg-red-100 border border-red-300 p-6 rounded-xl mt-10 max-w-2xl mx-auto shadow-gentle",children:[O.jsx("p",{className:"font-bold text-xl text-red-900",children:"Oh no, something went wrong!"}),O.jsx("p",{className:"text-sm mt-2",children:n})]});if(t.length===0)return O.jsxs("div",{className:"text-center text-secondary-text mt-20 bg-secondary-bg/50 p-10 rounded-xl max-w-md mx-auto border border-accent-soft/40 shadow-gentle flex flex-col items-center",children:[O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-20 w-20 text-accent-soft mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1,children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),O.jsx("h2",{className:"text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400",children:"No Memories Found"}),O.jsx("p",{className:"mt-2",children:"Try a different search, or click the '+' to add a photo."})]});const s=t.reduce((d,h)=>{if(!h.createdAt||!h.createdAt.toDate)return d;const p=h.createdAt.toDate().toLocaleDateString("en-CA");return d[p]||(d[p]=[]),d[p].push(h),d},{}),u=Object.keys(s).sort((d,h)=>new Date(h).getTime()-new Date(d).getTime());let c=0;return O.jsx("div",{className:"w-full mx-auto space-y-12",children:u.map(d=>O.jsxs("section",{children:[O.jsx("h2",{className:"text-xl font-semibold text-primary-text pb-2 mb-6 border-b border-accent-soft",children:ER(d)}),O.jsx("div",{className:"columns-2 sm:columns-3 md:columns-4 lg:columns-5 gap-4 md:gap-6",children:s[d].map(h=>O.jsx(TR,{photo:h,onDelete:r,onFavorite:i,onClick:o,index:c++},h.id))})]},d))})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let CR,wR;function SR(){return{geminiUrl:CR,vertexUrl:wR}}function AR(t,e,n,r){var i,o;if(!(t!=null&&t.baseUrl)){const s=SR();return e?(i=s.vertexUrl)!==null&&i!==void 0?i:n:(o=s.geminiUrl)!==null&&o!==void 0?o:r}return t.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ui{}function J(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i];return o!=null?String(o):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function a(t,e,n){for(let o=0;o<e.length-1;o++){const s=e[o];if(s.endsWith("[]")){const u=s.slice(0,-2);if(!(u in t))if(Array.isArray(n))t[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${s}`);if(Array.isArray(t[u])){const c=t[u];if(Array.isArray(n))for(let d=0;d<c.length;d++){const h=c[d];a(h,e.slice(o+1),n[d])}else for(const d of c)a(d,e.slice(o+1),n)}return}else if(s.endsWith("[0]")){const u=s.slice(0,-3);u in t||(t[u]=[{}]);const c=t[u];a(c[0],e.slice(o+1),n);return}(!t[s]||typeof t[s]!="object")&&(t[s]={}),t=t[s]}const r=e[e.length-1],i=t[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else r==="_self"&&typeof n=="object"&&n!==null&&!Array.isArray(n)?Object.assign(t,n):t[r]=n}function l(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in t){const o=t[i];return Array.isArray(o)?o.map(s=>l(s,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Oh(t){if(typeof t!="string")throw new Error("fromImageBytes must be a string");return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RR(t){const e={},n=l(t,["operationName"]);n!=null&&a(e,["operationName"],n);const r=l(t,["resourceName"]);return r!=null&&a(e,["_url","resourceName"],r),e}function PR(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&a(e,["response"],DR(s)),e}function xR(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response"]);return s!=null&&a(e,["response"],MR(s)),e}function DR(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>kR(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function MR(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>NR(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function kR(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],FR(n)),e}function NR(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],UR(n)),e}function VR(t){const e={},n=l(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function LR(t){const e={},n=l(t,["operationName"]);return n!=null&&a(e,["_url","operationName"],n),e}function FR(t){const e={},n=l(t,["video","uri"]);n!=null&&a(e,["uri"],n);const r=l(t,["video","encodedVideo"]);r!=null&&a(e,["videoBytes"],Oh(r));const i=l(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function UR(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["videoBytes"],Oh(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Yg;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Yg||(Yg={}));var Xg;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Xg||(Xg={}));var jn;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT",t.NULL="NULL"})(jn||(jn={}));var Zg;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",t.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",t.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",t.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",t.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Zg||(Zg={}));var jg;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(jg||(jg={}));var ey;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(ey||(ey={}));var ty;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(ty||(ty={}));var ny;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(ny||(ny={}));var ry;(function(t){t.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",t.SIMPLE_SEARCH="SIMPLE_SEARCH",t.ELASTIC_SEARCH="ELASTIC_SEARCH"})(ry||(ry={}));var iy;(function(t){t.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",t.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",t.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",t.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",t.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(iy||(iy={}));var oy;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY",t.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(oy||(oy={}));var sy;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(sy||(sy={}));var ly;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(ly||(ly={}));var ay;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.IMAGE_SAFETY="IMAGE_SAFETY"})(ay||(ay={}));var uy;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(uy||(uy={}));var iu;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(iu||(iu={}));var cy;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(cy||(cy={}));var af;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(af||(af={}));var dy;(function(t){t.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",t.TUNING_MODE_FULL="TUNING_MODE_FULL",t.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(dy||(dy={}));var fy;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(fy||(fy={}));var hy;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(hy||(hy={}));var py;(function(t){t.UNSPECIFIED="UNSPECIFIED",t.BLOCKING="BLOCKING",t.NON_BLOCKING="NON_BLOCKING"})(py||(py={}));var my;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(my||(my={}));var gy;(function(t){t.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",t.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(gy||(gy={}));var yy;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE",t.VALIDATED="VALIDATED"})(yy||(yy={}));var _y;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(_y||(_y={}));var vy;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(vy||(vy={}));var Ty;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi",t.zh="zh",t.pt="pt",t.es="es"})(Ty||(Ty={}));var Ey;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Ey||(Ey={}));var Iy;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Iy||(Iy={}));var Cy;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Cy||(Cy={}));var wy;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(wy||(wy={}));var Sy;(function(t){t.FOREGROUND="FOREGROUND",t.BACKGROUND="BACKGROUND",t.PROMPT="PROMPT",t.SEMANTIC="SEMANTIC",t.INTERACTIVE="INTERACTIVE"})(Sy||(Sy={}));var Ay;(function(t){t.ASSET="ASSET",t.STYLE="STYLE"})(Ay||(Ay={}));var Ry;(function(t){t.INSERT="INSERT",t.REMOVE="REMOVE",t.REMOVE_STATIC="REMOVE_STATIC",t.OUTPAINT="OUTPAINT"})(Ry||(Ry={}));var Py;(function(t){t.OPTIMIZED="OPTIMIZED",t.LOSSLESS="LOSSLESS"})(Py||(Py={}));var xy;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(xy||(xy={}));var Dy;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Dy||(Dy={}));var My;(function(t){t.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.RESPONSE_REJECTED="RESPONSE_REJECTED",t.NEED_MORE_INPUT="NEED_MORE_INPUT"})(My||(My={}));var ky;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(ky||(ky={}));var Ny;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Ny||(Ny={}));var Vy;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Vy||(Vy={}));var Ly;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Ly||(Ly={}));var Fy;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Fy||(Fy={}));var Uy;(function(t){t.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",t.SILENT="SILENT",t.WHEN_IDLE="WHEN_IDLE",t.INTERRUPT="INTERRUPT"})(Uy||(Uy={}));var by;(function(t){t.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",t.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",t.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",t.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",t.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",t.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",t.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",t.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",t.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",t.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",t.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",t.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",t.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(by||(by={}));var By;(function(t){t.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",t.QUALITY="QUALITY",t.DIVERSITY="DIVERSITY",t.VOCALIZATION="VOCALIZATION"})(By||(By={}));var $i;(function(t){t.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",t.PLAY="PLAY",t.PAUSE="PAUSE",t.STOP="STOP",t.RESET_CONTEXT="RESET_CONTEXT"})($i||($i={}));class uf{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class Zo{get text(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const m of(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[_,S]of Object.entries(m))_!=="text"&&_!=="thought"&&(S!==null||S!==void 0)&&p.push(_);if(typeof m.text=="string"){if(typeof m.thought=="boolean"&&m.thought)continue;h=!0,d+=m.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)!==null&&c!==void 0?c:[]){for(const[m,_]of Object.entries(p))m!=="inlineData"&&(_!==null||_!==void 0)&&h.push(m);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,n,r,i,o,s,u,c;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,n,r,i,o,s,u,c,d;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,n,r,i,o,s,u,c,d;if(((i=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(u=(s=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content)===null||u===void 0?void 0:u.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class Oy{}class qy{}class bR{}class BR{}class OR{}class qR{}class Gy{}class $y{}class zy{}class GR{}class ou{_fromAPIResponse({apiResponse:e,isVertexAI:n}){const r=new ou;let i;const o=e;return n?i=xR(o):i=PR(o),Object.assign(r,i),r}}class Hy{}class Ky{}class Wy{}class $R{}class zR{}class HR{}class Jy{}class KR{get text(){var e,n,r;let i="",o=!1;const s=[];for(const u of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(u))c!=="text"&&c!=="thought"&&d!==null&&s.push(c);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;o=!0,i+=u.text}}return s.length>0&&console.warn(`there are non-text parts ${s} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?i:void 0}get data(){var e,n,r;let i="";const o=[];for(const s of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,c]of Object.entries(s))u!=="inlineData"&&c!==null&&o.push(u);s.inlineData&&typeof s.inlineData.data=="string"&&(i+=atob(s.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class WR{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ue(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function jE(t,e){const n=ue(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function eI(t){return Array.isArray(t)?t.map(e=>su(e)):[su(t)]}function su(t){if(typeof t=="object"&&t!==null)return t;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof t}`)}function tI(t){const e=su(t);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function nI(t){const e=su(t);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function Qy(t){if(t==null)throw new Error("PartUnion is required");if(typeof t=="object")return t;if(typeof t=="string")return{text:t};throw new Error(`Unsupported part type: ${typeof t}`)}function rI(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("PartListUnion is required");return Array.isArray(t)?t.map(e=>Qy(e)):[Qy(t)]}function cf(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function Yy(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Xy(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ut(t){if(t==null)throw new Error("ContentUnion is required");return cf(t)?t:{role:"user",parts:rI(t)}}function qh(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ut(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ut(e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ut(n)):[ut(e)]}function Kt(t){if(t==null||Array.isArray(t)&&t.length===0)throw new Error("contents are required");if(!Array.isArray(t)){if(Yy(t)||Xy(t))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ut(t)]}const e=[],n=[],r=cf(t[0]);for(const i of t){const o=cf(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(i);else{if(Yy(i)||Xy(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||e.push({role:"user",parts:rI(n)}),e}function JR(t,e){t.includes("null")&&(e.nullable=!0);const n=t.filter(r=>r!=="null");if(n.length===1)e.type=Object.values(jn).includes(n[0].toUpperCase())?n[0].toUpperCase():jn.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of n)e.anyOf.push({type:Object.values(jn).includes(r.toUpperCase())?r.toUpperCase():jn.TYPE_UNSPECIFIED})}}function Yi(t){const e={},n=["items"],r=["anyOf"],i=["properties"];if(t.type&&t.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=t.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,t=o[1]):o[1].type==="null"&&(e.nullable=!0,t=o[0])),t.type instanceof Array&&JR(t.type,e);for(const[s,u]of Object.entries(t))if(u!=null)if(s=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;e.type=Object.values(jn).includes(u.toUpperCase())?u.toUpperCase():jn.TYPE_UNSPECIFIED}else if(n.includes(s))e[s]=Yi(u);else if(r.includes(s)){const c=[];for(const d of u){if(d.type=="null"){e.nullable=!0;continue}c.push(Yi(d))}e[s]=c}else if(i.includes(s)){const c={};for(const[d,h]of Object.entries(u))c[d]=Yi(h);e[s]=c}else{if(s==="additionalProperties")continue;e[s]=u}return e}function Gh(t){return Yi(t)}function $h(t){if(typeof t=="object")return t;if(typeof t=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:t}}};throw new Error(`Unsupported speechConfig type: ${typeof t}`)}function zh(t){if("multiSpeakerVoiceConfig"in t)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return t}function Io(t){if(t.functionDeclarations)for(const e of t.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Yi(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Yi(e.response));return t}function Co(t){if(t==null)throw new Error("tools is required");if(!Array.isArray(t))throw new Error("tools is required and must be an array of Tools");const e=[];for(const n of t)e.push(n);return e}function QR(t,e,n,r=1){const i=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:i?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:i?`${n}/${e}`:e}function Un(t,e){if(typeof e!="string")throw new Error("name must be a string");return QR(t,e,"cachedContents")}function iI(t){switch(t){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return t}}function ci(t){return Oh(t)}function YR(t){return t!=null&&typeof t=="object"&&"name"in t}function XR(t){return t!=null&&typeof t=="object"&&"video"in t}function ZR(t){return t!=null&&typeof t=="object"&&"uri"in t}function oI(t){var e;let n;if(YR(t)&&(n=t.name),!(ZR(t)&&(n=t.uri,n===void 0))&&!(XR(t)&&(n=(e=t.video)===null||e===void 0?void 0:e.uri,n===void 0))){if(typeof t=="string"&&(n=t),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function sI(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function lI(t){for(const e of["models","tunedModels","publisherModels"])if(jR(t,e))return t[e];return[]}function jR(t,e){return t!==null&&typeof t=="object"&&e in t}function eP(t,e={}){const n=t,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return n.outputSchema&&(r.responseJsonSchema=n.outputSchema),e.behavior&&(r.behavior=e.behavior),{functionDeclarations:[r]}}function tP(t,e={}){const n=[],r=new Set;for(const i of t){const o=i.name;if(r.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);r.add(o);const s=eP(i,e);s.functionDeclarations&&n.push(...s.functionDeclarations)}return{functionDeclarations:n}}function aI(t,e){let n;if(typeof e=="string")if(t.isVertexAI())if(e.startsWith("gs://"))n={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))n={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))n={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(t.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");n={inlinedRequests:e}}else n=e;const r=[n.gcsUri,n.bigqueryUri].filter(Boolean).length,i=[n.inlinedRequests,n.fileName].filter(Boolean).length;if(t.isVertexAI()){if(i>0||r!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(r>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return n}function nP(t){if(typeof t!="string")return t;const e=t;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function uI(t){if(typeof t!="object"||t===null)return{};const e=t,n=e.inlinedResponses;if(typeof n!="object"||n===null)return t;const i=n.inlinedResponses;if(!Array.isArray(i)||i.length===0)return t;let o=!1;for(const s of i){if(typeof s!="object"||s===null)continue;const c=s.response;if(typeof c!="object"||c===null)continue;if(c.embedding!==void 0){o=!0;break}}return o&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),t}function wo(t,e){const n=e;if(!t.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function cI(t){const e=t;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rP(t){const e={},n=l(t,["responsesFile"]);n!=null&&a(e,["fileName"],n);const r=l(t,["inlinedResponses","inlinedResponses"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>$P(s))),a(e,["inlinedResponses"],o)}const i=l(t,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>qP(s))),a(e,["inlinedEmbedContentResponses"],o)}return e}function iP(t){const e={},n=l(t,["predictionsFormat"]);n!=null&&a(e,["format"],n);const r=l(t,["gcsDestination","outputUriPrefix"]);r!=null&&a(e,["gcsUri"],r);const i=l(t,["bigqueryDestination","outputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function oP(t){const e={},n=l(t,["format"]);n!=null&&a(e,["predictionsFormat"],n);const r=l(t,["gcsUri"]);r!=null&&a(e,["gcsDestination","outputUriPrefix"],r);const i=l(t,["bigqueryUri"]);if(i!=null&&a(e,["bigqueryDestination","outputUri"],i),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(l(t,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Si(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata","displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["metadata","state"]);i!=null&&a(e,["state"],cI(i));const o=l(t,["metadata","createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["metadata","endTime"]);s!=null&&a(e,["endTime"],s);const u=l(t,["metadata","updateTime"]);u!=null&&a(e,["updateTime"],u);const c=l(t,["metadata","model"]);c!=null&&a(e,["model"],c);const d=l(t,["metadata","output"]);return d!=null&&a(e,["dest"],rP(uI(d))),e}function df(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],cI(i));const o=l(t,["error"]);o!=null&&a(e,["error"],fI(o));const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["startTime"]);u!=null&&a(e,["startTime"],u);const c=l(t,["endTime"]);c!=null&&a(e,["endTime"],c);const d=l(t,["updateTime"]);d!=null&&a(e,["updateTime"],d);const h=l(t,["model"]);h!=null&&a(e,["model"],h);const p=l(t,["inputConfig"]);p!=null&&a(e,["src"],sP(p));const m=l(t,["outputConfig"]);return m!=null&&a(e,["dest"],iP(uI(m))),e}function sP(t){const e={},n=l(t,["instancesFormat"]);n!=null&&a(e,["format"],n);const r=l(t,["gcsSource","uris"]);r!=null&&a(e,["gcsUri"],r);const i=l(t,["bigquerySource","inputUri"]);return i!=null&&a(e,["bigqueryUri"],i),e}function lP(t,e){const n={};if(l(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(l(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=l(e,["fileName"]);r!=null&&a(n,["fileName"],r);const i=l(e,["inlinedRequests"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>GP(t,s))),a(n,["requests","requests"],o)}return n}function aP(t){const e={},n=l(t,["format"]);n!=null&&a(e,["instancesFormat"],n);const r=l(t,["gcsUri"]);r!=null&&a(e,["gcsSource","uris"],r);const i=l(t,["bigqueryUri"]);if(i!=null&&a(e,["bigquerySource","inputUri"],i),l(t,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(l(t,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function uP(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function cP(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function dP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function fP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function hP(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],gP(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],pP(r));const i=l(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],fx(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function pP(t){const e={},n=l(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function mP(t){const e={},n=l(t,["values"]);return n!=null&&a(e,["values"],n),e}function gP(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>jP(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function dI(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ex(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function yP(t,e){const n={},r=l(t,["displayName"]);if(e!==void 0&&r!=null&&a(e,["batch","displayName"],r),l(t,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function _P(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["dest"]);return e!==void 0&&i!=null&&a(e,["outputConfig"],oP(nP(i))),n}function ed(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["batch","inputConfig"],lP(t,aI(t,i)));const o=l(e,["config"]);return o!=null&&yP(o,n),n}function vP(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["inputConfig"],aP(aI(t,i)));const o=l(e,["config"]);return o!=null&&_P(o,n),n}function TP(t,e){const n={},r=l(t,["displayName"]);return e!==void 0&&r!=null&&a(e,["batch","displayName"],r),n}function td(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["src"]);i!=null&&a(n,["batch","inputConfig"],PP(t,i));const o=l(e,["config"]);return o!=null&&TP(o,n),n}function EP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function IP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function CP(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);return o!=null&&a(e,["error"],Hh(o)),e}function wP(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);return o!=null&&a(e,["error"],fI(o)),e}function SP(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function AP(t,e){const n={},r=l(e,["contents"]);r!=null&&a(n,["requests[]","request","content"],qh(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],RP(i,n)),n}function RP(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["requests[]","taskType"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&a(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function PP(t,e){const n={},r=l(e,["fileName"]);r!=null&&a(n,["file_name"],r);const i=l(e,["inlinedRequests"]);return i!=null&&a(n,["requests"],AP(t,i)),n}function xP(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function DP(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function MP(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function kP(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function NP(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function VP(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function LP(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],dI(ut(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const S=l(e,["frequencyPenalty"]);S!=null&&a(r,["frequencyPenalty"],S);const P=l(e,["seed"]);P!=null&&a(r,["seed"],P);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const C=l(e,["responseSchema"]);C!=null&&a(r,["responseSchema"],ix(Gh(C)));const T=l(e,["responseJsonSchema"]);if(T!=null&&a(r,["responseJsonSchema"],T),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let D=I;Array.isArray(D)&&(D=D.map(N=>rx(N))),a(n,["safetySettings"],D)}const M=l(e,["tools"]);if(n!==void 0&&M!=null){let D=Co(M);Array.isArray(D)&&(D=D.map(N=>dx(Io(N)))),a(n,["tools"],D)}const F=l(e,["toolConfig"]);if(n!==void 0&&F!=null&&a(n,["toolConfig"],cx(F)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const b=l(e,["cachedContent"]);n!==void 0&&b!=null&&a(n,["cachedContent"],Un(t,b));const A=l(e,["responseModalities"]);A!=null&&a(r,["responseModalities"],A);const v=l(e,["mediaResolution"]);v!=null&&a(r,["mediaResolution"],v);const w=l(e,["speechConfig"]);if(w!=null&&a(r,["speechConfig"],lx($h(w))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=l(e,["thinkingConfig"]);return R!=null&&a(r,["thinkingConfig"],ax(R)),r}function FP(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>hP(d))),a(e,["candidates"],c)}const i=l(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=l(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&a(e,["responseId"],s);const u=l(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function UP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function bP(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],wo(t,r)),n}function BP(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],SP(n)),e}function OP(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],zP(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function qP(t){const e={},n=l(t,["response"]);n!=null&&a(e,["response"],ox(n));const r=l(t,["error"]);return r!=null&&a(e,["error"],Hh(r)),e}function GP(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["request","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Kt(i);Array.isArray(s)&&(s=s.map(u=>dI(u))),a(n,["request","contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["request","generationConfig"],LP(t,o,n)),n}function $P(t){const e={},n=l(t,["response"]);n!=null&&a(e,["response"],FP(n));const r=l(t,["error"]);return r!=null&&a(e,["error"],Hh(r)),e}function zP(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Hh(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["code"]);r!=null&&a(e,["code"],r);const i=l(t,["message"]);return i!=null&&a(e,["message"],i),e}function fI(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["code"]);r!=null&&a(e,["code"],r);const i=l(t,["message"]);return i!=null&&a(e,["message"],i),e}function HP(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function KP(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);if(e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),l(t,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function WP(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function JP(t){const e={},n=l(t,["config"]);return n!=null&&KP(n,e),e}function QP(t){const e={},n=l(t,["config"]);return n!=null&&WP(n,e),e}function YP(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["operations"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Si(s))),a(e,["batchJobs"],o)}return e}function XP(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["batchPredictionJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>df(s))),a(e,["batchJobs"],o)}return e}function ZP(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sx(i))),a(e,["speakerVoiceConfigs"],r)}return e}function jP(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],mx(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],uP(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],xP(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],MP(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function ex(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],gx(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],cP(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],DP(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],kP(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function tx(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function nx(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],HP(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function rx(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&a(e,["category"],n);const r=l(t,["threshold"]);return r!=null&&a(e,["threshold"],r),e}function ix(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const S=l(t,["minLength"]);S!=null&&a(e,["minLength"],S);const P=l(t,["minProperties"]);P!=null&&a(e,["minProperties"],P);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const C=l(t,["nullable"]);C!=null&&a(e,["nullable"],C);const T=l(t,["pattern"]);T!=null&&a(e,["pattern"],T);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const M=l(t,["propertyOrdering"]);M!=null&&a(e,["propertyOrdering"],M);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const b=l(t,["title"]);b!=null&&a(e,["title"],b);const A=l(t,["type"]);return A!=null&&a(e,["type"],A),e}function ox(t){const e={},n=l(t,["embedding"]);n!=null&&a(e,["embedding"],mP(n));const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function sx(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],hI(r)),e}function lx(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],hI(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],ZP(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function ax(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function ux(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function cx(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],NP(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],nx(r)),e}function dx(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>VP(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],OP(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],BP(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],hx());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],ux(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function fx(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>px(i))),a(e,["urlMetadata"],r)}return e}function hx(){return{}}function px(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function mx(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function gx(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function hI(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],tx(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Xr;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Xr||(Xr={}));class cl{constructor(e,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,i)}init(e,n,r){var i,o;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let s={config:{}};!r||Object.keys(r).length===0?s={config:{}}:typeof r=="object"?s=Object.assign({},r):s=r,s.config&&(s.config.pageToken=n.nextPageToken),this.paramsInternal=s,this.pageInternalSize=(o=(i=s.config)===null||i===void 0?void 0:i.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yx extends ui{constructor(e){super(),this.apiClient=e,this.create=async n=>{var r,i;if(this.apiClient.isVertexAI())return n.config=this.formatDestination(n.src,n.config),this.createInternal(n);const o=n.src;if(!(Array.isArray(n.src)||o.inlinedRequests!==void 0))return this.createInternal(n);const u=this.createInlinedGenerateContentRequest(n),c=u.path,d=u.body,h=ed(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=n.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()).then(m=>Si(m))},this.createEmbeddings=async n=>{var r,i;if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");if(!(n.src.inlinedRequests!==void 0))return this.createEmbeddingsInternal(n);const u=this.createInlinedEmbedContentRequest(n),c=u.path,d=u.body,h=td(this.apiClient,n)._query||{};return this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=n.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=n.config)===null||i===void 0?void 0:i.abortSignal}).then(m=>m.json()).then(m=>Si(m))},this.list=async(n={})=>new cl(Xr.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}createInlinedGenerateContentRequest(e){const n=ed(this.apiClient,e),r=n._url,i=J("{model}:batchGenerateContent",r),u=n.batch.inputConfig.requests,c=u.requests,d=[];for(const h of c){const p=Object.assign({},h);if(p.systemInstruction){const m=p.systemInstruction;delete p.systemInstruction;const _=p.request;_.systemInstruction=m,p.request=_}d.push(p)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:i,body:n}}createInlinedEmbedContentRequest(e){const n=td(this.apiClient,e),r=n._url,i=J("{model}:asyncBatchEmbedContent",r),u=n.batch.inputConfig.requests,c=u.requests,d=[];delete u.config;for(const h of c){const p=Object.assign({},h),m=p.request;for(const _ in p)_!=="request"&&(m[_]=p[_],delete p[_]);d.push(p)}return u.requests=d,delete n.config,delete n._url,delete n._query,{path:i,body:n}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,n){const r=n?Object.assign({},n):{},i=Date.now().toString();if(r.displayName||(r.displayName=`genaiBatchJob_${i}`),r.dest===void 0){const o=this.getGcsUri(e),s=this.getBigqueryUri(e);if(o)o.endsWith(".jsonl")?r.dest=`${o.slice(0,-6)}/dest`:r.dest=`${o}_dest_${i}`;else if(s)r.dest=`${s}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return r}async createInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=vP(this.apiClient,e);return u=J("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>df(h))}else{const d=ed(this.apiClient,e);return u=J("{model}:batchGenerateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Si(h))}}async createEmbeddingsInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=td(this.apiClient,e);return o=J("{model}:asyncBatchEmbedContent",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>Si(c))}}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=bP(this.apiClient,e);return u=J("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>df(h))}else{const d=UP(this.apiClient,e);return u=J("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Si(h))}}async cancel(e){var n,r,i,o;let s="",u={};if(this.apiClient.isVertexAI()){const c=fP(this.apiClient,e);s=J("batchPredictionJobs/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=dP(this.apiClient,e);s=J("batches/{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=QP(e);return u=J("batchPredictionJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=XP(h),m=new Jy;return Object.assign(m,p),m})}else{const d=JP(e);return u=J("batches",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=YP(h),m=new Jy;return Object.assign(m,p),m})}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=IP(this.apiClient,e);return u=J("batchPredictionJobs/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>wP(h))}else{const d=EP(this.apiClient,e);return u=J("batches/{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>CP(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _x(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function vx(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],_x(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function Tx(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function Ex(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Ca(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["model"]);i!=null&&a(e,["model"],i);const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&a(e,["updateTime"],s);const u=l(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function wa(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["model"]);i!=null&&a(e,["model"],i);const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["updateTime"]);s!=null&&a(e,["updateTime"],s);const u=l(t,["expireTime"]);u!=null&&a(e,["expireTime"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function Zy(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>iD(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function jy(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>oD(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Ix(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const o=l(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let h=Kt(s);Array.isArray(h)&&(h=h.map(p=>Zy(p))),a(e,["contents"],h)}const u=l(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],Zy(ut(u)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>fD(p))),a(e,["tools"],h)}const d=l(t,["toolConfig"]);if(e!==void 0&&d!=null&&a(e,["toolConfig"],cD(d)),l(t,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Cx(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);e!==void 0&&i!=null&&a(e,["expireTime"],i);const o=l(t,["displayName"]);e!==void 0&&o!=null&&a(e,["displayName"],o);const s=l(t,["contents"]);if(e!==void 0&&s!=null){let p=Kt(s);Array.isArray(p)&&(p=p.map(m=>jy(m))),a(e,["contents"],p)}const u=l(t,["systemInstruction"]);e!==void 0&&u!=null&&a(e,["systemInstruction"],jy(ut(u)));const c=l(t,["tools"]);if(e!==void 0&&c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>hD(m))),a(e,["tools"],p)}const d=l(t,["toolConfig"]);e!==void 0&&d!=null&&a(e,["toolConfig"],dD(d));const h=l(t,["kmsKeyName"]);return e!==void 0&&h!=null&&a(e,["encryption_spec","kmsKeyName"],h),n}function wx(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],jE(t,r));const i=l(e,["config"]);return i!=null&&Ix(i,n),n}function Sx(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["model"],jE(t,r));const i=l(e,["config"]);return i!=null&&Cx(i,n),n}function Ax(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Un(t,r)),n}function Rx(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Un(t,r)),n}function Px(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function xx(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function Dx(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function Mx(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function kx(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function Nx(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function Vx(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Lx(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function Fx(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function Ux(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function bx(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function Bx(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function Ox(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function qx(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Un(t,r)),n}function Gx(t,e){const n={},r=l(e,["name"]);return r!=null&&a(n,["_url","name"],Un(t,r)),n}function $x(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],vx(n)),e}function zx(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Dx(n)),e}function Hx(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],Mx(n)),e}function Kx(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],Jx(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function Wx(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],Qx(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function Jx(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Qx(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function Yx(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function Xx(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function Zx(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function jx(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function eD(t){const e={},n=l(t,["config"]);return n!=null&&Zx(n,e),e}function tD(t){const e={},n=l(t,["config"]);return n!=null&&jx(n,e),e}function nD(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>Ca(s))),a(e,["cachedContents"],o)}return e}function rD(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["cachedContents"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>wa(s))),a(e,["cachedContents"],o)}return e}function iD(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],TD(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Tx(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],Nx(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],Lx(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function oD(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],ED(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Ex(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],Vx(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],Fx(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function sD(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],Yx(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function lD(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],Xx(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function aD(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function uD(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function cD(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],Ux(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],sD(r)),e}function dD(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],bx(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],lD(r)),e}function fD(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>Bx(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],Kx(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],zx(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],_D());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],aD(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function hD(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>Ox(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],Wx(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],Hx(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],kx(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],$x(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],vD());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],uD(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function pD(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function mD(t,e){const n={},r=l(t,["ttl"]);e!==void 0&&r!=null&&a(e,["ttl"],r);const i=l(t,["expireTime"]);return e!==void 0&&i!=null&&a(e,["expireTime"],i),n}function gD(t,e){const n={},r=l(e,["name"]);r!=null&&a(n,["_url","name"],Un(t,r));const i=l(e,["config"]);return i!=null&&pD(i,n),n}function yD(t,e){const n={},r=l(e,["name"]);r!=null&&a(n,["_url","name"],Un(t,r));const i=l(e,["config"]);return i!=null&&mD(i,n),n}function _D(){return{}}function vD(){return{}}function TD(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function ED(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ID extends ui{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cl(Xr.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Sx(this.apiClient,e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>wa(h))}else{const d=wx(this.apiClient,e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Ca(h))}}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Gx(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>wa(h))}else{const d=qx(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Ca(h))}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=Rx(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=xx(h),m=new Ky;return Object.assign(m,p),m})}else{const d=Ax(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=Px(h),m=new Ky;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=yD(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>wa(h))}else{const d=gD(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>Ca(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=tD(e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=rD(h),m=new Wy;return Object.assign(m,p),m})}else{const d=eD(e);return u=J("cachedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=nD(h),m=new Wy;return Object.assign(m,p),m})}}}function e_(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Te(t){return this instanceof Te?(this.v=t,this):new Te(t)}function Xi(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(_){return function(S){return Promise.resolve(S).then(_,p)}}function u(_,S){r[_]&&(i[_]=function(P){return new Promise(function(k,C){o.push([_,P,k,C])>1||c(_,P)})},S&&(i[_]=S(i[_])))}function c(_,S){try{d(r[_](S))}catch(P){m(o[0][3],P)}}function d(_){_.value instanceof Te?Promise.resolve(_.value.v).then(h,p):m(o[0][2],_)}function h(_){c("next",_)}function p(_){c("throw",_)}function m(_,S){_(S),o.shift(),o.length&&c(o[0][0],o[0][1])}}function Is(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof e_=="function"?e_(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(o){n[o]=t[o]&&function(s){return new Promise(function(u,c){s=t[o](s),i(u,c,s.done,s.value)})}}function i(o,s,u,c){Promise.resolve(c).then(function(d){o({value:d,done:u})},s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CD(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:pI(n)}function pI(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function wD(t){if(t.length!==0){for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function t_(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0;for(;r<n;)if(t[r].role==="user")e.push(t[r]),r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!pI(t[r])&&(o=!1),r++;o?e.push(...i):e.pop()}return e}class SD{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new AD(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class AD{constructor(e,n,r,i={},o=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=i,this.history=o,this.sendPromise=Promise.resolve(),wD(o)}async sendMessage(e){var n;await this.sendPromise;const r=ut(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var o,s,u;const c=await i,d=(s=(o=c.candidates)===null||o===void 0?void 0:o[0])===null||s===void 0?void 0:s.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let m=[];h!=null&&(m=(u=h.slice(p))!==null&&u!==void 0?u:[]);const _=d?[d]:[];this.recordHistory(r,_,m)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var n;await this.sendPromise;const r=ut(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const o=await i;return this.processStreamResponse(o,r)}getHistory(e=!1){const n=e?t_(this.history):this.history;return structuredClone(n)}processStreamResponse(e,n){var r,i;return Xi(this,arguments,function*(){var s,u,c,d;const h=[];try{for(var p=!0,m=Is(e),_;_=yield Te(m.next()),s=_.done,!s;p=!0){d=_.value,p=!1;const S=d;if(CD(S)){const P=(i=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;P!==void 0&&h.push(P)}yield yield Te(S)}}catch(S){u={error:S}}finally{try{!p&&!s&&(c=m.return)&&(yield Te(c.call(m)))}finally{if(u)throw u.error}}this.recordHistory(n,h)})}recordHistory(e,n,r){let i=[];n.length>0&&n.every(o=>o.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...t_(r)):this.history.push(e),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Uu extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Uu.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RD(t){const e={},n=l(t,["file"]);return n!=null&&a(e,["file"],ND(n)),e}function PD(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function xD(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","file"],oI(n)),e}function DD(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function ff(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=l(t,["sizeBytes"]);o!=null&&a(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["sha256Hash"]);d!=null&&a(e,["sha256Hash"],d);const h=l(t,["uri"]);h!=null&&a(e,["uri"],h);const p=l(t,["downloadUri"]);p!=null&&a(e,["downloadUri"],p);const m=l(t,["state"]);m!=null&&a(e,["state"],m);const _=l(t,["source"]);_!=null&&a(e,["source"],_);const S=l(t,["videoMetadata"]);S!=null&&a(e,["videoMetadata"],S);const P=l(t,["error"]);return P!=null&&a(e,["error"],MD(P)),e}function MD(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["message"]);r!=null&&a(e,["message"],r);const i=l(t,["code"]);return i!=null&&a(e,["code"],i),e}function kD(t){const e={},n=l(t,["details"]);n!=null&&a(e,["details"],n);const r=l(t,["message"]);r!=null&&a(e,["message"],r);const i=l(t,["code"]);return i!=null&&a(e,["code"],i),e}function ND(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["mimeType"]);i!=null&&a(e,["mimeType"],i);const o=l(t,["sizeBytes"]);o!=null&&a(e,["sizeBytes"],o);const s=l(t,["createTime"]);s!=null&&a(e,["createTime"],s);const u=l(t,["expirationTime"]);u!=null&&a(e,["expirationTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["sha256Hash"]);d!=null&&a(e,["sha256Hash"],d);const h=l(t,["uri"]);h!=null&&a(e,["uri"],h);const p=l(t,["downloadUri"]);p!=null&&a(e,["downloadUri"],p);const m=l(t,["state"]);m!=null&&a(e,["state"],m);const _=l(t,["source"]);_!=null&&a(e,["source"],_);const S=l(t,["videoMetadata"]);S!=null&&a(e,["videoMetadata"],S);const P=l(t,["error"]);return P!=null&&a(e,["error"],kD(P)),e}function VD(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","file"],oI(n)),e}function LD(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);return e!==void 0&&i!=null&&a(e,["_query","pageToken"],i),n}function FD(t){const e={},n=l(t,["config"]);return n!=null&&LD(n,e),e}function UD(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["files"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>ff(s))),a(e,["files"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class bD extends ui{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new cl(Xr.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>ff(n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=FD(e);return o=J("files",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=UD(c),h=new $R;return Object.assign(h,d),h})}}async createInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=RD(e);return o=J("upload/v1beta/files",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=PD(c),h=new zR;return Object.assign(h,d),h})}}async get(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=VD(e);return o=J("files/{file}",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>ff(c))}}async delete(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=xD(e);return o=J("files/{file}",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=DD(c),h=new HR;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BD(){return{}}function OD(){return{}}function qD(){return{}}function GD(){return{}}function $D(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function zD(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);r!=null&&a(e,["mimeType"],r);const i=l(t,["sourceMetadata"]);return i!=null&&a(e,["sourceMetadata"],VM(i)),e}function n_(){return{}}function r_(){return{}}function HD(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],$D(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function KD(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function WD(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function JD(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function QD(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function YD(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function XD(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function ZD(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ZM(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function jD(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>jM(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function eM(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>ek(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function tM(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>tk(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function nM(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],ck(r)),e}function rM(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],dk(r)),e}function iM(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function oM(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function sM(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function lM(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function aM(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function uM(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function cM(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function mI(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function gI(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function dM(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function fM(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function hM(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function pM(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function mM(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],HD(n)),e}function gM(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],iM(n)),e}function yM(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],oM(n)),e}function _M(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],TM(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function vM(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],EM(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function TM(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function EM(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function IM(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],hk(zh(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],eM(ut(_)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let F=Co(S);Array.isArray(F)&&(F=F.map(b=>yk(Io(b)))),a(e,["setup","tools"],F)}const P=l(t,["sessionResumption"]);e!==void 0&&P!=null&&a(e,["setup","sessionResumption"],ak(P));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],n_());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&a(e,["setup","outputAudioTranscription"],n_());const T=l(t,["realtimeInputConfig"]);e!==void 0&&T!=null&&a(e,["setup","realtimeInputConfig"],sk(T));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],nM(I));const M=l(t,["proactivity"]);return e!==void 0&&M!=null&&a(e,["setup","proactivity"],ik(M)),n}function CM(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],pk(zh(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],tM(ut(_)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let F=Co(S);Array.isArray(F)&&(F=F.map(b=>_k(Io(b)))),a(e,["setup","tools"],F)}const P=l(t,["sessionResumption"]);e!==void 0&&P!=null&&a(e,["setup","sessionResumption"],uk(P));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],r_());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&a(e,["setup","outputAudioTranscription"],r_());const T=l(t,["realtimeInputConfig"]);e!==void 0&&T!=null&&a(e,["setup","realtimeInputConfig"],lk(T));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],rM(I));const M=l(t,["proactivity"]);return e!==void 0&&M!=null&&a(e,["setup","proactivity"],ok(M)),n}function wM(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],IM(i,n)),n}function SM(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],CM(i,n)),n}function AM(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Dk(i))),a(e,["weightedPrompts"],r)}return e}function yI(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>EI(i))),a(e,["weightedPrompts"],r)}return e}function hf(t){const e={},n=l(t,["setup"]);n!=null&&a(e,["setup"],_I(n));const r=l(t,["clientContent"]);r!=null&&a(e,["clientContent"],yI(r));const i=l(t,["musicGenerationConfig"]);i!=null&&a(e,["musicGenerationConfig"],vI(i));const o=l(t,["playbackControl"]);return o!=null&&a(e,["playbackControl"],o),e}function _I(t){const e={},n=l(t,["model"]);return n!=null&&a(e,["model"],n),e}function RM(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["filteredReason"]);return r!=null&&a(e,["filteredReason"],r),e}function PM(t){const e={},n=l(t,["temperature"]);n!=null&&a(e,["temperature"],n);const r=l(t,["topK"]);r!=null&&a(e,["topK"],r);const i=l(t,["seed"]);i!=null&&a(e,["seed"],i);const o=l(t,["guidance"]);o!=null&&a(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&a(e,["bpm"],s);const u=l(t,["density"]);u!=null&&a(e,["density"],u);const c=l(t,["brightness"]);c!=null&&a(e,["brightness"],c);const d=l(t,["scale"]);d!=null&&a(e,["scale"],d);const h=l(t,["muteBass"]);h!=null&&a(e,["muteBass"],h);const p=l(t,["muteDrums"]);p!=null&&a(e,["muteDrums"],p);const m=l(t,["onlyBassAndDrums"]);m!=null&&a(e,["onlyBassAndDrums"],m);const _=l(t,["musicGenerationMode"]);return _!=null&&a(e,["musicGenerationMode"],_),e}function vI(t){const e={},n=l(t,["temperature"]);n!=null&&a(e,["temperature"],n);const r=l(t,["topK"]);r!=null&&a(e,["topK"],r);const i=l(t,["seed"]);i!=null&&a(e,["seed"],i);const o=l(t,["guidance"]);o!=null&&a(e,["guidance"],o);const s=l(t,["bpm"]);s!=null&&a(e,["bpm"],s);const u=l(t,["density"]);u!=null&&a(e,["density"],u);const c=l(t,["brightness"]);c!=null&&a(e,["brightness"],c);const d=l(t,["scale"]);d!=null&&a(e,["scale"],d);const h=l(t,["muteBass"]);h!=null&&a(e,["muteBass"],h);const p=l(t,["muteDrums"]);p!=null&&a(e,["muteDrums"],p);const m=l(t,["onlyBassAndDrums"]);m!=null&&a(e,["onlyBassAndDrums"],m);const _=l(t,["musicGenerationMode"]);return _!=null&&a(e,["musicGenerationMode"],_),e}function xM(t){const e={},n=l(t,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>zD(i))),a(e,["audioChunks"],r)}return e}function DM(t){const e={};l(t,["setupComplete"])!=null&&a(e,["setupComplete"],MM());const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],xM(r));const i=l(t,["filteredPrompt"]);return i!=null&&a(e,["filteredPrompt"],RM(i)),e}function MM(){return{}}function kM(t){const e={},n=l(t,["musicGenerationConfig"]);return n!=null&&a(e,["musicGenerationConfig"],vI(n)),e}function NM(t){const e={},n=l(t,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>EI(i))),a(e,["weightedPrompts"],r)}return e}function VM(t){const e={},n=l(t,["clientContent"]);n!=null&&a(e,["clientContent"],AM(n));const r=l(t,["musicGenerationConfig"]);return r!=null&&a(e,["musicGenerationConfig"],PM(r)),e}function LM(t){const e={},n=l(t,["media"]);if(n!=null){let d=eI(n);Array.isArray(d)&&(d=d.map(h=>h)),a(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&a(e,["audio"],nI(r));const i=l(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const o=l(t,["video"]);o!=null&&a(e,["video"],tI(o));const s=l(t,["text"]);return s!=null&&a(e,["text"],s),l(t,["activityStart"])!=null&&a(e,["activityStart"],qD()),l(t,["activityEnd"])!=null&&a(e,["activityEnd"],BD()),e}function FM(t){const e={},n=l(t,["media"]);if(n!=null){let d=eI(n);Array.isArray(d)&&(d=d.map(h=>h)),a(e,["mediaChunks"],d)}const r=l(t,["audio"]);r!=null&&a(e,["audio"],nI(r));const i=l(t,["audioStreamEnd"]);i!=null&&a(e,["audioStreamEnd"],i);const o=l(t,["video"]);o!=null&&a(e,["video"],tI(o));const s=l(t,["text"]);return s!=null&&a(e,["text"],s),l(t,["activityStart"])!=null&&a(e,["activityStart"],GD()),l(t,["activityEnd"])!=null&&a(e,["activityEnd"],OD()),e}function UM(t){const e={},n=l(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],ZD(n));const r=l(t,["turnComplete"]);r!=null&&a(e,["turnComplete"],r);const i=l(t,["interrupted"]);i!=null&&a(e,["interrupted"],i);const o=l(t,["groundingMetadata"]);o!=null&&a(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&a(e,["generationComplete"],s);const u=l(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],i_(u));const c=l(t,["outputTranscription"]);c!=null&&a(e,["outputTranscription"],i_(c));const d=l(t,["urlContextMetadata"]);d!=null&&a(e,["urlContextMetadata"],vk(d));const h=l(t,["turnCompleteReason"]);h!=null&&a(e,["turnCompleteReason"],h);const p=l(t,["waitingForInput"]);return p!=null&&a(e,["waitingForInput"],p),e}function bM(t){const e={},n=l(t,["modelTurn"]);n!=null&&a(e,["modelTurn"],jD(n));const r=l(t,["turnComplete"]);r!=null&&a(e,["turnComplete"],r);const i=l(t,["interrupted"]);i!=null&&a(e,["interrupted"],i);const o=l(t,["groundingMetadata"]);o!=null&&a(e,["groundingMetadata"],o);const s=l(t,["generationComplete"]);s!=null&&a(e,["generationComplete"],s);const u=l(t,["inputTranscription"]);u!=null&&a(e,["inputTranscription"],o_(u));const c=l(t,["outputTranscription"]);c!=null&&a(e,["outputTranscription"],o_(c));const d=l(t,["turnCompleteReason"]);d!=null&&a(e,["turnCompleteReason"],d);const h=l(t,["waitingForInput"]);return h!=null&&a(e,["waitingForInput"],h),e}function BM(t){const e={},n=l(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function OM(t){const e={},n=l(t,["timeLeft"]);return n!=null&&a(e,["timeLeft"],n),e}function qM(t){const e={};l(t,["setupComplete"])!=null&&a(e,["setupComplete"],HM());const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],UM(r));const i=l(t,["toolCall"]);i!=null&&a(e,["toolCall"],QM(i));const o=l(t,["toolCallCancellation"]);o!=null&&a(e,["toolCallCancellation"],WM(o));const s=l(t,["usageMetadata"]);s!=null&&a(e,["usageMetadata"],Ck(s));const u=l(t,["goAway"]);u!=null&&a(e,["goAway"],BM(u));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&a(e,["sessionResumptionUpdate"],$M(c)),e}function GM(t){const e={},n=l(t,["setupComplete"]);n!=null&&a(e,["setupComplete"],KM(n));const r=l(t,["serverContent"]);r!=null&&a(e,["serverContent"],bM(r));const i=l(t,["toolCall"]);i!=null&&a(e,["toolCall"],YM(i));const o=l(t,["toolCallCancellation"]);o!=null&&a(e,["toolCallCancellation"],JM(o));const s=l(t,["usageMetadata"]);s!=null&&a(e,["usageMetadata"],wk(s));const u=l(t,["goAway"]);u!=null&&a(e,["goAway"],OM(u));const c=l(t,["sessionResumptionUpdate"]);return c!=null&&a(e,["sessionResumptionUpdate"],zM(c)),e}function $M(t){const e={},n=l(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const r=l(t,["resumable"]);r!=null&&a(e,["resumable"],r);const i=l(t,["lastConsumedClientMessageIndex"]);return i!=null&&a(e,["lastConsumedClientMessageIndex"],i),e}function zM(t){const e={},n=l(t,["newHandle"]);n!=null&&a(e,["newHandle"],n);const r=l(t,["resumable"]);r!=null&&a(e,["resumable"],r);const i=l(t,["lastConsumedClientMessageIndex"]);return i!=null&&a(e,["lastConsumedClientMessageIndex"],i),e}function HM(){return{}}function KM(t){const e={},n=l(t,["sessionId"]);return n!=null&&a(e,["sessionId"],n),e}function WM(t){const e={},n=l(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function JM(t){const e={},n=l(t,["ids"]);return n!=null&&a(e,["ids"],n),e}function QM(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>mI(i))),a(e,["functionCalls"],r)}return e}function YM(t){const e={},n=l(t,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>gI(i))),a(e,["functionCalls"],r)}return e}function ea(t){const e={},n=l(t,["modality"]);n!=null&&a(e,["modality"],n);const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function ta(t){const e={},n=l(t,["modality"]);n!=null&&a(e,["modality"],n);const r=l(t,["tokenCount"]);return r!=null&&a(e,["tokenCount"],r),e}function XM(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>fk(i))),a(e,["speakerVoiceConfigs"],r)}return e}function ZM(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Sk(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],JD(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],lM(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],mI(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function jM(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Ak(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],QD(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],aM(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],gI(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function ek(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Rk(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],YD(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],uM(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],dM(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function tk(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],Pk(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],XD(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],cM(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],fM(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function nk(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function rk(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function ik(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function ok(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function sk(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],KD(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function lk(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],WD(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function ak(t){const e={},n=l(t,["handle"]);if(n!=null&&a(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function uk(t){const e={},n=l(t,["handle"]);n!=null&&a(e,["handle"],n);const r=l(t,["transparent"]);return r!=null&&a(e,["transparent"],r),e}function ck(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function dk(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function fk(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],TI(r)),e}function hk(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],TI(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],XM(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function pk(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],xk(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function mk(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function gk(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function yk(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>hM(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],_M(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],gM(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],Tk());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],mk(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function _k(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>pM(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],vM(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],yM(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],sM(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],mM(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],Ek());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],gk(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function i_(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["finished"]);return r!=null&&a(e,["finished"],r),e}function o_(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["finished"]);return r!=null&&a(e,["finished"],r),e}function vk(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Ik(i))),a(e,["urlMetadata"],r)}return e}function Tk(){return{}}function Ek(){return{}}function Ik(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function Ck(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&a(e,["cachedContentTokenCount"],r);const i=l(t,["responseTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&a(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&a(e,["thoughtsTokenCount"],s);const u=l(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const c=l(t,["promptTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(_=>ea(_))),a(e,["promptTokensDetails"],m)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(_=>ea(_))),a(e,["cacheTokensDetails"],m)}const h=l(t,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(_=>ea(_))),a(e,["responseTokensDetails"],m)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(_=>ea(_))),a(e,["toolUsePromptTokensDetails"],m)}return e}function wk(t){const e={},n=l(t,["promptTokenCount"]);n!=null&&a(e,["promptTokenCount"],n);const r=l(t,["cachedContentTokenCount"]);r!=null&&a(e,["cachedContentTokenCount"],r);const i=l(t,["candidatesTokenCount"]);i!=null&&a(e,["responseTokenCount"],i);const o=l(t,["toolUsePromptTokenCount"]);o!=null&&a(e,["toolUsePromptTokenCount"],o);const s=l(t,["thoughtsTokenCount"]);s!=null&&a(e,["thoughtsTokenCount"],s);const u=l(t,["totalTokenCount"]);u!=null&&a(e,["totalTokenCount"],u);const c=l(t,["promptTokensDetails"]);if(c!=null){let _=c;Array.isArray(_)&&(_=_.map(S=>ta(S))),a(e,["promptTokensDetails"],_)}const d=l(t,["cacheTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(S=>ta(S))),a(e,["cacheTokensDetails"],_)}const h=l(t,["candidatesTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(S=>ta(S))),a(e,["responseTokensDetails"],_)}const p=l(t,["toolUsePromptTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(S=>ta(S))),a(e,["toolUsePromptTokensDetails"],_)}const m=l(t,["trafficType"]);return m!=null&&a(e,["trafficType"],m),e}function Sk(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Ak(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Rk(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function Pk(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function TI(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],nk(n)),e}function xk(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],rk(n)),e}function Dk(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["weight"]);return r!=null&&a(e,["weight"],r),e}function EI(t){const e={},n=l(t,["text"]);n!=null&&a(e,["text"],n);const r=l(t,["weight"]);return r!=null&&a(e,["weight"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mk(t){const e={},n=l(t,["apiKeyString"]);return n!=null&&a(e,["apiKeyString"],n),e}function kk(t){const e={},n=l(t,["apiKeyConfig"]);n!=null&&a(e,["apiKeyConfig"],Mk(n));const r=l(t,["authType"]);r!=null&&a(e,["authType"],r);const i=l(t,["googleServiceAccountConfig"]);i!=null&&a(e,["googleServiceAccountConfig"],i);const o=l(t,["httpBasicAuthConfig"]);o!=null&&a(e,["httpBasicAuthConfig"],o);const s=l(t,["oauthConfig"]);s!=null&&a(e,["oauthConfig"],s);const u=l(t,["oidcConfig"]);return u!=null&&a(e,["oidcConfig"],u),e}function Nk(t){const e={},n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function Vk(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Lk(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function Fk(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["data"]);r!=null&&a(e,["data"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function Uk(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],Wk(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],Ok(r));const i=l(t,["tokenCount"]);i!=null&&a(e,["tokenCount"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],hV(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function bk(t){const e={},n=l(t,["content"]);n!=null&&a(e,["content"],Jk(n));const r=l(t,["citationMetadata"]);r!=null&&a(e,["citationMetadata"],qk(r));const i=l(t,["finishMessage"]);i!=null&&a(e,["finishMessage"],i);const o=l(t,["finishReason"]);o!=null&&a(e,["finishReason"],o);const s=l(t,["urlContextMetadata"]);s!=null&&a(e,["urlContextMetadata"],pV(s));const u=l(t,["avgLogprobs"]);u!=null&&a(e,["avgLogprobs"],u);const c=l(t,["groundingMetadata"]);c!=null&&a(e,["groundingMetadata"],c);const d=l(t,["index"]);d!=null&&a(e,["index"],d);const h=l(t,["logprobsResult"]);h!=null&&a(e,["logprobsResult"],h);const p=l(t,["safetyRatings"]);return p!=null&&a(e,["safetyRatings"],p),e}function Bk(t){const e={},n=l(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const r=l(t,["epoch"]);r!=null&&a(e,["epoch"],r);const i=l(t,["step"]);return i!=null&&a(e,["step"],i),e}function Ok(t){const e={},n=l(t,["citationSources"]);return n!=null&&a(e,["citations"],n),e}function qk(t){const e={},n=l(t,["citations"]);return n!=null&&a(e,["citations"],n),e}function Gk(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let o=Kt(i);Array.isArray(o)&&(o=o.map(s=>So(s))),a(n,["contents"],o)}return n}function $k(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["tokensInfo"]);return r!=null&&a(e,["tokensInfo"],r),e}function zk(t){const e={},n=l(t,["values"]);return n!=null&&a(e,["values"],n),e}function Hk(t){const e={},n=l(t,["values"]);n!=null&&a(e,["values"],n);const r=l(t,["statistics"]);return r!=null&&a(e,["statistics"],Kk(r)),e}function Kk(t){const e={},n=l(t,["truncated"]);n!=null&&a(e,["truncated"],n);const r=l(t,["token_count"]);return r!=null&&a(e,["tokenCount"],r),e}function Wk(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>C1(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Jk(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>w1(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function bu(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>S1(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function So(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>A1(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function Qk(t){const e={},n=l(t,["controlType"]);n!=null&&a(e,["controlType"],n);const r=l(t,["enableControlImageComputation"]);return r!=null&&a(e,["computeControl"],r),e}function Yk(t){const e={};if(l(t,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(l(t,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(l(t,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Xk(t,e){const n={},r=l(t,["systemInstruction"]);e!==void 0&&r!=null&&a(e,["systemInstruction"],So(ut(r)));const i=l(t,["tools"]);if(e!==void 0&&i!=null){let s=i;Array.isArray(s)&&(s=s.map(u=>AI(u))),a(e,["tools"],s)}const o=l(t,["generationConfig"]);return e!==void 0&&o!=null&&a(e,["generationConfig"],o),n}function Zk(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Kt(i);Array.isArray(s)&&(s=s.map(u=>bu(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&Yk(o),n}function jk(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Kt(i);Array.isArray(s)&&(s=s.map(u=>So(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&Xk(o,n),n}function eN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);r!=null&&a(e,["totalTokens"],r);const i=l(t,["cachedContentTokenCount"]);return i!=null&&a(e,["cachedContentTokenCount"],i),e}function tN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["totalTokens"]);return r!=null&&a(e,["totalTokens"],r),e}function nN(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function rN(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function iN(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function oN(t){const e={},n=l(t,["sdkHttpResponse"]);return n!=null&&a(e,["sdkHttpResponse"],n),e}function sN(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function lN(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function aN(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&a(e,["parameters","aspectRatio"],s);const u=l(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const c=l(t,["seed"]);e!==void 0&&c!=null&&a(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&a(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const _=l(t,["language"]);e!==void 0&&_!=null&&a(e,["parameters","language"],_);const S=l(t,["outputMimeType"]);e!==void 0&&S!=null&&a(e,["parameters","outputOptions","mimeType"],S);const P=l(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&a(e,["parameters","outputOptions","compressionQuality"],P);const k=l(t,["addWatermark"]);e!==void 0&&k!=null&&a(e,["parameters","addWatermark"],k);const C=l(t,["editMode"]);e!==void 0&&C!=null&&a(e,["parameters","editMode"],C);const T=l(t,["baseSteps"]);return e!==void 0&&T!=null&&a(e,["parameters","editConfig","baseSteps"],T),n}function uN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["referenceImages"]);if(o!=null){let u=o;Array.isArray(u)&&(u=u.map(c=>V1(c))),a(n,["instances[0]","referenceImages"],u)}const s=l(e,["config"]);return s!=null&&aN(s,n),n}function cN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Bu(o))),a(e,["generatedImages"],i)}return e}function dN(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["requests[]","taskType"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["requests[]","title"],i);const o=l(t,["outputDimensionality"]);if(e!==void 0&&o!=null&&a(e,["requests[]","outputDimensionality"],o),l(t,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(l(t,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function fN(t,e){const n={},r=l(t,["taskType"]);e!==void 0&&r!=null&&a(e,["instances[]","task_type"],r);const i=l(t,["title"]);e!==void 0&&i!=null&&a(e,["instances[]","title"],i);const o=l(t,["outputDimensionality"]);e!==void 0&&o!=null&&a(e,["parameters","outputDimensionality"],o);const s=l(t,["mimeType"]);e!==void 0&&s!=null&&a(e,["instances[]","mimeType"],s);const u=l(t,["autoTruncate"]);return e!==void 0&&u!=null&&a(e,["parameters","autoTruncate"],u),n}function hN(){return{}}function pN(t){const e={},n=l(t,["billableCharacterCount"]);return n!=null&&a(e,["billableCharacterCount"],n),e}function mN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);i!=null&&a(n,["requests[]","content"],qh(t,i));const o=l(e,["config"]);o!=null&&dN(o,n);const s=l(e,["model"]);return s!==void 0&&a(n,["requests[]","model"],ue(t,s)),n}function gN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);i!=null&&a(n,["instances[]","content"],qh(t,i));const o=l(e,["config"]);return o!=null&&fN(o,n),n}function yN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>zk(s))),a(e,["embeddings"],o)}return l(t,["metadata"])!=null&&a(e,["metadata"],hN()),e}function _N(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions[]","embeddings"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Hk(s))),a(e,["embeddings"],o)}const i=l(t,["metadata"]);return i!=null&&a(e,["metadata"],pN(i)),e}function vN(t){const e={},n=l(t,["endpoint"]);n!=null&&a(e,["name"],n);const r=l(t,["deployedModelId"]);return r!=null&&a(e,["deployedModelId"],r),e}function TN(t){const e={},n=l(t,["excludeDomains"]);return n!=null&&a(e,["excludeDomains"],n),e}function EN(t){const e={},n=l(t,["label"]);n!=null&&a(e,["label"],n);const r=l(t,["score"]);return r!=null&&a(e,["score"],r),e}function IN(t){const e={},n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function CN(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function wN(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function SN(t){const e={},n=l(t,["displayName"]);n!=null&&a(e,["displayName"],n);const r=l(t,["fileUri"]);r!=null&&a(e,["fileUri"],r);const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function AN(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function RN(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function PN(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function xN(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function DN(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function MN(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["allowedFunctionNames"]);return r!=null&&a(e,["allowedFunctionNames"],r),e}function kN(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function NN(t){const e={};if(l(t,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=l(t,["description"]);n!=null&&a(e,["description"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["parameters"]);i!=null&&a(e,["parameters"],i);const o=l(t,["parametersJsonSchema"]);o!=null&&a(e,["parametersJsonSchema"],o);const s=l(t,["response"]);s!=null&&a(e,["response"],s);const u=l(t,["responseJsonSchema"]);return u!=null&&a(e,["responseJsonSchema"],u),e}function VN(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],bu(ut(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const S=l(e,["frequencyPenalty"]);S!=null&&a(r,["frequencyPenalty"],S);const P=l(e,["seed"]);P!=null&&a(r,["seed"],P);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const C=l(e,["responseSchema"]);C!=null&&a(r,["responseSchema"],B1(Gh(C)));const T=l(e,["responseJsonSchema"]);if(T!=null&&a(r,["responseJsonSchema"],T),l(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(l(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const I=l(e,["safetySettings"]);if(n!==void 0&&I!=null){let D=I;Array.isArray(D)&&(D=D.map(N=>U1(N))),a(n,["safetySettings"],D)}const M=l(e,["tools"]);if(n!==void 0&&M!=null){let D=Co(M);Array.isArray(D)&&(D=D.map(N=>rV(Io(N)))),a(n,["tools"],D)}const F=l(e,["toolConfig"]);if(n!==void 0&&F!=null&&a(n,["toolConfig"],tV(F)),l(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const b=l(e,["cachedContent"]);n!==void 0&&b!=null&&a(n,["cachedContent"],Un(t,b));const A=l(e,["responseModalities"]);A!=null&&a(r,["responseModalities"],A);const v=l(e,["mediaResolution"]);v!=null&&a(r,["mediaResolution"],v);const w=l(e,["speechConfig"]);if(w!=null&&a(r,["speechConfig"],W1($h(w))),l(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const R=l(e,["thinkingConfig"]);return R!=null&&a(r,["thinkingConfig"],X1(R)),r}function LN(t,e,n){const r={},i=l(e,["systemInstruction"]);n!==void 0&&i!=null&&a(n,["systemInstruction"],So(ut(i)));const o=l(e,["temperature"]);o!=null&&a(r,["temperature"],o);const s=l(e,["topP"]);s!=null&&a(r,["topP"],s);const u=l(e,["topK"]);u!=null&&a(r,["topK"],u);const c=l(e,["candidateCount"]);c!=null&&a(r,["candidateCount"],c);const d=l(e,["maxOutputTokens"]);d!=null&&a(r,["maxOutputTokens"],d);const h=l(e,["stopSequences"]);h!=null&&a(r,["stopSequences"],h);const p=l(e,["responseLogprobs"]);p!=null&&a(r,["responseLogprobs"],p);const m=l(e,["logprobs"]);m!=null&&a(r,["logprobs"],m);const _=l(e,["presencePenalty"]);_!=null&&a(r,["presencePenalty"],_);const S=l(e,["frequencyPenalty"]);S!=null&&a(r,["frequencyPenalty"],S);const P=l(e,["seed"]);P!=null&&a(r,["seed"],P);const k=l(e,["responseMimeType"]);k!=null&&a(r,["responseMimeType"],k);const C=l(e,["responseSchema"]);C!=null&&a(r,["responseSchema"],O1(Gh(C)));const T=l(e,["responseJsonSchema"]);T!=null&&a(r,["responseJsonSchema"],T);const I=l(e,["routingConfig"]);I!=null&&a(r,["routingConfig"],I);const M=l(e,["modelSelectionConfig"]);M!=null&&a(r,["modelConfig"],E1(M));const F=l(e,["safetySettings"]);if(n!==void 0&&F!=null){let Je=F;Array.isArray(Je)&&(Je=Je.map(mn=>b1(mn))),a(n,["safetySettings"],Je)}const b=l(e,["tools"]);if(n!==void 0&&b!=null){let Je=Co(b);Array.isArray(Je)&&(Je=Je.map(mn=>AI(Io(mn)))),a(n,["tools"],Je)}const A=l(e,["toolConfig"]);n!==void 0&&A!=null&&a(n,["toolConfig"],nV(A));const v=l(e,["labels"]);n!==void 0&&v!=null&&a(n,["labels"],v);const w=l(e,["cachedContent"]);n!==void 0&&w!=null&&a(n,["cachedContent"],Un(t,w));const R=l(e,["responseModalities"]);R!=null&&a(r,["responseModalities"],R);const D=l(e,["mediaResolution"]);D!=null&&a(r,["mediaResolution"],D);const N=l(e,["speechConfig"]);N!=null&&a(r,["speechConfig"],J1($h(N)));const x=l(e,["audioTimestamp"]);x!=null&&a(r,["audioTimestamp"],x);const Se=l(e,["thinkingConfig"]);return Se!=null&&a(r,["thinkingConfig"],Z1(Se)),r}function s_(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Kt(i);Array.isArray(s)&&(s=s.map(u=>bu(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["generationConfig"],VN(t,o,n)),n}function l_(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["contents"]);if(i!=null){let s=Kt(i);Array.isArray(s)&&(s=s.map(u=>So(u))),a(n,["contents"],s)}const o=l(e,["config"]);return o!=null&&a(n,["generationConfig"],LN(t,o,n)),n}function a_(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Uk(d))),a(e,["candidates"],c)}const i=l(t,["modelVersion"]);i!=null&&a(e,["modelVersion"],i);const o=l(t,["promptFeedback"]);o!=null&&a(e,["promptFeedback"],o);const s=l(t,["responseId"]);s!=null&&a(e,["responseId"],s);const u=l(t,["usageMetadata"]);return u!=null&&a(e,["usageMetadata"],u),e}function u_(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>bk(h))),a(e,["candidates"],d)}const i=l(t,["createTime"]);i!=null&&a(e,["createTime"],i);const o=l(t,["modelVersion"]);o!=null&&a(e,["modelVersion"],o);const s=l(t,["promptFeedback"]);s!=null&&a(e,["promptFeedback"],s);const u=l(t,["responseId"]);u!=null&&a(e,["responseId"],u);const c=l(t,["usageMetadata"]);return c!=null&&a(e,["usageMetadata"],c),e}function FN(t,e){const n={};if(l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["aspectRatio"]);e!==void 0&&i!=null&&a(e,["parameters","aspectRatio"],i);const o=l(t,["guidanceScale"]);if(e!==void 0&&o!=null&&a(e,["parameters","guidanceScale"],o),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=l(t,["safetyFilterLevel"]);e!==void 0&&s!=null&&a(e,["parameters","safetySetting"],s);const u=l(t,["personGeneration"]);e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u);const c=l(t,["includeSafetyAttributes"]);e!==void 0&&c!=null&&a(e,["parameters","includeSafetyAttributes"],c);const d=l(t,["includeRaiReason"]);e!==void 0&&d!=null&&a(e,["parameters","includeRaiReason"],d);const h=l(t,["language"]);e!==void 0&&h!=null&&a(e,["parameters","language"],h);const p=l(t,["outputMimeType"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","mimeType"],p);const m=l(t,["outputCompressionQuality"]);if(e!==void 0&&m!=null&&a(e,["parameters","outputOptions","compressionQuality"],m),l(t,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const _=l(t,["imageSize"]);if(e!==void 0&&_!=null&&a(e,["parameters","sampleImageSize"],_),l(t,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function UN(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["negativePrompt"]);e!==void 0&&i!=null&&a(e,["parameters","negativePrompt"],i);const o=l(t,["numberOfImages"]);e!==void 0&&o!=null&&a(e,["parameters","sampleCount"],o);const s=l(t,["aspectRatio"]);e!==void 0&&s!=null&&a(e,["parameters","aspectRatio"],s);const u=l(t,["guidanceScale"]);e!==void 0&&u!=null&&a(e,["parameters","guidanceScale"],u);const c=l(t,["seed"]);e!==void 0&&c!=null&&a(e,["parameters","seed"],c);const d=l(t,["safetyFilterLevel"]);e!==void 0&&d!=null&&a(e,["parameters","safetySetting"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["includeSafetyAttributes"]);e!==void 0&&p!=null&&a(e,["parameters","includeSafetyAttributes"],p);const m=l(t,["includeRaiReason"]);e!==void 0&&m!=null&&a(e,["parameters","includeRaiReason"],m);const _=l(t,["language"]);e!==void 0&&_!=null&&a(e,["parameters","language"],_);const S=l(t,["outputMimeType"]);e!==void 0&&S!=null&&a(e,["parameters","outputOptions","mimeType"],S);const P=l(t,["outputCompressionQuality"]);e!==void 0&&P!=null&&a(e,["parameters","outputOptions","compressionQuality"],P);const k=l(t,["addWatermark"]);e!==void 0&&k!=null&&a(e,["parameters","addWatermark"],k);const C=l(t,["imageSize"]);e!==void 0&&C!=null&&a(e,["parameters","sampleImageSize"],C);const T=l(t,["enhancePrompt"]);return e!==void 0&&T!=null&&a(e,["parameters","enhancePrompt"],T),n}function bN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["config"]);return o!=null&&FN(o,n),n}function BN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["config"]);return o!=null&&UN(o,n),n}function ON(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>ZN(s))),a(e,["generatedImages"],o)}const i=l(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],wI(i)),e}function qN(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(s=>Bu(s))),a(e,["generatedImages"],o)}const i=l(t,["positivePromptSafetyAttributes"]);return i!=null&&a(e,["positivePromptSafetyAttributes"],SI(i)),e}function GN(t,e){const n={},r=l(t,["numberOfVideos"]);if(e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r),l(t,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(l(t,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=l(t,["durationSeconds"]);if(e!==void 0&&i!=null&&a(e,["parameters","durationSeconds"],i),l(t,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=l(t,["aspectRatio"]);e!==void 0&&o!=null&&a(e,["parameters","aspectRatio"],o);const s=l(t,["resolution"]);e!==void 0&&s!=null&&a(e,["parameters","resolution"],s);const u=l(t,["personGeneration"]);if(e!==void 0&&u!=null&&a(e,["parameters","personGeneration"],u),l(t,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=l(t,["negativePrompt"]);e!==void 0&&c!=null&&a(e,["parameters","negativePrompt"],c);const d=l(t,["enhancePrompt"]);if(e!==void 0&&d!=null&&a(e,["parameters","enhancePrompt"],d),l(t,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(l(t,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(l(t,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(l(t,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(l(t,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function $N(t,e){const n={},r=l(t,["numberOfVideos"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["outputGcsUri"]);e!==void 0&&i!=null&&a(e,["parameters","storageUri"],i);const o=l(t,["fps"]);e!==void 0&&o!=null&&a(e,["parameters","fps"],o);const s=l(t,["durationSeconds"]);e!==void 0&&s!=null&&a(e,["parameters","durationSeconds"],s);const u=l(t,["seed"]);e!==void 0&&u!=null&&a(e,["parameters","seed"],u);const c=l(t,["aspectRatio"]);e!==void 0&&c!=null&&a(e,["parameters","aspectRatio"],c);const d=l(t,["resolution"]);e!==void 0&&d!=null&&a(e,["parameters","resolution"],d);const h=l(t,["personGeneration"]);e!==void 0&&h!=null&&a(e,["parameters","personGeneration"],h);const p=l(t,["pubsubTopic"]);e!==void 0&&p!=null&&a(e,["parameters","pubsubTopic"],p);const m=l(t,["negativePrompt"]);e!==void 0&&m!=null&&a(e,["parameters","negativePrompt"],m);const _=l(t,["enhancePrompt"]);e!==void 0&&_!=null&&a(e,["parameters","enhancePrompt"],_);const S=l(t,["generateAudio"]);e!==void 0&&S!=null&&a(e,["parameters","generateAudio"],S);const P=l(t,["lastFrame"]);e!==void 0&&P!=null&&a(e,["instances[0]","lastFrame"],on(P));const k=l(t,["referenceImages"]);if(e!==void 0&&k!=null){let I=k;Array.isArray(I)&&(I=I.map(M=>IV(M))),a(e,["instances[0]","referenceImages"],I)}const C=l(t,["mask"]);e!==void 0&&C!=null&&a(e,["instances[0]","mask"],EV(C));const T=l(t,["compressionQuality"]);return e!==void 0&&T!=null&&a(e,["parameters","compressionQuality"],T),n}function zN(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response","generateVideoResponse"]);return s!=null&&a(e,["response"],JN(s)),e}function HN(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["metadata"]);r!=null&&a(e,["metadata"],r);const i=l(t,["done"]);i!=null&&a(e,["done"],i);const o=l(t,["error"]);o!=null&&a(e,["error"],o);const s=l(t,["response"]);return s!=null&&a(e,["response"],QN(s)),e}function KN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["image"]);if(o!=null&&a(n,["instances[0]","image"],CI(o)),l(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const s=l(e,["source"]);s!=null&&YN(s,n);const u=l(e,["config"]);return u!=null&&GN(u,n),n}function WN(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["prompt"]);i!=null&&a(n,["instances[0]","prompt"],i);const o=l(e,["image"]);o!=null&&a(n,["instances[0]","image"],on(o));const s=l(e,["video"]);s!=null&&a(n,["instances[0]","video"],RI(s));const u=l(e,["source"]);u!=null&&XN(u,n);const c=l(e,["config"]);return c!=null&&$N(c,n),n}function JN(t){const e={},n=l(t,["generatedSamples"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>e1(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function QN(t){const e={},n=l(t,["videos"]);if(n!=null){let o=n;Array.isArray(o)&&(o=o.map(s=>t1(s))),a(e,["generatedVideos"],o)}const r=l(t,["raiMediaFilteredCount"]);r!=null&&a(e,["raiMediaFilteredCount"],r);const i=l(t,["raiMediaFilteredReasons"]);return i!=null&&a(e,["raiMediaFilteredReasons"],i),e}function YN(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);if(e!==void 0&&i!=null&&a(e,["instances[0]","image"],CI(i)),l(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");return n}function XN(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],on(i));const o=l(t,["video"]);return e!==void 0&&o!=null&&a(e,["instances[0]","video"],RI(o)),n}function ZN(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["image"],u1(n));const r=l(t,["raiFilteredReason"]);r!=null&&a(e,["raiFilteredReason"],r);const i=l(t,["_self"]);return i!=null&&a(e,["safetyAttributes"],wI(i)),e}function Bu(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["image"],II(n));const r=l(t,["raiFilteredReason"]);r!=null&&a(e,["raiFilteredReason"],r);const i=l(t,["_self"]);i!=null&&a(e,["safetyAttributes"],SI(i));const o=l(t,["prompt"]);return o!=null&&a(e,["enhancedPrompt"],o),e}function jN(t){const e={},n=l(t,["_self"]);n!=null&&a(e,["mask"],II(n));const r=l(t,["labels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>EN(o))),a(e,["labels"],i)}return e}function e1(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],vV(n)),e}function t1(t){const e={},n=l(t,["_self"]);return n!=null&&a(e,["video"],TV(n)),e}function n1(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function r1(t,e){const n={},r=l(e,["model"]);return r!=null&&a(n,["_url","name"],ue(t,r)),n}function i1(t){const e={},n=l(t,["authConfig"]);return n!=null&&a(e,["authConfig"],kk(n)),e}function o1(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],sN(n)),e}function s1(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],lN(n)),e}function l1(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],c1(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function a1(t){const e={},n=l(t,["timeRangeFilter"]);n!=null&&a(e,["timeRangeFilter"],d1(n));const r=l(t,["excludeDomains"]);return r!=null&&a(e,["excludeDomains"],r),e}function u1(t){const e={},n=l(t,["bytesBase64Encoded"]);n!=null&&a(e,["imageBytes"],ci(n));const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function II(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["imageBytes"],ci(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function CI(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=l(t,["imageBytes"]);n!=null&&a(e,["bytesBase64Encoded"],ci(n));const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function on(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["imageBytes"]);r!=null&&a(e,["bytesBase64Encoded"],ci(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function c1(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function d1(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function f1(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function h1(t){const e={},n=l(t,["latitude"]);n!=null&&a(e,["latitude"],n);const r=l(t,["longitude"]);return r!=null&&a(e,["longitude"],r),e}function p1(t,e,n){const r={},i=l(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&a(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&a(n,["_query","filter"],s);const u=l(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],sI(t,u)),r}function m1(t,e,n){const r={},i=l(e,["pageSize"]);n!==void 0&&i!=null&&a(n,["_query","pageSize"],i);const o=l(e,["pageToken"]);n!==void 0&&o!=null&&a(n,["_query","pageToken"],o);const s=l(e,["filter"]);n!==void 0&&s!=null&&a(n,["_query","filter"],s);const u=l(e,["queryBase"]);return n!==void 0&&u!=null&&a(n,["_url","models_url"],sI(t,u)),r}function g1(t,e){const n={},r=l(e,["config"]);return r!=null&&p1(t,r,n),n}function y1(t,e){const n={},r=l(e,["config"]);return r!=null&&m1(t,r,n),n}function _1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["_self"]);if(i!=null){let o=lI(i);Array.isArray(o)&&(o=o.map(s=>pf(s))),a(e,["models"],o)}return e}function v1(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["_self"]);if(i!=null){let o=lI(i);Array.isArray(o)&&(o=o.map(s=>mf(s))),a(e,["models"],o)}return e}function T1(t){const e={},n=l(t,["maskMode"]);n!=null&&a(e,["maskMode"],n);const r=l(t,["segmentationClasses"]);r!=null&&a(e,["maskClasses"],r);const i=l(t,["maskDilation"]);return i!=null&&a(e,["dilation"],i),e}function pf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["version"]);o!=null&&a(e,["version"],o);const s=l(t,["_self"]);s!=null&&a(e,["tunedModelInfo"],iV(s));const u=l(t,["inputTokenLimit"]);u!=null&&a(e,["inputTokenLimit"],u);const c=l(t,["outputTokenLimit"]);c!=null&&a(e,["outputTokenLimit"],c);const d=l(t,["supportedGenerationMethods"]);return d!=null&&a(e,["supportedActions"],d),e}function mf(t){const e={},n=l(t,["name"]);n!=null&&a(e,["name"],n);const r=l(t,["displayName"]);r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["versionId"]);o!=null&&a(e,["version"],o);const s=l(t,["deployedModels"]);if(s!=null){let p=s;Array.isArray(p)&&(p=p.map(m=>vN(m))),a(e,["endpoints"],p)}const u=l(t,["labels"]);u!=null&&a(e,["labels"],u);const c=l(t,["_self"]);c!=null&&a(e,["tunedModelInfo"],oV(c));const d=l(t,["defaultCheckpointId"]);d!=null&&a(e,["defaultCheckpointId"],d);const h=l(t,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Bk(m))),a(e,["checkpoints"],p)}return e}function E1(t){const e={},n=l(t,["featureSelectionPreference"]);return n!=null&&a(e,["featureSelectionPreference"],n),e}function I1(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>K1(i))),a(e,["speakerVoiceConfigs"],r)}return e}function C1(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],CV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Nk(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],IN(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],AN(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function w1(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],wV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Vk(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],CN(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],RN(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function S1(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],SV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Lk(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],wN(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],PN(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function A1(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],AV(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],Fk(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],SN(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],xN(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function R1(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function P1(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function x1(t){const e={},n=l(t,["productImage"]);return n!=null&&a(e,["image"],on(n)),e}function D1(t,e){const n={},r=l(t,["numberOfImages"]);e!==void 0&&r!=null&&a(e,["parameters","sampleCount"],r);const i=l(t,["baseSteps"]);e!==void 0&&i!=null&&a(e,["parameters","editConfig","baseSteps"],i);const o=l(t,["outputGcsUri"]);e!==void 0&&o!=null&&a(e,["parameters","storageUri"],o);const s=l(t,["seed"]);e!==void 0&&s!=null&&a(e,["parameters","seed"],s);const u=l(t,["safetyFilterLevel"]);e!==void 0&&u!=null&&a(e,["parameters","safetySetting"],u);const c=l(t,["personGeneration"]);e!==void 0&&c!=null&&a(e,["parameters","personGeneration"],c);const d=l(t,["addWatermark"]);e!==void 0&&d!=null&&a(e,["parameters","addWatermark"],d);const h=l(t,["outputMimeType"]);e!==void 0&&h!=null&&a(e,["parameters","outputOptions","mimeType"],h);const p=l(t,["outputCompressionQuality"]);e!==void 0&&p!=null&&a(e,["parameters","outputOptions","compressionQuality"],p);const m=l(t,["enhancePrompt"]);return e!==void 0&&m!=null&&a(e,["parameters","enhancePrompt"],m),n}function M1(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["source"]);i!=null&&N1(i,n);const o=l(e,["config"]);return o!=null&&D1(o,n),n}function k1(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Bu(i))),a(e,["generatedImages"],r)}return e}function N1(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["personImage"]);e!==void 0&&i!=null&&a(e,["instances[0]","personImage","image"],on(i));const o=l(t,["productImages"]);if(e!==void 0&&o!=null){let s=o;Array.isArray(s)&&(s=s.map(u=>x1(u))),a(e,["instances[0]","productImages"],s)}return n}function V1(t){const e={},n=l(t,["referenceImage"]);n!=null&&a(e,["referenceImage"],on(n));const r=l(t,["referenceId"]);r!=null&&a(e,["referenceId"],r);const i=l(t,["referenceType"]);i!=null&&a(e,["referenceType"],i);const o=l(t,["maskImageConfig"]);o!=null&&a(e,["maskImageConfig"],T1(o));const s=l(t,["controlImageConfig"]);s!=null&&a(e,["controlImageConfig"],Qk(s));const u=l(t,["styleImageConfig"]);u!=null&&a(e,["styleImageConfig"],Q1(u));const c=l(t,["subjectImageConfig"]);return c!=null&&a(e,["subjectImageConfig"],Y1(c)),e}function L1(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],f1(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function F1(t){const e={},n=l(t,["latLng"]);n!=null&&a(e,["latLng"],h1(n));const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function wI(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&a(e,["scores"],r);const i=l(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function SI(t){const e={},n=l(t,["safetyAttributes","categories"]);n!=null&&a(e,["categories"],n);const r=l(t,["safetyAttributes","scores"]);r!=null&&a(e,["scores"],r);const i=l(t,["contentType"]);return i!=null&&a(e,["contentType"],i),e}function U1(t){const e={};if(l(t,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=l(t,["category"]);n!=null&&a(e,["category"],n);const r=l(t,["threshold"]);return r!=null&&a(e,["threshold"],r),e}function b1(t){const e={},n=l(t,["method"]);n!=null&&a(e,["method"],n);const r=l(t,["category"]);r!=null&&a(e,["category"],r);const i=l(t,["threshold"]);return i!=null&&a(e,["threshold"],i),e}function B1(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const S=l(t,["minLength"]);S!=null&&a(e,["minLength"],S);const P=l(t,["minProperties"]);P!=null&&a(e,["minProperties"],P);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const C=l(t,["nullable"]);C!=null&&a(e,["nullable"],C);const T=l(t,["pattern"]);T!=null&&a(e,["pattern"],T);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const M=l(t,["propertyOrdering"]);M!=null&&a(e,["propertyOrdering"],M);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const b=l(t,["title"]);b!=null&&a(e,["title"],b);const A=l(t,["type"]);return A!=null&&a(e,["type"],A),e}function O1(t){const e={},n=l(t,["anyOf"]);n!=null&&a(e,["anyOf"],n);const r=l(t,["default"]);r!=null&&a(e,["default"],r);const i=l(t,["description"]);i!=null&&a(e,["description"],i);const o=l(t,["enum"]);o!=null&&a(e,["enum"],o);const s=l(t,["example"]);s!=null&&a(e,["example"],s);const u=l(t,["format"]);u!=null&&a(e,["format"],u);const c=l(t,["items"]);c!=null&&a(e,["items"],c);const d=l(t,["maxItems"]);d!=null&&a(e,["maxItems"],d);const h=l(t,["maxLength"]);h!=null&&a(e,["maxLength"],h);const p=l(t,["maxProperties"]);p!=null&&a(e,["maxProperties"],p);const m=l(t,["maximum"]);m!=null&&a(e,["maximum"],m);const _=l(t,["minItems"]);_!=null&&a(e,["minItems"],_);const S=l(t,["minLength"]);S!=null&&a(e,["minLength"],S);const P=l(t,["minProperties"]);P!=null&&a(e,["minProperties"],P);const k=l(t,["minimum"]);k!=null&&a(e,["minimum"],k);const C=l(t,["nullable"]);C!=null&&a(e,["nullable"],C);const T=l(t,["pattern"]);T!=null&&a(e,["pattern"],T);const I=l(t,["properties"]);I!=null&&a(e,["properties"],I);const M=l(t,["propertyOrdering"]);M!=null&&a(e,["propertyOrdering"],M);const F=l(t,["required"]);F!=null&&a(e,["required"],F);const b=l(t,["title"]);b!=null&&a(e,["title"],b);const A=l(t,["type"]);return A!=null&&a(e,["type"],A),e}function q1(t){const e={},n=l(t,["image"]);return n!=null&&a(e,["image"],on(n)),e}function G1(t,e){const n={},r=l(t,["mode"]);e!==void 0&&r!=null&&a(e,["parameters","mode"],r);const i=l(t,["maxPredictions"]);e!==void 0&&i!=null&&a(e,["parameters","maxPredictions"],i);const o=l(t,["confidenceThreshold"]);e!==void 0&&o!=null&&a(e,["parameters","confidenceThreshold"],o);const s=l(t,["maskDilation"]);e!==void 0&&s!=null&&a(e,["parameters","maskDilation"],s);const u=l(t,["binaryColorThreshold"]);return e!==void 0&&u!=null&&a(e,["parameters","binaryColorThreshold"],u),n}function $1(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["source"]);i!=null&&H1(i,n);const o=l(e,["config"]);return o!=null&&G1(o,n),n}function z1(t){const e={},n=l(t,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>jN(i))),a(e,["generatedMasks"],r)}return e}function H1(t,e){const n={},r=l(t,["prompt"]);e!==void 0&&r!=null&&a(e,["instances[0]","prompt"],r);const i=l(t,["image"]);e!==void 0&&i!=null&&a(e,["instances[0]","image"],on(i));const o=l(t,["scribbleImage"]);return e!==void 0&&o!=null&&a(e,["instances[0]","scribble"],q1(o)),n}function K1(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],PI(r)),e}function W1(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],PI(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],I1(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function J1(t){const e={},n=l(t,["voiceConfig"]);if(n!=null&&a(e,["voiceConfig"],RV(n)),l(t,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=l(t,["languageCode"]);return r!=null&&a(e,["languageCode"],r),e}function Q1(t){const e={},n=l(t,["styleDescription"]);return n!=null&&a(e,["styleDescription"],n),e}function Y1(t){const e={},n=l(t,["subjectType"]);n!=null&&a(e,["subjectType"],n);const r=l(t,["subjectDescription"]);return r!=null&&a(e,["subjectDescription"],r),e}function X1(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function Z1(t){const e={},n=l(t,["includeThoughts"]);n!=null&&a(e,["includeThoughts"],n);const r=l(t,["thinkingBudget"]);return r!=null&&a(e,["thinkingBudget"],r),e}function j1(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function eV(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function tV(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],DN(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],L1(r)),e}function nV(t){const e={},n=l(t,["functionCallingConfig"]);n!=null&&a(e,["functionCallingConfig"],MN(n));const r=l(t,["retrievalConfig"]);return r!=null&&a(e,["retrievalConfig"],F1(r)),e}function rV(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>kN(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],l1(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],o1(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],mV());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],j1(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function AI(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>NN(m))),a(e,["functionDeclarations"],p)}const r=l(t,["retrieval"]);r!=null&&a(e,["retrieval"],r);const i=l(t,["googleSearch"]);i!=null&&a(e,["googleSearch"],a1(i));const o=l(t,["googleSearchRetrieval"]);o!=null&&a(e,["googleSearchRetrieval"],s1(o));const s=l(t,["enterpriseWebSearch"]);s!=null&&a(e,["enterpriseWebSearch"],TN(s));const u=l(t,["googleMaps"]);u!=null&&a(e,["googleMaps"],i1(u)),l(t,["urlContext"])!=null&&a(e,["urlContext"],gV());const d=l(t,["computerUse"]);d!=null&&a(e,["computerUse"],eV(d));const h=l(t,["codeExecution"]);return h!=null&&a(e,["codeExecution"],h),e}function iV(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&a(e,["createTime"],r);const i=l(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function oV(t){const e={},n=l(t,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["createTime"]);r!=null&&a(e,["createTime"],r);const i=l(t,["updateTime"]);return i!=null&&a(e,["updateTime"],i),e}function sV(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&a(e,["defaultCheckpointId"],o),n}function lV(t,e){const n={},r=l(t,["displayName"]);e!==void 0&&r!=null&&a(e,["displayName"],r);const i=l(t,["description"]);e!==void 0&&i!=null&&a(e,["description"],i);const o=l(t,["defaultCheckpointId"]);return e!==void 0&&o!=null&&a(e,["defaultCheckpointId"],o),n}function aV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","name"],ue(t,r));const i=l(e,["config"]);return i!=null&&sV(i,n),n}function uV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&lV(i,n),n}function cV(t,e){const n={},r=l(t,["outputGcsUri"]);e!==void 0&&r!=null&&a(e,["parameters","storageUri"],r);const i=l(t,["includeRaiReason"]);e!==void 0&&i!=null&&a(e,["parameters","includeRaiReason"],i);const o=l(t,["outputMimeType"]);e!==void 0&&o!=null&&a(e,["parameters","outputOptions","mimeType"],o);const s=l(t,["outputCompressionQuality"]);e!==void 0&&s!=null&&a(e,["parameters","outputOptions","compressionQuality"],s);const u=l(t,["enhanceInputImage"]);e!==void 0&&u!=null&&a(e,["parameters","upscaleConfig","enhanceInputImage"],u);const c=l(t,["imagePreservationFactor"]);e!==void 0&&c!=null&&a(e,["parameters","upscaleConfig","imagePreservationFactor"],c);const d=l(t,["numberOfImages"]);e!==void 0&&d!=null&&a(e,["parameters","sampleCount"],d);const h=l(t,["mode"]);return e!==void 0&&h!=null&&a(e,["parameters","mode"],h),n}function dV(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["_url","model"],ue(t,r));const i=l(e,["image"]);i!=null&&a(n,["instances[0]","image"],on(i));const o=l(e,["upscaleFactor"]);o!=null&&a(n,["parameters","upscaleConfig","upscaleFactor"],o);const s=l(e,["config"]);return s!=null&&cV(s,n),n}function fV(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Bu(o))),a(e,["generatedImages"],i)}return e}function hV(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>yV(i))),a(e,["urlMetadata"],r)}return e}function pV(t){const e={},n=l(t,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>_V(i))),a(e,["urlMetadata"],r)}return e}function mV(){return{}}function gV(){return{}}function yV(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function _V(t){const e={},n=l(t,["retrievedUrl"]);n!=null&&a(e,["retrievedUrl"],n);const r=l(t,["urlRetrievalStatus"]);return r!=null&&a(e,["urlRetrievalStatus"],r),e}function vV(t){const e={},n=l(t,["video","uri"]);n!=null&&a(e,["uri"],n);const r=l(t,["video","encodedVideo"]);r!=null&&a(e,["videoBytes"],ci(r));const i=l(t,["encoding"]);return i!=null&&a(e,["mimeType"],i),e}function TV(t){const e={},n=l(t,["gcsUri"]);n!=null&&a(e,["uri"],n);const r=l(t,["bytesBase64Encoded"]);r!=null&&a(e,["videoBytes"],ci(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function EV(t){const e={},n=l(t,["image"]);n!=null&&a(e,["_self"],on(n));const r=l(t,["maskMode"]);return r!=null&&a(e,["maskMode"],r),e}function IV(t){const e={},n=l(t,["image"]);n!=null&&a(e,["image"],on(n));const r=l(t,["referenceType"]);return r!=null&&a(e,["referenceType"],r),e}function CV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function wV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function SV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function AV(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function RI(t){const e={},n=l(t,["uri"]);n!=null&&a(e,["gcsUri"],n);const r=l(t,["videoBytes"]);r!=null&&a(e,["bytesBase64Encoded"],ci(r));const i=l(t,["mimeType"]);return i!=null&&a(e,["mimeType"],i),e}function PI(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],R1(n)),e}function RV(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],P1(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const PV="Content-Type",xV="X-Server-Timeout",DV="User-Agent",gf="x-goog-api-client",MV="1.21.0",kV=`google-genai-sdk/${MV}`,NV="v1beta1",VV="v1beta",c_=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class LV{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:NV,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:VV,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[s,u]of Object.entries(e.queryParams))i.searchParams.append(s,String(u));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.unaryApiCall(i,o,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[i,o]of Object.entries(n))typeof o=="object"?r[i]=Object.assign(Object.assign({},r[i]),o):o!==void 0&&(r[i]=o);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,n,e.abortSignal),this.streamApiCall(i,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const i=new AbortController,o=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const s=setTimeout(()=>i.abort(),n.timeout);s&&typeof s.unref=="function"&&s.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),e.signal=o}return n&&n.extraBody!==null&&FV(e,n.extraBody),e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await d_(i),new uf(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await d_(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){var n;return Xi(this,arguments,function*(){const i=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),o=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let s="";for(;;){const{done:u,value:c}=yield Te(i.read());if(u){if(s.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=o.decode(c,{stream:!0});try{const p=JSON.parse(d);if("error"in p){const m=JSON.parse(JSON.stringify(p.error)),_=m.status,S=m.code,P=`got status: ${_}. ${JSON.stringify(p)}`;if(S>=400&&S<600)throw new Uu({message:P,status:S})}}catch(p){if(p.name==="ApiError")throw p}s+=d;let h=s.match(c_);for(;h;){const p=h[1];try{const m=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Te(new uf(m)),s=s.slice(h[0].length),h=s.match(c_)}catch(m){throw new Error(`exception parsing stream chunk ${p}. ${m}`)}}}}finally{i.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=kV+" "+this.clientOptions.userAgentExtra;return e[DV]=n,e[gf]=n,e[PV]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,i]of Object.entries(e.headers))n.append(r,i);e.timeout&&e.timeout>0&&n.append(xV,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const o=this.clientOptions.uploader,s=await o.stat(e);i.sizeBytes=String(s.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:s.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const c=await this.fetchUploadUrl(i,n);return o.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},s=await this.request({path:J("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:i});if(!s||!(s!=null&&s.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=s==null?void 0:s.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function d_(t){var e;if(t===void 0)throw new Error("response is undefined");if(!t.ok){const n=t.status;let r;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await t.json():r={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new Uu({message:i,status:n}):new Error(i)}}function FV(t,e){if(!e||Object.keys(e).length===0)return;if(t.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof t.body=="string"&&t.body.length>0)try{const o=JSON.parse(t.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))n=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(o,s){const u=Object.assign({},o);for(const c in s)if(Object.prototype.hasOwnProperty.call(s,c)){const d=s[c],h=u[c];d&&typeof d=="object"&&!Array.isArray(d)&&h&&typeof h=="object"&&!Array.isArray(h)?u[c]=r(h,d):(h&&d&&typeof h!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${c}". Original type: ${typeof h}, New type: ${typeof d}. Overwriting.`),u[c]=d)}return u}const i=r(n,e);t.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const UV="mcp_used/unknown";let bV=!1;function xI(t){for(const e of t)if(BV(e)||typeof e=="object"&&"inputSchema"in e)return!0;return bV}function DI(t){var e;const n=(e=t[gf])!==null&&e!==void 0?e:"";t[gf]=(n+` ${UV}`).trimStart()}function BV(t){return t!==null&&typeof t=="object"&&t instanceof Kh}function OV(t,e=100){return Xi(this,arguments,function*(){let r,i=0;for(;i<e;){const o=yield Te(t.listTools({cursor:r}));for(const s of o.tools)yield yield Te(s),i++;if(!o.nextCursor)break;r=o.nextCursor}})}class Kh{constructor(e=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=n}static create(e,n){return new Kh(e,n)}async initialize(){var e,n,r,i;if(this.mcpTools.length>0)return;const o={},s=[];for(const h of this.mcpClients)try{for(var u=!0,c=(n=void 0,Is(OV(h))),d;d=await c.next(),e=d.done,!e;u=!0){i=d.value,u=!1;const p=i;s.push(p);const m=p.name;if(o[m])throw new Error(`Duplicate function name ${m} found in MCP tools. Please ensure function names are unique.`);o[m]=h}}catch(p){n={error:p}}finally{try{!u&&!e&&(r=c.return)&&await r.call(c)}finally{if(n)throw n.error}}this.mcpTools=s,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),tP(this.mcpTools,this.config)}async callTool(e){await this.initialize();const n=[];for(const r of e)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const s=await i.callTool({name:r.name,arguments:r.args},void 0,o);n.push({functionResponse:{name:r.name,response:s.isError?{error:s}:s}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function qV(t,e,n){const r=new WR;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const o=DM(i);Object.assign(r,o),e(r)}class GV{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),s=HV(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),c=`${i}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${u}`;let d=()=>{};const h=new Promise(I=>{d=I}),p=e.callbacks,m=function(){d({})},_=this.apiClient,S={onopen:m,onmessage:I=>{qV(_,p.onmessage,I)},onerror:(n=p==null?void 0:p.onerror)!==null&&n!==void 0?n:function(I){},onclose:(r=p==null?void 0:p.onclose)!==null&&r!==void 0?r:function(I){}},P=this.webSocketFactory.create(c,zV(s),S);P.connect(),await h;const k=ue(this.apiClient,e.model),C=_I({model:k}),T=hf({setup:C});return P.send(JSON.stringify(T)),new $V(P,this.apiClient)}}class $V{constructor(e,n){this.conn=e,this.apiClient=n}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=NM(e),r=yI(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const n=kM(e),r=hf(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const n=hf({playbackControl:e});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl($i.PLAY)}pause(){this.sendPlaybackControl($i.PAUSE)}stop(){this.sendPlaybackControl($i.STOP)}resetContext(){this.sendPlaybackControl($i.RESET_CONTEXT)}close(){this.conn.close()}}function zV(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function HV(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const KV="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function WV(t,e,n){const r=new KR;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const o=JSON.parse(i);if(t.isVertexAI()){const s=GM(o);Object.assign(r,s)}else{const s=qM(o);Object.assign(r,s)}e(r)}class JV{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r,this.music=new GV(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var n,r,i,o,s,u;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&xI(e.config.tools)&&DI(p);const m=ZV(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(m);else{const w=this.apiClient.getApiKey();let R="BidiGenerateContent",D="key";w!=null&&w.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),R="BidiGenerateContentConstrained",D="access_token"),h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.${R}?${D}=${w}`}let _=()=>{};const S=new Promise(w=>{_=w}),P=e.callbacks,k=function(){var w;(w=P==null?void 0:P.onopen)===null||w===void 0||w.call(P),_({})},C=this.apiClient,T={onopen:k,onmessage:w=>{WV(C,P.onmessage,w)},onerror:(n=P==null?void 0:P.onerror)!==null&&n!==void 0?n:function(w){},onclose:(r=P==null?void 0:P.onclose)!==null&&r!==void 0?r:function(w){}},I=this.webSocketFactory.create(h,XV(m),T);I.connect(),await S;let M=ue(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const w=this.apiClient.getProject(),R=this.apiClient.getLocation();M=`projects/${w}/locations/${R}/`+M}let F={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[iu.AUDIO]}:e.config.responseModalities=[iu.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const b=(u=(s=e.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[],A=[];for(const w of b)if(this.isCallableTool(w)){const R=w;A.push(await R.tool())}else A.push(w);A.length>0&&(e.config.tools=A);const v={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?F=SM(this.apiClient,v):F=wM(this.apiClient,v),delete F.config,I.send(JSON.stringify(F)),new YV(I,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const QV={turnComplete:!0};class YV{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Kt(n.turns),e.isVertexAI()?r=r.map(i=>So(i)):r=r.map(i=>bu(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const o of r){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(KV)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},QV),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:FM(e)}:n={realtimeInput:LM(e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function XV(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function ZV(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f_=10;function h_(t){var e,n,r;if(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const s of(n=t==null?void 0:t.tools)!==null&&n!==void 0?n:[])if(Zi(s)){i=!0;break}if(!i)return!0;const o=(r=t==null?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function Zi(t){return"callTool"in t&&typeof t.callTool=="function"}function jV(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>Zi(i)))!==null&&r!==void 0?r:!1}function eL(t){var e,n,r;return(r=(n=(e=t.config)===null||e===void 0?void 0:e.tools)===null||n===void 0?void 0:n.some(i=>!Zi(i)))!==null&&r!==void 0?r:!1}function p_(t){var e;return!(!((e=t==null?void 0:t.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tL extends ui{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>{var r,i,o,s,u;const c=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!jV(n)||h_(n.config))return await this.generateContentInternal(c);if(eL(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let d,h;const p=Kt(c.contents),m=(o=(i=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&o!==void 0?o:f_;let _=0;for(;_<m&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const S=d.candidates[0].content,P=[];for(const k of(u=(s=n.config)===null||s===void 0?void 0:s.tools)!==null&&u!==void 0?u:[])if(Zi(k)){const T=await k.callTool(d.functionCalls);P.push(...T)}_++,h={role:"user",parts:P},c.contents=Kt(c.contents),c.contents.push(S),c.contents.push(h),p_(c.config)&&(p.push(S),p.push(h))}return p_(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),h_(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let o;const s=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((i=c==null?void 0:c.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?o=c==null?void 0:c.safetyAttributes:s.push(c);let u;return o?u={generatedImages:s,positivePromptSafetyAttributes:o,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:s,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async n=>{var r;const s={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!s.config.queryBase){if(!((r=s.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");s.config.filter="labels.tune-type:*"}return new cl(Xr.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(s),s)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>{if((n.prompt||n.image||n.video)&&n.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(n)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var n,r,i;const o=(n=e.config)===null||n===void 0?void 0:n.tools;if(!o)return e;const s=await Promise.all(o.map(async c=>Zi(c)?await c.tool():c)),u={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};if(u.config.tools=s,e.config&&e.config.tools&&xI(e.config.tools)){const c=(i=(r=e.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},c);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),DI(d),u.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return u}async initAfcToolsMap(e){var n,r,i;const o=new Map;for(const s of(r=(n=e.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Zi(s)){const u=s,c=await u.tool();for(const d of(i=c.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(o.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);o.set(d.name,u)}}return o}async processAfcStream(e){var n,r,i;const o=(i=(r=(n=e.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:f_;let s=!1,u=0;const c=await this.initAfcToolsMap(e);return function(d,h,p){var m,_;return Xi(this,arguments,function*(){for(var S,P,k,C;u<o;){s&&(u++,s=!1);const F=yield Te(d.processParamsMaybeAddMcpUsage(p)),b=yield Te(d.generateContentStreamInternal(F)),A=[],v=[];try{for(var T=!0,I=(P=void 0,Is(b)),M;M=yield Te(I.next()),S=M.done,!S;T=!0){C=M.value,T=!1;const w=C;if(yield yield Te(w),w.candidates&&(!((m=w.candidates[0])===null||m===void 0)&&m.content)){v.push(w.candidates[0].content);for(const R of(_=w.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(u<o&&R.functionCall){if(!R.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(R.functionCall.name)){const D=yield Te(h.get(R.functionCall.name).callTool([R.functionCall]));A.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${R.functionCall.name}`)}}}}catch(w){P={error:w}}finally{try{!T&&!S&&(k=I.return)&&(yield Te(k.call(I)))}finally{if(P)throw P.error}}if(A.length>0){s=!0;const w=new Zo;w.candidates=[{content:{role:"user",parts:A}}],yield yield Te(w);const R=[];R.push(...v),R.push({role:"user",parts:A});const D=Kt(p.contents).concat(R);p.contents=D}else break}})}(this,c,e)}async generateContentInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=l_(this.apiClient,e);return u=J("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=u_(h),m=new Zo;return Object.assign(m,p),m})}else{const d=s_(this.apiClient,e);return u=J("{model}:generateContent",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=a_(h),m=new Zo;return Object.assign(m,p),m})}}async generateContentStreamInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=l_(this.apiClient,e);return u=J("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),s.then(function(p){return Xi(this,arguments,function*(){var m,_,S,P;try{for(var k=!0,C=Is(p),T;T=yield Te(C.next()),m=T.done,!m;k=!0){P=T.value,k=!1;const I=P,M=u_(yield Te(I.json()));M.sdkHttpResponse={headers:I.headers};const F=new Zo;Object.assign(F,M),yield yield Te(F)}}catch(I){_={error:I}}finally{try{!k&&!m&&(S=C.return)&&(yield Te(S.call(C)))}finally{if(_)throw _.error}}})})}else{const d=s_(this.apiClient,e);return u=J("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.requestStream({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),s.then(function(p){return Xi(this,arguments,function*(){var m,_,S,P;try{for(var k=!0,C=Is(p),T;T=yield Te(C.next()),m=T.done,!m;k=!0){P=T.value,k=!1;const I=P,M=a_(yield Te(I.json()));M.sdkHttpResponse={headers:I.headers};const F=new Zo;Object.assign(F,M),yield yield Te(F)}}catch(I){_={error:I}}finally{try{!k&&!m&&(S=C.return)&&(yield Te(S.call(C)))}finally{if(_)throw _.error}}})})}}async embedContent(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=gN(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=_N(h),m=new Oy;return Object.assign(m,p),m})}else{const d=mN(this.apiClient,e);return u=J("{model}:batchEmbedContents",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=yN(h),m=new Oy;return Object.assign(m,p),m})}}async generateImagesInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=BN(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=qN(h),m=new qy;return Object.assign(m,p),m})}else{const d=bN(this.apiClient,e);return u=J("{model}:predict",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=ON(h),m=new qy;return Object.assign(m,p),m})}}async editImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=uN(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=cN(c),h=new bR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=dV(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=fV(c),h=new BR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=M1(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=k1(c),h=new OR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=$1(this.apiClient,e);return o=J("{model}:predict",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i.then(c=>{const d=z1(c),h=new qR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=r1(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>mf(h))}else{const d=n1(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>pf(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=y1(this.apiClient,e);return u=J("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=v1(h),m=new Gy;return Object.assign(m,p),m})}else{const d=g1(this.apiClient,e);return u=J("{models_url}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=_1(h),m=new Gy;return Object.assign(m,p),m})}}async update(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=uV(this.apiClient,e);return u=J("{model}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>mf(h))}else{const d=aV(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>pf(h))}}async delete(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=rN(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=oN(h),m=new $y;return Object.assign(m,p),m})}else{const d=nN(this.apiClient,e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=iN(h),m=new $y;return Object.assign(m,p),m})}}async countTokens(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=jk(this.apiClient,e);return u=J("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=tN(h),m=new zy;return Object.assign(m,p),m})}else{const d=Zk(this.apiClient,e);return u=J("{model}:countTokens",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=eN(h),m=new zy;return Object.assign(m,p),m})}}async computeTokens(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=Gk(this.apiClient,e);return o=J("{model}:computeTokens",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>{const d=$k(c),h=new GR;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=WN(this.apiClient,e);return u=J("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s.then(h=>{const p=HN(h),m=new ou;return Object.assign(m,p),m})}else{const d=KN(this.apiClient,e);return u=J("{model}:predictLongRunning",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s.then(h=>{const p=zN(h),m=new ou;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nL extends ui{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let o;r&&"httpOptions"in r&&(o=r.httpOptions);const s=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:o}});return n._fromAPIResponse({apiResponse:s,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=LR(e);return u=J("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),s}else{const d=VR(e);return u=J("{operationName}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json()),s}}async fetchPredictVideosOperationInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=RR(e);return o=J("{resourceName}:fetchPredictOperation",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function m_(){return{}}function rL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["name"],n),e}function iL(t){const e={},n=l(t,["disabled"]);n!=null&&a(e,["disabled"],n);const r=l(t,["startOfSpeechSensitivity"]);r!=null&&a(e,["startOfSpeechSensitivity"],r);const i=l(t,["endOfSpeechSensitivity"]);i!=null&&a(e,["endOfSpeechSensitivity"],i);const o=l(t,["prefixPaddingMs"]);o!=null&&a(e,["prefixPaddingMs"],o);const s=l(t,["silenceDurationMs"]);return s!=null&&a(e,["silenceDurationMs"],s),e}function oL(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["data"]);n!=null&&a(e,["data"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function sL(t){const e={},n=l(t,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(o=>TL(o))),a(e,["parts"],i)}const r=l(t,["role"]);return r!=null&&a(e,["role"],r),e}function lL(t){const e={},n=l(t,["triggerTokens"]);n!=null&&a(e,["triggerTokens"],n);const r=l(t,["slidingWindow"]);return r!=null&&a(e,["slidingWindow"],SL(r)),e}function aL(t,e,n){const r={},i=l(e,["expireTime"]);n!==void 0&&i!=null&&a(n,["expireTime"],i);const o=l(e,["newSessionExpireTime"]);n!==void 0&&o!=null&&a(n,["newSessionExpireTime"],o);const s=l(e,["uses"]);n!==void 0&&s!=null&&a(n,["uses"],s);const u=l(e,["liveConnectConstraints"]);n!==void 0&&u!=null&&a(n,["bidiGenerateContentSetup"],_L(t,u));const c=l(e,["lockAdditionalFields"]);return n!==void 0&&c!=null&&a(n,["fieldMask"],c),r}function uL(t,e){const n={},r=l(e,["config"]);return r!=null&&a(n,["config"],aL(t,r,n)),n}function cL(t){const e={},n=l(t,["mode"]);n!=null&&a(e,["mode"],n);const r=l(t,["dynamicThreshold"]);return r!=null&&a(e,["dynamicThreshold"],r),e}function dL(t){const e={};if(l(t,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=l(t,["fileUri"]);n!=null&&a(e,["fileUri"],n);const r=l(t,["mimeType"]);return r!=null&&a(e,["mimeType"],r),e}function fL(t){const e={},n=l(t,["id"]);n!=null&&a(e,["id"],n);const r=l(t,["args"]);r!=null&&a(e,["args"],r);const i=l(t,["name"]);return i!=null&&a(e,["name"],i),e}function hL(t){const e={},n=l(t,["behavior"]);n!=null&&a(e,["behavior"],n);const r=l(t,["description"]);r!=null&&a(e,["description"],r);const i=l(t,["name"]);i!=null&&a(e,["name"],i);const o=l(t,["parameters"]);o!=null&&a(e,["parameters"],o);const s=l(t,["parametersJsonSchema"]);s!=null&&a(e,["parametersJsonSchema"],s);const u=l(t,["response"]);u!=null&&a(e,["response"],u);const c=l(t,["responseJsonSchema"]);return c!=null&&a(e,["responseJsonSchema"],c),e}function pL(t){const e={},n=l(t,["dynamicRetrievalConfig"]);return n!=null&&a(e,["dynamicRetrievalConfig"],cL(n)),e}function mL(t){const e={},n=l(t,["timeRangeFilter"]);if(n!=null&&a(e,["timeRangeFilter"],gL(n)),l(t,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function gL(t){const e={},n=l(t,["startTime"]);n!=null&&a(e,["startTime"],n);const r=l(t,["endTime"]);return r!=null&&a(e,["endTime"],r),e}function yL(t,e){const n={},r=l(t,["generationConfig"]);e!==void 0&&r!=null&&a(e,["setup","generationConfig"],r);const i=l(t,["responseModalities"]);e!==void 0&&i!=null&&a(e,["setup","generationConfig","responseModalities"],i);const o=l(t,["temperature"]);e!==void 0&&o!=null&&a(e,["setup","generationConfig","temperature"],o);const s=l(t,["topP"]);e!==void 0&&s!=null&&a(e,["setup","generationConfig","topP"],s);const u=l(t,["topK"]);e!==void 0&&u!=null&&a(e,["setup","generationConfig","topK"],u);const c=l(t,["maxOutputTokens"]);e!==void 0&&c!=null&&a(e,["setup","generationConfig","maxOutputTokens"],c);const d=l(t,["mediaResolution"]);e!==void 0&&d!=null&&a(e,["setup","generationConfig","mediaResolution"],d);const h=l(t,["seed"]);e!==void 0&&h!=null&&a(e,["setup","generationConfig","seed"],h);const p=l(t,["speechConfig"]);e!==void 0&&p!=null&&a(e,["setup","generationConfig","speechConfig"],RL(zh(p)));const m=l(t,["enableAffectiveDialog"]);e!==void 0&&m!=null&&a(e,["setup","generationConfig","enableAffectiveDialog"],m);const _=l(t,["systemInstruction"]);e!==void 0&&_!=null&&a(e,["setup","systemInstruction"],sL(ut(_)));const S=l(t,["tools"]);if(e!==void 0&&S!=null){let F=Co(S);Array.isArray(F)&&(F=F.map(b=>xL(Io(b)))),a(e,["setup","tools"],F)}const P=l(t,["sessionResumption"]);e!==void 0&&P!=null&&a(e,["setup","sessionResumption"],wL(P));const k=l(t,["inputAudioTranscription"]);e!==void 0&&k!=null&&a(e,["setup","inputAudioTranscription"],m_());const C=l(t,["outputAudioTranscription"]);e!==void 0&&C!=null&&a(e,["setup","outputAudioTranscription"],m_());const T=l(t,["realtimeInputConfig"]);e!==void 0&&T!=null&&a(e,["setup","realtimeInputConfig"],CL(T));const I=l(t,["contextWindowCompression"]);e!==void 0&&I!=null&&a(e,["setup","contextWindowCompression"],lL(I));const M=l(t,["proactivity"]);return e!==void 0&&M!=null&&a(e,["setup","proactivity"],IL(M)),n}function _L(t,e){const n={},r=l(e,["model"]);r!=null&&a(n,["setup","model"],ue(t,r));const i=l(e,["config"]);return i!=null&&a(n,["config"],yL(i,n)),n}function vL(t){const e={},n=l(t,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>AL(i))),a(e,["speakerVoiceConfigs"],r)}return e}function TL(t){const e={},n=l(t,["videoMetadata"]);n!=null&&a(e,["videoMetadata"],ML(n));const r=l(t,["thought"]);r!=null&&a(e,["thought"],r);const i=l(t,["inlineData"]);i!=null&&a(e,["inlineData"],oL(i));const o=l(t,["fileData"]);o!=null&&a(e,["fileData"],dL(o));const s=l(t,["thoughtSignature"]);s!=null&&a(e,["thoughtSignature"],s);const u=l(t,["functionCall"]);u!=null&&a(e,["functionCall"],fL(u));const c=l(t,["codeExecutionResult"]);c!=null&&a(e,["codeExecutionResult"],c);const d=l(t,["executableCode"]);d!=null&&a(e,["executableCode"],d);const h=l(t,["functionResponse"]);h!=null&&a(e,["functionResponse"],h);const p=l(t,["text"]);return p!=null&&a(e,["text"],p),e}function EL(t){const e={},n=l(t,["voiceName"]);return n!=null&&a(e,["voiceName"],n),e}function IL(t){const e={},n=l(t,["proactiveAudio"]);return n!=null&&a(e,["proactiveAudio"],n),e}function CL(t){const e={},n=l(t,["automaticActivityDetection"]);n!=null&&a(e,["automaticActivityDetection"],iL(n));const r=l(t,["activityHandling"]);r!=null&&a(e,["activityHandling"],r);const i=l(t,["turnCoverage"]);return i!=null&&a(e,["turnCoverage"],i),e}function wL(t){const e={},n=l(t,["handle"]);if(n!=null&&a(e,["handle"],n),l(t,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function SL(t){const e={},n=l(t,["targetTokens"]);return n!=null&&a(e,["targetTokens"],n),e}function AL(t){const e={},n=l(t,["speaker"]);n!=null&&a(e,["speaker"],n);const r=l(t,["voiceConfig"]);return r!=null&&a(e,["voiceConfig"],MI(r)),e}function RL(t){const e={},n=l(t,["voiceConfig"]);n!=null&&a(e,["voiceConfig"],MI(n));const r=l(t,["multiSpeakerVoiceConfig"]);r!=null&&a(e,["multiSpeakerVoiceConfig"],vL(r));const i=l(t,["languageCode"]);return i!=null&&a(e,["languageCode"],i),e}function PL(t){const e={},n=l(t,["environment"]);n!=null&&a(e,["environment"],n);const r=l(t,["excludedPredefinedFunctions"]);return r!=null&&a(e,["excludedPredefinedFunctions"],r),e}function xL(t){const e={},n=l(t,["functionDeclarations"]);if(n!=null){let c=n;Array.isArray(c)&&(c=c.map(d=>hL(d))),a(e,["functionDeclarations"],c)}if(l(t,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=l(t,["googleSearch"]);r!=null&&a(e,["googleSearch"],mL(r));const i=l(t,["googleSearchRetrieval"]);if(i!=null&&a(e,["googleSearchRetrieval"],pL(i)),l(t,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(l(t,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");l(t,["urlContext"])!=null&&a(e,["urlContext"],DL());const s=l(t,["computerUse"]);s!=null&&a(e,["computerUse"],PL(s));const u=l(t,["codeExecution"]);return u!=null&&a(e,["codeExecution"],u),e}function DL(){return{}}function ML(t){const e={},n=l(t,["fps"]);n!=null&&a(e,["fps"],n);const r=l(t,["endOffset"]);r!=null&&a(e,["endOffset"],r);const i=l(t,["startOffset"]);return i!=null&&a(e,["startOffset"],i),e}function MI(t){const e={},n=l(t,["prebuiltVoiceConfig"]);return n!=null&&a(e,["prebuiltVoiceConfig"],EL(n)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kL(t){const e=[];for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)){const r=t[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(o=>`${n}.${o}`);e.push(...i)}else e.push(n)}return e.join(",")}function NL(t,e){let n=null;const r=t.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const o=r.setup;typeof o=="object"&&o!==null?(t.bidiGenerateContentSetup=o,n=o):delete t.bidiGenerateContentSetup}else r!==void 0&&delete t.bidiGenerateContentSetup;const i=t.fieldMask;if(n){const o=kL(n);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?t.fieldMask=o:delete t.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const s=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(d=>s.includes(d)?`generationConfig.${d}`:d));const c=[];o&&c.push(o),u.length>0&&c.push(...u),c.length>0?t.fieldMask=c.join(","):delete t.fieldMask}else delete t.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?t.fieldMask=i.join(","):delete t.fieldMask;return t}class VL extends ui{constructor(e){super(),this.apiClient=e}async create(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=uL(this.apiClient,e);o=J("auth_tokens",u._url),s=u._query,delete u.config,delete u._url,delete u._query;const c=NL(u,e.config);return i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>rL(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function LL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function FL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function UL(t,e){const n={};if(l(t,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=l(t,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&a(e,["displayName"],r),l(t,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=l(t,["epochCount"]);e!==void 0&&i!=null&&a(e,["tuningTask","hyperparameters","epochCount"],i);const o=l(t,["learningRateMultiplier"]);if(o!=null&&a(n,["tuningTask","hyperparameters","learningRateMultiplier"],o),l(t,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(l(t,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(l(t,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const s=l(t,["batchSize"]);e!==void 0&&s!=null&&a(e,["tuningTask","hyperparameters","batchSize"],s);const u=l(t,["learningRate"]);if(e!==void 0&&u!=null&&a(e,["tuningTask","hyperparameters","learningRate"],u),l(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");return n}function bL(t,e){const n={},r=l(t,["validationDataset"]);e!==void 0&&r!=null&&a(e,["supervisedTuningSpec"],nF(r,n));const i=l(t,["tunedModelDisplayName"]);e!==void 0&&i!=null&&a(e,["tunedModelDisplayName"],i);const o=l(t,["description"]);e!==void 0&&o!=null&&a(e,["description"],o);const s=l(t,["epochCount"]);e!==void 0&&s!=null&&a(e,["supervisedTuningSpec","hyperParameters","epochCount"],s);const u=l(t,["learningRateMultiplier"]);e!==void 0&&u!=null&&a(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const c=l(t,["exportLastCheckpointOnly"]);e!==void 0&&c!=null&&a(e,["supervisedTuningSpec","exportLastCheckpointOnly"],c);const d=l(t,["adapterSize"]);if(e!==void 0&&d!=null&&a(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),l(t,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(l(t,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const h=l(t,["labels"]);return e!==void 0&&h!=null&&a(e,["labels"],h),n}function BL(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["preTunedModel"]);r!=null&&a(e,["preTunedModel"],r);const i=l(t,["trainingDataset"]);i!=null&&a(e,["tuningTask","trainingData"],ZL(i));const o=l(t,["config"]);return o!=null&&UL(o,e),e}function OL(t){const e={},n=l(t,["baseModel"]);n!=null&&a(e,["baseModel"],n);const r=l(t,["preTunedModel"]);r!=null&&a(e,["preTunedModel"],r);const i=l(t,["trainingDataset"]);i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],jL(i,e));const o=l(t,["config"]);return o!=null&&bL(o,e),e}function qL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function GL(t){const e={},n=l(t,["name"]);return n!=null&&a(e,["_url","name"],n),e}function $L(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function zL(t,e){const n={},r=l(t,["pageSize"]);e!==void 0&&r!=null&&a(e,["_query","pageSize"],r);const i=l(t,["pageToken"]);e!==void 0&&i!=null&&a(e,["_query","pageToken"],i);const o=l(t,["filter"]);return e!==void 0&&o!=null&&a(e,["_query","filter"],o),n}function HL(t){const e={},n=l(t,["config"]);return n!=null&&$L(n,e),e}function KL(t){const e={},n=l(t,["config"]);return n!=null&&zL(n,e),e}function WL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["tunedModels"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>kI(s))),a(e,["tuningJobs"],o)}return e}function JL(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["nextPageToken"]);r!=null&&a(e,["nextPageToken"],r);const i=l(t,["tuningJobs"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>yf(s))),a(e,["tuningJobs"],o)}return e}function QL(t){const e={},n=l(t,["checkpointId"]);n!=null&&a(e,["checkpointId"],n);const r=l(t,["epoch"]);r!=null&&a(e,["epoch"],r);const i=l(t,["step"]);i!=null&&a(e,["step"],i);const o=l(t,["endpoint"]);return o!=null&&a(e,["endpoint"],o),e}function YL(t){const e={},n=l(t,["name"]);n!=null&&a(e,["model"],n);const r=l(t,["name"]);return r!=null&&a(e,["endpoint"],r),e}function XL(t){const e={},n=l(t,["model"]);n!=null&&a(e,["model"],n);const r=l(t,["endpoint"]);r!=null&&a(e,["endpoint"],r);const i=l(t,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(s=>QL(s))),a(e,["checkpoints"],o)}return e}function ZL(t){const e={};if(l(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(l(t,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=l(t,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>eF(i))),a(e,["examples","examples"],r)}return e}function jL(t,e){const n={},r=l(t,["gcsUri"]);e!==void 0&&r!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],r);const i=l(t,["vertexDatasetResource"]);if(e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),l(t,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function eF(t){const e={},n=l(t,["textInput"]);n!=null&&a(e,["textInput"],n);const r=l(t,["output"]);return r!=null&&a(e,["output"],r),e}function kI(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],iI(i));const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["tuningTask","startTime"]);s!=null&&a(e,["startTime"],s);const u=l(t,["tuningTask","completeTime"]);u!=null&&a(e,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["description"]);d!=null&&a(e,["description"],d);const h=l(t,["baseModel"]);h!=null&&a(e,["baseModel"],h);const p=l(t,["_self"]);p!=null&&a(e,["tunedModel"],YL(p));const m=l(t,["customBaseModel"]);m!=null&&a(e,["customBaseModel"],m);const _=l(t,["experiment"]);_!=null&&a(e,["experiment"],_);const S=l(t,["labels"]);S!=null&&a(e,["labels"],S);const P=l(t,["outputUri"]);P!=null&&a(e,["outputUri"],P);const k=l(t,["pipelineJob"]);k!=null&&a(e,["pipelineJob"],k);const C=l(t,["serviceAccount"]);C!=null&&a(e,["serviceAccount"],C);const T=l(t,["tunedModelDisplayName"]);return T!=null&&a(e,["tunedModelDisplayName"],T),e}function yf(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["state"]);i!=null&&a(e,["state"],iI(i));const o=l(t,["createTime"]);o!=null&&a(e,["createTime"],o);const s=l(t,["startTime"]);s!=null&&a(e,["startTime"],s);const u=l(t,["endTime"]);u!=null&&a(e,["endTime"],u);const c=l(t,["updateTime"]);c!=null&&a(e,["updateTime"],c);const d=l(t,["error"]);d!=null&&a(e,["error"],d);const h=l(t,["description"]);h!=null&&a(e,["description"],h);const p=l(t,["baseModel"]);p!=null&&a(e,["baseModel"],p);const m=l(t,["tunedModel"]);m!=null&&a(e,["tunedModel"],XL(m));const _=l(t,["preTunedModel"]);_!=null&&a(e,["preTunedModel"],_);const S=l(t,["supervisedTuningSpec"]);S!=null&&a(e,["supervisedTuningSpec"],S);const P=l(t,["tuningDataStats"]);P!=null&&a(e,["tuningDataStats"],P);const k=l(t,["encryptionSpec"]);k!=null&&a(e,["encryptionSpec"],k);const C=l(t,["partnerModelTuningSpec"]);C!=null&&a(e,["partnerModelTuningSpec"],C);const T=l(t,["customBaseModel"]);T!=null&&a(e,["customBaseModel"],T);const I=l(t,["experiment"]);I!=null&&a(e,["experiment"],I);const M=l(t,["labels"]);M!=null&&a(e,["labels"],M);const F=l(t,["outputUri"]);F!=null&&a(e,["outputUri"],F);const b=l(t,["pipelineJob"]);b!=null&&a(e,["pipelineJob"],b);const A=l(t,["serviceAccount"]);A!=null&&a(e,["serviceAccount"],A);const v=l(t,["tunedModelDisplayName"]);return v!=null&&a(e,["tunedModelDisplayName"],v),e}function tF(t){const e={},n=l(t,["sdkHttpResponse"]);n!=null&&a(e,["sdkHttpResponse"],n);const r=l(t,["name"]);r!=null&&a(e,["name"],r);const i=l(t,["metadata"]);i!=null&&a(e,["metadata"],i);const o=l(t,["done"]);o!=null&&a(e,["done"],o);const s=l(t,["error"]);return s!=null&&a(e,["error"],s),e}function nF(t,e){const n={},r=l(t,["gcsUri"]);r!=null&&a(n,["validationDatasetUri"],r);const i=l(t,["vertexDatasetResource"]);return e!==void 0&&i!=null&&a(e,["supervisedTuningSpec","trainingDatasetUri"],i),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rF extends ui{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new cl(Xr.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{var r;if(this.apiClient.isVertexAI())if(n.baseModel.startsWith("projects/")){const i={tunedModelName:n.baseModel};!((r=n.config)===null||r===void 0)&&r.preTunedModelCheckpointId&&(i.checkpointId=n.config.preTunedModelCheckpointId);const o=Object.assign(Object.assign({},n),{preTunedModel:i});return o.baseModel=void 0,await this.tuneInternal(o)}else{const i=Object.assign({},n);return await this.tuneInternal(i)}else{const i=Object.assign({},n),o=await this.tuneMldevInternal(i);let s="";return o.metadata!==void 0&&o.metadata.tunedModel!==void 0?s=o.metadata.tunedModel:o.name!==void 0&&o.name.includes("/operations/")&&(s=o.name.split("/operations/")[0]),{name:s,state:af.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=GL(e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>yf(h))}else{const d=qL(e);return u=J("{name}",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>kI(h))}}async listInternal(e){var n,r,i,o;let s,u="",c={};if(this.apiClient.isVertexAI()){const d=KL(e);return u=J("tuningJobs",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=JL(h),m=new Hy;return Object.assign(m,p),m})}else{const d=HL(e);return u=J("tunedModels",d._url),c=d._query,delete d._url,delete d._query,s=this.apiClient.request({path:u,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(h=>h.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:h.headers},m})),s.then(h=>{const p=WL(h),m=new Hy;return Object.assign(m,p),m})}}async cancel(e){var n,r,i,o;let s="",u={};if(this.apiClient.isVertexAI()){const c=FL(e);s=J("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}else{const c=LL(e);s=J("{name}:cancel",c._url),u=c._query,delete c._url,delete c._query,await this.apiClient.request({path:s,queryParams:u,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI()){const u=OL(e);return o=J("tuningJobs",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>yf(c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let i,o="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=BL(e);return o=J("tunedModels",u._url),s=u._query,delete u._url,delete u._query,i=this.apiClient.request({path:o,queryParams:s,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(d=>{const h=d;return h.sdkHttpResponse={headers:c.headers},h})),i.then(c=>tF(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class iF{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const oF=1024*1024*8,sF=3,lF=1e3,aF=2,nd="x-goog-upload-status";async function uF(t,e,n){var r,i,o;let s=0,u=0,c=new uf(new Response),d="upload";for(s=t.size;u<s;){const p=Math.min(oF,s-u),m=t.slice(u,u+p);u+p>=s&&(d+=", finalize");let _=0,S=lF;for(;_<sF&&(c=await n.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(u),"Content-Length":String(p)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[nd]));)_++,await dF(S),S=S*aF;if(u+=p,((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[nd])!=="active")break;if(s<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(c==null?void 0:c.json());if(((o=c==null?void 0:c.headers)===null||o===void 0?void 0:o[nd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function cF(t){return{size:t.size,type:t.type}}function dF(t){return new Promise(e=>setTimeout(e,t))}class fF{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await uF(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await cF(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class hF{create(e,n,r){return new pF(e,n,r)}}class pF{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const g_="x-goog-api-key";class mF{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(g_)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(g_,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gF="gl-node/";class yF{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=AR(e.httpOptions,e.vertexai,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const i=new mF(this.apiKey);this.apiClient=new LV({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:gF+"web",uploader:new fF,downloader:new iF}),this.models=new tL(this.apiClient),this.live=new JV(this.apiClient,i,new hF),this.batches=new yx(this.apiClient),this.chats=new SD(this.models,this.apiClient),this.caches=new ID(this.apiClient),this.files=new bD(this.apiClient),this.operations=new nL(this.apiClient),this.authTokens=new VL(this.apiClient),this.tunings=new rF(this.apiClient)}}var y_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NI=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},_F=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[n++];e[r++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[n++],s=t[n++],u=t[n++],c=((i&7)<<18|(o&63)<<12|(s&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const o=t[n++],s=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(o&63)<<6|s&63)}}return e.join("")},VI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const o=t[i],s=i+1<t.length,u=s?t[i+1]:0,c=i+2<t.length,d=c?t[i+2]:0,h=o>>2,p=(o&3)<<4|u>>4;let m=(u&15)<<2|d>>6,_=d&63;c||(_=64,s||(m=64)),r.push(n[h],n[p],n[m],n[_])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(NI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):_F(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const o=n[t.charAt(i++)],u=i<t.length?n[t.charAt(i)]:0;++i;const d=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,o==null||u==null||d==null||p==null)throw new vF;const m=o<<2|u>>4;if(r.push(m),d!==64){const _=u<<4&240|d>>2;if(r.push(_),p!==64){const S=d<<6&192|p;r.push(S)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class vF extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TF=function(t){const e=NI(t);return VI.encodeByteArray(e,!0)},lu=function(t){return TF(t).replace(/\./g,"")},EF=function(t){try{return VI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IF(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CF=()=>IF().__FIREBASE_DEFAULTS__,wF=()=>{if(typeof process>"u"||typeof y_>"u")return;const t=y_.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},SF=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&EF(t[1]);return e&&JSON.parse(e)},Wh=()=>{try{return CF()||wF()||SF()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},AF=t=>{var e,n;return(n=(e=Wh())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},LI=t=>{const e=AF(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},FI=()=>{var t;return(t=Wh())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[lu(JSON.stringify(n)),lu(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PF(){var t;const e=(t=Wh())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bI(){return!PF()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function BI(){try{return typeof indexedDB=="object"}catch{return!1}}function xF(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DF="FirebaseError";class di extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=DF,Object.setPrototypeOf(this,di.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,OI.prototype.create)}}class OI{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,o=this.errors[e],s=o?MF(o,r):"Error",u=`${this.serviceName}: ${s} (${i}).`;return new di(i,u,r)}}function MF(t,e){return t.replace(kF,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const kF=/\{\$([^}]+)}/g;function _f(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const o=t[i],s=e[i];if(__(o)&&__(s)){if(!_f(o,s))return!1}else if(o!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function __(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t){return t&&t._delegate?t._delegate:t}class lo{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kr="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new RF;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(LF(e))try{this.getOrInitializeService({instanceIdentifier:kr})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:i});r.resolve(o)}catch{}}}}clearInstance(e=kr){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kr){return this.instances.has(e)}getOptions(e=kr){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,s]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);r===u&&s.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(i,o);const s=this.instances.get(i);return s&&e(s,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:VF(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kr){return this.component?this.component.multipleInstances?e:kr:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VF(t){return t===kr?void 0:t}function LF(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FF{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new NF(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var se;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(se||(se={}));const UF={debug:se.DEBUG,verbose:se.VERBOSE,info:se.INFO,warn:se.WARN,error:se.ERROR,silent:se.SILENT},bF=se.INFO,BF={[se.DEBUG]:"log",[se.VERBOSE]:"log",[se.INFO]:"info",[se.WARN]:"warn",[se.ERROR]:"error"},OF=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=BF[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qI{constructor(e){this.name=e,this._logLevel=bF,this._logHandler=OF,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in se))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?UF[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,se.DEBUG,...e),this._logHandler(this,se.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,se.VERBOSE,...e),this._logHandler(this,se.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,se.INFO,...e),this._logHandler(this,se.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,se.WARN,...e),this._logHandler(this,se.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,se.ERROR,...e),this._logHandler(this,se.ERROR,...e)}}const qF=(t,e)=>e.some(n=>t instanceof n);let v_,T_;function GF(){return v_||(v_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function $F(){return T_||(T_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const GI=new WeakMap,vf=new WeakMap,$I=new WeakMap,rd=new WeakMap,Jh=new WeakMap;function zF(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",s)},o=()=>{n(ur(t.result)),i()},s=()=>{r(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",s)});return e.then(n=>{n instanceof IDBCursor&&GI.set(n,t)}).catch(()=>{}),Jh.set(e,t),e}function HF(t){if(vf.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",s),t.removeEventListener("abort",s)},o=()=>{n(),i()},s=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",s),t.addEventListener("abort",s)});vf.set(t,e)}let Tf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return vf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$I.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ur(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function KF(t){Tf=t(Tf)}function WF(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(id(this),e,...n);return $I.set(r,e.sort?e.sort():[e]),ur(r)}:$F().includes(t)?function(...e){return t.apply(id(this),e),ur(GI.get(this))}:function(...e){return ur(t.apply(id(this),e))}}function JF(t){return typeof t=="function"?WF(t):(t instanceof IDBTransaction&&HF(t),qF(t,GF())?new Proxy(t,Tf):t)}function ur(t){if(t instanceof IDBRequest)return zF(t);if(rd.has(t))return rd.get(t);const e=JF(t);return e!==t&&(rd.set(t,e),Jh.set(e,t)),e}const id=t=>Jh.get(t);function QF(t,e,{blocked:n,upgrade:r,blocking:i,terminated:o}={}){const s=indexedDB.open(t,e),u=ur(s);return r&&s.addEventListener("upgradeneeded",c=>{r(ur(s.result),c.oldVersion,c.newVersion,ur(s.transaction),c)}),n&&s.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),u.then(c=>{o&&c.addEventListener("close",()=>o()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const YF=["get","getKey","getAll","getAllKeys","count"],XF=["put","add","delete","clear"],od=new Map;function E_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(od.get(e))return od.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=XF.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||YF.includes(n)))return;const o=async function(s,...u){const c=this.transaction(s,i?"readwrite":"readonly");let d=c.store;return r&&(d=d.index(u.shift())),(await Promise.all([d[n](...u),i&&c.done]))[0]};return od.set(e,o),o}KF(t=>({...t,get:(e,n,r)=>E_(e,n)||t.get(e,n,r),has:(e,n)=>!!E_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(jF(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function jF(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Ef="@firebase/app",I_="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn=new qI("@firebase/app"),e2="@firebase/app-compat",t2="@firebase/analytics-compat",n2="@firebase/analytics",r2="@firebase/app-check-compat",i2="@firebase/app-check",o2="@firebase/auth",s2="@firebase/auth-compat",l2="@firebase/database",a2="@firebase/data-connect",u2="@firebase/database-compat",c2="@firebase/functions",d2="@firebase/functions-compat",f2="@firebase/installations",h2="@firebase/installations-compat",p2="@firebase/messaging",m2="@firebase/messaging-compat",g2="@firebase/performance",y2="@firebase/performance-compat",_2="@firebase/remote-config",v2="@firebase/remote-config-compat",T2="@firebase/storage",E2="@firebase/storage-compat",I2="@firebase/firestore",C2="@firebase/vertexai-preview",w2="@firebase/firestore-compat",S2="firebase",A2="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const If="[DEFAULT]",R2={[Ef]:"fire-core",[e2]:"fire-core-compat",[n2]:"fire-analytics",[t2]:"fire-analytics-compat",[i2]:"fire-app-check",[r2]:"fire-app-check-compat",[o2]:"fire-auth",[s2]:"fire-auth-compat",[l2]:"fire-rtdb",[a2]:"fire-data-connect",[u2]:"fire-rtdb-compat",[c2]:"fire-fn",[d2]:"fire-fn-compat",[f2]:"fire-iid",[h2]:"fire-iid-compat",[p2]:"fire-fcm",[m2]:"fire-fcm-compat",[g2]:"fire-perf",[y2]:"fire-perf-compat",[_2]:"fire-rc",[v2]:"fire-rc-compat",[T2]:"fire-gcs",[E2]:"fire-gcs-compat",[I2]:"fire-fst",[w2]:"fire-fst-compat",[C2]:"fire-vertex","fire-js":"fire-js",[S2]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu=new Map,P2=new Map,Cf=new Map;function C_(t,e){try{t.container.addComponent(e)}catch(n){Vn.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Ks(t){const e=t.name;if(Cf.has(e))return Vn.debug(`There were multiple attempts to register component ${e}.`),!1;Cf.set(e,t);for(const n of uu.values())C_(n,t);for(const n of P2.values())C_(n,t);return!0}function zI(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x2={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cr=new OI("app","Firebase",x2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D2{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw cr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HI=A2;function KI(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:If,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw cr.create("bad-app-name",{appName:String(i)});if(n||(n=FI()),!n)throw cr.create("no-options");const o=uu.get(i);if(o){if(_f(n,o.options)&&_f(r,o.config))return o;throw cr.create("duplicate-app",{appName:i})}const s=new FF(i);for(const c of Cf.values())s.addComponent(c);const u=new D2(n,r,s);return uu.set(i,u),u}function WI(t=If){const e=uu.get(t);if(!e&&t===If&&FI())return KI();if(!e)throw cr.create("no-app",{appName:t});return e}function dr(t,e,n){var r;let i=(r=R2[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&s&&u.push("and"),s&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vn.warn(u.join(" "));return}Ks(new lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M2="firebase-heartbeat-database",k2=1,Ws="firebase-heartbeat-store";let sd=null;function JI(){return sd||(sd=QF(M2,k2,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ws)}catch(n){console.warn(n)}}}}).catch(t=>{throw cr.create("idb-open",{originalErrorMessage:t.message})})),sd}async function N2(t){try{const n=(await JI()).transaction(Ws),r=await n.objectStore(Ws).get(QI(t));return await n.done,r}catch(e){if(e instanceof di)Vn.warn(e.message);else{const n=cr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Vn.warn(n.message)}}}async function w_(t,e){try{const r=(await JI()).transaction(Ws,"readwrite");await r.objectStore(Ws).put(e,QI(t)),await r.done}catch(n){if(n instanceof di)Vn.warn(n.message);else{const r=cr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Vn.warn(r.message)}}}function QI(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V2=1024,L2=30*24*60*60*1e3;class F2{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new b2(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=S_();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(s=>s.date===o)?void 0:(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(s=>{const u=new Date(s.date).valueOf();return Date.now()-u<=L2}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Vn.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=S_(),{heartbeatsToSend:r,unsentEntries:i}=U2(this._heartbeatsCache.heartbeats),o=lu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Vn.warn(n),""}}}function S_(){return new Date().toISOString().substring(0,10)}function U2(t,e=V2){const n=[];let r=t.slice();for(const i of t){const o=n.find(s=>s.agent===i.agent);if(o){if(o.dates.push(i.date),A_(n)>e){o.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),A_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class b2{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return BI()?xF().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await N2(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return w_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return w_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function A_(t){return lu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(t){Ks(new lo("platform-logger",e=>new ZF(e),"PRIVATE")),Ks(new lo("heartbeat",e=>new F2(e),"PRIVATE")),dr(Ef,I_,t),dr(Ef,I_,"esm2017"),dr("fire-js","")}B2("");var R_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var $r,YI;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,v){function w(){}w.prototype=v.prototype,A.D=v.prototype,A.prototype=new w,A.prototype.constructor=A,A.C=function(R,D,N){for(var x=Array(arguments.length-2),Se=2;Se<arguments.length;Se++)x[Se-2]=arguments[Se];return v.prototype[D].apply(R,x)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,v,w){w||(w=0);var R=Array(16);if(typeof v=="string")for(var D=0;16>D;++D)R[D]=v.charCodeAt(w++)|v.charCodeAt(w++)<<8|v.charCodeAt(w++)<<16|v.charCodeAt(w++)<<24;else for(D=0;16>D;++D)R[D]=v[w++]|v[w++]<<8|v[w++]<<16|v[w++]<<24;v=A.g[0],w=A.g[1],D=A.g[2];var N=A.g[3],x=v+(N^w&(D^N))+R[0]+3614090360&4294967295;v=w+(x<<7&4294967295|x>>>25),x=N+(D^v&(w^D))+R[1]+3905402710&4294967295,N=v+(x<<12&4294967295|x>>>20),x=D+(w^N&(v^w))+R[2]+606105819&4294967295,D=N+(x<<17&4294967295|x>>>15),x=w+(v^D&(N^v))+R[3]+3250441966&4294967295,w=D+(x<<22&4294967295|x>>>10),x=v+(N^w&(D^N))+R[4]+4118548399&4294967295,v=w+(x<<7&4294967295|x>>>25),x=N+(D^v&(w^D))+R[5]+1200080426&4294967295,N=v+(x<<12&4294967295|x>>>20),x=D+(w^N&(v^w))+R[6]+2821735955&4294967295,D=N+(x<<17&4294967295|x>>>15),x=w+(v^D&(N^v))+R[7]+4249261313&4294967295,w=D+(x<<22&4294967295|x>>>10),x=v+(N^w&(D^N))+R[8]+1770035416&4294967295,v=w+(x<<7&4294967295|x>>>25),x=N+(D^v&(w^D))+R[9]+2336552879&4294967295,N=v+(x<<12&4294967295|x>>>20),x=D+(w^N&(v^w))+R[10]+4294925233&4294967295,D=N+(x<<17&4294967295|x>>>15),x=w+(v^D&(N^v))+R[11]+2304563134&4294967295,w=D+(x<<22&4294967295|x>>>10),x=v+(N^w&(D^N))+R[12]+1804603682&4294967295,v=w+(x<<7&4294967295|x>>>25),x=N+(D^v&(w^D))+R[13]+4254626195&4294967295,N=v+(x<<12&4294967295|x>>>20),x=D+(w^N&(v^w))+R[14]+2792965006&4294967295,D=N+(x<<17&4294967295|x>>>15),x=w+(v^D&(N^v))+R[15]+1236535329&4294967295,w=D+(x<<22&4294967295|x>>>10),x=v+(D^N&(w^D))+R[1]+4129170786&4294967295,v=w+(x<<5&4294967295|x>>>27),x=N+(w^D&(v^w))+R[6]+3225465664&4294967295,N=v+(x<<9&4294967295|x>>>23),x=D+(v^w&(N^v))+R[11]+643717713&4294967295,D=N+(x<<14&4294967295|x>>>18),x=w+(N^v&(D^N))+R[0]+3921069994&4294967295,w=D+(x<<20&4294967295|x>>>12),x=v+(D^N&(w^D))+R[5]+3593408605&4294967295,v=w+(x<<5&4294967295|x>>>27),x=N+(w^D&(v^w))+R[10]+38016083&4294967295,N=v+(x<<9&4294967295|x>>>23),x=D+(v^w&(N^v))+R[15]+3634488961&4294967295,D=N+(x<<14&4294967295|x>>>18),x=w+(N^v&(D^N))+R[4]+3889429448&4294967295,w=D+(x<<20&4294967295|x>>>12),x=v+(D^N&(w^D))+R[9]+568446438&4294967295,v=w+(x<<5&4294967295|x>>>27),x=N+(w^D&(v^w))+R[14]+3275163606&4294967295,N=v+(x<<9&4294967295|x>>>23),x=D+(v^w&(N^v))+R[3]+4107603335&4294967295,D=N+(x<<14&4294967295|x>>>18),x=w+(N^v&(D^N))+R[8]+1163531501&4294967295,w=D+(x<<20&4294967295|x>>>12),x=v+(D^N&(w^D))+R[13]+2850285829&4294967295,v=w+(x<<5&4294967295|x>>>27),x=N+(w^D&(v^w))+R[2]+4243563512&4294967295,N=v+(x<<9&4294967295|x>>>23),x=D+(v^w&(N^v))+R[7]+1735328473&4294967295,D=N+(x<<14&4294967295|x>>>18),x=w+(N^v&(D^N))+R[12]+2368359562&4294967295,w=D+(x<<20&4294967295|x>>>12),x=v+(w^D^N)+R[5]+4294588738&4294967295,v=w+(x<<4&4294967295|x>>>28),x=N+(v^w^D)+R[8]+2272392833&4294967295,N=v+(x<<11&4294967295|x>>>21),x=D+(N^v^w)+R[11]+1839030562&4294967295,D=N+(x<<16&4294967295|x>>>16),x=w+(D^N^v)+R[14]+4259657740&4294967295,w=D+(x<<23&4294967295|x>>>9),x=v+(w^D^N)+R[1]+2763975236&4294967295,v=w+(x<<4&4294967295|x>>>28),x=N+(v^w^D)+R[4]+1272893353&4294967295,N=v+(x<<11&4294967295|x>>>21),x=D+(N^v^w)+R[7]+4139469664&4294967295,D=N+(x<<16&4294967295|x>>>16),x=w+(D^N^v)+R[10]+3200236656&4294967295,w=D+(x<<23&4294967295|x>>>9),x=v+(w^D^N)+R[13]+681279174&4294967295,v=w+(x<<4&4294967295|x>>>28),x=N+(v^w^D)+R[0]+3936430074&4294967295,N=v+(x<<11&4294967295|x>>>21),x=D+(N^v^w)+R[3]+3572445317&4294967295,D=N+(x<<16&4294967295|x>>>16),x=w+(D^N^v)+R[6]+76029189&4294967295,w=D+(x<<23&4294967295|x>>>9),x=v+(w^D^N)+R[9]+3654602809&4294967295,v=w+(x<<4&4294967295|x>>>28),x=N+(v^w^D)+R[12]+3873151461&4294967295,N=v+(x<<11&4294967295|x>>>21),x=D+(N^v^w)+R[15]+530742520&4294967295,D=N+(x<<16&4294967295|x>>>16),x=w+(D^N^v)+R[2]+3299628645&4294967295,w=D+(x<<23&4294967295|x>>>9),x=v+(D^(w|~N))+R[0]+4096336452&4294967295,v=w+(x<<6&4294967295|x>>>26),x=N+(w^(v|~D))+R[7]+1126891415&4294967295,N=v+(x<<10&4294967295|x>>>22),x=D+(v^(N|~w))+R[14]+2878612391&4294967295,D=N+(x<<15&4294967295|x>>>17),x=w+(N^(D|~v))+R[5]+4237533241&4294967295,w=D+(x<<21&4294967295|x>>>11),x=v+(D^(w|~N))+R[12]+1700485571&4294967295,v=w+(x<<6&4294967295|x>>>26),x=N+(w^(v|~D))+R[3]+2399980690&4294967295,N=v+(x<<10&4294967295|x>>>22),x=D+(v^(N|~w))+R[10]+4293915773&4294967295,D=N+(x<<15&4294967295|x>>>17),x=w+(N^(D|~v))+R[1]+2240044497&4294967295,w=D+(x<<21&4294967295|x>>>11),x=v+(D^(w|~N))+R[8]+1873313359&4294967295,v=w+(x<<6&4294967295|x>>>26),x=N+(w^(v|~D))+R[15]+4264355552&4294967295,N=v+(x<<10&4294967295|x>>>22),x=D+(v^(N|~w))+R[6]+2734768916&4294967295,D=N+(x<<15&4294967295|x>>>17),x=w+(N^(D|~v))+R[13]+1309151649&4294967295,w=D+(x<<21&4294967295|x>>>11),x=v+(D^(w|~N))+R[4]+4149444226&4294967295,v=w+(x<<6&4294967295|x>>>26),x=N+(w^(v|~D))+R[11]+3174756917&4294967295,N=v+(x<<10&4294967295|x>>>22),x=D+(v^(N|~w))+R[2]+718787259&4294967295,D=N+(x<<15&4294967295|x>>>17),x=w+(N^(D|~v))+R[9]+3951481745&4294967295,A.g[0]=A.g[0]+v&4294967295,A.g[1]=A.g[1]+(D+(x<<21&4294967295|x>>>11))&4294967295,A.g[2]=A.g[2]+D&4294967295,A.g[3]=A.g[3]+N&4294967295}r.prototype.u=function(A,v){v===void 0&&(v=A.length);for(var w=v-this.blockSize,R=this.B,D=this.h,N=0;N<v;){if(D==0)for(;N<=w;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<v;)if(R[D++]=A.charCodeAt(N++),D==this.blockSize){i(this,R),D=0;break}}else for(;N<v;)if(R[D++]=A[N++],D==this.blockSize){i(this,R),D=0;break}}this.h=D,this.o+=v},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var v=1;v<A.length-8;++v)A[v]=0;var w=8*this.o;for(v=A.length-8;v<A.length;++v)A[v]=w&255,w/=256;for(this.u(A),A=Array(16),v=w=0;4>v;++v)for(var R=0;32>R;R+=8)A[w++]=this.g[v]>>>R&255;return A};function o(A,v){var w=u;return Object.prototype.hasOwnProperty.call(w,A)?w[A]:w[A]=v(A)}function s(A,v){this.h=v;for(var w=[],R=!0,D=A.length-1;0<=D;D--){var N=A[D]|0;R&&N==v||(w[D]=N,R=!1)}this.g=w}var u={};function c(A){return-128<=A&&128>A?o(A,function(v){return new s([v|0],0>v?-1:0)}):new s([A|0],0>A?-1:0)}function d(A){if(isNaN(A)||!isFinite(A))return p;if(0>A)return k(d(-A));for(var v=[],w=1,R=0;A>=w;R++)v[R]=A/w|0,w*=4294967296;return new s(v,0)}function h(A,v){if(A.length==0)throw Error("number format error: empty string");if(v=v||10,2>v||36<v)throw Error("radix out of range: "+v);if(A.charAt(0)=="-")return k(h(A.substring(1),v));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=d(Math.pow(v,8)),R=p,D=0;D<A.length;D+=8){var N=Math.min(8,A.length-D),x=parseInt(A.substring(D,D+N),v);8>N?(N=d(Math.pow(v,N)),R=R.j(N).add(d(x))):(R=R.j(w),R=R.add(d(x)))}return R}var p=c(0),m=c(1),_=c(16777216);t=s.prototype,t.m=function(){if(P(this))return-k(this).m();for(var A=0,v=1,w=0;w<this.g.length;w++){var R=this.i(w);A+=(0<=R?R:4294967296+R)*v,v*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(S(this))return"0";if(P(this))return"-"+k(this).toString(A);for(var v=d(Math.pow(A,6)),w=this,R="";;){var D=M(w,v).g;w=C(w,D.j(v));var N=((0<w.g.length?w.g[0]:w.h)>>>0).toString(A);if(w=D,S(w))return N+R;for(;6>N.length;)N="0"+N;R=N+R}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function S(A){if(A.h!=0)return!1;for(var v=0;v<A.g.length;v++)if(A.g[v]!=0)return!1;return!0}function P(A){return A.h==-1}t.l=function(A){return A=C(this,A),P(A)?-1:S(A)?0:1};function k(A){for(var v=A.g.length,w=[],R=0;R<v;R++)w[R]=~A.g[R];return new s(w,~A.h).add(m)}t.abs=function(){return P(this)?k(this):this},t.add=function(A){for(var v=Math.max(this.g.length,A.g.length),w=[],R=0,D=0;D<=v;D++){var N=R+(this.i(D)&65535)+(A.i(D)&65535),x=(N>>>16)+(this.i(D)>>>16)+(A.i(D)>>>16);R=x>>>16,N&=65535,x&=65535,w[D]=x<<16|N}return new s(w,w[w.length-1]&-2147483648?-1:0)};function C(A,v){return A.add(k(v))}t.j=function(A){if(S(this)||S(A))return p;if(P(this))return P(A)?k(this).j(k(A)):k(k(this).j(A));if(P(A))return k(this.j(k(A)));if(0>this.l(_)&&0>A.l(_))return d(this.m()*A.m());for(var v=this.g.length+A.g.length,w=[],R=0;R<2*v;R++)w[R]=0;for(R=0;R<this.g.length;R++)for(var D=0;D<A.g.length;D++){var N=this.i(R)>>>16,x=this.i(R)&65535,Se=A.i(D)>>>16,Je=A.i(D)&65535;w[2*R+2*D]+=x*Je,T(w,2*R+2*D),w[2*R+2*D+1]+=N*Je,T(w,2*R+2*D+1),w[2*R+2*D+1]+=x*Se,T(w,2*R+2*D+1),w[2*R+2*D+2]+=N*Se,T(w,2*R+2*D+2)}for(R=0;R<v;R++)w[R]=w[2*R+1]<<16|w[2*R];for(R=v;R<2*v;R++)w[R]=0;return new s(w,0)};function T(A,v){for(;(A[v]&65535)!=A[v];)A[v+1]+=A[v]>>>16,A[v]&=65535,v++}function I(A,v){this.g=A,this.h=v}function M(A,v){if(S(v))throw Error("division by zero");if(S(A))return new I(p,p);if(P(A))return v=M(k(A),v),new I(k(v.g),k(v.h));if(P(v))return v=M(A,k(v)),new I(k(v.g),v.h);if(30<A.g.length){if(P(A)||P(v))throw Error("slowDivide_ only works with positive integers.");for(var w=m,R=v;0>=R.l(A);)w=F(w),R=F(R);var D=b(w,1),N=b(R,1);for(R=b(R,2),w=b(w,2);!S(R);){var x=N.add(R);0>=x.l(A)&&(D=D.add(w),N=x),R=b(R,1),w=b(w,1)}return v=C(A,D.j(v)),new I(D,v)}for(D=p;0<=A.l(v);){for(w=Math.max(1,Math.floor(A.m()/v.m())),R=Math.ceil(Math.log(w)/Math.LN2),R=48>=R?1:Math.pow(2,R-48),N=d(w),x=N.j(v);P(x)||0<x.l(A);)w-=R,N=d(w),x=N.j(v);S(N)&&(N=m),D=D.add(N),A=C(A,x)}return new I(D,A)}t.A=function(A){return M(this,A).h},t.and=function(A){for(var v=Math.max(this.g.length,A.g.length),w=[],R=0;R<v;R++)w[R]=this.i(R)&A.i(R);return new s(w,this.h&A.h)},t.or=function(A){for(var v=Math.max(this.g.length,A.g.length),w=[],R=0;R<v;R++)w[R]=this.i(R)|A.i(R);return new s(w,this.h|A.h)},t.xor=function(A){for(var v=Math.max(this.g.length,A.g.length),w=[],R=0;R<v;R++)w[R]=this.i(R)^A.i(R);return new s(w,this.h^A.h)};function F(A){for(var v=A.g.length+1,w=[],R=0;R<v;R++)w[R]=A.i(R)<<1|A.i(R-1)>>>31;return new s(w,A.h)}function b(A,v){var w=v>>5;v%=32;for(var R=A.g.length-w,D=[],N=0;N<R;N++)D[N]=0<v?A.i(N+w)>>>v|A.i(N+w+1)<<32-v:A.i(N+w);return new s(D,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,YI=r,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=d,s.fromString=h,$r=s}).apply(typeof R_<"u"?R_:typeof self<"u"?self:typeof window<"u"?window:{});var na=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XI,us,ZI,Sa,wf,jI,eC,tC;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(f,g,y){return f==Array.prototype||f==Object.prototype||(f[g]=y.value),f};function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof na=="object"&&na];for(var g=0;g<f.length;++g){var y=f[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var r=n(this);function i(f,g){if(g)e:{var y=r;f=f.split(".");for(var E=0;E<f.length-1;E++){var V=f[E];if(!(V in y))break e;y=y[V]}f=f[f.length-1],E=y[f],g=g(E),g!=E&&g!=null&&e(y,f,{configurable:!0,writable:!0,value:g})}}function o(f,g){f instanceof String&&(f+="");var y=0,E=!1,V={next:function(){if(!E&&y<f.length){var U=y++;return{value:g(U,f[U]),done:!1}}return E=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}i("Array.prototype.values",function(f){return f||function(){return o(this,function(g,y){return y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var s=s||{},u=this||self;function c(f){var g=typeof f;return g=g!="object"?g:f?Array.isArray(f)?"array":g:"null",g=="array"||g=="object"&&typeof f.length=="number"}function d(f){var g=typeof f;return g=="object"&&f!=null||g=="function"}function h(f,g,y){return f.call.apply(f.bind,arguments)}function p(f,g,y){if(!f)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var V=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(V,E),f.apply(g,V)}}return function(){return f.apply(g,arguments)}}function m(f,g,y){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function _(f,g){var y=Array.prototype.slice.call(arguments,1);return function(){var E=y.slice();return E.push.apply(E,arguments),f.apply(this,E)}}function S(f,g){function y(){}y.prototype=g.prototype,f.aa=g.prototype,f.prototype=new y,f.prototype.constructor=f,f.Qb=function(E,V,U){for(var $=Array(arguments.length-2),me=2;me<arguments.length;me++)$[me-2]=arguments[me];return g.prototype[V].apply(E,$)}}function P(f){const g=f.length;if(0<g){const y=Array(g);for(let E=0;E<g;E++)y[E]=f[E];return y}return[]}function k(f,g){for(let y=1;y<arguments.length;y++){const E=arguments[y];if(c(E)){const V=f.length||0,U=E.length||0;f.length=V+U;for(let $=0;$<U;$++)f[V+$]=E[$]}else f.push(E)}}class C{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function T(f){return/^[\s\xa0]*$/.test(f)}function I(){var f=u.navigator;return f&&(f=f.userAgent)?f:""}function M(f){return M[" "](f),f}M[" "]=function(){};var F=I().indexOf("Gecko")!=-1&&!(I().toLowerCase().indexOf("webkit")!=-1&&I().indexOf("Edge")==-1)&&!(I().indexOf("Trident")!=-1||I().indexOf("MSIE")!=-1)&&I().indexOf("Edge")==-1;function b(f,g,y){for(const E in f)g.call(y,f[E],E,f)}function A(f,g){for(const y in f)g.call(void 0,f[y],y,f)}function v(f){const g={};for(const y in f)g[y]=f[y];return g}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function R(f,g){let y,E;for(let V=1;V<arguments.length;V++){E=arguments[V];for(y in E)f[y]=E[y];for(let U=0;U<w.length;U++)y=w[U],Object.prototype.hasOwnProperty.call(E,y)&&(f[y]=E[y])}}function D(f){var g=1;f=f.split(":");const y=[];for(;0<g&&f.length;)y.push(f.shift()),g--;return f.length&&y.push(f.join(":")),y}function N(f){u.setTimeout(()=>{throw f},0)}function x(){var f=Z;let g=null;return f.g&&(g=f.g,f.g=f.g.next,f.g||(f.h=null),g.next=null),g}class Se{constructor(){this.h=this.g=null}add(g,y){const E=Je.get();E.set(g,y),this.h?this.h.next=E:this.g=E,this.h=E}}var Je=new C(()=>new mn,f=>f.reset());class mn{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let gn,K=!1,Z=new Se,te=()=>{const f=u.Promise.resolve(void 0);gn=()=>{f.then(Ae)}};var Ae=()=>{for(var f;f=x();){try{f.h.call(f.g)}catch(y){N(y)}var g=Je;g.j(f),100>g.h&&(g.h++,f.next=g.g,g.g=f)}K=!1};function pe(){this.s=this.s,this.C=this.C}pe.prototype.s=!1,pe.prototype.ma=function(){this.s||(this.s=!0,this.N())},pe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ue(f,g){this.type=f,this.g=this.target=g,this.defaultPrevented=!1}Ue.prototype.h=function(){this.defaultPrevented=!0};var yn=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,g=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const y=()=>{};u.addEventListener("test",y,g),u.removeEventListener("test",y,g)}catch{}return f}();function _n(f,g){if(Ue.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var y=this.type=f.type,E=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=g,g=f.relatedTarget){if(F){e:{try{M(g.nodeName);var V=!0;break e}catch{}V=!1}V||(g=null)}}else y=="mouseover"?g=f.fromElement:y=="mouseout"&&(g=f.toElement);this.relatedTarget=g,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=typeof f.pointerType=="string"?f.pointerType:vn[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&_n.aa.h.call(this)}}S(_n,Ue);var vn={2:"touch",3:"pen",4:"mouse"};_n.prototype.h=function(){_n.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Tn="closure_listenable_"+(1e6*Math.random()|0),pS=0;function mS(f,g,y,E,V){this.listener=f,this.proxy=null,this.src=g,this.type=y,this.capture=!!E,this.ha=V,this.key=++pS,this.da=this.fa=!1}function vl(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function Tl(f){this.src=f,this.g={},this.h=0}Tl.prototype.add=function(f,g,y,E,V){var U=f.toString();f=this.g[U],f||(f=this.g[U]=[],this.h++);var $=sc(f,g,E,V);return-1<$?(g=f[$],y||(g.fa=!1)):(g=new mS(g,this.src,U,!!E,V),g.fa=y,f.push(g)),g};function oc(f,g){var y=g.type;if(y in f.g){var E=f.g[y],V=Array.prototype.indexOf.call(E,g,void 0),U;(U=0<=V)&&Array.prototype.splice.call(E,V,1),U&&(vl(g),f.g[y].length==0&&(delete f.g[y],f.h--))}}function sc(f,g,y,E){for(var V=0;V<f.length;++V){var U=f[V];if(!U.da&&U.listener==g&&U.capture==!!y&&U.ha==E)return V}return-1}var lc="closure_lm_"+(1e6*Math.random()|0),ac={};function Gp(f,g,y,E,V){if(Array.isArray(g)){for(var U=0;U<g.length;U++)Gp(f,g[U],y,E,V);return null}return y=Hp(y),f&&f[Tn]?f.K(g,y,d(E)?!!E.capture:!1,V):gS(f,g,y,!1,E,V)}function gS(f,g,y,E,V,U){if(!g)throw Error("Invalid event type");var $=d(V)?!!V.capture:!!V,me=cc(f);if(me||(f[lc]=me=new Tl(f)),y=me.add(g,y,E,$,U),y.proxy)return y;if(E=yS(),y.proxy=E,E.src=f,E.listener=y,f.addEventListener)yn||(V=$),V===void 0&&(V=!1),f.addEventListener(g.toString(),E,V);else if(f.attachEvent)f.attachEvent(zp(g.toString()),E);else if(f.addListener&&f.removeListener)f.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return y}function yS(){function f(y){return g.call(f.src,f.listener,y)}const g=_S;return f}function $p(f,g,y,E,V){if(Array.isArray(g))for(var U=0;U<g.length;U++)$p(f,g[U],y,E,V);else E=d(E)?!!E.capture:!!E,y=Hp(y),f&&f[Tn]?(f=f.i,g=String(g).toString(),g in f.g&&(U=f.g[g],y=sc(U,y,E,V),-1<y&&(vl(U[y]),Array.prototype.splice.call(U,y,1),U.length==0&&(delete f.g[g],f.h--)))):f&&(f=cc(f))&&(g=f.g[g.toString()],f=-1,g&&(f=sc(g,y,E,V)),(y=-1<f?g[f]:null)&&uc(y))}function uc(f){if(typeof f!="number"&&f&&!f.da){var g=f.src;if(g&&g[Tn])oc(g.i,f);else{var y=f.type,E=f.proxy;g.removeEventListener?g.removeEventListener(y,E,f.capture):g.detachEvent?g.detachEvent(zp(y),E):g.addListener&&g.removeListener&&g.removeListener(E),(y=cc(g))?(oc(y,f),y.h==0&&(y.src=null,g[lc]=null)):vl(f)}}}function zp(f){return f in ac?ac[f]:ac[f]="on"+f}function _S(f,g){if(f.da)f=!0;else{g=new _n(g,this);var y=f.listener,E=f.ha||f.src;f.fa&&uc(f),f=y.call(E,g)}return f}function cc(f){return f=f[lc],f instanceof Tl?f:null}var dc="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hp(f){return typeof f=="function"?f:(f[dc]||(f[dc]=function(g){return f.handleEvent(g)}),f[dc])}function tt(){pe.call(this),this.i=new Tl(this),this.M=this,this.F=null}S(tt,pe),tt.prototype[Tn]=!0,tt.prototype.removeEventListener=function(f,g,y,E){$p(this,f,g,y,E)};function dt(f,g){var y,E=f.F;if(E)for(y=[];E;E=E.F)y.push(E);if(f=f.M,E=g.type||g,typeof g=="string")g=new Ue(g,f);else if(g instanceof Ue)g.target=g.target||f;else{var V=g;g=new Ue(E,f),R(g,V)}if(V=!0,y)for(var U=y.length-1;0<=U;U--){var $=g.g=y[U];V=El($,E,!0,g)&&V}if($=g.g=f,V=El($,E,!0,g)&&V,V=El($,E,!1,g)&&V,y)for(U=0;U<y.length;U++)$=g.g=y[U],V=El($,E,!1,g)&&V}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var f=this.i,g;for(g in f.g){for(var y=f.g[g],E=0;E<y.length;E++)vl(y[E]);delete f.g[g],f.h--}}this.F=null},tt.prototype.K=function(f,g,y,E){return this.i.add(String(f),g,!1,y,E)},tt.prototype.L=function(f,g,y,E){return this.i.add(String(f),g,!0,y,E)};function El(f,g,y,E){if(g=f.i.g[String(g)],!g)return!0;g=g.concat();for(var V=!0,U=0;U<g.length;++U){var $=g[U];if($&&!$.da&&$.capture==y){var me=$.listener,Qe=$.ha||$.src;$.fa&&oc(f.i,$),V=me.call(Qe,E)!==!1&&V}}return V&&!E.defaultPrevented}function Kp(f,g,y){if(typeof f=="function")y&&(f=m(f,y));else if(f&&typeof f.handleEvent=="function")f=m(f.handleEvent,f);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:u.setTimeout(f,g||0)}function Wp(f){f.g=Kp(()=>{f.g=null,f.i&&(f.i=!1,Wp(f))},f.l);const g=f.h;f.h=null,f.m.apply(null,g)}class vS extends pe{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Wp(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Mo(f){pe.call(this),this.h=f,this.g={}}S(Mo,pe);var Jp=[];function Qp(f){b(f.g,function(g,y){this.g.hasOwnProperty(y)&&uc(g)},f),f.g={}}Mo.prototype.N=function(){Mo.aa.N.call(this),Qp(this)},Mo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var fc=u.JSON.stringify,TS=u.JSON.parse,ES=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function hc(){}hc.prototype.h=null;function Yp(f){return f.h||(f.h=f.i())}function Xp(){}var ko={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pc(){Ue.call(this,"d")}S(pc,Ue);function mc(){Ue.call(this,"c")}S(mc,Ue);var Sr={},Zp=null;function Il(){return Zp=Zp||new tt}Sr.La="serverreachability";function jp(f){Ue.call(this,Sr.La,f)}S(jp,Ue);function No(f){const g=Il();dt(g,new jp(g))}Sr.STAT_EVENT="statevent";function em(f,g){Ue.call(this,Sr.STAT_EVENT,f),this.stat=g}S(em,Ue);function ft(f){const g=Il();dt(g,new em(g,f))}Sr.Ma="timingevent";function tm(f,g){Ue.call(this,Sr.Ma,f),this.size=g}S(tm,Ue);function Vo(f,g){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},g)}function Lo(){this.g=!0}Lo.prototype.xa=function(){this.g=!1};function IS(f,g,y,E,V,U){f.info(function(){if(f.g)if(U)for(var $="",me=U.split("&"),Qe=0;Qe<me.length;Qe++){var ae=me[Qe].split("=");if(1<ae.length){var nt=ae[0];ae=ae[1];var rt=nt.split("_");$=2<=rt.length&&rt[1]=="type"?$+(nt+"="+ae+"&"):$+(nt+"=redacted&")}}else $=null;else $=U;return"XMLHTTP REQ ("+E+") [attempt "+V+"]: "+g+`
`+y+`
`+$})}function CS(f,g,y,E,V,U,$){f.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+V+"]: "+g+`
`+y+`
`+U+" "+$})}function gi(f,g,y,E){f.info(function(){return"XMLHTTP TEXT ("+g+"): "+SS(f,y)+(E?" "+E:"")})}function wS(f,g){f.info(function(){return"TIMEOUT: "+g})}Lo.prototype.info=function(){};function SS(f,g){if(!f.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(f=0;f<y.length;f++)if(Array.isArray(y[f])){var E=y[f];if(!(2>E.length)){var V=E[1];if(Array.isArray(V)&&!(1>V.length)){var U=V[0];if(U!="noop"&&U!="stop"&&U!="close")for(var $=1;$<V.length;$++)V[$]=""}}}}return fc(y)}catch{return g}}var Cl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},nm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gc;function wl(){}S(wl,hc),wl.prototype.g=function(){return new XMLHttpRequest},wl.prototype.i=function(){return{}},gc=new wl;function Bn(f,g,y,E){this.j=f,this.i=g,this.l=y,this.R=E||1,this.U=new Mo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rm}function rm(){this.i=null,this.g="",this.h=!1}var im={},yc={};function _c(f,g,y){f.L=1,f.v=Pl(En(g)),f.m=y,f.P=!0,om(f,null)}function om(f,g){f.F=Date.now(),Sl(f),f.A=En(f.v);var y=f.A,E=f.R;Array.isArray(E)||(E=[String(E)]),vm(y.i,"t",E),f.C=0,y=f.j.J,f.h=new rm,f.g=Um(f.j,y?g:null,!f.m),0<f.O&&(f.M=new vS(m(f.Y,f,f.g),f.O)),g=f.U,y=f.g,E=f.ca;var V="readystatechange";Array.isArray(V)||(V&&(Jp[0]=V.toString()),V=Jp);for(var U=0;U<V.length;U++){var $=Gp(y,V[U],E||g.handleEvent,!1,g.h||g);if(!$)break;g.g[$.key]=$}g=f.H?v(f.H):{},f.m?(f.u||(f.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,g)):(f.u="GET",f.g.ea(f.A,f.u,null,g)),No(),IS(f.i,f.u,f.A,f.l,f.R,f.m)}Bn.prototype.ca=function(f){f=f.target;const g=this.M;g&&In(f)==3?g.j():this.Y(f)},Bn.prototype.Y=function(f){try{if(f==this.g)e:{const rt=In(this.g);var g=this.g.Ba();const vi=this.g.Z();if(!(3>rt)&&(rt!=3||this.g&&(this.h.h||this.g.oa()||Am(this.g)))){this.J||rt!=4||g==7||(g==8||0>=vi?No(3):No(2)),vc(this);var y=this.g.Z();this.X=y;t:if(sm(this)){var E=Am(this.g);f="";var V=E.length,U=In(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ar(this),Fo(this);var $="";break t}this.h.i=new u.TextDecoder}for(g=0;g<V;g++)this.h.h=!0,f+=this.h.i.decode(E[g],{stream:!(U&&g==V-1)});E.length=0,this.h.g+=f,this.C=0,$=this.h.g}else $=this.g.oa();if(this.o=y==200,CS(this.i,this.u,this.A,this.l,this.R,rt,y),this.o){if(this.T&&!this.K){t:{if(this.g){var me,Qe=this.g;if((me=Qe.g?Qe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(me)){var ae=me;break t}}ae=null}if(y=ae)gi(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Tc(this,y);else{this.o=!1,this.s=3,ft(12),Ar(this),Fo(this);break e}}if(this.P){y=!0;let Yt;for(;!this.J&&this.C<$.length;)if(Yt=AS(this,$),Yt==yc){rt==4&&(this.s=4,ft(14),y=!1),gi(this.i,this.l,null,"[Incomplete Response]");break}else if(Yt==im){this.s=4,ft(15),gi(this.i,this.l,$,"[Invalid Chunk]"),y=!1;break}else gi(this.i,this.l,Yt,null),Tc(this,Yt);if(sm(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),rt!=4||$.length!=0||this.h.h||(this.s=1,ft(16),y=!1),this.o=this.o&&y,!y)gi(this.i,this.l,$,"[Invalid Chunked Response]"),Ar(this),Fo(this);else if(0<$.length&&!this.W){this.W=!0;var nt=this.j;nt.g==this&&nt.ba&&!nt.M&&(nt.j.info("Great, no buffering proxy detected. Bytes received: "+$.length),Ac(nt),nt.M=!0,ft(11))}}else gi(this.i,this.l,$,null),Tc(this,$);rt==4&&Ar(this),this.o&&!this.J&&(rt==4?Nm(this.j,this):(this.o=!1,Sl(this)))}else $S(this.g),y==400&&0<$.indexOf("Unknown SID")?(this.s=3,ft(12)):(this.s=0,ft(13)),Ar(this),Fo(this)}}}catch{}finally{}};function sm(f){return f.g?f.u=="GET"&&f.L!=2&&f.j.Ca:!1}function AS(f,g){var y=f.C,E=g.indexOf(`
`,y);return E==-1?yc:(y=Number(g.substring(y,E)),isNaN(y)?im:(E+=1,E+y>g.length?yc:(g=g.slice(E,E+y),f.C=E+y,g)))}Bn.prototype.cancel=function(){this.J=!0,Ar(this)};function Sl(f){f.S=Date.now()+f.I,lm(f,f.I)}function lm(f,g){if(f.B!=null)throw Error("WatchDog timer not null");f.B=Vo(m(f.ba,f),g)}function vc(f){f.B&&(u.clearTimeout(f.B),f.B=null)}Bn.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(wS(this.i,this.A),this.L!=2&&(No(),ft(17)),Ar(this),this.s=2,Fo(this)):lm(this,this.S-f)};function Fo(f){f.j.G==0||f.J||Nm(f.j,f)}function Ar(f){vc(f);var g=f.M;g&&typeof g.ma=="function"&&g.ma(),f.M=null,Qp(f.U),f.g&&(g=f.g,f.g=null,g.abort(),g.ma())}function Tc(f,g){try{var y=f.j;if(y.G!=0&&(y.g==f||Ec(y.h,f))){if(!f.K&&Ec(y.h,f)&&y.G==3){try{var E=y.Da.g.parse(g)}catch{E=null}if(Array.isArray(E)&&E.length==3){var V=E;if(V[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<f.F)Vl(y),kl(y);else break e;Sc(y),ft(18)}}else y.za=V[1],0<y.za-y.T&&37500>V[2]&&y.F&&y.v==0&&!y.C&&(y.C=Vo(m(y.Za,y),6e3));if(1>=cm(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Pr(y,11)}else if((f.K||y.g==f)&&Vl(y),!T(g))for(V=y.Da.g.parse(g),g=0;g<V.length;g++){let ae=V[g];if(y.T=ae[0],ae=ae[1],y.G==2)if(ae[0]=="c"){y.K=ae[1],y.ia=ae[2];const nt=ae[3];nt!=null&&(y.la=nt,y.j.info("VER="+y.la));const rt=ae[4];rt!=null&&(y.Aa=rt,y.j.info("SVER="+y.Aa));const vi=ae[5];vi!=null&&typeof vi=="number"&&0<vi&&(E=1.5*vi,y.L=E,y.j.info("backChannelRequestTimeoutMs_="+E)),E=y;const Yt=f.g;if(Yt){const Fl=Yt.g?Yt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fl){var U=E.h;U.g||Fl.indexOf("spdy")==-1&&Fl.indexOf("quic")==-1&&Fl.indexOf("h2")==-1||(U.j=U.l,U.g=new Set,U.h&&(Ic(U,U.h),U.h=null))}if(E.D){const Rc=Yt.g?Yt.g.getResponseHeader("X-HTTP-Session-Id"):null;Rc&&(E.ya=Rc,_e(E.I,E.D,Rc))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-f.F,y.j.info("Handshake RTT: "+y.R+"ms")),E=y;var $=f;if(E.qa=Fm(E,E.J?E.ia:null,E.W),$.K){dm(E.h,$);var me=$,Qe=E.L;Qe&&(me.I=Qe),me.B&&(vc(me),Sl(me)),E.g=$}else Mm(E);0<y.i.length&&Nl(y)}else ae[0]!="stop"&&ae[0]!="close"||Pr(y,7);else y.G==3&&(ae[0]=="stop"||ae[0]=="close"?ae[0]=="stop"?Pr(y,7):wc(y):ae[0]!="noop"&&y.l&&y.l.ta(ae),y.v=0)}}No(4)}catch{}}var RS=class{constructor(f,g){this.g=f,this.map=g}};function am(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=0<f.length&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function um(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function cm(f){return f.h?1:f.g?f.g.size:0}function Ec(f,g){return f.h?f.h==g:f.g?f.g.has(g):!1}function Ic(f,g){f.g?f.g.add(g):f.h=g}function dm(f,g){f.h&&f.h==g?f.h=null:f.g&&f.g.has(g)&&f.g.delete(g)}am.prototype.cancel=function(){if(this.i=fm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function fm(f){if(f.h!=null)return f.i.concat(f.h.D);if(f.g!=null&&f.g.size!==0){let g=f.i;for(const y of f.g.values())g=g.concat(y.D);return g}return P(f.i)}function PS(f){if(f.V&&typeof f.V=="function")return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if(typeof f=="string")return f.split("");if(c(f)){for(var g=[],y=f.length,E=0;E<y;E++)g.push(f[E]);return g}g=[],y=0;for(E in f)g[y++]=f[E];return g}function xS(f){if(f.na&&typeof f.na=="function")return f.na();if(!f.V||typeof f.V!="function"){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(c(f)||typeof f=="string"){var g=[];f=f.length;for(var y=0;y<f;y++)g.push(y);return g}g=[],y=0;for(const E in f)g[y++]=E;return g}}}function hm(f,g){if(f.forEach&&typeof f.forEach=="function")f.forEach(g,void 0);else if(c(f)||typeof f=="string")Array.prototype.forEach.call(f,g,void 0);else for(var y=xS(f),E=PS(f),V=E.length,U=0;U<V;U++)g.call(void 0,E[U],y&&y[U],f)}var pm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function DS(f,g){if(f){f=f.split("&");for(var y=0;y<f.length;y++){var E=f[y].indexOf("="),V=null;if(0<=E){var U=f[y].substring(0,E);V=f[y].substring(E+1)}else U=f[y];g(U,V?decodeURIComponent(V.replace(/\+/g," ")):"")}}}function Rr(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof Rr){this.h=f.h,Al(this,f.j),this.o=f.o,this.g=f.g,Rl(this,f.s),this.l=f.l;var g=f.i,y=new Bo;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),mm(this,y),this.m=f.m}else f&&(g=String(f).match(pm))?(this.h=!1,Al(this,g[1]||"",!0),this.o=Uo(g[2]||""),this.g=Uo(g[3]||"",!0),Rl(this,g[4]),this.l=Uo(g[5]||"",!0),mm(this,g[6]||"",!0),this.m=Uo(g[7]||"")):(this.h=!1,this.i=new Bo(null,this.h))}Rr.prototype.toString=function(){var f=[],g=this.j;g&&f.push(bo(g,gm,!0),":");var y=this.g;return(y||g=="file")&&(f.push("//"),(g=this.o)&&f.push(bo(g,gm,!0),"@"),f.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&f.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&f.push("/"),f.push(bo(y,y.charAt(0)=="/"?NS:kS,!0))),(y=this.i.toString())&&f.push("?",y),(y=this.m)&&f.push("#",bo(y,LS)),f.join("")};function En(f){return new Rr(f)}function Al(f,g,y){f.j=y?Uo(g,!0):g,f.j&&(f.j=f.j.replace(/:$/,""))}function Rl(f,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);f.s=g}else f.s=null}function mm(f,g,y){g instanceof Bo?(f.i=g,FS(f.i,f.h)):(y||(g=bo(g,VS)),f.i=new Bo(g,f.h))}function _e(f,g,y){f.i.set(g,y)}function Pl(f){return _e(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Uo(f,g){return f?g?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function bo(f,g,y){return typeof f=="string"?(f=encodeURI(f).replace(g,MS),y&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function MS(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var gm=/[#\/\?@]/g,kS=/[#\?:]/g,NS=/[#\?]/g,VS=/[#\?@]/g,LS=/#/g;function Bo(f,g){this.h=this.g=null,this.i=f||null,this.j=!!g}function On(f){f.g||(f.g=new Map,f.h=0,f.i&&DS(f.i,function(g,y){f.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=Bo.prototype,t.add=function(f,g){On(this),this.i=null,f=yi(this,f);var y=this.g.get(f);return y||this.g.set(f,y=[]),y.push(g),this.h+=1,this};function ym(f,g){On(f),g=yi(f,g),f.g.has(g)&&(f.i=null,f.h-=f.g.get(g).length,f.g.delete(g))}function _m(f,g){return On(f),g=yi(f,g),f.g.has(g)}t.forEach=function(f,g){On(this),this.g.forEach(function(y,E){y.forEach(function(V){f.call(g,V,E,this)},this)},this)},t.na=function(){On(this);const f=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let E=0;E<g.length;E++){const V=f[E];for(let U=0;U<V.length;U++)y.push(g[E])}return y},t.V=function(f){On(this);let g=[];if(typeof f=="string")_m(this,f)&&(g=g.concat(this.g.get(yi(this,f))));else{f=Array.from(this.g.values());for(let y=0;y<f.length;y++)g=g.concat(f[y])}return g},t.set=function(f,g){return On(this),this.i=null,f=yi(this,f),_m(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[g]),this.h+=1,this},t.get=function(f,g){return f?(f=this.V(f),0<f.length?String(f[0]):g):g};function vm(f,g,y){ym(f,g),0<y.length&&(f.i=null,f.g.set(yi(f,g),P(y)),f.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var E=g[y];const U=encodeURIComponent(String(E)),$=this.V(E);for(E=0;E<$.length;E++){var V=U;$[E]!==""&&(V+="="+encodeURIComponent(String($[E]))),f.push(V)}}return this.i=f.join("&")};function yi(f,g){return g=String(g),f.j&&(g=g.toLowerCase()),g}function FS(f,g){g&&!f.j&&(On(f),f.i=null,f.g.forEach(function(y,E){var V=E.toLowerCase();E!=V&&(ym(this,E),vm(this,V,y))},f)),f.j=g}function US(f,g){const y=new Lo;if(u.Image){const E=new Image;E.onload=_(qn,y,"TestLoadImage: loaded",!0,g,E),E.onerror=_(qn,y,"TestLoadImage: error",!1,g,E),E.onabort=_(qn,y,"TestLoadImage: abort",!1,g,E),E.ontimeout=_(qn,y,"TestLoadImage: timeout",!1,g,E),u.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=f}else g(!1)}function bS(f,g){const y=new Lo,E=new AbortController,V=setTimeout(()=>{E.abort(),qn(y,"TestPingServer: timeout",!1,g)},1e4);fetch(f,{signal:E.signal}).then(U=>{clearTimeout(V),U.ok?qn(y,"TestPingServer: ok",!0,g):qn(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(V),qn(y,"TestPingServer: error",!1,g)})}function qn(f,g,y,E,V){try{V&&(V.onload=null,V.onerror=null,V.onabort=null,V.ontimeout=null),E(y)}catch{}}function BS(){this.g=new ES}function OS(f,g,y){const E=y||"";try{hm(f,function(V,U){let $=V;d(V)&&($=fc(V)),g.push(E+U+"="+encodeURIComponent($))})}catch(V){throw g.push(E+"type="+encodeURIComponent("_badmap")),V}}function xl(f){this.l=f.Ub||null,this.j=f.eb||!1}S(xl,hc),xl.prototype.g=function(){return new Dl(this.l,this.j)},xl.prototype.i=function(f){return function(){return f}}({});function Dl(f,g){tt.call(this),this.D=f,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(Dl,tt),t=Dl.prototype,t.open=function(f,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=g,this.readyState=1,qo(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(g.body=f),(this.D||u).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Oo(this)),this.readyState=0},t.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,qo(this)),this.g&&(this.readyState=3,qo(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Tm(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))};function Tm(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}t.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var g=f.value?f.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!f.done}))&&(this.response=this.responseText+=g)}f.done?Oo(this):qo(this),this.readyState==3&&Tm(this)}},t.Ra=function(f){this.g&&(this.response=this.responseText=f,Oo(this))},t.Qa=function(f){this.g&&(this.response=f,Oo(this))},t.ga=function(){this.g&&Oo(this)};function Oo(f){f.readyState=4,f.l=null,f.j=null,f.v=null,qo(f)}t.setRequestHeader=function(f,g){this.u.append(f,g)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,f.push(y[0]+": "+y[1]),y=g.next();return f.join(`\r
`)};function qo(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(Dl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function Em(f){let g="";return b(f,function(y,E){g+=E,g+=":",g+=y,g+=`\r
`}),g}function Cc(f,g,y){e:{for(E in y){var E=!1;break e}E=!0}E||(y=Em(y),typeof f=="string"?y!=null&&encodeURIComponent(String(y)):_e(f,g,y))}function ke(f){tt.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(ke,tt);var qS=/^https?$/i,GS=["POST","PUT"];t=ke.prototype,t.Ha=function(f){this.J=f},t.ea=function(f,g,y,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);g=g?g.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gc.g(),this.v=this.o?Yp(this.o):Yp(gc),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(g,String(f),!0),this.B=!1}catch(U){Im(this,U);return}if(f=y||"",y=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var V in E)y.set(V,E[V]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const U of E.keys())y.set(U,E.get(U));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(y.keys()).find(U=>U.toLowerCase()=="content-type"),V=u.FormData&&f instanceof u.FormData,!(0<=Array.prototype.indexOf.call(GS,g,void 0))||E||V||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[U,$]of y)this.g.setRequestHeader(U,$);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Sm(this),this.u=!0,this.g.send(f),this.u=!1}catch(U){Im(this,U)}};function Im(f,g){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=g,f.m=5,Cm(f),Ml(f)}function Cm(f){f.A||(f.A=!0,dt(f,"complete"),dt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,dt(this,"complete"),dt(this,"abort"),Ml(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ml(this,!0)),ke.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?wm(this):this.bb())},t.bb=function(){wm(this)};function wm(f){if(f.h&&typeof s<"u"&&(!f.v[1]||In(f)!=4||f.Z()!=2)){if(f.u&&In(f)==4)Kp(f.Ea,0,f);else if(dt(f,"readystatechange"),In(f)==4){f.h=!1;try{const $=f.Z();e:switch($){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var E;if(E=$===0){var V=String(f.D).match(pm)[1]||null;!V&&u.self&&u.self.location&&(V=u.self.location.protocol.slice(0,-1)),E=!qS.test(V?V.toLowerCase():"")}y=E}if(y)dt(f,"complete"),dt(f,"success");else{f.m=6;try{var U=2<In(f)?f.g.statusText:""}catch{U=""}f.l=U+" ["+f.Z()+"]",Cm(f)}}finally{Ml(f)}}}}function Ml(f,g){if(f.g){Sm(f);const y=f.g,E=f.v[0]?()=>{}:null;f.g=null,f.v=null,g||dt(f,"ready");try{y.onreadystatechange=E}catch{}}}function Sm(f){f.I&&(u.clearTimeout(f.I),f.I=null)}t.isActive=function(){return!!this.g};function In(f){return f.g?f.g.readyState:0}t.Z=function(){try{return 2<In(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(f){if(this.g){var g=this.g.responseText;return f&&g.indexOf(f)==0&&(g=g.substring(f.length)),TS(g)}};function Am(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function $S(f){const g={};f=(f.g&&2<=In(f)&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<f.length;E++){if(T(f[E]))continue;var y=D(f[E]);const V=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();const U=g[V]||[];g[V]=U,U.push(y)}A(g,function(E){return E.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Go(f,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[f]||g}function Rm(f){this.Aa=0,this.i=[],this.j=new Lo,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Go("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Go("baseRetryDelayMs",5e3,f),this.cb=Go("retryDelaySeedMs",1e4,f),this.Wa=Go("forwardChannelMaxRetries",2,f),this.wa=Go("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new am(f&&f.concurrentRequestLimit),this.Da=new BS,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Rm.prototype,t.la=8,t.G=1,t.connect=function(f,g,y,E){ft(0),this.W=f,this.H=g||{},y&&E!==void 0&&(this.H.OSID=y,this.H.OAID=E),this.F=this.X,this.I=Fm(this,null,this.W),Nl(this)};function wc(f){if(Pm(f),f.G==3){var g=f.U++,y=En(f.I);if(_e(y,"SID",f.K),_e(y,"RID",g),_e(y,"TYPE","terminate"),$o(f,y),g=new Bn(f,f.j,g),g.L=2,g.v=Pl(En(y)),y=!1,u.navigator&&u.navigator.sendBeacon)try{y=u.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&u.Image&&(new Image().src=g.v,y=!0),y||(g.g=Um(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Sl(g)}Lm(f)}function kl(f){f.g&&(Ac(f),f.g.cancel(),f.g=null)}function Pm(f){kl(f),f.u&&(u.clearTimeout(f.u),f.u=null),Vl(f),f.h.cancel(),f.s&&(typeof f.s=="number"&&u.clearTimeout(f.s),f.s=null)}function Nl(f){if(!um(f.h)&&!f.s){f.s=!0;var g=f.Ga;gn||te(),K||(gn(),K=!0),Z.add(g,f),f.B=0}}function zS(f,g){return cm(f.h)>=f.h.j-(f.s?1:0)?!1:f.s?(f.i=g.D.concat(f.i),!0):f.G==1||f.G==2||f.B>=(f.Va?0:f.Wa)?!1:(f.s=Vo(m(f.Ga,f,g),Vm(f,f.B)),f.B++,!0)}t.Ga=function(f){if(this.s)if(this.s=null,this.G==1){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const V=new Bn(this,this.j,f);let U=this.o;if(this.S&&(U?(U=v(U),R(U,this.S)):U=this.S),this.m!==null||this.O||(V.H=U,U=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var E=this.i[y];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(g+=E,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=Dm(this,V,g),y=En(this.I),_e(y,"RID",f),_e(y,"CVER",22),this.D&&_e(y,"X-HTTP-Session-Id",this.D),$o(this,y),U&&(this.O?g="headers="+encodeURIComponent(String(Em(U)))+"&"+g:this.m&&Cc(y,this.m,U)),Ic(this.h,V),this.Ua&&_e(y,"TYPE","init"),this.P?(_e(y,"$req",g),_e(y,"SID","null"),V.T=!0,_c(V,y,null)):_c(V,y,g),this.G=2}}else this.G==3&&(f?xm(this,f):this.i.length==0||um(this.h)||xm(this))};function xm(f,g){var y;g?y=g.l:y=f.U++;const E=En(f.I);_e(E,"SID",f.K),_e(E,"RID",y),_e(E,"AID",f.T),$o(f,E),f.m&&f.o&&Cc(E,f.m,f.o),y=new Bn(f,f.j,y,f.B+1),f.m===null&&(y.H=f.o),g&&(f.i=g.D.concat(f.i)),g=Dm(f,y,1e3),y.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),Ic(f.h,y),_c(y,E,g)}function $o(f,g){f.H&&b(f.H,function(y,E){_e(g,E,y)}),f.l&&hm({},function(y,E){_e(g,E,y)})}function Dm(f,g,y){y=Math.min(f.i.length,y);var E=f.l?m(f.l.Na,f.l,f):null;e:{var V=f.i;let U=-1;for(;;){const $=["count="+y];U==-1?0<y?(U=V[0].g,$.push("ofs="+U)):U=0:$.push("ofs="+U);let me=!0;for(let Qe=0;Qe<y;Qe++){let ae=V[Qe].g;const nt=V[Qe].map;if(ae-=U,0>ae)U=Math.max(0,V[Qe].g-100),me=!1;else try{OS(nt,$,"req"+ae+"_")}catch{E&&E(nt)}}if(me){E=$.join("&");break e}}}return f=f.i.splice(0,y),g.D=f,E}function Mm(f){if(!f.g&&!f.u){f.Y=1;var g=f.Fa;gn||te(),K||(gn(),K=!0),Z.add(g,f),f.v=0}}function Sc(f){return f.g||f.u||3<=f.v?!1:(f.Y++,f.u=Vo(m(f.Fa,f),Vm(f,f.v)),f.v++,!0)}t.Fa=function(){if(this.u=null,km(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=Vo(m(this.ab,this),f)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ft(10),kl(this),km(this))};function Ac(f){f.A!=null&&(u.clearTimeout(f.A),f.A=null)}function km(f){f.g=new Bn(f,f.j,"rpc",f.Y),f.m===null&&(f.g.H=f.o),f.g.O=0;var g=En(f.qa);_e(g,"RID","rpc"),_e(g,"SID",f.K),_e(g,"AID",f.T),_e(g,"CI",f.F?"0":"1"),!f.F&&f.ja&&_e(g,"TO",f.ja),_e(g,"TYPE","xmlhttp"),$o(f,g),f.m&&f.o&&Cc(g,f.m,f.o),f.L&&(f.g.I=f.L);var y=f.g;f=f.ia,y.L=1,y.v=Pl(En(g)),y.m=null,y.P=!0,om(y,f)}t.Za=function(){this.C!=null&&(this.C=null,kl(this),Sc(this),ft(19))};function Vl(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function Nm(f,g){var y=null;if(f.g==g){Vl(f),Ac(f),f.g=null;var E=2}else if(Ec(f.h,g))y=g.D,dm(f.h,g),E=1;else return;if(f.G!=0){if(g.o)if(E==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var V=f.B;E=Il(),dt(E,new tm(E,y)),Nl(f)}else Mm(f);else if(V=g.s,V==3||V==0&&0<g.X||!(E==1&&zS(f,g)||E==2&&Sc(f)))switch(y&&0<y.length&&(g=f.h,g.i=g.i.concat(y)),V){case 1:Pr(f,5);break;case 4:Pr(f,10);break;case 3:Pr(f,6);break;default:Pr(f,2)}}}function Vm(f,g){let y=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(y*=2),y*g}function Pr(f,g){if(f.j.info("Error code "+g),g==2){var y=m(f.fb,f),E=f.Xa;const V=!E;E=new Rr(E||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Al(E,"https"),Pl(E),V?US(E.toString(),y):bS(E.toString(),y)}else ft(2);f.G=0,f.l&&f.l.sa(g),Lm(f),Pm(f)}t.fb=function(f){f?(this.j.info("Successfully pinged google.com"),ft(2)):(this.j.info("Failed to ping google.com"),ft(1))};function Lm(f){if(f.G=0,f.ka=[],f.l){const g=fm(f.h);(g.length!=0||f.i.length!=0)&&(k(f.ka,g),k(f.ka,f.i),f.h.i.length=0,P(f.i),f.i.length=0),f.l.ra()}}function Fm(f,g,y){var E=y instanceof Rr?En(y):new Rr(y);if(E.g!="")g&&(E.g=g+"."+E.g),Rl(E,E.s);else{var V=u.location;E=V.protocol,g=g?g+"."+V.hostname:V.hostname,V=+V.port;var U=new Rr(null);E&&Al(U,E),g&&(U.g=g),V&&Rl(U,V),y&&(U.l=y),E=U}return y=f.D,g=f.ya,y&&g&&_e(E,y,g),_e(E,"VER",f.la),$o(f,E),E}function Um(f,g,y){if(g&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=f.Ca&&!f.pa?new ke(new xl({eb:y})):new ke(f.pa),g.Ha(f.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function bm(){}t=bm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ll(){}Ll.prototype.g=function(f,g){return new Dt(f,g)};function Dt(f,g){tt.call(this),this.g=new Rm(g),this.l=f,this.h=g&&g.messageUrlParams||null,f=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(f?f["X-WebChannel-Content-Type"]=g.messageContentType:f={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(f?f["X-WebChannel-Client-Profile"]=g.va:f={"X-WebChannel-Client-Profile":g.va}),this.g.S=f,(f=g&&g.Sb)&&!T(f)&&(this.g.m=f),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!T(g)&&(this.g.D=g,f=this.h,f!==null&&g in f&&(f=this.h,g in f&&delete f[g])),this.j=new _i(this)}S(Dt,tt),Dt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Dt.prototype.close=function(){wc(this.g)},Dt.prototype.o=function(f){var g=this.g;if(typeof f=="string"){var y={};y.__data__=f,f=y}else this.u&&(y={},y.__data__=fc(f),f=y);g.i.push(new RS(g.Ya++,f)),g.G==3&&Nl(g)},Dt.prototype.N=function(){this.g.l=null,delete this.j,wc(this.g),delete this.g,Dt.aa.N.call(this)};function Bm(f){pc.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var g=f.__sm__;if(g){e:{for(const y in g){f=y;break e}f=void 0}(this.i=f)&&(f=this.i,g=g!==null&&f in g?g[f]:void 0),this.data=g}else this.data=f}S(Bm,pc);function Om(){mc.call(this),this.status=1}S(Om,mc);function _i(f){this.g=f}S(_i,bm),_i.prototype.ua=function(){dt(this.g,"a")},_i.prototype.ta=function(f){dt(this.g,new Bm(f))},_i.prototype.sa=function(f){dt(this.g,new Om)},_i.prototype.ra=function(){dt(this.g,"b")},Ll.prototype.createWebChannel=Ll.prototype.g,Dt.prototype.send=Dt.prototype.o,Dt.prototype.open=Dt.prototype.m,Dt.prototype.close=Dt.prototype.close,tC=function(){return new Ll},eC=function(){return Il()},jI=Sr,wf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Cl.NO_ERROR=0,Cl.TIMEOUT=8,Cl.HTTP_ERROR=6,Sa=Cl,nm.COMPLETE="complete",ZI=nm,Xp.EventType=ko,ko.OPEN="a",ko.CLOSE="b",ko.ERROR="c",ko.MESSAGE="d",tt.prototype.listen=tt.prototype.K,us=Xp,ke.prototype.listenOnce=ke.prototype.L,ke.prototype.getLastError=ke.prototype.Ka,ke.prototype.getLastErrorCode=ke.prototype.Ba,ke.prototype.getStatus=ke.prototype.Z,ke.prototype.getResponseJson=ke.prototype.Oa,ke.prototype.getResponseText=ke.prototype.oa,ke.prototype.send=ke.prototype.ea,ke.prototype.setWithCredentials=ke.prototype.Ha,XI=ke}).apply(typeof na<"u"?na:typeof self<"u"?self:typeof window<"u"?window:{});const P_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xe.UNAUTHENTICATED=new Xe(null),Xe.GOOGLE_CREDENTIALS=new Xe("google-credentials-uid"),Xe.FIRST_PARTY=new Xe("first-party-uid"),Xe.MOCK_USER=new Xe("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ao="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new qI("@firebase/firestore");function Ai(){return Zr.logLevel}function q(t,...e){if(Zr.logLevel<=se.DEBUG){const n=e.map(Qh);Zr.debug(`Firestore (${Ao}): ${t}`,...n)}}function mt(t,...e){if(Zr.logLevel<=se.ERROR){const n=e.map(Qh);Zr.error(`Firestore (${Ao}): ${t}`,...n)}}function jr(t,...e){if(Zr.logLevel<=se.WARN){const n=e.map(Qh);Zr.warn(`Firestore (${Ao}): ${t}`,...n)}}function Qh(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(t="Unexpected state"){const e=`FIRESTORE (${Ao}) INTERNAL ASSERTION FAILED: `+t;throw mt(e),new Error(e)}function Y(t,e){t||Q()}function j(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends di{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class O2{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xe.UNAUTHENTICATED))}shutdown(){}}class q2{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class G2{constructor(e){this.t=e,this.currentUser=Xe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Y(this.o===void 0);let r=this.i;const i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let o=new xn;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xn,e.enqueueRetryable(()=>i(this.currentUser))};const s=()=>{const c=o;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},u=c=>{q("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?u(c):(q("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xn)}},0),s()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(q("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Y(typeof r.accessToken=="string"),new nC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new Xe(e)}}class $2{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Xe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class z2{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $2(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Xe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class H2{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class K2{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Y(this.o===void 0);const r=o=>{o.error!=null&&q("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const s=o.token!==this.R;return this.R=o.token,q("FirebaseAppCheckTokenProvider",`Received ${s?"new":"existing"} token.`),s?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const i=o=>{q("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.A.getImmediate({optional:!0});o?i(o):q("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Y(typeof n.token=="string"),this.R=n.token,new H2(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W2(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=W2(40);for(let o=0;o<i.length;++o)r.length<20&&i[o]<n&&(r+=e.charAt(i[o]%e.length))}return r}}function ee(t,e){return t<e?-1:t>e?1:0}function ao(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function iC(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new z(B.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(B.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return De.fromMillis(Date.now())}static fromDate(e){return De.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new De(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ee(this.nanoseconds,e.nanoseconds):ee(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new De(0,0))}static max(){return new X(new De(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Js{constructor(e,n,r){n===void 0?n=0:n>e.length&&Q(),r===void 0?r=e.length-n:r>e.length-n&&Q(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Js.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Js?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const o=e.get(i),s=n.get(i);if(o<s)return-1;if(o>s)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ce extends Js{construct(e,n,r){return new ce(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new z(B.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ce(n)}static emptyPath(){return new ce([])}}const J2=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Pe extends Js{construct(e,n,r){return new Pe(e,n,r)}static isValidIdentifier(e){return J2.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Pe.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Pe(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const o=()=>{if(r.length===0)throw new z(B.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let s=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new z(B.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new z(B.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(s=!s,i++):u!=="."||s?(r+=u,i++):(o(),i++)}if(o(),s)throw new z(B.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Pe(n)}static emptyPath(){return new Pe([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.path=e}static fromPath(e){return new H(ce.fromString(e))}static fromName(e){return new H(ce.fromString(e).popFirst(5))}static empty(){return new H(ce.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ce.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ce.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new H(new ce(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Sf(t){return t.fields.find(e=>e.kind===2)}function Nr(t){return t.fields.filter(e=>e.kind!==2)}cu.UNKNOWN_ID=-1;class Aa{constructor(e,n){this.fieldPath=e,this.kind=n}}class Qs{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Qs(0,bt.min())}}function Q2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=X.fromTimestamp(r===1e9?new De(n+1,0):new De(n,r));return new bt(i,H.empty(),e)}function oC(t){return new bt(t.readTime,t.key,-1)}class bt{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new bt(X.min(),H.empty(),-1)}static max(){return new bt(X.max(),H.empty(),-1)}}function Yh(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=H.comparator(t.documentKey,e.documentKey),n!==0?n:ee(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class lC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fi(t){if(t.code!==B.FAILED_PRECONDITION||t.message!==sC)throw t;q("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Q(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new L((r,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,i)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof L?n:L.resolve(n)}catch(n){return L.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):L.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):L.reject(n)}static resolve(e){return new L((n,r)=>{n(e)})}static reject(e){return new L((n,r)=>{r(e)})}static waitFor(e){return new L((n,r)=>{let i=0,o=0,s=!1;e.forEach(u=>{++i,u.next(()=>{++o,s&&o===i&&n()},c=>r(c))}),s=!0,o===i&&n()})}static or(e){let n=L.resolve(!1);for(const r of e)n=n.next(i=>i?L.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,o)=>{r.push(n.call(this,i,o))}),this.waitFor(r)}static mapArray(e,n){return new L((r,i)=>{const o=e.length,s=new Array(o);let u=0;for(let c=0;c<o;c++){const d=c;n(e[d]).next(h=>{s[d]=h,++u,u===o&&r(s)},h=>i(h))}})}static doWhile(e,n){return new L((r,i)=>{const o=()=>{e()===!0?n().next(()=>{o()},i):r()};o()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new xn,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Cs(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Xh(r.target.error);this.V.reject(new Cs(e,i))}}static open(e,n,r,i){try{return new Ou(n,e.transaction(i,r))}catch(o){throw new Cs(n,o)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(q("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new X2(n)}}class fr{constructor(e,n,r){this.name=e,this.version=n,this.p=r,fr.S(au())===12.2&&mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return q("SimpleDb","Removing database:",e),Vr(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!BI())return!1;if(fr.v())return!0;const e=au(),n=fr.S(e),r=0<n&&n<10,i=aC(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(q("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=o=>{const s=o.target.result;n(s)},i.onblocked=()=>{r(new Cs(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=o=>{const s=o.target.error;s.name==="VersionError"?r(new z(B.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):s.name==="InvalidStateError"?r(new z(B.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+s)):r(new Cs(e,s))},i.onupgradeneeded=o=>{q("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',o.oldVersion);const s=o.target.result;this.p.O(s,i.transaction,o.oldVersion,this.version).next(()=>{q("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const o=n==="readonly";let s=0;for(;;){++s;try{this.db=await this.M(e);const u=Ou.open(this.db,e,o?"readonly":"readwrite",r),c=i(u).next(d=>(u.g(),d)).catch(d=>(u.abort(d),L.reject(d))).toPromise();return c.catch(()=>{}),await u.m,c}catch(u){const c=u,d=c.name!=="FirebaseError"&&s<3;if(q("SimpleDb","Transaction failed with error:",c.message,"Retrying:",d),this.close(),!d)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function aC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Y2{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Vr(this.B.delete())}}class Cs extends z{constructor(e,n){super(B.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Cr(t){return t.name==="IndexedDbTransactionError"}class X2{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(q("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(q("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vr(r)}add(e){return q("SimpleDb","ADD",this.store.name,e,e),Vr(this.store.add(e))}get(e){return Vr(this.store.get(e)).next(n=>(n===void 0&&(n=null),q("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return q("SimpleDb","DELETE",this.store.name,e),Vr(this.store.delete(e))}count(){return q("SimpleDb","COUNT",this.store.name),Vr(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const o=i.getAll(r.range);return new L((s,u)=>{o.onerror=c=>{u(c.target.error)},o.onsuccess=c=>{s(c.target.result)}})}{const o=this.cursor(r),s=[];return this.W(o,(u,c)=>{s.push(c)}).next(()=>s)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new L((i,o)=>{r.onerror=s=>{o(s.target.error)},r.onsuccess=s=>{i(s.target.result)}})}j(e,n){q("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(o,s,u)=>u.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new L((r,i)=>{n.onerror=o=>{const s=Xh(o.target.error);i(s)},n.onsuccess=o=>{const s=o.target.result;s?e(s.primaryKey,s.value).next(u=>{u?s.continue():r()}):r()}})}W(e,n){const r=[];return new L((i,o)=>{e.onerror=s=>{o(s.target.error)},e.onsuccess=s=>{const u=s.target.result;if(!u)return void i();const c=new Y2(u),d=n(u.primaryKey,u.value,c);if(d instanceof L){const h=d.catch(p=>(c.done(),L.reject(p)));r.push(h)}c.isDone?i():c.K===null?u.continue():u.continue(c.K)}}).next(()=>L.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Vr(t){return new L((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Xh(r.target.error);n(i)}})}let x_=!1;function Xh(t){const e=fr.S(au());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return x_||(x_=!0,setTimeout(()=>{throw r},0)),r}}return t}class Z2{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){q("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{q("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Cr(n)?q("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await fi(n)}await this.X(6e4)})}}class j2{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,o=!0;return L.doWhile(()=>o===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(s=>{if(s!==null&&!r.has(s))return q("IndexBackfiller",`Processing collection: ${s}`),this.ne(e,s,i).next(u=>{i-=u,r.add(s)});o=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(o=>{const s=o.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.re(i,o)).next(u=>(q("IndexBackfiller",`Updating offset: ${u}`),this.localStore.indexManager.updateCollectionGroup(e,n,u))).next(()=>s.size)}))}re(e,n){let r=e;return n.changes.forEach((i,o)=>{const s=oC(o);Yh(s,r)>0&&(r=s)}),new bt(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}zt.oe=-1;function qu(t){return t==null}function Ys(t){return t===0&&1/t==-1/0}function eU(t){return typeof t=="number"&&Number.isInteger(t)&&!Ys(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=D_(e)),e=tU(t.get(n),e);return D_(e)}function tU(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function D_(t){return t+""}function un(t){const e=t.length;if(Y(e>=2),e===2)return Y(t.charAt(0)===""&&t.charAt(1)===""),ce.emptyPath();const n=e-2,r=[];let i="";for(let o=0;o<e;){const s=t.indexOf("",o);switch((s<0||s>n)&&Q(),t.charAt(s+1)){case"":const u=t.substring(o,s);let c;i.length===0?c=u:(i+=u,c=i,i=""),r.push(c);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Q()}o=s+2}return new ce(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ra(t,e){return[t,_t(e)]}function uC(t,e,n){return[t,_t(e),n]}const nU={},rU=["prefixPath","collectionGroup","readTime","documentId"],iU=["prefixPath","collectionGroup","documentId"],oU=["collectionGroup","readTime","prefixPath","documentId"],sU=["canonicalId","targetId"],lU=["targetId","path"],aU=["path","targetId"],uU=["collectionId","parent"],cU=["indexId","uid"],dU=["uid","sequenceNumber"],fU=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],hU=["indexId","uid","orderedDocumentKey"],pU=["userId","collectionPath","documentId"],mU=["userId","collectionPath","largestBatchId"],gU=["userId","collectionGroup","largestBatchId"],cC=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],yU=[...cC,"documentOverlays"],dC=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],fC=dC,Zh=[...fC,"indexConfiguration","indexState","indexEntries"],_U=Zh,vU=[...Zh,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af extends lC{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function ze(t,e){const n=j(t);return fr.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function hi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function hC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e,n){this.comparator=e,this.root=n||Ze.EMPTY}insert(e,n){return new we(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ze.BLACK,null,null))}remove(e){return new we(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ze.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ra(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ra(this.root,e,this.comparator,!1)}getReverseIterator(){return new ra(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ra(this.root,e,this.comparator,!0)}}class ra{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ze{constructor(e,n,r,i,o){this.key=e,this.value=n,this.color=r??Ze.RED,this.left=i??Ze.EMPTY,this.right=o??Ze.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,o){return new Ze(e??this.key,n??this.value,r??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const o=r(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,n,r),null):o===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ze.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Ze.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ze.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ze.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Q();const e=this.left.check();if(e!==this.right.check())throw Q();return e+(this.isRed()?0:1)}}Ze.EMPTY=null,Ze.RED=!0,Ze.BLACK=!1;Ze.EMPTY=new class{constructor(){this.size=0}get key(){throw Q()}get value(){throw Q()}get color(){throw Q()}get left(){throw Q()}get right(){throw Q()}copy(e,n,r,i,o){return this}insert(e,n,r){return new Ze(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class he{constructor(e){this.comparator=e,this.data=new we(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new N_(this.data.getIterator())}getIteratorFrom(e){return new N_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof he)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new he(this.comparator);return n.data=e,n}}class N_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Ei(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class St{constructor(e){this.fields=e,e.sort(Pe.comparator)}static empty(){return new St([])}unionWith(e){let n=new he(Pe.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new St(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ao(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new pC("Invalid base64 string: "+o):o}}(e);return new qe(n)}static fromUint8Array(e){const n=function(i){let o="";for(let s=0;s<i.length;++s)o+=String.fromCharCode(i[s]);return o}(e);return new qe(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ee(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}qe.EMPTY_BYTE_STRING=new qe("");const TU=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ln(t){if(Y(!!t),typeof t=="string"){let e=0;const n=TU.exec(t);if(Y(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ie(t.seconds),nanos:Ie(t.nanos)}}function Ie(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function gr(t){return typeof t=="string"?qe.fromBase64String(t):qe.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jh(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ep(t){const e=t.mapValue.fields.__previous_value__;return jh(e)?ep(e):e}function Xs(t){const e=Ln(t.mapValue.fields.__local_write_time__.timestampValue);return new De(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EU{constructor(e,n,r,i,o,s,u,c,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}}class ei{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ei("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ei&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const er={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Pa={nullValue:"NULL_VALUE"};function ti(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?jh(t)?4:mC(t)?9007199254740991:Gu(t)?10:11:Q()}function pn(t,e){if(t===e)return!0;const n=ti(t);if(n!==ti(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Xs(t).isEqual(Xs(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const s=Ln(i.timestampValue),u=Ln(o.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return gr(i.bytesValue).isEqual(gr(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return Ie(i.geoPointValue.latitude)===Ie(o.geoPointValue.latitude)&&Ie(i.geoPointValue.longitude)===Ie(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return Ie(i.integerValue)===Ie(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const s=Ie(i.doubleValue),u=Ie(o.doubleValue);return s===u?Ys(s)===Ys(u):isNaN(s)&&isNaN(u)}return!1}(t,e);case 9:return ao(t.arrayValue.values||[],e.arrayValue.values||[],pn);case 10:case 11:return function(i,o){const s=i.mapValue.fields||{},u=o.mapValue.fields||{};if(k_(s)!==k_(u))return!1;for(const c in s)if(s.hasOwnProperty(c)&&(u[c]===void 0||!pn(s[c],u[c])))return!1;return!0}(t,e);default:return Q()}}function Zs(t,e){return(t.values||[]).find(n=>pn(n,e))!==void 0}function yr(t,e){if(t===e)return 0;const n=ti(t),r=ti(e);if(n!==r)return ee(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ee(t.booleanValue,e.booleanValue);case 2:return function(o,s){const u=Ie(o.integerValue||o.doubleValue),c=Ie(s.integerValue||s.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(t,e);case 3:return V_(t.timestampValue,e.timestampValue);case 4:return V_(Xs(t),Xs(e));case 5:return ee(t.stringValue,e.stringValue);case 6:return function(o,s){const u=gr(o),c=gr(s);return u.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){const u=o.split("/"),c=s.split("/");for(let d=0;d<u.length&&d<c.length;d++){const h=ee(u[d],c[d]);if(h!==0)return h}return ee(u.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){const u=ee(Ie(o.latitude),Ie(s.latitude));return u!==0?u:ee(Ie(o.longitude),Ie(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return L_(t.arrayValue,e.arrayValue);case 10:return function(o,s){var u,c,d,h;const p=o.fields||{},m=s.fields||{},_=(u=p.value)===null||u===void 0?void 0:u.arrayValue,S=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=ee(((d=_==null?void 0:_.values)===null||d===void 0?void 0:d.length)||0,((h=S==null?void 0:S.values)===null||h===void 0?void 0:h.length)||0);return P!==0?P:L_(_,S)}(t.mapValue,e.mapValue);case 11:return function(o,s){if(o===er.mapValue&&s===er.mapValue)return 0;if(o===er.mapValue)return 1;if(s===er.mapValue)return-1;const u=o.fields||{},c=Object.keys(u),d=s.fields||{},h=Object.keys(d);c.sort(),h.sort();for(let p=0;p<c.length&&p<h.length;++p){const m=ee(c[p],h[p]);if(m!==0)return m;const _=yr(u[c[p]],d[h[p]]);if(_!==0)return _}return ee(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Q()}}function V_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ee(t,e);const n=Ln(t),r=Ln(e),i=ee(n.seconds,r.seconds);return i!==0?i:ee(n.nanos,r.nanos)}function L_(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const o=yr(n[i],r[i]);if(o)return o}return ee(n.length,r.length)}function uo(t){return Rf(t)}function Rf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ln(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return gr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return H.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const o of n.values||[])i?i=!1:r+=",",r+=Rf(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",o=!0;for(const s of r)o?o=!1:i+=",",i+=`${s}:${Rf(n.fields[s])}`;return i+"}"}(t.mapValue):Q()}function js(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Pf(t){return!!t&&"integerValue"in t}function el(t){return!!t&&"arrayValue"in t}function F_(t){return!!t&&"nullValue"in t}function U_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function xa(t){return!!t&&"mapValue"in t}function Gu(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ws(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return hi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ws(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ws(t.arrayValue.values[n]);return e}return Object.assign({},t)}function mC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const gC={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function IU(t){return"nullValue"in t?Pa:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?js(ei.empty(),H.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Gu(t)?gC:{mapValue:{}}:Q()}function CU(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?js(ei.empty(),H.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?gC:"mapValue"in t?Gu(t)?{mapValue:{}}:er:Q()}function b_(t,e){const n=yr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function B_(t,e){const n=yr(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.value=e}static empty(){return new at({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!xa(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ws(n)}setAll(e){let n=Pe.emptyPath(),r={},i=[];e.forEach((s,u)=>{if(!n.isImmediateParentOf(u)){const c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=u.popLast()}s?r[u.lastSegment()]=ws(s):i.push(u.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,i)}delete(e){const n=this.field(e.popLast());xa(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return pn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];xa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){hi(n,(i,o)=>e[i]=o);for(const i of r)delete e[i]}clone(){return new at(ws(this.value))}}function yC(t){const e=[];return hi(t.fields,(n,r)=>{const i=new Pe([n]);if(xa(r)){const o=yC(r.mapValue).fields;if(o.length===0)e.push(i);else for(const s of o)e.push(i.child(s))}else e.push(i)}),new St(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e,n,r,i,o,s,u){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=o,this.data=s,this.documentState=u}static newInvalidDocument(e){return new Ve(e,0,X.min(),X.min(),X.min(),at.empty(),0)}static newFoundDocument(e,n,r,i){return new Ve(e,1,n,X.min(),r,i,0)}static newNoDocument(e,n){return new Ve(e,2,n,X.min(),X.min(),at.empty(),0)}static newUnknownDocument(e,n){return new Ve(e,3,n,X.min(),X.min(),at.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(X.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=at.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=at.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ve&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ve(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e,n){this.position=e,this.inclusive=n}}function O_(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const o=e[i],s=t.position[i];if(o.field.isKeyField()?r=H.comparator(H.fromName(s.referenceValue),n.key):r=yr(s,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function q_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!pn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n="asc"){this.field=e,this.dir=n}}function wU(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{}class ie extends _C{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new SU(e,n,r):n==="array-contains"?new PU(e,r):n==="in"?new wC(e,r):n==="not-in"?new xU(e,r):n==="array-contains-any"?new DU(e,r):new ie(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new AU(e,r):new RU(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(yr(n,this.value)):n!==null&&ti(this.value)===ti(n)&&this.matchesComparison(yr(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Q()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class de extends _C{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new de(e,n)}matches(e){return fo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function fo(t){return t.op==="and"}function xf(t){return t.op==="or"}function tp(t){return vC(t)&&fo(t)}function vC(t){for(const e of t.filters)if(e instanceof de)return!1;return!0}function Df(t){if(t instanceof ie)return t.field.canonicalString()+t.op.toString()+uo(t.value);if(tp(t))return t.filters.map(e=>Df(e)).join(",");{const e=t.filters.map(n=>Df(n)).join(",");return`${t.op}(${e})`}}function TC(t,e){return t instanceof ie?function(r,i){return i instanceof ie&&r.op===i.op&&r.field.isEqual(i.field)&&pn(r.value,i.value)}(t,e):t instanceof de?function(r,i){return i instanceof de&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((o,s,u)=>o&&TC(s,i.filters[u]),!0):!1}(t,e):void Q()}function EC(t,e){const n=t.filters.concat(e);return de.create(n,t.op)}function IC(t){return t instanceof ie?function(n){return`${n.field.canonicalString()} ${n.op} ${uo(n.value)}`}(t):t instanceof de?function(n){return n.op.toString()+" {"+n.getFilters().map(IC).join(" ,")+"}"}(t):"Filter"}class SU extends ie{constructor(e,n,r){super(e,n,r),this.key=H.fromName(r.referenceValue)}matches(e){const n=H.comparator(e.key,this.key);return this.matchesComparison(n)}}class AU extends ie{constructor(e,n){super(e,"in",n),this.keys=CC("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class RU extends ie{constructor(e,n){super(e,"not-in",n),this.keys=CC("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function CC(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>H.fromName(r.referenceValue))}class PU extends ie{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return el(n)&&Zs(n.arrayValue,this.value)}}class wC extends ie{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zs(this.value.arrayValue,n)}}class xU extends ie{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Zs(this.value.arrayValue,n)}}class DU extends ie{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!el(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zs(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(e,n=null,r=[],i=[],o=null,s=null,u=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=o,this.startAt=s,this.endAt=u,this.ue=null}}function Mf(t,e=null,n=[],r=[],i=null,o=null,s=null){return new MU(t,e,n,r,i,o,s)}function ni(t){const e=j(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Df(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),qu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>uo(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>uo(r)).join(",")),e.ue=n}return e.ue}function dl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!wU(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!TC(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!q_(t.startAt,e.startAt)&&q_(t.endAt,e.endAt)}function du(t){return H.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function fu(t,e){return t.filters.filter(n=>n instanceof ie&&n.field.isEqual(e))}function G_(t,e,n){let r=Pa,i=!0;for(const o of fu(t,e)){let s=Pa,u=!0;switch(o.op){case"<":case"<=":s=IU(o.value);break;case"==":case"in":case">=":s=o.value;break;case">":s=o.value,u=!1;break;case"!=":case"not-in":s=Pa}b_({value:r,inclusive:i},{value:s,inclusive:u})<0&&(r=s,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const s=n.position[o];b_({value:r,inclusive:i},{value:s,inclusive:n.inclusive})<0&&(r=s,i=n.inclusive);break}}return{value:r,inclusive:i}}function $_(t,e,n){let r=er,i=!0;for(const o of fu(t,e)){let s=er,u=!0;switch(o.op){case">=":case">":s=CU(o.value),u=!1;break;case"==":case"in":case"<=":s=o.value;break;case"<":s=o.value,u=!1;break;case"!=":case"not-in":s=er}B_({value:r,inclusive:i},{value:s,inclusive:u})>0&&(r=s,i=u)}if(n!==null){for(let o=0;o<t.orderBy.length;++o)if(t.orderBy[o].field.isEqual(e)){const s=n.position[o];B_({value:r,inclusive:i},{value:s,inclusive:n.inclusive})>0&&(r=s,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ro{constructor(e,n=null,r=[],i=[],o=null,s="F",u=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function kU(t,e,n,r,i,o,s,u){return new Ro(t,e,n,r,i,o,s,u)}function np(t){return new Ro(t)}function z_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function SC(t){return t.collectionGroup!==null}function Ss(t){const e=j(t);if(e.ce===null){e.ce=[];const n=new Set;for(const o of e.explicitOrderBy)e.ce.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(s){let u=new he(Pe.comparator);return s.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.ce.push(new tl(o,r))}),n.has(Pe.keyField().canonicalString())||e.ce.push(new tl(Pe.keyField(),r))}return e.ce}function Wt(t){const e=j(t);return e.le||(e.le=NU(e,Ss(t))),e.le}function NU(t,e){if(t.limitType==="F")return Mf(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new tl(i.field,o)});const n=t.endAt?new co(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new co(t.startAt.position,t.startAt.inclusive):null;return Mf(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function kf(t,e){const n=t.filters.concat([e]);return new Ro(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Nf(t,e,n){return new Ro(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function $u(t,e){return dl(Wt(t),Wt(e))&&t.limitType===e.limitType}function AC(t){return`${ni(Wt(t))}|lt:${t.limitType}`}function Ri(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>IC(i)).join(", ")}]`),qu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>uo(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>uo(i)).join(",")),`Target(${r})`}(Wt(t))}; limitType=${t.limitType})`}function fl(t,e){return e.isFoundDocument()&&function(r,i){const o=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):H.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,i){for(const o of Ss(r))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const o of r.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(s,u,c){const d=O_(s,u,c);return s.inclusive?d<=0:d<0}(r.startAt,Ss(r),i)||r.endAt&&!function(s,u,c){const d=O_(s,u,c);return s.inclusive?d>=0:d>0}(r.endAt,Ss(r),i))}(t,e)}function VU(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function RC(t){return(e,n)=>{let r=!1;for(const i of Ss(t)){const o=LU(i,e,n);if(o!==0)return o;r=r||i.field.isKeyField()}return 0}}function LU(t,e,n){const r=t.field.isKeyField()?H.comparator(e.key,n.key):function(o,s,u){const c=s.data.field(o),d=u.data.field(o);return c!==null&&d!==null?yr(c,d):Q()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Q()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wr{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,o]of r)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){hi(this.inner,(n,r)=>{for(const[i,o]of r)e(i,o)})}isEmpty(){return hC(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FU=new we(H.comparator);function Nt(){return FU}const PC=new we(H.comparator);function cs(...t){let e=PC;for(const n of t)e=e.insert(n.key,n);return e}function xC(t){let e=PC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function cn(){return As()}function DC(){return As()}function As(){return new wr(t=>t.toString(),(t,e)=>t.isEqual(e))}const UU=new we(H.comparator),bU=new he(H.comparator);function ne(...t){let e=bU;for(const n of t)e=e.add(n);return e}const BU=new he(ee);function OU(){return BU}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ys(e)?"-0":e}}function MC(t){return{integerValue:""+t}}function qU(t,e){return eU(e)?MC(e):rp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zu{constructor(){this._=void 0}}function GU(t,e,n){return t instanceof ho?function(i,o){const s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&jh(o)&&(o=ep(o)),o&&(s.fields.__previous_value__=o),{mapValue:s}}(n,e):t instanceof po?NC(t,e):t instanceof mo?VC(t,e):function(i,o){const s=kC(i,o),u=H_(s)+H_(i.Pe);return Pf(s)&&Pf(i.Pe)?MC(u):rp(i.serializer,u)}(t,e)}function $U(t,e,n){return t instanceof po?NC(t,e):t instanceof mo?VC(t,e):n}function kC(t,e){return t instanceof nl?function(r){return Pf(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class ho extends zu{}class po extends zu{constructor(e){super(),this.elements=e}}function NC(t,e){const n=LC(e);for(const r of t.elements)n.some(i=>pn(i,r))||n.push(r);return{arrayValue:{values:n}}}class mo extends zu{constructor(e){super(),this.elements=e}}function VC(t,e){let n=LC(e);for(const r of t.elements)n=n.filter(i=>!pn(i,r));return{arrayValue:{values:n}}}class nl extends zu{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function H_(t){return Ie(t.integerValue||t.doubleValue)}function LC(t){return el(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(e,n){this.field=e,this.transform=n}}function zU(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof po&&i instanceof po||r instanceof mo&&i instanceof mo?ao(r.elements,i.elements,pn):r instanceof nl&&i instanceof nl?pn(r.Pe,i.Pe):r instanceof ho&&i instanceof ho}(t.transform,e.transform)}class HU{constructor(e,n){this.version=e,this.transformResults=n}}class gt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new gt}static exists(e){return new gt(void 0,e)}static updateTime(e){return new gt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Da(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Hu{}function UC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ku(t.key,gt.none()):new Po(t.key,t.data,gt.none());{const n=t.data,r=at.empty();let i=new he(Pe.comparator);for(let o of e.fields)if(!i.has(o)){let s=n.field(o);s===null&&o.length>1&&(o=o.popLast(),s=n.field(o)),s===null?r.delete(o):r.set(o,s),i=i.add(o)}return new bn(t.key,r,new St(i.toArray()),gt.none())}}function KU(t,e,n){t instanceof Po?function(i,o,s){const u=i.value.clone(),c=W_(i.fieldTransforms,o,s.transformResults);u.setAll(c),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(t,e,n):t instanceof bn?function(i,o,s){if(!Da(i.precondition,o))return void o.convertToUnknownDocument(s.version);const u=W_(i.fieldTransforms,o,s.transformResults),c=o.data;c.setAll(bC(i)),c.setAll(u),o.convertToFoundDocument(s.version,c).setHasCommittedMutations()}(t,e,n):function(i,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function Rs(t,e,n,r){return t instanceof Po?function(o,s,u,c){if(!Da(o.precondition,s))return u;const d=o.value.clone(),h=J_(o.fieldTransforms,c,s);return d.setAll(h),s.convertToFoundDocument(s.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof bn?function(o,s,u,c){if(!Da(o.precondition,s))return u;const d=J_(o.fieldTransforms,c,s),h=s.data;return h.setAll(bC(o)),h.setAll(d),s.convertToFoundDocument(s.version,h).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(o,s,u){return Da(o.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):u}(t,e,n)}function WU(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),o=kC(r.transform,i||null);o!=null&&(n===null&&(n=at.empty()),n.set(r.field,o))}return n||null}function K_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&ao(r,i,(o,s)=>zU(o,s))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Po extends Hu{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class bn extends Hu{constructor(e,n,r,i,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function bC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function W_(t,e,n){const r=new Map;Y(t.length===n.length);for(let i=0;i<n.length;i++){const o=t[i],s=o.transform,u=e.data.field(o.field);r.set(o.field,$U(s,u,n[i]))}return r}function J_(t,e,n){const r=new Map;for(const i of t){const o=i.transform,s=n.data.field(i.field);r.set(i.field,GU(o,s,e))}return r}class Ku extends Hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class BC extends Hu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&KU(o,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Rs(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Rs(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=DC();return this.mutations.forEach(i=>{const o=e.get(i.key),s=o.overlayedDocument;let u=this.applyToLocalView(s,o.mutatedFields);u=n.has(i.key)?null:u;const c=UC(s,u);c!==null&&r.set(i.key,c),s.isValidDocument()||s.convertToNoDocument(X.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ne())}isEqual(e){return this.batchId===e.batchId&&ao(this.mutations,e.mutations,(n,r)=>K_(n,r))&&ao(this.baseMutations,e.baseMutations,(n,r)=>K_(n,r))}}class op{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){Y(e.mutations.length===r.length);let i=function(){return UU}();const o=e.mutations;for(let s=0;s<o.length;s++)i=i.insert(o[s].key,r[s].version);return new op(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Be,oe;function QU(t){switch(t){default:return Q();case B.CANCELLED:case B.UNKNOWN:case B.DEADLINE_EXCEEDED:case B.RESOURCE_EXHAUSTED:case B.INTERNAL:case B.UNAVAILABLE:case B.UNAUTHENTICATED:return!1;case B.INVALID_ARGUMENT:case B.NOT_FOUND:case B.ALREADY_EXISTS:case B.PERMISSION_DENIED:case B.FAILED_PRECONDITION:case B.ABORTED:case B.OUT_OF_RANGE:case B.UNIMPLEMENTED:case B.DATA_LOSS:return!0}}function OC(t){if(t===void 0)return mt("GRPC error has no .code"),B.UNKNOWN;switch(t){case Be.OK:return B.OK;case Be.CANCELLED:return B.CANCELLED;case Be.UNKNOWN:return B.UNKNOWN;case Be.DEADLINE_EXCEEDED:return B.DEADLINE_EXCEEDED;case Be.RESOURCE_EXHAUSTED:return B.RESOURCE_EXHAUSTED;case Be.INTERNAL:return B.INTERNAL;case Be.UNAVAILABLE:return B.UNAVAILABLE;case Be.UNAUTHENTICATED:return B.UNAUTHENTICATED;case Be.INVALID_ARGUMENT:return B.INVALID_ARGUMENT;case Be.NOT_FOUND:return B.NOT_FOUND;case Be.ALREADY_EXISTS:return B.ALREADY_EXISTS;case Be.PERMISSION_DENIED:return B.PERMISSION_DENIED;case Be.FAILED_PRECONDITION:return B.FAILED_PRECONDITION;case Be.ABORTED:return B.ABORTED;case Be.OUT_OF_RANGE:return B.OUT_OF_RANGE;case Be.UNIMPLEMENTED:return B.UNIMPLEMENTED;case Be.DATA_LOSS:return B.DATA_LOSS;default:return Q()}}(oe=Be||(Be={}))[oe.OK=0]="OK",oe[oe.CANCELLED=1]="CANCELLED",oe[oe.UNKNOWN=2]="UNKNOWN",oe[oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",oe[oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",oe[oe.NOT_FOUND=5]="NOT_FOUND",oe[oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",oe[oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",oe[oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",oe[oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",oe[oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",oe[oe.ABORTED=10]="ABORTED",oe[oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",oe[oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",oe[oe.INTERNAL=13]="INTERNAL",oe[oe.UNAVAILABLE=14]="UNAVAILABLE",oe[oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XU=new $r([4294967295,4294967295],0);function Q_(t){const e=YU().encode(t),n=new YI;return n.update(e),new Uint8Array(n.digest())}function Y_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new $r([n,r],0),new $r([i,o],0)]}class lp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ds(`Invalid padding: ${n}`);if(r<0)throw new ds(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ds(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ds(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=$r.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply($r.fromNumber(r)));return i.compare(XU)===1&&(i=new $r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Q_(e),[r,i]=Y_(n);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);if(!this.de(s))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),s=new lp(o,i,n);return r.forEach(u=>s.insert(u)),s}insert(e){if(this.Ie===0)return;const n=Q_(e),[r,i]=Y_(n);for(let o=0;o<this.hashCount;o++){const s=this.Ee(r,i,o);this.Ae(s)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ds extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wu{constructor(e,n,r,i,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,hl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Wu(X.min(),i,new we(ee),Nt(),ne())}}class hl{constructor(e,n,r,i,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new hl(r,n,ne(),ne(),ne())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class qC{constructor(e,n){this.targetId=e,this.me=n}}class GC{constructor(e,n,r=qe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class X_{constructor(){this.fe=0,this.ge=j_(),this.pe=qe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ne(),n=ne(),r=ne();return this.ge.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:Q()}}),new hl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=j_()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Y(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class ZU{constructor(e){this.Le=e,this.Be=new Map,this.ke=Nt(),this.qe=Z_(),this.Qe=new we(ee)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:Q()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const o=i.target;if(du(o))if(r===0){const s=new H(o.path);this.Ue(n,s,Ve.newNoDocument(s,X.min()))}else Y(r===1);else{const s=this.Ye(n);if(s!==r){const u=this.Ze(e),c=u?this.Xe(u,e,s):1;if(c!==0){this.je(n);const d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:o=0}=n;let s,u;try{s=gr(r).toUint8Array()}catch(c){if(c instanceof pC)return jr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new lp(s,i,o)}catch(c){return jr(c instanceof ds?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(o=>{const s=this.Le.tt(),u=`projects/${s.projectId}/databases/${s.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Ue(n,o,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((o,s)=>{const u=this.Je(s);if(u){if(o.current&&du(u.target)){const c=new H(u.target.path);this.ke.get(c)!==null||this.it(s,c)||this.Ue(s,c,Ve.newNoDocument(c,e))}o.be&&(n.set(s,o.ve()),o.Ce())}});let r=ne();this.qe.forEach((o,s)=>{let u=!0;s.forEachWhile(c=>{const d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(o))}),this.ke.forEach((o,s)=>s.setReadTime(e));const i=new Wu(e,n,this.Qe,this.ke,r);return this.ke=Nt(),this.qe=Z_(),this.Qe=new we(ee),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new X_,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new he(ee),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||q("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new X_),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Z_(){return new we(H.comparator)}function j_(){return new we(H.comparator)}const jU={asc:"ASCENDING",desc:"DESCENDING"},eb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tb={and:"AND",or:"OR"};class nb{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Vf(t,e){return t.useProto3Json||qu(e)?e:{value:e}}function go(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $C(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function rb(t,e){return go(t,e.toTimestamp())}function vt(t){return Y(!!t),X.fromTimestamp(function(n){const r=Ln(n);return new De(r.seconds,r.nanos)}(t))}function ap(t,e){return Lf(t,e).canonicalString()}function Lf(t,e){const n=function(i){return new ce(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function zC(t){const e=ce.fromString(t);return Y(jC(e)),e}function hu(t,e){return ap(t.databaseId,e.path)}function zr(t,e){const n=zC(e);if(n.get(1)!==t.databaseId.projectId)throw new z(B.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new z(B.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new H(WC(n))}function HC(t,e){return ap(t.databaseId,e)}function KC(t){const e=zC(t);return e.length===4?ce.emptyPath():WC(e)}function Ff(t){return new ce(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function WC(t){return Y(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function ev(t,e,n){return{name:hu(t,e),fields:n.value.mapValue.fields}}function ib(t,e,n){const r=zr(t,e.name),i=vt(e.updateTime),o=e.createTime?vt(e.createTime):X.min(),s=new at({mapValue:{fields:e.fields}}),u=Ve.newFoundDocument(r,i,o,s);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function ob(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:Q()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,h){return d.useProto3Json?(Y(h===void 0||typeof h=="string"),qe.fromBase64String(h||"")):(Y(h===void 0||h instanceof Buffer||h instanceof Uint8Array),qe.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),s=e.targetChange.cause,u=s&&function(d){const h=d.code===void 0?B.UNKNOWN:OC(d.code);return new z(h,d.message||"")}(s);n=new GC(r,i,o,u||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=zr(t,r.document.name),o=vt(r.document.updateTime),s=r.document.createTime?vt(r.document.createTime):X.min(),u=new at({mapValue:{fields:r.document.fields}}),c=Ve.newFoundDocument(i,o,s,u),d=r.targetIds||[],h=r.removedTargetIds||[];n=new Ma(d,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=zr(t,r.document),o=r.readTime?vt(r.readTime):X.min(),s=Ve.newNoDocument(i,o),u=r.removedTargetIds||[];n=new Ma([],u,s.key,s)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=zr(t,r.document),o=r.removedTargetIds||[];n=new Ma([],o,i,null)}else{if(!("filter"in e))return Q();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:o}=r,s=new JU(i,o),u=r.targetId;n=new qC(u,s)}}return n}function pu(t,e){let n;if(e instanceof Po)n={update:ev(t,e.key,e.value)};else if(e instanceof Ku)n={delete:hu(t,e.key)};else if(e instanceof bn)n={update:ev(t,e.key,e.data),updateMask:db(e.fieldMask)};else{if(!(e instanceof BC))return Q();n={verify:hu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,s){const u=s.transform;if(u instanceof ho)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof po)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof mo)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof nl)return{fieldPath:s.field.canonicalString(),increment:u.Pe};throw Q()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:rb(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Q()}(t,e.precondition)),n}function Uf(t,e){const n=e.currentDocument?function(o){return o.updateTime!==void 0?gt.updateTime(vt(o.updateTime)):o.exists!==void 0?gt.exists(o.exists):gt.none()}(e.currentDocument):gt.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,u){let c=null;if("setToServerValue"in u)Y(u.setToServerValue==="REQUEST_TIME"),c=new ho;else if("appendMissingElements"in u){const h=u.appendMissingElements.values||[];c=new po(h)}else if("removeAllFromArray"in u){const h=u.removeAllFromArray.values||[];c=new mo(h)}else"increment"in u?c=new nl(s,u.increment):Q();const d=Pe.fromServerFormat(u.fieldPath);return new FC(d,c)}(t,i)):[];if(e.update){e.update.name;const i=zr(t,e.update.name),o=new at({mapValue:{fields:e.update.fields}});if(e.updateMask){const s=function(c){const d=c.fieldPaths||[];return new St(d.map(h=>Pe.fromServerFormat(h)))}(e.updateMask);return new bn(i,o,s,n,r)}return new Po(i,o,n,r)}if(e.delete){const i=zr(t,e.delete);return new Ku(i,n)}if(e.verify){const i=zr(t,e.verify);return new BC(i,n)}return Q()}function sb(t,e){return t&&t.length>0?(Y(e!==void 0),t.map(n=>function(i,o){let s=i.updateTime?vt(i.updateTime):vt(o);return s.isEqual(X.min())&&(s=vt(o)),new HU(s,i.transformResults||[])}(n,e))):[]}function JC(t,e){return{documents:[HC(t,e.path)]}}function QC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=HC(t,i);const o=function(d){if(d.length!==0)return ZC(de.create(d,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const s=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Pi(m.field),direction:ab(m.dir)}}(h))}(e.orderBy);s&&(n.structuredQuery.orderBy=s);const u=Vf(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:i}}function YC(t){let e=KC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Y(r===1);const h=n.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let o=[];n.where&&(o=function(p){const m=XC(p);return m instanceof de&&tp(m)?m.getFilters():[m]}(n.where));let s=[];n.orderBy&&(s=function(p){return p.map(m=>function(S){return new tl(xi(S.field),function(k){switch(k){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(m))}(n.orderBy));let u=null;n.limit&&(u=function(p){let m;return m=typeof p=="object"?p.value:p,qu(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(p){const m=!!p.before,_=p.values||[];return new co(_,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,_=p.values||[];return new co(_,m)}(n.endAt)),kU(e,i,s,o,u,"F",c,d)}function lb(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Q()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function XC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xi(n.unaryFilter.field);return ie.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xi(n.unaryFilter.field);return ie.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=xi(n.unaryFilter.field);return ie.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=xi(n.unaryFilter.field);return ie.create(s,"!=",{nullValue:"NULL_VALUE"});default:return Q()}}(t):t.fieldFilter!==void 0?function(n){return ie.create(xi(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Q()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return de.create(n.compositeFilter.filters.map(r=>XC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Q()}}(n.compositeFilter.op))}(t):Q()}function ab(t){return jU[t]}function ub(t){return eb[t]}function cb(t){return tb[t]}function Pi(t){return{fieldPath:t.canonicalString()}}function xi(t){return Pe.fromServerFormat(t.fieldPath)}function ZC(t){return t instanceof ie?function(n){if(n.op==="=="){if(U_(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NAN"}};if(F_(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(U_(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NOT_NAN"}};if(F_(n.value))return{unaryFilter:{field:Pi(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Pi(n.field),op:ub(n.op),value:n.value}}}(t):t instanceof de?function(n){const r=n.getFilters().map(i=>ZC(i));return r.length===1?r[0]:{compositeFilter:{op:cb(n.op),filters:r}}}(t):Q()}function db(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function jC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e,n,r,i,o=X.min(),s=X.min(),u=qe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new Rn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Rn(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Rn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Rn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ew{constructor(e){this.ct=e}}function fb(t,e){let n;if(e.document)n=ib(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=H.fromSegments(e.noDocument.path),i=ii(e.noDocument.readTime);n=Ve.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return Q();{const r=H.fromSegments(e.unknownDocument.path),i=ii(e.unknownDocument.version);n=Ve.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const o=new De(i[0],i[1]);return X.fromTimestamp(o)}(e.readTime)),n}function tv(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:mu(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(o,s){return{name:hu(o,s.key),fields:s.data.value.mapValue.fields,updateTime:go(o,s.version.toTimestamp()),createTime:go(o,s.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ri(e.version)};else{if(!e.isUnknownDocument())return Q();r.unknownDocument={path:n.path.toArray(),version:ri(e.version)}}return r}function mu(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ri(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ii(t){const e=new De(t.seconds,t.nanoseconds);return X.fromTimestamp(e)}function Lr(t,e){const n=(e.baseMutations||[]).map(o=>Uf(t.ct,o));for(let o=0;o<e.mutations.length-1;++o){const s=e.mutations[o];if(o+1<e.mutations.length&&e.mutations[o+1].transform!==void 0){const u=e.mutations[o+1];s.updateTransforms=u.transform.fieldTransforms,e.mutations.splice(o+1,1),++o}}const r=e.mutations.map(o=>Uf(t.ct,o)),i=De.fromMillis(e.localWriteTimeMs);return new ip(e.batchId,i,n,r)}function fs(t){const e=ii(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ii(t.lastLimboFreeSnapshotVersion):X.min();let r;return r=function(o){return o.documents!==void 0}(t.query)?function(o){return Y(o.documents.length===1),Wt(np(KC(o.documents[0])))}(t.query):function(o){return Wt(YC(o))}(t.query),new Rn(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,qe.fromBase64String(t.resumeToken))}function tw(t,e){const n=ri(e.snapshotVersion),r=ri(e.lastLimboFreeSnapshotVersion);let i;i=du(e.target)?JC(t.ct,e.target):QC(t.ct,e.target)._t;const o=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ni(e.target),readTime:n,resumeToken:o,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nw(t){const e=YC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Nf(e,e.limit,"L"):e}function ld(t,e){return new sp(e.largestBatchId,Uf(t.ct,e.overlayMutation))}function nv(t,e){const n=e.path.lastSegment();return[t,_t(e.path.popLast()),n]}function rv(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ri(r.readTime),documentKey:_t(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{getBundleMetadata(e,n){return iv(e).get(n).next(r=>{if(r)return function(o){return{id:o.bundleId,createTime:ii(o.createTime),version:o.version}}(r)})}saveBundleMetadata(e,n){return iv(e).put(function(i){return{bundleId:i.id,createTime:ri(vt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return ov(e).get(n).next(r=>{if(r)return function(o){return{name:o.name,query:nw(o.bundledQuery),readTime:ii(o.readTime)}}(r)})}saveNamedQuery(e,n){return ov(e).put(function(i){return{name:i.name,readTime:ri(vt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function iv(t){return ze(t,"bundles")}function ov(t){return ze(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Ju(e,r)}getOverlay(e,n){return jo(e).get(nv(this.userId,n)).next(r=>r?ld(this.serializer,r):null)}getOverlays(e,n){const r=cn();return L.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((o,s)=>{const u=new sp(n,s);i.push(this.ht(e,u))}),L.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(s=>i.add(_t(s.getCollectionPath())));const o=[];return i.forEach(s=>{const u=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,r+1],!1,!0);o.push(jo(e).j("collectionPathOverlayIndex",u))}),L.waitFor(o)}getOverlaysForCollection(e,n,r){const i=cn(),o=_t(n),s=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,Number.POSITIVE_INFINITY],!0);return jo(e).U("collectionPathOverlayIndex",s).next(u=>{for(const c of u){const d=ld(this.serializer,c);i.set(d.getKey(),d)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const o=cn();let s;const u=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return jo(e).J({index:"collectionGroupOverlayIndex",range:u},(c,d,h)=>{const p=ld(this.serializer,d);o.size()<i||p.largestBatchId===s?(o.set(p.getKey(),p),s=p.largestBatchId):h.done()}).next(()=>o)}ht(e,n){return jo(e).put(function(i,o,s){const[u,c,d]=nv(o,s.mutation.key);return{userId:o,collectionPath:c,documentId:d,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:pu(i.ct,s.mutation)}}(this.serializer,this.userId,n))}}function jo(t){return ze(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{Pt(e){return ze(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?qe.fromUint8Array(r):qe.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fr{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Ie(e.integerValue));else if("doubleValue"in e){const r=Ie(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Ys(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Ln(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(gr(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?mC(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Gu(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):Q()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const o=e.fields||{};this.dt(n,53);const s="value",u=((i=(r=o[s].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(Ie(u)),this.Vt(s,n),this.Tt(o[s],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),H.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Fr.vt=new Fr;function mb(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function sv(t){const e=64-function(r){let i=0;for(let o=0;o<8;++o){const s=mb(255&r[o]);if(i+=s,s!==8)break}return i}(t);return Math.ceil(e/8)}class gb{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=sv(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=sv(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(o){const s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,o,!1),new Uint8Array(s.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class yb{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class _b{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class es{constructor(){this.jt=new gb,this.Ht=new yb(this.jt),this.Jt=new _b(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ur(this.indexId,this.documentKey,this.arrayValue,r)}}function $n(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=lv(t.arrayValue,e.arrayValue),n!==0?n:(n=lv(t.directionalValue,e.directionalValue),n!==0?n:H.comparator(t.documentKey,e.documentKey)))}function lv(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){this.Xt=new he((n,r)=>Pe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Y(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Sf(e);if(n!==void 0&&!this.sn(n))return!1;const r=Nr(e);let i=new Set,o=0,s=0;for(;o<r.length&&this.sn(r[o]);++o)i=i.add(r[o].fieldPath.canonicalString());if(o===r.length)return!0;if(this.Xt.size>0){const u=this.Xt.getIterator().getNext();if(!i.has(u.field.canonicalString())){const c=r[o];if(!this.on(u,c)||!this._n(this.en[s++],c))return!1}++o}for(;o<r.length;++o){const u=r[o];if(s>=this.en.length||!this._n(this.en[s++],u))return!1}return!0}an(){if(this.nn)return null;let e=new he(Pe.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Aa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Aa(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Aa(r.field,r.dir==="asc"?0:1)));return new cu(cu.UNKNOWN_ID,this.collectionId,n,Qs.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rw(t){var e,n;if(Y(t instanceof ie||t instanceof de),t instanceof ie){if(t instanceof wC){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(o=>ie.create(t.field,"==",o)))||[];return de.create(i,"or")}return t}const r=t.filters.map(i=>rw(i));return de.create(r,t.op)}function vb(t){if(t.getFilters().length===0)return[];const e=Of(rw(t));return Y(iw(e)),bf(e)||Bf(e)?[e]:e.getFilters()}function bf(t){return t instanceof ie}function Bf(t){return t instanceof de&&tp(t)}function iw(t){return bf(t)||Bf(t)||function(n){if(n instanceof de&&xf(n)){for(const r of n.getFilters())if(!bf(r)&&!Bf(r))return!1;return!0}return!1}(t)}function Of(t){if(Y(t instanceof ie||t instanceof de),t instanceof ie)return t;if(t.filters.length===1)return Of(t.filters[0]);const e=t.filters.map(r=>Of(r));let n=de.create(e,t.op);return n=gu(n),iw(n)?n:(Y(n instanceof de),Y(fo(n)),Y(n.filters.length>1),n.filters.reduce((r,i)=>up(r,i)))}function up(t,e){let n;return Y(t instanceof ie||t instanceof de),Y(e instanceof ie||e instanceof de),n=t instanceof ie?e instanceof ie?function(i,o){return de.create([i,o],"and")}(t,e):uv(t,e):e instanceof ie?uv(e,t):function(i,o){if(Y(i.filters.length>0&&o.filters.length>0),fo(i)&&fo(o))return EC(i,o.getFilters());const s=xf(i)?i:o,u=xf(i)?o:i,c=s.filters.map(d=>up(d,u));return de.create(c,"or")}(t,e),gu(n)}function uv(t,e){if(fo(e))return EC(e,t.getFilters());{const n=e.filters.map(r=>up(t,r));return de.create(n,"or")}}function gu(t){if(Y(t instanceof ie||t instanceof de),t instanceof ie)return t;const e=t.getFilters();if(e.length===1)return gu(e[0]);if(vC(t))return t;const n=e.map(i=>gu(i)),r=[];return n.forEach(i=>{i instanceof ie?r.push(i):i instanceof de&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:de.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(){this.un=new cp}addToCollectionParentIndex(e,n){return this.un.add(n),L.resolve()}getCollectionParents(e,n){return L.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return L.resolve()}deleteFieldIndex(e,n){return L.resolve()}deleteAllFieldIndexes(e){return L.resolve()}createTargetIndexes(e,n){return L.resolve()}getDocumentsMatchingTarget(e,n){return L.resolve(null)}getIndexType(e,n){return L.resolve(0)}getFieldIndexes(e,n){return L.resolve([])}getNextCollectionGroupToUpdate(e){return L.resolve(null)}getMinOffset(e,n){return L.resolve(bt.min())}getMinOffsetFromCollectionGroup(e,n){return L.resolve(bt.min())}updateCollectionGroup(e,n,r){return L.resolve()}updateIndexEntries(e,n){return L.resolve()}}class cp{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new he(ce.comparator),o=!i.has(r);return this.index[n]=i.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new he(ce.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ia=new Uint8Array(0);class Eb{constructor(e,n){this.databaseId=n,this.cn=new cp,this.ln=new wr(r=>ni(r),(r,i)=>dl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const o={collectionId:r,parent:_t(i)};return cv(e).put(o)}return L.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[iC(n),""],!1,!0);return cv(e).U(i).next(o=>{for(const s of o){if(s.collectionId!==n)break;r.push(un(s.parent))}return r})}addFieldIndex(e,n){const r=ts(e),i=function(u){return{indexId:u.indexId,collectionGroup:u.collectionGroup,fields:u.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;const o=r.add(i);if(n.indexState){const s=Ci(e);return o.next(u=>{s.put(rv(u,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return o.next()}deleteFieldIndex(e,n){const r=ts(e),i=Ci(e),o=Ii(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>o.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ts(e),r=Ii(e),i=Ci(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return L.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const o=new av(r).an();if(o!=null)return this.addFieldIndex(e,o)}}))}getDocumentsMatchingTarget(e,n){const r=Ii(e);let i=!0;const o=new Map;return L.forEach(this.hn(n),s=>this.Pn(e,s).next(u=>{i&&(i=!!u),o.set(s,u)})).next(()=>{if(i){let s=ne();const u=[];return L.forEach(o,(c,d)=>{q("IndexedDbIndexManager",`Using index ${function(I){return`id=${I.indexId}|cg=${I.collectionGroup}|f=${I.fields.map(M=>`${M.fieldPath}:${M.kind}`).join(",")}`}(c)} to execute ${ni(n)}`);const h=function(I,M){const F=Sf(M);if(F===void 0)return null;for(const b of fu(I,F.fieldPath))switch(b.op){case"array-contains-any":return b.value.arrayValue.values||[];case"array-contains":return[b.value]}return null}(d,c),p=function(I,M){const F=new Map;for(const b of Nr(M))for(const A of fu(I,b.fieldPath))switch(A.op){case"==":case"in":F.set(b.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return F.set(b.fieldPath.canonicalString(),A.value),Array.from(F.values())}return null}(d,c),m=function(I,M){const F=[];let b=!0;for(const A of Nr(M)){const v=A.kind===0?G_(I,A.fieldPath,I.startAt):$_(I,A.fieldPath,I.startAt);F.push(v.value),b&&(b=v.inclusive)}return new co(F,b)}(d,c),_=function(I,M){const F=[];let b=!0;for(const A of Nr(M)){const v=A.kind===0?$_(I,A.fieldPath,I.endAt):G_(I,A.fieldPath,I.endAt);F.push(v.value),b&&(b=v.inclusive)}return new co(F,b)}(d,c),S=this.In(c,d,m),P=this.In(c,d,_),k=this.Tn(c,d,p),C=this.En(c.indexId,h,S,m.inclusive,P,_.inclusive,k);return L.forEach(C,T=>r.G(T,n.limit).next(I=>{I.forEach(M=>{const F=H.fromSegments(M.documentKey);s.has(F)||(s=s.add(F),u.push(F))})}))}).next(()=>u)}return L.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=vb(de.create(e.filters,"and")).map(r=>Mf(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,o,s,u){const c=(n!=null?n.length:1)*Math.max(r.length,o.length),d=c/(n!=null?n.length:1),h=[];for(let p=0;p<c;++p){const m=n?this.dn(n[p/d]):ia,_=this.An(e,m,r[p%d],i),S=this.Rn(e,m,o[p%d],s),P=u.map(k=>this.An(e,m,k,!0));h.push(...this.createRange(_,S,P))}return h}An(e,n,r,i){const o=new Ur(e,H.empty(),n,r);return i?o:o.Zt()}Rn(e,n,r,i){const o=new Ur(e,H.empty(),n,r);return i?o.Zt():o}Pn(e,n){const r=new av(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(o=>{let s=null;for(const u of o)r.rn(u)&&(!s||u.fields.length>s.fields.length)&&(s=u);return s})}getIndexType(e,n){let r=2;const i=this.hn(n);return L.forEach(i,o=>this.Pn(e,o).next(s=>{s?r!==0&&s.fields.length<function(c){let d=new he(Pe.comparator),h=!1;for(const p of c.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:d=d.add(m.field));for(const p of c.orderBy)p.field.isKeyField()||(d=d.add(p.field));return d.size+(h?1:0)}(o)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new es;for(const i of Nr(e)){const o=n.data.field(i.fieldPath);if(o==null)return null;const s=r.Yt(i.kind);Fr.vt.It(o,s)}return r.zt()}dn(e){const n=new es;return Fr.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new es;return Fr.vt.It(js(this.databaseId,n),r.Yt(function(o){const s=Nr(o);return s.length===0?0:s[s.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new es);let o=0;for(const s of Nr(e)){const u=r[o++];for(const c of i)if(this.fn(n,s.fieldPath)&&el(u))i=this.gn(i,s,u);else{const d=c.Yt(s.kind);Fr.vt.It(u,d)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],o=[];for(const s of r.arrayValue.values||[])for(const u of i){const c=new es;c.seed(u.zt()),Fr.vt.It(s,c.Yt(n.kind)),o.push(c)}return o}fn(e,n){return!!e.filters.find(r=>r instanceof ie&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ts(e),i=Ci(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(o=>{const s=[];return L.forEach(o,u=>i.get([u.indexId,this.uid]).next(c=>{s.push(function(h,p){const m=p?new Qs(p.sequenceNumber,new bt(ii(p.readTime),new H(un(p.documentKey)),p.largestBatchId)):Qs.empty(),_=h.fields.map(([S,P])=>new Aa(Pe.fromServerFormat(S),P));return new cu(h.indexId,h.collectionGroup,_,m)}(u,c))})).next(()=>s)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const o=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return o!==0?o:ee(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ts(e),o=Ci(e);return this.yn(e).next(s=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(u=>L.forEach(u,c=>o.put(rv(c.indexId,this.uid,s,r)))))}updateIndexEntries(e,n){const r=new Map;return L.forEach(n,(i,o)=>{const s=r.get(i.collectionGroup);return(s?L.resolve(s):this.getFieldIndexes(e,i.collectionGroup)).next(u=>(r.set(i.collectionGroup,u),L.forEach(u,c=>this.wn(e,i,c).next(d=>{const h=this.Sn(o,c);return d.isEqual(h)?L.resolve():this.bn(e,o,c,d,h)}))))})}Dn(e,n,r,i){return Ii(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Ii(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Ii(e);let o=new he($n);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(s,u)=>{o=o.add(new Ur(r.indexId,n,u.arrayValue,u.directionalValue))}).next(()=>o)}Sn(e,n){let r=new he($n);const i=this.Vn(n,e);if(i==null)return r;const o=Sf(n);if(o!=null){const s=e.data.field(o.fieldPath);if(el(s))for(const u of s.arrayValue.values||[])r=r.add(new Ur(n.indexId,e.key,this.dn(u),i))}else r=r.add(new Ur(n.indexId,e.key,ia,i));return r}bn(e,n,r,i,o){q("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const s=[];return function(c,d,h,p,m){const _=c.getIterator(),S=d.getIterator();let P=Ei(_),k=Ei(S);for(;P||k;){let C=!1,T=!1;if(P&&k){const I=h(P,k);I<0?T=!0:I>0&&(C=!0)}else P!=null?T=!0:C=!0;C?(p(k),k=Ei(S)):T?(m(P),P=Ei(_)):(P=Ei(_),k=Ei(S))}}(i,o,$n,u=>{s.push(this.Dn(e,n,r,u))},u=>{s.push(this.vn(e,n,r,u))}),L.waitFor(s)}yn(e){let n=1;return Ci(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,o)=>{o.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((s,u)=>$n(s,u)).filter((s,u,c)=>!u||$n(s,c[u-1])!==0);const i=[];i.push(e);for(const s of r){const u=$n(s,e),c=$n(s,n);if(u===0)i[0]=e.Zt();else if(u>0&&c<0)i.push(s),i.push(s.Zt());else if(c>0)break}i.push(n);const o=[];for(let s=0;s<i.length;s+=2){if(this.Cn(i[s],i[s+1]))return[];const u=[i[s].indexId,this.uid,i[s].arrayValue,i[s].directionalValue,ia,[]],c=[i[s+1].indexId,this.uid,i[s+1].arrayValue,i[s+1].directionalValue,ia,[]];o.push(IDBKeyRange.bound(u,c))}return o}Cn(e,n){return $n(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(dv)}getMinOffset(e,n){return L.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||Q())).next(dv)}}function cv(t){return ze(t,"collectionParents")}function Ii(t){return ze(t,"indexEntries")}function ts(t){return ze(t,"indexConfiguration")}function Ci(t){return ze(t,"indexState")}function dv(t){Y(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Yh(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new bt(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class It{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new It(e,It.DEFAULT_COLLECTION_PERCENTILE,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),o=[],s=IDBKeyRange.only(n.batchId);let u=0;const c=r.J({range:s},(h,p,m)=>(u++,m.delete()));o.push(c.next(()=>{Y(u===1)}));const d=[];for(const h of n.mutations){const p=uC(e,h.key.path,n.batchId);o.push(i.delete(p)),d.push(h.key)}return L.waitFor(o).next(()=>d)}function yu(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Q();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */It.DEFAULT_COLLECTION_PERCENTILE=10,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,It.DEFAULT=new It(41943040,It.DEFAULT_COLLECTION_PERCENTILE,It.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),It.DISABLED=new It(-1,0,0);class Qu{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){Y(e.uid!=="");const o=e.isAuthenticated()?e.uid:"";return new Qu(o,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).J({index:"userMutationsIndex",range:r},(i,o,s)=>{n=!1,s.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const o=Di(e),s=zn(e);return s.add({}).next(u=>{Y(typeof u=="number");const c=new ip(u,n,r,i),d=function(_,S,P){const k=P.baseMutations.map(T=>pu(_.ct,T)),C=P.mutations.map(T=>pu(_.ct,T));return{userId:S,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:k,mutations:C}}(this.serializer,this.userId,c),h=[];let p=new he((m,_)=>ee(m.canonicalString(),_.canonicalString()));for(const m of i){const _=uC(this.userId,m.key.path,u);p=p.add(m.key.path.popLast()),h.push(s.put(d)),h.push(o.put(_,nU))}return p.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[u]=c.keys()}),L.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return zn(e).get(n).next(r=>r?(Y(r.userId===this.userId),Lr(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?L.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let o=null;return zn(e).J({index:"userMutationsIndex",range:i},(s,u,c)=>{u.userId===this.userId&&(Y(u.batchId>=r),o=Lr(this.serializer,u)),c.done()}).next(()=>o)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return zn(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,o,s)=>{r=o.batchId,s.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return zn(e).U("userMutationsIndex",n).next(r=>r.map(i=>Lr(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Ra(this.userId,n.path),i=IDBKeyRange.lowerBound(r),o=[];return Di(e).J({range:i},(s,u,c)=>{const[d,h,p]=s,m=un(h);if(d===this.userId&&n.path.isEqual(m))return zn(e).get(p).next(_=>{if(!_)throw Q();Y(_.userId===this.userId),o.push(Lr(this.serializer,_))});c.done()}).next(()=>o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new he(ee);const i=[];return n.forEach(o=>{const s=Ra(this.userId,o.path),u=IDBKeyRange.lowerBound(s),c=Di(e).J({range:u},(d,h,p)=>{const[m,_,S]=d,P=un(_);m===this.userId&&o.path.isEqual(P)?r=r.add(S):p.done()});i.push(c)}),L.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,o=Ra(this.userId,r),s=IDBKeyRange.lowerBound(o);let u=new he(ee);return Di(e).J({range:s},(c,d,h)=>{const[p,m,_]=c,S=un(m);p===this.userId&&r.isPrefixOf(S)?S.length===i&&(u=u.add(_)):h.done()}).next(()=>this.xn(e,u))}xn(e,n){const r=[],i=[];return n.forEach(o=>{i.push(zn(e).get(o).next(s=>{if(s===null)throw Q();Y(s.userId===this.userId),r.push(Lr(this.serializer,s))}))}),L.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return ow(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),L.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return L.resolve();const r=IDBKeyRange.lowerBound(function(s){return[s]}(this.userId)),i=[];return Di(e).J({range:r},(o,s,u)=>{if(o[0]===this.userId){const c=un(o[1]);i.push(c)}else u.done()}).next(()=>{Y(i.length===0)})})}containsKey(e,n){return sw(e,this.userId,n)}Nn(e){return lw(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function sw(t,e,n){const r=Ra(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r);let s=!1;return Di(t).J({range:o,H:!0},(u,c,d)=>{const[h,p,m]=u;h===e&&p===i&&(s=!0),d.done()}).next(()=>s)}function zn(t){return ze(t,"mutations")}function Di(t){return ze(t,"documentMutations")}function lw(t){return ze(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new oi(0)}static kn(){return new oi(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new oi(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>X.fromTimestamp(new De(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>wi(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(Y(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const o=[];return wi(e).J((s,u)=>{const c=fs(u);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,o.push(this.removeTargetData(e,c)))}).next(()=>L.waitFor(o)).next(()=>i)}forEachTarget(e,n){return wi(e).J((r,i)=>{const o=fs(i);n(o)})}qn(e){return hv(e).get("targetGlobalKey").next(n=>(Y(n!==null),n))}Qn(e,n){return hv(e).put("targetGlobalKey",n)}Kn(e,n){return wi(e).put(tw(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=ni(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let o=null;return wi(e).J({range:i,index:"queryTargetsIndex"},(s,u,c)=>{const d=fs(u);dl(n,d.target)&&(o=d,c.done())}).next(()=>o)}addMatchingKeys(e,n,r){const i=[],o=Qn(e);return n.forEach(s=>{const u=_t(s.path);i.push(o.put({targetId:r,path:u})),i.push(this.referenceDelegate.addReference(e,r,s))}),L.waitFor(i)}removeMatchingKeys(e,n,r){const i=Qn(e);return L.forEach(n,o=>{const s=_t(o.path);return L.waitFor([i.delete([r,s]),this.referenceDelegate.removeReference(e,r,o)])})}removeMatchingKeysForTargetId(e,n){const r=Qn(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Qn(e);let o=ne();return i.J({range:r,H:!0},(s,u,c)=>{const d=un(s[1]),h=new H(d);o=o.add(h)}).next(()=>o)}containsKey(e,n){const r=_t(n.path),i=IDBKeyRange.bound([r],[iC(r)],!1,!0);let o=0;return Qn(e).J({index:"documentTargetsIndex",H:!0,range:i},([s,u],c,d)=>{s!==0&&(o++,d.done())}).next(()=>o>0)}ot(e,n){return wi(e).get(n).next(r=>r?fs(r):null)}}function wi(t){return ze(t,"targets")}function hv(t){return ze(t,"targetGlobal")}function Qn(t){return ze(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pv([t,e],[n,r]){const i=ee(t,n);return i===0?ee(e,r):i}class Cb{constructor(e){this.Un=e,this.buffer=new he(pv),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();pv(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class wb{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){q("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Cr(n)?q("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await fi(n)}await this.Hn(3e5)})}}class Sb{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return L.resolve(zt.oe);const r=new Cb(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(q("LruGarbageCollector","Garbage collection skipped; disabled"),L.resolve(fv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(q("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fv):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,o,s,u,c,d;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(q("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,s=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,u=Date.now(),this.removeTargets(e,r,n))).next(p=>(o=p,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(d=Date.now(),Ai()<=se.DEBUG&&q("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-h}ms
	Determined least recently used ${i} in `+(u-s)+`ms
	Removed ${o} targets in `+(c-u)+`ms
	Removed ${p} documents in `+(d-c)+`ms
Total Duration: ${d-h}ms`),L.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:p})))}}function Ab(t,e){return new Sb(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,n){this.db=e,this.garbageCollector=Ab(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return oa(e,r)}removeReference(e,n,r){return oa(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return oa(e,n)}nr(e,n){return function(i,o){let s=!1;return lw(i).Y(u=>sw(i,u,o).next(c=>(c&&(s=!0),L.resolve(!c)))).next(()=>s)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let o=0;return this.tr(e,(s,u)=>{if(u<=n){const c=this.nr(e,s).next(d=>{if(!d)return o++,r.getEntry(e,s).next(()=>(r.removeEntry(s,X.min()),Qn(e).delete(function(p){return[0,_t(p.path)]}(s))))});i.push(c)}}).next(()=>L.waitFor(i)).next(()=>r.apply(e)).next(()=>o)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return oa(e,n)}tr(e,n){const r=Qn(e);let i,o=zt.oe;return r.J({index:"documentTargetsIndex"},([s,u],{path:c,sequenceNumber:d})=>{s===0?(o!==zt.oe&&n(new H(un(i)),o),o=d,i=c):o=zt.oe}).next(()=>{o!==zt.oe&&n(new H(un(i)),o)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function oa(t,e){return Qn(t).put(function(r,i){return{targetId:0,path:_t(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(){this.changes=new wr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ve.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?L.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xr(e).put(r)}removeEntry(e,n,r){return xr(e).delete(function(o,s){const u=o.path.toArray();return[u.slice(0,u.length-2),u[u.length-2],mu(s),u[u.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Ve.newInvalidDocument(n);return xr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ns(n))},(i,o)=>{r=this.ir(n,o)}).next(()=>r)}sr(e,n){let r={size:0,document:Ve.newInvalidDocument(n)};return xr(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ns(n))},(i,o)=>{r={document:this.ir(n,o),size:yu(o)}}).next(()=>r)}getEntries(e,n){let r=Nt();return this._r(e,n,(i,o)=>{const s=this.ir(i,o);r=r.insert(i,s)}).next(()=>r)}ar(e,n){let r=Nt(),i=new we(H.comparator);return this._r(e,n,(o,s)=>{const u=this.ir(o,s);r=r.insert(o,u),i=i.insert(o,yu(s))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return L.resolve();let i=new he(yv);n.forEach(c=>i=i.add(c));const o=IDBKeyRange.bound(ns(i.first()),ns(i.last())),s=i.getIterator();let u=s.getNext();return xr(e).J({index:"documentKeyIndex",range:o},(c,d,h)=>{const p=H.fromSegments([...d.prefixPath,d.collectionGroup,d.documentId]);for(;u&&yv(u,p)<0;)r(u,null),u=s.getNext();u&&u.isEqual(p)&&(r(u,d),u=s.hasNext()?s.getNext():null),u?h.$(ns(u)):h.done()}).next(()=>{for(;u;)r(u,null),u=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,o){const s=n.path,u=[s.popLast().toArray(),s.lastSegment(),mu(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xr(e).U(IDBKeyRange.bound(u,c,!0)).next(d=>{o==null||o.incrementDocumentReadCount(d.length);let h=Nt();for(const p of d){const m=this.ir(H.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(fl(n,m)||i.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,r,i){let o=Nt();const s=gv(n,r),u=gv(n,bt.max());return xr(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,u,!0)},(c,d,h)=>{const p=this.ir(H.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);o=o.insert(p.key,p),o.size===i&&h.done()}).next(()=>o)}newChangeBuffer(e){return new xb(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return mv(e).get("remoteDocumentGlobalKey").next(n=>(Y(!!n),n))}rr(e,n){return mv(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=fb(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(X.min())))return r}return Ve.newInvalidDocument(e)}}function uw(t){return new Pb(t)}class xb extends aw{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new wr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new he((o,s)=>ee(o.canonicalString(),s.canonicalString()));return this.changes.forEach((o,s)=>{const u=this.lr.get(o);if(n.push(this.cr.removeEntry(e,o,u.readTime)),s.isValidDocument()){const c=tv(this.cr.serializer,s);i=i.add(o.path.popLast());const d=yu(c);r+=d-u.size,n.push(this.cr.addEntry(e,o,c))}else if(r-=u.size,this.trackRemovals){const c=tv(this.cr.serializer,s.convertToNoDocument(X.min()));n.push(this.cr.addEntry(e,o,c))}}),i.forEach(o=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,o))}),n.push(this.cr.updateMetadata(e,r)),L.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((o,s)=>{this.lr.set(o,{size:s,readTime:r.get(o).readTime})}),r))}}function mv(t){return ze(t,"remoteDocumentGlobal")}function xr(t){return ze(t,"remoteDocumentsV14")}function ns(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function gv(t,e){const n=e.documentKey.path.toArray();return[t,mu(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function yv(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let o=0;o<n.length-2&&o<r.length-2;++o)if(i=ee(n[o],r[o]),i)return i;return i=ee(n.length,r.length),i||(i=ee(n[n.length-2],r[r.length-2]),i||ee(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Rs(r.mutation,i,St.empty(),De.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ne()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ne()){const i=cn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(o=>{let s=cs();return o.forEach((u,c)=>{s=s.insert(u,c.overlayedDocument)}),s}))}getOverlayedDocuments(e,n){const r=cn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ne()))}populateOverlays(e,n,r){const i=[];return r.forEach(o=>{n.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((s,u)=>{n.set(s,u)})})}computeViews(e,n,r,i){let o=Nt();const s=As(),u=function(){return As()}();return n.forEach((c,d)=>{const h=r.get(d.key);i.has(d.key)&&(h===void 0||h.mutation instanceof bn)?o=o.insert(d.key,d):h!==void 0?(s.set(d.key,h.mutation.getFieldMask()),Rs(h.mutation,d,h.mutation.getFieldMask(),De.now())):s.set(d.key,St.empty())}),this.recalculateAndSaveOverlays(e,o).next(c=>(c.forEach((d,h)=>s.set(d,h)),n.forEach((d,h)=>{var p;return u.set(d,new Db(h,(p=s.get(d))!==null&&p!==void 0?p:null))}),u))}recalculateAndSaveOverlays(e,n){const r=As();let i=new we((s,u)=>s-u),o=ne();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(s=>{for(const u of s)u.keys().forEach(c=>{const d=n.get(c);if(d===null)return;let h=r.get(c)||St.empty();h=u.applyToLocalView(d,h),r.set(c,h);const p=(i.get(u.batchId)||ne()).add(c);i=i.insert(u.batchId,p)})}).next(()=>{const s=[],u=i.getReverseIterator();for(;u.hasNext();){const c=u.getNext(),d=c.key,h=c.value,p=DC();h.forEach(m=>{if(!o.has(m)){const _=UC(n.get(m),r.get(m));_!==null&&p.set(m,_),o=o.add(m)}}),s.push(this.documentOverlayCache.saveOverlays(e,d,p))}return L.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(s){return H.isDocumentKey(s.path)&&s.collectionGroup===null&&s.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):SC(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(o=>{const s=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-o.size):L.resolve(cn());let u=-1,c=o;return s.next(d=>L.forEach(d,(h,p)=>(u<p.largestBatchId&&(u=p.largestBatchId),o.get(h)?L.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,c,d,ne())).next(h=>({batchId:u,changes:xC(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new H(n)).next(r=>{let i=cs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const o=n.collectionGroup;let s=cs();return this.indexManager.getCollectionParents(e,o).next(u=>L.forEach(u,c=>{const d=function(p,m){return new Ro(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,c.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(h=>{h.forEach((p,m)=>{s=s.insert(p,m)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,n,r,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(s=>(o=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,i))).next(s=>{o.forEach((c,d)=>{const h=d.getKey();s.get(h)===null&&(s=s.insert(h,Ve.newInvalidDocument(h)))});let u=cs();return s.forEach((c,d)=>{const h=o.get(c);h!==void 0&&Rs(h.mutation,d,St.empty(),De.now()),fl(n,d)&&(u=u.insert(c,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return L.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:vt(i.createTime)}}(n)),L.resolve()}getNamedQuery(e,n){return L.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:nw(i.bundledQuery),readTime:vt(i.readTime)}}(n)),L.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kb{constructor(){this.overlays=new we(H.comparator),this.Ir=new Map}getOverlay(e,n){return L.resolve(this.overlays.get(n))}getOverlays(e,n){const r=cn();return L.forEach(n,i=>this.getOverlay(e,i).next(o=>{o!==null&&r.set(i,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,o)=>{this.ht(e,n,o)}),L.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.Ir.delete(r)),L.resolve()}getOverlaysForCollection(e,n,r){const i=cn(),o=n.length+1,s=new H(n.child("")),u=this.overlays.getIteratorFrom(s);for(;u.hasNext();){const c=u.getNext().value,d=c.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===o&&c.largestBatchId>r&&i.set(c.getKey(),c)}return L.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let o=new we((d,h)=>d-h);const s=this.overlays.getIterator();for(;s.hasNext();){const d=s.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=o.get(d.largestBatchId);h===null&&(h=cn(),o=o.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const u=cn(),c=o.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,h)=>u.set(d,h)),!(u.size()>=i)););return L.resolve(u)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const s=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,s)}this.overlays=this.overlays.insert(r.key,new sp(n,r));let o=this.Ir.get(n);o===void 0&&(o=ne(),this.Ir.set(n,o)),this.Ir.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(){this.sessionToken=qe.EMPTY_BYTE_STRING}getSessionToken(e){return L.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,L.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(){this.Tr=new he(He.Er),this.dr=new he(He.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new He(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new He(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new H(new ce([])),r=new He(n,e),i=new He(n,e+1),o=[];return this.dr.forEachInRange([r,i],s=>{this.Vr(s),o.push(s.key)}),o}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new H(new ce([])),r=new He(n,e),i=new He(n,e+1);let o=ne();return this.dr.forEachInRange([r,i],s=>{o=o.add(s.key)}),o}containsKey(e){const n=new He(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class He{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return H.comparator(e.key,n.key)||ee(e.wr,n.wr)}static Ar(e,n){return ee(e.wr,n.wr)||H.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new he(He.Er)}checkEmpty(e){return L.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const o=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ip(o,n,r,i);this.mutationQueue.push(s);for(const u of i)this.br=this.br.add(new He(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return L.resolve(s)}lookupMutationBatch(e,n){return L.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),o=i<0?0:i;return L.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return L.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return L.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new He(n,0),i=new He(n,Number.POSITIVE_INFINITY),o=[];return this.br.forEachInRange([r,i],s=>{const u=this.Dr(s.wr);o.push(u)}),L.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new he(ee);return n.forEach(i=>{const o=new He(i,0),s=new He(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([o,s],u=>{r=r.add(u.wr)})}),L.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let o=r;H.isDocumentKey(o)||(o=o.child(""));const s=new He(new H(o),0);let u=new he(ee);return this.br.forEachWhile(c=>{const d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},s),L.resolve(this.Cr(u))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){Y(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return L.forEach(n.mutations,i=>{const o=new He(i.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new He(n,0),i=this.br.firstAfterOrEqual(r);return L.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,L.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e){this.Mr=e,this.docs=function(){return new we(H.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),o=i?i.size:0,s=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:s}),this.size+=s-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return L.resolve(r?r.document.mutableCopy():Ve.newInvalidDocument(n))}getEntries(e,n){let r=Nt();return n.forEach(i=>{const o=this.docs.get(i);r=r.insert(i,o?o.document.mutableCopy():Ve.newInvalidDocument(i))}),L.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let o=Nt();const s=n.path,u=new H(s.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){const{key:d,value:{document:h}}=c.getNext();if(!s.isPrefixOf(d.path))break;d.path.length>s.length+1||Yh(oC(h),r)<=0||(i.has(h.key)||fl(n,h))&&(o=o.insert(h.key,h.mutableCopy()))}return L.resolve(o)}getAllFromCollectionGroup(e,n,r,i){Q()}Or(e,n){return L.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Fb(this)}getSize(e){return L.resolve(this.size)}}class Fb extends aw{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),L.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e){this.persistence=e,this.Nr=new wr(n=>ni(n),dl),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Lr=0,this.Br=new dp,this.targetCount=0,this.kr=oi.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),L.resolve()}getLastRemoteSnapshotVersion(e){return L.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return L.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),L.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),L.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new oi(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,L.resolve()}updateTargetData(e,n){return this.Kn(n),L.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,L.resolve()}removeTargets(e,n,r){let i=0;const o=[];return this.Nr.forEach((s,u)=>{u.sequenceNumber<=n&&r.get(u.targetId)===null&&(this.Nr.delete(s),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),L.waitFor(o).next(()=>i)}getTargetCount(e){return L.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return L.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),L.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,o=[];return i&&n.forEach(s=>{o.push(i.markPotentiallyOrphaned(e,s))}),L.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),L.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return L.resolve(r)}containsKey(e,n){return L.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dw{constructor(e,n){this.qr={},this.overlays={},this.Qr=new zt(0),this.Kr=!1,this.Kr=!0,this.$r=new Nb,this.referenceDelegate=e(this),this.Ur=new Ub(this),this.indexManager=new Tb,this.remoteDocumentCache=function(i){return new Lb(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new ew(n),this.Gr=new Mb(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new kb,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Vb(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){q("MemoryPersistence","Starting transaction:",e);const i=new bb(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(o=>this.referenceDelegate.jr(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Hr(e,n){return L.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class bb extends lC{constructor(e){super(),this.currentSequenceNumber=e}}class Yu{constructor(e){this.persistence=e,this.Jr=new dp,this.Yr=null}static Zr(e){return new Yu(e)}get Xr(){if(this.Yr)return this.Yr;throw Q()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),L.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),L.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),L.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(o=>this.Xr.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return L.forEach(this.Xr,r=>{const i=H.fromPath(r);return this.ei(e,i).next(o=>{o||n.removeEntry(i,X.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return L.or([()=>L.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bb{constructor(e){this.serializer=e}O(e,n,r,i){const o=new Ou("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M_,{unique:!0}),c.createObjectStore("documentMutations")}(e),_v(e),function(c){c.createObjectStore("remoteDocuments")}(e));let s=L.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),_v(e)),s=s.next(()=>function(c){const d=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:X.min().toTimestamp(),targetCount:0};return d.put("targetGlobalKey",h)}(o))),r<4&&i>=4&&(r!==0&&(s=s.next(()=>function(c,d){return d.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",M_,{unique:!0});const p=d.store("mutations"),m=h.map(_=>p.put(_));return L.waitFor(m)})}(e,o))),s=s.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(s=s.next(()=>this.ni(o))),r<6&&i>=6&&(s=s.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(o)))),r<7&&i>=7&&(s=s.next(()=>this.ii(o))),r<8&&i>=8&&(s=s.next(()=>this.si(e,o))),r<9&&i>=9&&(s=s.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(s=s.next(()=>this.oi(o))),r<11&&i>=11&&(s=s.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(s=s.next(()=>{(function(c){const d=c.createObjectStore("documentOverlays",{keyPath:pU});d.createIndex("collectionPathOverlayIndex",mU,{unique:!1}),d.createIndex("collectionGroupOverlayIndex",gU,{unique:!1})})(e)})),r<13&&i>=13&&(s=s.next(()=>function(c){const d=c.createObjectStore("remoteDocumentsV14",{keyPath:rU});d.createIndex("documentKeyIndex",iU),d.createIndex("collectionGroupIndex",oU)}(e)).next(()=>this._i(e,o)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(s=s.next(()=>this.ai(e,o))),r<15&&i>=15&&(s=s.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:cU}).createIndex("sequenceNumberIndex",dU,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:fU}).createIndex("documentKeyIndex",hU,{unique:!1})}(e))),r<16&&i>=16&&(s=s.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(s=s.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),s}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=yu(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>L.forEach(i,o=>{const s=IDBKeyRange.bound([o.userId,-1],[o.userId,o.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",s).next(u=>L.forEach(u,c=>{Y(c.userId===o.userId);const d=Lr(this.serializer,c);return ow(e,o.userId,d).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const o=[];return r.J((s,u)=>{const c=new ce(s),d=function(p){return[0,_t(p)]}(c);o.push(n.get(d).next(h=>h?L.resolve():(p=>n.put({targetId:0,path:_t(p),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>L.waitFor(o))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:uU});const r=n.store("collectionParents"),i=new cp,o=s=>{if(i.add(s)){const u=s.lastSegment(),c=s.popLast();return r.put({collectionId:u,parent:_t(c)})}};return n.store("remoteDocuments").J({H:!0},(s,u)=>{const c=new ce(s);return o(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([s,u,c],d)=>{const h=un(u);return o(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const o=fs(i),s=tw(this.serializer,o);return n.put(s)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((o,s)=>{const u=n.store("remoteDocumentsV14"),c=function(p){return p.document?new H(ce.fromString(p.document.name).popFirst(5)):p.noDocument?H.fromSegments(p.noDocument.path):p.unknownDocument?H.fromSegments(p.unknownDocument.path):Q()}(s).path.toArray(),d={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:s.readTime||[0,0],unknownDocument:s.unknownDocument,noDocument:s.noDocument,document:s.document,hasCommittedMutations:!!s.hasCommittedMutations};i.push(u.put(d))}).next(()=>L.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=uw(this.serializer),o=new dw(Yu.Zr,this.serializer.ct);return r.U().next(s=>{const u=new Map;return s.forEach(c=>{var d;let h=(d=u.get(c.userId))!==null&&d!==void 0?d:ne();Lr(this.serializer,c).keys().forEach(p=>h=h.add(p)),u.set(c.userId,h)}),L.forEach(u,(c,d)=>{const h=new Xe(d),p=Ju.lt(this.serializer,h),m=o.getIndexManager(h),_=Qu.lt(h,this.serializer,m,o.referenceDelegate);return new cw(i,_,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Af(n,zt.oe),c).next()})})}}function _v(t){t.createObjectStore("targetDocuments",{keyPath:lU}).createIndex("documentTargetsIndex",aU,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",sU,{unique:!0}),t.createObjectStore("targetGlobal")}const ad="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class fp{constructor(e,n,r,i,o,s,u,c,d,h,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=o,this.window=s,this.document=u,this.ci=d,this.li=h,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!fp.D())throw new z(B.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Rb(this,i),this.Ai=n+"main",this.serializer=new ew(c),this.Ri=new fr(this.Ai,this.hi,new Bb(this.serializer)),this.$r=new pb,this.Ur=new Ib(this.referenceDelegate,this.serializer),this.remoteDocumentCache=uw(this.serializer),this.Gr=new hb,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&mt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new z(B.FAILED_PRECONDITION,ad);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new zt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sa(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Cr(e))return q("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return q("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return rs(e).get("owner").next(n=>L.resolve(this.vi(n)))}Ci(e){return sa(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=ze(n,"clientMetadata");return r.U().next(i=>{const o=this.xi(i,18e5),s=i.filter(u=>o.indexOf(u)===-1);return L.forEach(s,u=>r.delete(u.clientId)).next(()=>s)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?L.resolve(!0):rs(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new z(B.FAILED_PRECONDITION,ad);return!1}}return!(!this.networkEnabled||!this.inForeground)||sa(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const o=!this.networkEnabled&&i.networkEnabled,s=!this.inForeground&&i.inForeground,u=this.networkEnabled===i.networkEnabled;if(o||s&&u)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&q("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Af(e,zt.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>sa(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Qu.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Eb(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ju.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){q("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",o=function(c){return c===17?vU:c===16?_U:c===15?Zh:c===14?fC:c===13?dC:c===12?yU:c===11?cC:void Q()}(this.hi);let s;return this.Ri.runTransaction(e,i,o,u=>(s=new Af(u,this.Qr?this.Qr.next():zt.oe),n==="readwrite-primary"?this.wi(s).next(c=>!!c||this.Si(s)).next(c=>{if(!c)throw mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new z(B.FAILED_PRECONDITION,sC);return r(s)}).next(c=>this.Di(s).next(()=>c)):this.Ki(s).next(()=>r(s)))).then(u=>(s.raiseOnCommittedEvent(),u))}Ki(e){return rs(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new z(B.FAILED_PRECONDITION,ad)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return rs(e).put("owner",n)}static D(){return fr.D()}bi(e){const n=rs(e);return n.get("owner").next(r=>this.vi(r)?(q("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):L.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;bI()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return q("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){mt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function rs(t){return ze(t,"owner")}function sa(t){return ze(t,"clientMetadata")}function Ob(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ne(),i=ne();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new hp(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fw{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return bI()?8:aC(au())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const o={result:null};return this.Yi(e,n).next(s=>{o.result=s}).next(()=>{if(!o.result)return this.Zi(e,n,i,r).next(s=>{o.result=s})}).next(()=>{if(o.result)return;const s=new qb;return this.Xi(e,n,s).next(u=>{if(o.result=u,this.zi)return this.es(e,n,s,u.size)})}).next(()=>o.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Ai()<=se.DEBUG&&q("QueryEngine","SDK will not create cache indexes for query:",Ri(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),L.resolve()):(Ai()<=se.DEBUG&&q("QueryEngine","Query:",Ri(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ai()<=se.DEBUG&&q("QueryEngine","The SDK decides to create cache indexes for query:",Ri(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wt(n))):L.resolve())}Yi(e,n){if(z_(n))return L.resolve(null);let r=Wt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Nf(n,null,"F"),r=Wt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const s=ne(...o);return this.Ji.getDocuments(e,s).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{const d=this.ts(n,u);return this.ns(n,d,s,c.readTime)?this.Yi(e,Nf(n,null,"F")):this.rs(e,d,n,c)}))})))}Zi(e,n,r,i){return z_(n)||i.isEqual(X.min())?L.resolve(null):this.Ji.getDocuments(e,r).next(o=>{const s=this.ts(n,o);return this.ns(n,s,r,i)?L.resolve(null):(Ai()<=se.DEBUG&&q("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ri(n)),this.rs(e,s,n,Q2(i,-1)).next(u=>u))})}ts(e,n){let r=new he(RC(e));return n.forEach((i,o)=>{fl(e,o)&&(r=r.add(o))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}Xi(e,n,r){return Ai()<=se.DEBUG&&q("QueryEngine","Using full collection scan to execute query:",Ri(n)),this.Ji.getDocumentsMatchingQuery(e,n,bt.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(o=>(n.forEach(s=>{o=o.insert(s.key,s)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new we(ee),this._s=new wr(o=>ni(o),dl),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cw(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function hw(t,e,n,r){return new Gb(t,e,n,r)}async function pw(t,e){const n=j(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(o=>(i=o,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const s=[],u=[];let c=ne();for(const d of i){s.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}for(const d of o){u.push(d.batchId);for(const h of d.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:s,addedBatchIds:u}))})})}function $b(t,e){const n=j(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),o=n.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,h){const p=d.batch,m=p.keys();let _=L.resolve();return m.forEach(S=>{_=_.next(()=>h.getEntry(c,S)).next(P=>{const k=d.docVersions.get(S);Y(k!==null),P.version.compareTo(k)<0&&(p.applyToRemoteDocument(P,d),P.isValidDocument()&&(P.setReadTime(d.commitVersion),h.addEntry(P)))})}),_.next(()=>u.mutationQueue.removeMutationBatch(c,p))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=ne();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mw(t){const e=j(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function zb(t,e){const n=j(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const u=[];e.targetChanges.forEach((h,p)=>{const m=i.get(p);if(!m)return;u.push(n.Ur.removeMatchingKeys(o,h.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(o,h.addedDocuments,p)));let _=m.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(p)!==null?_=_.withResumeToken(qe.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):h.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(h.resumeToken,r)),i=i.insert(p,_),function(P,k,C){return P.resumeToken.approximateByteSize()===0||k.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(m,_,h)&&u.push(n.Ur.updateTargetData(o,_))});let c=Nt(),d=ne();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&u.push(n.persistence.referenceDelegate.updateLimboDocument(o,h))}),u.push(Hb(o,s,e.documentUpdates).next(h=>{c=h.Ps,d=h.Is})),!r.isEqual(X.min())){const h=n.Ur.getLastRemoteSnapshotVersion(o).next(p=>n.Ur.setTargetsMetadata(o,o.currentSequenceNumber,r));u.push(h)}return L.waitFor(u).next(()=>s.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,c,d)).next(()=>c)}).then(o=>(n.os=i,o))}function Hb(t,e,n){let r=ne(),i=ne();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let s=Nt();return n.forEach((u,c)=>{const d=o.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(X.min())?(e.removeEntry(u,c.readTime),s=s.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),s=s.insert(u,c)):q("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:s,Is:i}})}function Kb(t,e){const n=j(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Wb(t,e){const n=j(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(o=>o?(i=o,L.resolve(i)):n.Ur.allocateTargetId(r).next(s=>(i=new Rn(e,s,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function qf(t,e,n){const r=j(t),i=r.os.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,s=>r.persistence.referenceDelegate.removeTarget(s,i))}catch(s){if(!Cr(s))throw s;q("LocalStore",`Failed to update sequence numbers for target ${e}: ${s}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function vv(t,e,n){const r=j(t);let i=X.min(),o=ne();return r.persistence.runTransaction("Execute query","readwrite",s=>function(c,d,h){const p=j(c),m=p._s.get(h);return m!==void 0?L.resolve(p.os.get(m)):p.Ur.getTargetData(d,h)}(r,s,Wt(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(s,u.targetId).next(c=>{o=c})}).next(()=>r.ss.getDocumentsMatchingQuery(s,e,n?i:X.min(),n?o:ne())).next(u=>(Jb(r,VU(e),u),{documents:u,Ts:o})))}function Jb(t,e,n){let r=t.us.get(e)||X.min();n.forEach((i,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.us.set(e,r)}class Tv{constructor(){this.activeTargetIds=OU()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gw{constructor(){this.so=new Tv,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Tv,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qb{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){q("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){q("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let la=null;function ud(){return la===null?la=function(){return 268435456+Math.round(2147483648*Math.random())}():la++,"0x"+la.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yb={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const st="WebChannelConnection";class Zb extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),o=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${o}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${o}`}get Fo(){return!1}Mo(n,r,i,o,s){const u=ud(),c=this.xo(n,r.toUriEncodedString());q("RestConnection",`Sending RPC '${n}' ${u}:`,c,i);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,o,s),this.No(n,c,d,i).then(h=>(q("RestConnection",`Received RPC '${n}' ${u}: `,h),h),h=>{throw jr("RestConnection",`RPC '${n}' ${u} failed with error: `,h,"url: ",c,"request:",i),h})}Lo(n,r,i,o,s,u){return this.Mo(n,r,i,o,s)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ao}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((o,s)=>n[s]=o),i&&i.headers.forEach((o,s)=>n[s]=o)}xo(n,r){const i=Yb[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const o=ud();return new Promise((s,u)=>{const c=new XI;c.setWithCredentials(!0),c.listenOnce(ZI.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sa.NO_ERROR:const h=c.getResponseJson();q(st,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),s(h);break;case Sa.TIMEOUT:q(st,`RPC '${e}' ${o} timed out`),u(new z(B.DEADLINE_EXCEEDED,"Request time out"));break;case Sa.HTTP_ERROR:const p=c.getStatus();if(q(st,`RPC '${e}' ${o} failed with status:`,p,"response text:",c.getResponseText()),p>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const _=m==null?void 0:m.error;if(_&&_.status&&_.message){const S=function(k){const C=k.toLowerCase().replace(/_/g,"-");return Object.values(B).indexOf(C)>=0?C:B.UNKNOWN}(_.status);u(new z(S,_.message))}else u(new z(B.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new z(B.UNAVAILABLE,"Connection failed."));break;default:Q()}}finally{q(st,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);q(st,`RPC '${e}' ${o} sending request:`,i),c.send(n,"POST",d,r,15)})}Bo(e,n,r){const i=ud(),o=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=tC(),u=eC(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const h=o.join("");q(st,`Creating RPC '${e}' stream ${i}: ${h}`,c);const p=s.createWebChannel(h,c);let m=!1,_=!1;const S=new Xb({Io:k=>{_?q(st,`Not sending because RPC '${e}' stream ${i} is closed:`,k):(m||(q(st,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),q(st,`RPC '${e}' stream ${i} sending:`,k),p.send(k))},To:()=>p.close()}),P=(k,C,T)=>{k.listen(C,I=>{try{T(I)}catch(M){setTimeout(()=>{throw M},0)}})};return P(p,us.EventType.OPEN,()=>{_||(q(st,`RPC '${e}' stream ${i} transport opened.`),S.yo())}),P(p,us.EventType.CLOSE,()=>{_||(_=!0,q(st,`RPC '${e}' stream ${i} transport closed`),S.So())}),P(p,us.EventType.ERROR,k=>{_||(_=!0,jr(st,`RPC '${e}' stream ${i} transport errored:`,k),S.So(new z(B.UNAVAILABLE,"The operation could not be completed")))}),P(p,us.EventType.MESSAGE,k=>{var C;if(!_){const T=k.data[0];Y(!!T);const I=T,M=I.error||((C=I[0])===null||C===void 0?void 0:C.error);if(M){q(st,`RPC '${e}' stream ${i} received error:`,M);const F=M.status;let b=function(w){const R=Be[w];if(R!==void 0)return OC(R)}(F),A=M.message;b===void 0&&(b=B.INTERNAL,A="Unknown error status: "+F+" with message "+M.message),_=!0,S.So(new z(b,A)),p.close()}else q(st,`RPC '${e}' stream ${i} received:`,T),S.bo(T)}}),P(u,jI.STAT_EVENT,k=>{k.stat===wf.PROXY?q(st,`RPC '${e}' stream ${i} detected buffering proxy`):k.stat===wf.NOPROXY&&q(st,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.wo()},0),S}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jb(){return typeof window<"u"?window:null}function ka(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t){return new nb(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yw{constructor(e,n,r=1e3,i=1.5,o=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=o,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&q("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,n,r,i,o,s,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=o,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yw(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===B.RESOURCE_EXHAUSTED?(mt(n.toString()),mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===B.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new z(B.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return q("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(q("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class e4 extends _w{constructor(e,n,r,i,o,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,s),this.serializer=o}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=ob(this.serializer,e),r=function(o){if(!("targetChange"in o))return X.min();const s=o.targetChange;return s.targetIds&&s.targetIds.length?X.min():s.readTime?vt(s.readTime):X.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Ff(this.serializer),n.addTarget=function(o,s){let u;const c=s.target;if(u=du(c)?{documents:JC(o,c)}:{query:QC(o,c)._t},u.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){u.resumeToken=$C(o,s.resumeToken);const d=Vf(o,s.expectedCount);d!==null&&(u.expectedCount=d)}else if(s.snapshotVersion.compareTo(X.min())>0){u.readTime=go(o,s.snapshotVersion.toTimestamp());const d=Vf(o,s.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const r=lb(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Ff(this.serializer),n.removeTarget=e,this.a_(n)}}class t4 extends _w{constructor(e,n,r,i,o,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,s),this.serializer=o}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Y(!!e.streamToken),this.lastStreamToken=e.streamToken,Y(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=sb(e.writeResults,e.commitTime),r=vt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Ff(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>pu(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n4 extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new z(B.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,s])=>this.connection.Mo(e,Lf(n,r),i,o,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(B.UNKNOWN,o.toString())})}Lo(e,n,r,i,o){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,u])=>this.connection.Lo(e,Lf(n,r),i,s,u,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===B.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(B.UNKNOWN,s.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class r4{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(mt(n),this.D_=!1):q("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i4{constructor(e,n,r,i,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=o,this.k_._o(s=>{r.enqueueAndForget(async()=>{pi(this)&&(q("RemoteStore","Restarting streams for network reachability change."),await async function(c){const d=j(c);d.L_.add(4),await pl(d),d.q_.set("Unknown"),d.L_.delete(4),await Zu(d)}(this))})}),this.q_=new r4(r,i)}}async function Zu(t){if(pi(t))for(const e of t.B_)await e(!0)}async function pl(t){for(const e of t.B_)await e(!1)}function vw(t,e){const n=j(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),yp(n)?gp(n):xo(n).r_()&&mp(n,e))}function pp(t,e){const n=j(t),r=xo(n);n.N_.delete(e),r.r_()&&Tw(n,e),n.N_.size===0&&(r.r_()?r.o_():pi(n)&&n.q_.set("Unknown"))}function mp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(X.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}xo(t).A_(e)}function Tw(t,e){t.Q_.xe(e),xo(t).R_(e)}function gp(t){t.Q_=new ZU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),xo(t).start(),t.q_.v_()}function yp(t){return pi(t)&&!xo(t).n_()&&t.N_.size>0}function pi(t){return j(t).L_.size===0}function Ew(t){t.Q_=void 0}async function o4(t){t.q_.set("Online")}async function s4(t){t.N_.forEach((e,n)=>{mp(t,e)})}async function l4(t,e){Ew(t),yp(t)?(t.q_.M_(e),gp(t)):t.q_.set("Unknown")}async function a4(t,e,n){if(t.q_.set("Online"),e instanceof GC&&e.state===2&&e.cause)try{await async function(i,o){const s=o.cause;for(const u of o.targetIds)i.N_.has(u)&&(await i.remoteSyncer.rejectListen(u,s),i.N_.delete(u),i.Q_.removeTarget(u))}(t,e)}catch(r){q("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await _u(t,r)}else if(e instanceof Ma?t.Q_.Ke(e):e instanceof qC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(X.min()))try{const r=await mw(t.localStore);n.compareTo(r)>=0&&await function(o,s){const u=o.Q_.rt(s);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const h=o.N_.get(d);h&&o.N_.set(d,h.withResumeToken(c.resumeToken,s))}}),u.targetMismatches.forEach((c,d)=>{const h=o.N_.get(c);if(!h)return;o.N_.set(c,h.withResumeToken(qe.EMPTY_BYTE_STRING,h.snapshotVersion)),Tw(o,c);const p=new Rn(h.target,c,d,h.sequenceNumber);mp(o,p)}),o.remoteSyncer.applyRemoteEvent(u)}(t,n)}catch(r){q("RemoteStore","Failed to raise snapshot:",r),await _u(t,r)}}async function _u(t,e,n){if(!Cr(e))throw e;t.L_.add(1),await pl(t),t.q_.set("Offline"),n||(n=()=>mw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{q("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Zu(t)})}function Iw(t,e){return e().catch(n=>_u(t,n,e))}async function ml(t){const e=j(t),n=_r(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;u4(e);)try{const i=await Kb(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,c4(e,i)}catch(i){await _u(e,i)}Cw(e)&&ww(e)}function u4(t){return pi(t)&&t.O_.length<10}function c4(t,e){t.O_.push(e);const n=_r(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Cw(t){return pi(t)&&!_r(t).n_()&&t.O_.length>0}function ww(t){_r(t).start()}async function d4(t){_r(t).p_()}async function f4(t){const e=_r(t);for(const n of t.O_)e.m_(n.mutations)}async function h4(t,e,n){const r=t.O_.shift(),i=op.from(r,e,n);await Iw(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ml(t)}async function p4(t,e){e&&_r(t).V_&&await async function(r,i){if(function(s){return QU(s)&&s!==B.ABORTED}(i.code)){const o=r.O_.shift();_r(r).s_(),await Iw(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,i)),await ml(r)}}(t,e),Cw(t)&&ww(t)}async function Iv(t,e){const n=j(t);n.asyncQueue.verifyOperationInProgress(),q("RemoteStore","RemoteStore received new credentials");const r=pi(n);n.L_.add(3),await pl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Zu(n)}async function m4(t,e){const n=j(t);e?(n.L_.delete(2),await Zu(n)):e||(n.L_.add(2),await pl(n),n.q_.set("Unknown"))}function xo(t){return t.K_||(t.K_=function(n,r,i){const o=j(n);return o.w_(),new e4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:o4.bind(null,t),Ro:s4.bind(null,t),mo:l4.bind(null,t),d_:a4.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),yp(t)?gp(t):t.q_.set("Unknown")):(await t.K_.stop(),Ew(t))})),t.K_}function _r(t){return t.U_||(t.U_=function(n,r,i){const o=j(n);return o.w_(),new t4(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:d4.bind(null,t),mo:p4.bind(null,t),f_:f4.bind(null,t),g_:h4.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ml(t)):(await t.U_.stop(),t.O_.length>0&&(q("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e,n,r,i,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=o,this.deferred=new xn,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(s=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,o){const s=Date.now()+r,u=new _p(e,n,s,i,o);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(B.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function vp(t,e){if(mt("AsyncQueue",`${e}: ${t}`),Cr(t))return new z(B.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji{constructor(e){this.comparator=e?(n,r)=>e(n,r)||H.comparator(n.key,r.key):(n,r)=>H.comparator(n.key,r.key),this.keyedMap=cs(),this.sortedSet=new we(this.comparator)}static emptySet(e){return new ji(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ji)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ji;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cv{constructor(){this.W_=new we(H.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):Q():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class yo{constructor(e,n,r,i,o,s,u,c,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=o,this.fromCache=s,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,i,o){const s=[];return n.forEach(u=>{s.push({type:0,doc:u})}),new yo(e,n,ji.emptySet(n),s,r,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&$u(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class y4{constructor(){this.queries=wv(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=j(n),o=i.queries;i.queries=wv(),o.forEach((s,u)=>{for(const c of u.j_)c.onError(r)})})(this,new z(B.ABORTED,"Firestore shutting down"))}}function wv(){return new wr(t=>AC(t),$u)}async function _4(t,e){const n=j(t);let r=3;const i=e.query;let o=n.queries.get(i);o?!o.H_()&&e.J_()&&(r=2):(o=new g4,r=e.J_()?0:1);try{switch(r){case 0:o.z_=await n.onListen(i,!0);break;case 1:o.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(s){const u=vp(s,`Initialization of query '${Ri(e.query)}' failed`);return void e.onError(u)}n.queries.set(i,o),o.j_.push(e),e.Z_(n.onlineState),o.z_&&e.X_(o.z_)&&Tp(n)}async function v4(t,e){const n=j(t),r=e.query;let i=3;const o=n.queries.get(r);if(o){const s=o.j_.indexOf(e);s>=0&&(o.j_.splice(s,1),o.j_.length===0?i=e.J_()?0:1:!o.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function T4(t,e){const n=j(t);let r=!1;for(const i of e){const o=i.query,s=n.queries.get(o);if(s){for(const u of s.j_)u.X_(i)&&(r=!0);s.z_=i}}r&&Tp(n)}function E4(t,e,n){const r=j(t),i=r.queries.get(e);if(i)for(const o of i.j_)o.onError(n);r.queries.delete(e)}function Tp(t){t.Y_.forEach(e=>{e.next()})}var Gf,Sv;(Sv=Gf||(Gf={})).ea="default",Sv.Cache="cache";class I4{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new yo(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Gf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sw{constructor(e){this.key=e}}class Aw{constructor(e){this.key=e}}class C4{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ne(),this.mutatedKeys=ne(),this.Aa=RC(e),this.Ra=new ji(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Cv,i=n?n.Ra:this.Ra;let o=n?n.mutatedKeys:this.mutatedKeys,s=i,u=!1;const c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((h,p)=>{const m=i.get(h),_=fl(this.query,p)?p:null,S=!!m&&this.mutatedKeys.has(m.key),P=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let k=!1;m&&_?m.data.isEqual(_.data)?S!==P&&(r.track({type:3,doc:_}),k=!0):this.ga(m,_)||(r.track({type:2,doc:_}),k=!0,(c&&this.Aa(_,c)>0||d&&this.Aa(_,d)<0)&&(u=!0)):!m&&_?(r.track({type:0,doc:_}),k=!0):m&&!_&&(r.track({type:1,doc:m}),k=!0,(c||d)&&(u=!0)),k&&(_?(s=s.add(_),o=P?o.add(h):o.delete(h)):(s=s.delete(h),o=o.delete(h)))}),this.query.limit!==null)for(;s.size>this.query.limit;){const h=this.query.limitType==="F"?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key),r.track({type:1,doc:h})}return{Ra:s,fa:r,ns:u,mutatedKeys:o}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const o=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort((h,p)=>function(_,S){const P=k=>{switch(k){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Q()}};return P(_)-P(S)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),i=i!=null&&i;const u=n&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,s.length!==0||d?{snapshot:new yo(this.query,e.Ra,o,s,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Cv,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ne(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Aw(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Sw(r))}),n}ba(e){this.Ta=e.Ts,this.da=ne();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return yo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class w4{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class S4{constructor(e){this.key=e,this.va=!1}}class A4{constructor(e,n,r,i,o,s){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new wr(u=>AC(u),$u),this.Ma=new Map,this.xa=new Set,this.Oa=new we(H.comparator),this.Na=new Map,this.La=new dp,this.Ba={},this.ka=new Map,this.qa=oi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function R4(t,e,n=!0){const r=kw(t);let i;const o=r.Fa.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.Da()):i=await Rw(r,e,n,!0),i}async function P4(t,e){const n=kw(t);await Rw(n,e,!0,!1)}async function Rw(t,e,n,r){const i=await Wb(t.localStore,Wt(e)),o=i.targetId,s=t.sharedClientState.addLocalQueryTarget(o,n);let u;return r&&(u=await x4(t,e,o,s==="current",i.resumeToken)),t.isPrimaryClient&&n&&vw(t.remoteStore,i),u}async function x4(t,e,n,r,i){t.Ka=(p,m,_)=>async function(P,k,C,T){let I=k.view.ma(C);I.ns&&(I=await vv(P.localStore,k.query,!1).then(({documents:A})=>k.view.ma(A,I)));const M=T&&T.targetChanges.get(k.targetId),F=T&&T.targetMismatches.get(k.targetId)!=null,b=k.view.applyChanges(I,P.isPrimaryClient,M,F);return Rv(P,k.targetId,b.wa),b.snapshot}(t,p,m,_);const o=await vv(t.localStore,e,!0),s=new C4(e,o.Ts),u=s.ma(o.documents),c=hl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),d=s.applyChanges(u,t.isPrimaryClient,c);Rv(t,n,d.wa);const h=new w4(e,n,s);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function D4(t,e,n){const r=j(t),i=r.Fa.get(e),o=r.Ma.get(i.targetId);if(o.length>1)return r.Ma.set(i.targetId,o.filter(s=>!$u(s,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await qf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&pp(r.remoteStore,i.targetId),$f(r,i.targetId)}).catch(fi)):($f(r,i.targetId),await qf(r.localStore,i.targetId,!0))}async function M4(t,e){const n=j(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),pp(n.remoteStore,r.targetId))}async function k4(t,e,n){const r=Nw(t);try{const i=await function(s,u){const c=j(s),d=De.now(),h=u.reduce((_,S)=>_.add(S.key),ne());let p,m;return c.persistence.runTransaction("Locally write mutations","readwrite",_=>{let S=Nt(),P=ne();return c.cs.getEntries(_,h).next(k=>{S=k,S.forEach((C,T)=>{T.isValidDocument()||(P=P.add(C))})}).next(()=>c.localDocuments.getOverlayedDocuments(_,S)).next(k=>{p=k;const C=[];for(const T of u){const I=WU(T,p.get(T.key).overlayedDocument);I!=null&&C.push(new bn(T.key,I,yC(I.value.mapValue),gt.exists(!0)))}return c.mutationQueue.addMutationBatch(_,d,C,u)}).next(k=>{m=k;const C=k.applyToLocalDocumentSet(p,P);return c.documentOverlayCache.saveOverlays(_,k.batchId,C)})}).then(()=>({batchId:m.batchId,changes:xC(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,u,c){let d=s.Ba[s.currentUser.toKey()];d||(d=new we(ee)),d=d.insert(u,c),s.Ba[s.currentUser.toKey()]=d}(r,i.batchId,n),await gl(r,i.changes),await ml(r.remoteStore)}catch(i){const o=vp(i,"Failed to persist write");n.reject(o)}}async function Pw(t,e){const n=j(t);try{const r=await zb(n.localStore,e);e.targetChanges.forEach((i,o)=>{const s=n.Na.get(o);s&&(Y(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?s.va=!0:i.modifiedDocuments.size>0?Y(s.va):i.removedDocuments.size>0&&(Y(s.va),s.va=!1))}),await gl(n,r,e)}catch(r){await fi(r)}}function Av(t,e,n){const r=j(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((o,s)=>{const u=s.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(s,u){const c=j(s);c.onlineState=u;let d=!1;c.queries.forEach((h,p)=>{for(const m of p.j_)m.Z_(u)&&(d=!0)}),d&&Tp(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function N4(t,e,n){const r=j(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),o=i&&i.key;if(o){let s=new we(H.comparator);s=s.insert(o,Ve.newNoDocument(o,X.min()));const u=ne().add(o),c=new Wu(X.min(),new Map,new we(ee),s,u);await Pw(r,c),r.Oa=r.Oa.remove(o),r.Na.delete(e),Ep(r)}else await qf(r.localStore,e,!1).then(()=>$f(r,e,n)).catch(fi)}async function V4(t,e){const n=j(t),r=e.batch.batchId;try{const i=await $b(n.localStore,e);Dw(n,r,null),xw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await gl(n,i)}catch(i){await fi(i)}}async function L4(t,e,n){const r=j(t);try{const i=await function(s,u){const c=j(s);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return c.mutationQueue.lookupMutationBatch(d,u).next(p=>(Y(p!==null),h=p.keys(),c.mutationQueue.removeMutationBatch(d,p))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,h,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>c.localDocuments.getDocuments(d,h))})}(r.localStore,e);Dw(r,e,n),xw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await gl(r,i)}catch(i){await fi(i)}}function xw(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Dw(t,e,n){const r=j(t);let i=r.Ba[r.currentUser.toKey()];if(i){const o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function $f(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Mw(t,r)})}function Mw(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(pp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Ep(t))}function Rv(t,e,n){for(const r of n)r instanceof Sw?(t.La.addReference(r.key,e),F4(t,r)):r instanceof Aw?(q("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Mw(t,r.key)):Q()}function F4(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(q("SyncEngine","New document in limbo: "+n),t.xa.add(r),Ep(t))}function Ep(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new H(ce.fromString(e)),r=t.qa.next();t.Na.set(r,new S4(n)),t.Oa=t.Oa.insert(n,r),vw(t.remoteStore,new Rn(Wt(np(n.path)),r,"TargetPurposeLimboResolution",zt.oe))}}async function gl(t,e,n){const r=j(t),i=[],o=[],s=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{s.push(r.Ka(c,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(c.targetId,p?"current":"not-current")}if(d){i.push(d);const p=hp.Wi(c.targetId,d);o.push(p)}}))}),await Promise.all(s),r.Ca.d_(i),await async function(c,d){const h=j(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>L.forEach(d,m=>L.forEach(m.$i,_=>h.persistence.referenceDelegate.addReference(p,m.targetId,_)).next(()=>L.forEach(m.Ui,_=>h.persistence.referenceDelegate.removeReference(p,m.targetId,_)))))}catch(p){if(!Cr(p))throw p;q("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const _=h.os.get(m),S=_.snapshotVersion,P=_.withLastLimboFreeSnapshotVersion(S);h.os=h.os.insert(m,P)}}}(r.localStore,o))}async function U4(t,e){const n=j(t);if(!n.currentUser.isEqual(e)){q("SyncEngine","User change. New user:",e.toKey());const r=await pw(n.localStore,e);n.currentUser=e,function(o,s){o.ka.forEach(u=>{u.forEach(c=>{c.reject(new z(B.CANCELLED,s))})}),o.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gl(n,r.hs)}}function b4(t,e){const n=j(t),r=n.Na.get(e);if(r&&r.va)return ne().add(r.key);{let i=ne();const o=n.Ma.get(e);if(!o)return i;for(const s of o){const u=n.Fa.get(s);i=i.unionWith(u.view.Va)}return i}}function kw(t){const e=j(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Pw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=b4.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=N4.bind(null,e),e.Ca.d_=T4.bind(null,e.eventManager),e.Ca.$a=E4.bind(null,e.eventManager),e}function Nw(t){const e=j(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=V4.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=L4.bind(null,e),e}class rl{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Xu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return hw(this.persistence,new fw,e.initialUser,this.serializer)}Ga(e){return new dw(Yu.Zr,this.serializer)}Wa(e){return new gw}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}rl.provider={build:()=>new rl};class B4 extends rl{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Nw(this.Ja.syncEngine),await ml(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return hw(this.persistence,new fw,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new wb(r,e.asyncQueue,n)}Ha(e,n){const r=new j2(n,this.persistence);return new Z2(e.asyncQueue,r)}Ga(e){const n=Ob(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?It.withCacheSize(this.cacheSizeBytes):It.DEFAULT;return new fp(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,jb(),ka(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new gw}}class vu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Av(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=U4.bind(null,this.syncEngine),await m4(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new y4}()}createDatastore(e){const n=Xu(e.databaseInfo.databaseId),r=function(o){return new Zb(o)}(e.databaseInfo);return function(o,s,u,c){return new n4(o,s,u,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,o,s,u){return new i4(r,i,o,s,u)}(this.localStore,this.datastore,e.asyncQueue,n=>Av(this.syncEngine,n,0),function(){return Ev.D()?new Ev:new Qb}())}createSyncEngine(e,n){return function(i,o,s,u,c,d,h){const p=new A4(i,o,s,u,c,d);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const o=j(i);q("RemoteStore","RemoteStore shutting down."),o.L_.add(5),await pl(o),o.k_.shutdown(),o.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}vu.provider={build:()=>new vu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O4{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q4{constructor(e,n,r,i,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xe.UNAUTHENTICATED,this.clientId=rC.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async s=>{q("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(q("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xn;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=vp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function cd(t,e){t.asyncQueue.verifyOperationInProgress(),q("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await pw(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Pv(t,e){t.asyncQueue.verifyOperationInProgress();const n=await G4(t);q("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Iv(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Iv(e.remoteStore,i)),t._onlineComponents=e}async function G4(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){q("FirestoreClient","Using user provided OfflineComponentProvider");try{await cd(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===B.FAILED_PRECONDITION||i.code===B.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;jr("Error using user provided cache. Falling back to memory cache: "+n),await cd(t,new rl)}}else q("FirestoreClient","Using default OfflineComponentProvider"),await cd(t,new rl);return t._offlineComponents}async function Vw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(q("FirestoreClient","Using user provided OnlineComponentProvider"),await Pv(t,t._uninitializedComponentsProvider._online)):(q("FirestoreClient","Using default OnlineComponentProvider"),await Pv(t,new vu))),t._onlineComponents}function $4(t){return Vw(t).then(e=>e.syncEngine)}async function z4(t){const e=await Vw(t),n=e.eventManager;return n.onListen=R4.bind(null,e.syncEngine),n.onUnlisten=D4.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=P4.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=M4.bind(null,e.syncEngine),n}function H4(t,e,n={}){const r=new xn;return t.asyncQueue.enqueueAndForget(async()=>function(o,s,u,c,d){const h=new O4({next:m=>{h.Za(),s.enqueueAndForget(()=>v4(o,p)),m.fromCache&&c.source==="server"?d.reject(new z(B.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new I4(u,h,{includeMetadataChanges:!0,_a:!0});return _4(o,p)}(await z4(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(t,e,n){if(!n)throw new z(B.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function K4(t,e,n,r){if(e===!0&&r===!0)throw new z(B.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Dv(t){if(!H.isDocumentKey(t))throw new z(B.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Mv(t){if(H.isDocumentKey(t))throw new z(B.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ju(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Q()}function vr(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new z(B.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=ju(t);throw new z(B.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kv{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new z(B.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(B.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}K4("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Lw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new z(B.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ec{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(B.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new z(B.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new O2;switch(r.type){case"firstParty":return new z2(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(B.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=xv.get(n);r&&(q("ComponentProvider","Removing Datastore"),xv.delete(n),r.terminate())}(this),Promise.resolve()}}function W4(t,e,n,r={}){var i;const o=(t=vr(t,ec))._getSettings(),s=`${e}:${n}`;if(o.host!=="firestore.googleapis.com"&&o.host!==s&&jr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},o),{host:s,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Xe.MOCK_USER;else{u=UI(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new z(B.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Xe(d)}t._authCredentials=new q2(new nC(u,c))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new mi(this.firestore,e,this._query)}}class Ft{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new hr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}}class hr extends mi{constructor(e,n,r){super(e,n,np(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new H(e))}withConverter(e){return new hr(this.firestore,e,this._path)}}function Uw(t,e,...n){if(t=xt(t),Fw("collection","path",e),t instanceof ec){const r=ce.fromString(e,...n);return Mv(r),new hr(t,null,r)}{if(!(t instanceof Ft||t instanceof hr))throw new z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return Mv(r),new hr(t.firestore,null,r)}}function Ip(t,e,...n){if(t=xt(t),arguments.length===1&&(e=rC.newId()),Fw("doc","path",e),t instanceof ec){const r=ce.fromString(e,...n);return Dv(r),new Ft(t,null,new H(r))}{if(!(t instanceof Ft||t instanceof hr))throw new z(B.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ce.fromString(e,...n));return Dv(r),new Ft(t.firestore,t instanceof hr?t.converter:null,new H(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yw(this,"async_queue_retry"),this.Vu=()=>{const r=ka();r&&q("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=ka();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=ka();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new xn;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Cr(e))throw e;q("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(s){let u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),u}(r);throw mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=_p.createAndSchedule(this,e,n,r,o=>this.yu(o));return this.Tu.push(i),i}fu(){this.Eu&&Q()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Do extends ec{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Nv,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Nv(e),this._firestoreClient=void 0,await e}}}function J4(t,e){const n=typeof t=="object"?t:WI(),r=typeof t=="string"?t:"(default)",i=zI(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const o=LI("firestore");o&&W4(i,...o)}return i}function bw(t){if(t._terminated)throw new z(B.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Bw(t),t._firestoreClient}function Bw(t){var e,n,r;const i=t._freezeSettings(),o=function(u,c,d,h){return new EU(u,c,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Lw(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new q4(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const c=u==null?void 0:u._online.build();return{_offline:u==null?void 0:u._offline.build(c),_online:c}}(t._componentsProvider))}function Q4(t,e){jr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return Y4(t,vu.provider,{build:r=>new B4(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function Y4(t,e,n){if((t=vr(t,Do))._firestoreClient||t._terminated)throw new z(B.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new z(B.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},Bw(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e){this._byteString=e}static fromBase64String(e){try{return new _o(qe.fromBase64String(e))}catch(n){throw new z(B.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new _o(qe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new z(B.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Pe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new z(B.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new z(B.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ee(this._lat,e._lat)||ee(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X4=/^__.*__$/;class Z4{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new bn(e,this.data,this.fieldMask,n,this.fieldTransforms):new Po(e,this.data,n,this.fieldTransforms)}}class Ow{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new bn(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function qw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Q()}}class Sp{constructor(e,n,r,i,o,s){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,o===void 0&&this.vu(),this.fieldTransforms=o||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Sp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Tu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(qw(this.Cu)&&X4.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class j4{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Xu(e)}Qu(e,n,r,i=!1){return new Sp({Cu:e,methodName:n,qu:r,path:Pe.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ap(t){const e=t._freezeSettings(),n=Xu(t._databaseId);return new j4(t._databaseId,!!e.ignoreUndefinedProperties,n)}function eB(t,e,n,r,i,o={}){const s=t.Qu(o.merge||o.mergeFields?2:0,e,n,i);Pp("Data must be an object, but it was:",s,r);const u=Gw(r,s);let c,d;if(o.merge)c=new St(s.fieldMask),d=s.fieldTransforms;else if(o.mergeFields){const h=[];for(const p of o.mergeFields){const m=zf(e,p,n);if(!s.contains(m))throw new z(B.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);zw(h,m)||h.push(m)}c=new St(h),d=s.fieldTransforms.filter(p=>c.covers(p.field))}else c=null,d=s.fieldTransforms;return new Z4(new at(u),c,d)}class rc extends nc{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rc}}class Rp extends nc{_toFieldTransform(e){return new FC(e.path,new ho)}isEqual(e){return e instanceof Rp}}function tB(t,e,n,r){const i=t.Qu(1,e,n);Pp("Data must be an object, but it was:",i,r);const o=[],s=at.empty();hi(r,(c,d)=>{const h=xp(e,c,n);d=xt(d);const p=i.Nu(h);if(d instanceof rc)o.push(h);else{const m=yl(d,p);m!=null&&(o.push(h),s.set(h,m))}});const u=new St(o);return new Ow(s,u,i.fieldTransforms)}function nB(t,e,n,r,i,o){const s=t.Qu(1,e,n),u=[zf(e,r,n)],c=[i];if(o.length%2!=0)throw new z(B.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<o.length;m+=2)u.push(zf(e,o[m])),c.push(o[m+1]);const d=[],h=at.empty();for(let m=u.length-1;m>=0;--m)if(!zw(d,u[m])){const _=u[m];let S=c[m];S=xt(S);const P=s.Nu(_);if(S instanceof rc)d.push(_);else{const k=yl(S,P);k!=null&&(d.push(_),h.set(_,k))}}const p=new St(d);return new Ow(h,p,s.fieldTransforms)}function rB(t,e,n,r=!1){return yl(n,t.Qu(r?4:3,e))}function yl(t,e){if($w(t=xt(t)))return Pp("Unsupported field value:",e,t),Gw(t,e);if(t instanceof nc)return function(r,i){if(!qw(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const o=[];let s=0;for(const u of r){let c=yl(u,i.Lu(s));c==null&&(c={nullValue:"NULL_VALUE"}),o.push(c),s++}return{arrayValue:{values:o}}}(t,e)}return function(r,i){if((r=xt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return qU(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=De.fromDate(r);return{timestampValue:go(i.serializer,o)}}if(r instanceof De){const o=new De(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:go(i.serializer,o)}}if(r instanceof Cp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof _o)return{bytesValue:$C(i.serializer,r._byteString)};if(r instanceof Ft){const o=i.databaseId,s=r.firestore._databaseId;if(!s.isEqual(o))throw i.Bu(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:ap(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof wp)return function(s,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:s.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return rp(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ju(r)}`)}(t,e)}function Gw(t,e){const n={};return hC(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):hi(t,(r,i)=>{const o=yl(i,e.Mu(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function $w(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof De||t instanceof Cp||t instanceof _o||t instanceof Ft||t instanceof nc||t instanceof wp)}function Pp(t,e,n){if(!$w(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=ju(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function zf(t,e,n){if((e=xt(e))instanceof tc)return e._internalPath;if(typeof e=="string")return xp(t,e);throw Tu("Field path arguments must be of type string or ",t,!1,void 0,n)}const iB=new RegExp("[~\\*/\\[\\]]");function xp(t,e,n){if(e.search(iB)>=0)throw Tu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new tc(...e.split("."))._internalPath}catch{throw Tu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Tu(t,e,n,r,i){const o=r&&!r.isEmpty(),s=i!==void 0;let u=`Function ${e}() called with invalid data`;n&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(o||s)&&(c+=" (found",o&&(c+=` in field ${r}`),s&&(c+=` in document ${i}`),c+=")"),new z(B.INVALID_ARGUMENT,u+t+c)}function zw(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hw{constructor(e,n,r,i,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new oB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Dp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class oB extends Hw{data(){return super.data()}}function Dp(t,e){return typeof e=="string"?xp(t,e):e instanceof tc?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new z(B.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mp{}class Kw extends Mp{}function lB(t,e,...n){let r=[];e instanceof Mp&&r.push(e),r=r.concat(n),function(o){const s=o.filter(c=>c instanceof Np).length,u=o.filter(c=>c instanceof kp).length;if(s>1||s>0&&u>0)throw new z(B.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class kp extends Kw{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new kp(e,n,r)}_apply(e){const n=this._parse(e);return Ww(e._query,n),new mi(e.firestore,e.converter,kf(e._query,n))}_parse(e){const n=Ap(e.firestore);return function(o,s,u,c,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new z(B.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){Lv(p,h);const _=[];for(const S of p)_.push(Vv(c,o,S));m={arrayValue:{values:_}}}else m=Vv(c,o,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||Lv(p,h),m=rB(u,s,p,h==="in"||h==="not-in");return ie.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Np extends Mp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Np(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:de.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,o){let s=i;const u=o.getFlattenedFilters();for(const c of u)Ww(s,c),s=kf(s,c)}(e._query,n),new mi(e.firestore,e.converter,kf(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Vp extends Kw{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Vp(e,n)}_apply(e){const n=function(i,o,s){if(i.startAt!==null)throw new z(B.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new z(B.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new tl(o,s)}(e._query,this._field,this._direction);return new mi(e.firestore,e.converter,function(i,o){const s=i.explicitOrderBy.concat([o]);return new Ro(i.path,i.collectionGroup,s,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function aB(t,e="asc"){const n=e,r=Dp("orderBy",t);return Vp._create(r,n)}function Vv(t,e,n){if(typeof(n=xt(n))=="string"){if(n==="")throw new z(B.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!SC(e)&&n.indexOf("/")!==-1)throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ce.fromString(n));if(!H.isDocumentKey(r))throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return js(t,new H(r))}if(n instanceof Ft)return js(t,n._key);throw new z(B.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ju(n)}.`)}function Lv(t,e){if(!Array.isArray(t)||t.length===0)throw new z(B.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ww(t,e){const n=function(i,o){for(const s of i)for(const u of s.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new z(B.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new z(B.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class uB{convertValue(e,n="none"){switch(ti(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(gr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Q()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return hi(e,(i,o)=>{r[i]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,i;const o=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(s=>Ie(s.doubleValue));return new wp(o)}convertGeoPoint(e){return new Cp(Ie(e.latitude),Ie(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ep(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Xs(e));default:return null}}convertTimestamp(e){const n=Ln(e);return new De(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ce.fromString(e);Y(jC(r));const i=new ei(r.get(1),r.get(3)),o=new H(r.popFirst(5));return i.isEqual(n)||mt(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cB(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aa{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dB extends Hw{constructor(e,n,r,i,o,s){super(e,n,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Na(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Dp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Na extends dB{data(e={}){return super.data(e)}}class fB{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new aa(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Na(this._firestore,this._userDataWriter,r.key,r,new aa(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new z(B.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let s=0;return i._snapshot.docChanges.map(u=>{const c=new Na(i._firestore,i._userDataWriter,u.doc.key,u.doc,new aa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:s++}})}{let s=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const c=new Na(i._firestore,i._userDataWriter,u.doc.key,u.doc,new aa(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,h=-1;return u.type!==0&&(d=s.indexOf(u.doc.key),s=s.delete(u.doc.key)),u.type!==1&&(s=s.add(u.doc),h=s.indexOf(u.doc.key)),{type:hB(u.type),doc:c,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function hB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Q()}}class pB extends uB{constructor(e){super(),this.firestore=e}convertBytes(e){return new _o(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,n)}}function mB(t){t=vr(t,mi);const e=vr(t.firestore,Do),n=bw(e),r=new pB(e);return sB(t._query),H4(n,t._query).then(i=>new fB(e,r,t,i))}function gB(t,e,n,...r){t=vr(t,Ft);const i=vr(t.firestore,Do),o=Ap(i);let s;return s=typeof(e=xt(e))=="string"||e instanceof tc?nB(o,"updateDoc",t._key,e,n,r):tB(o,"updateDoc",t._key,e),Lp(i,[s.toMutation(t._key,gt.exists(!0))])}function yB(t){return Lp(vr(t.firestore,Do),[new Ku(t._key,gt.none())])}function _B(t,e){const n=vr(t.firestore,Do),r=Ip(t),i=cB(t.converter,e);return Lp(n,[eB(Ap(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,gt.exists(!1))]).then(()=>r)}function Lp(t,e){return function(r,i){const o=new xn;return r.asyncQueue.enqueueAndForget(async()=>k4(await $4(r),i,o)),o.promise}(bw(t),e)}function vB(){return new Rp("serverTimestamp")}(function(e,n=!0){(function(i){Ao=i})(HI),Ks(new lo("firestore",(r,{instanceIdentifier:i,options:o})=>{const s=r.getProvider("app").getImmediate(),u=new Do(new G2(r.getProvider("auth-internal")),new K2(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new z(B.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ei(d.options.projectId,h)}(s,i),s);return o=Object.assign({useFetchStreams:n},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),dr(P_,"4.7.3",e),dr(P_,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="firebasestorage.googleapis.com",Qw="storageBucket",TB=2*60*1e3,EB=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe extends di{constructor(e,n,r=0){super(dd(e),`Firebase Storage: ${n} (${dd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Fe.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return dd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Le;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Le||(Le={}));function dd(t){return"storage/"+t}function Fp(){const t="An unknown error occurred, please check the error payload for server response.";return new Fe(Le.UNKNOWN,t)}function IB(t){return new Fe(Le.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function CB(t){return new Fe(Le.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function wB(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Fe(Le.UNAUTHENTICATED,t)}function SB(){return new Fe(Le.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function AB(t){return new Fe(Le.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function RB(){return new Fe(Le.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function PB(){return new Fe(Le.CANCELED,"User canceled the upload/download.")}function xB(t){return new Fe(Le.INVALID_URL,"Invalid URL '"+t+"'.")}function DB(t){return new Fe(Le.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function MB(){return new Fe(Le.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Qw+"' property when initializing the app?")}function kB(){return new Fe(Le.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function NB(){return new Fe(Le.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function VB(t){return new Fe(Le.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Hf(t){return new Fe(Le.INVALID_ARGUMENT,t)}function Yw(){return new Fe(Le.APP_DELETED,"The Firebase app was deleted.")}function LB(t){return new Fe(Le.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ps(t,e){return new Fe(Le.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function is(t){throw new Fe(Le.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Vt.makeFromUrl(e,n)}catch{return new Vt(e,"")}if(r.path==="")return r;throw DB(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function o(M){M.path.charAt(M.path.length-1)==="/"&&(M.path_=M.path_.slice(0,-1))}const s="(/(.*))?$",u=new RegExp("^gs://"+i+s,"i"),c={bucket:1,path:3};function d(M){M.path_=decodeURIComponent(M.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",_=new RegExp(`^https?://${p}/${h}/b/${i}/o${m}`,"i"),S={bucket:1,path:3},P=n===Jw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,k="([^?#]*)",C=new RegExp(`^https?://${P}/${i}/${k}`,"i"),I=[{regex:u,indices:c,postModify:o},{regex:_,indices:S,postModify:d},{regex:C,indices:{bucket:1,path:2},postModify:d}];for(let M=0;M<I.length;M++){const F=I[M],b=F.regex.exec(e);if(b){const A=b[F.indices.bucket];let v=b[F.indices.path];v||(v=""),r=new Vt(A,v),F.postModify(r);break}}if(r==null)throw xB(e);return r}}class FB{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UB(t,e,n){let r=1,i=null,o=null,s=!1,u=0;function c(){return u===2}let d=!1;function h(...k){d||(d=!0,e.apply(null,k))}function p(k){i=setTimeout(()=>{i=null,t(_,c())},k)}function m(){o&&clearTimeout(o)}function _(k,...C){if(d){m();return}if(k){m(),h.call(null,k,...C);return}if(c()||s){m(),h.call(null,k,...C);return}r<64&&(r*=2);let I;u===1?(u=2,I=0):I=(r+Math.random())*1e3,p(I)}let S=!1;function P(k){S||(S=!0,m(),!d&&(i!==null?(k||(u=2),clearTimeout(i),p(0)):k||(u=1)))}return p(0),o=setTimeout(()=>{s=!0,P(!0)},n),P}function bB(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BB(t){return t!==void 0}function OB(t){return typeof t=="object"&&!Array.isArray(t)}function Up(t){return typeof t=="string"||t instanceof String}function Fv(t){return bp()&&t instanceof Blob}function bp(){return typeof Blob<"u"}function Uv(t,e,n,r){if(r<e)throw Hf(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Hf(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ic(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function Xw(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}var Hr;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Hr||(Hr={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qB(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,o=e.indexOf(t)!==-1;return n||i||o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GB{constructor(e,n,r,i,o,s,u,c,d,h,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=o,this.additionalRetryCodes_=s,this.callback_=u,this.errorCallback_=c,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((_,S)=>{this.resolve_=_,this.reject_=S,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new ua(!1,null,!0));return}const o=this.connectionFactory_();this.pendingConnection_=o;const s=u=>{const c=u.loaded,d=u.lengthComputable?u.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,d)};this.progressCallback_!==null&&o.addUploadProgressListener(s),o.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&o.removeUploadProgressListener(s),this.pendingConnection_=null;const u=o.getErrorCode()===Hr.NO_ERROR,c=o.getStatus();if(!u||qB(c,this.additionalRetryCodes_)&&this.retry){const h=o.getErrorCode()===Hr.ABORT;r(!1,new ua(!1,null,h));return}const d=this.successCodes_.indexOf(c)!==-1;r(!0,new ua(d,o))})},n=(r,i)=>{const o=this.resolve_,s=this.reject_,u=i.connection;if(i.wasSuccessCode)try{const c=this.callback_(u,u.getResponse());BB(c)?o(c):o()}catch(c){s(c)}else if(u!==null){const c=Fp();c.serverResponse=u.getErrorText(),this.errorCallback_?s(this.errorCallback_(u,c)):s(c)}else if(i.canceled){const c=this.appDelete_?Yw():PB();s(c)}else{const c=RB();s(c)}};this.canceled_?n(!1,new ua(!1,null,!0)):this.backoffId_=UB(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&bB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ua{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function $B(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function zB(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function HB(t,e){e&&(t["X-Firebase-GMPID"]=e)}function KB(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function WB(t,e,n,r,i,o,s=!0){const u=Xw(t.urlParams),c=t.url+u,d=Object.assign({},t.headers);return HB(d,e),$B(d,n),zB(d,o),KB(d,r),new GB(c,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JB(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function QB(...t){const e=JB();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(bp())return new Blob(t);throw new Fe(Le.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function YB(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(t){if(typeof atob>"u")throw VB("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class fd{constructor(e,n){this.data=e,this.contentType=n||null}}function ZB(t,e){switch(t){case dn.RAW:return new fd(Zw(e));case dn.BASE64:case dn.BASE64URL:return new fd(jw(t,e));case dn.DATA_URL:return new fd(eO(e),tO(e))}throw Fp()}function Zw(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const o=r,s=t.charCodeAt(++n);r=65536|(o&1023)<<10|s&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function jB(t){let e;try{e=decodeURIComponent(t)}catch{throw Ps(dn.DATA_URL,"Malformed data URL.")}return Zw(e)}function jw(t,e){switch(t){case dn.BASE64:{const i=e.indexOf("-")!==-1,o=e.indexOf("_")!==-1;if(i||o)throw Ps(t,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case dn.BASE64URL:{const i=e.indexOf("+")!==-1,o=e.indexOf("/")!==-1;if(i||o)throw Ps(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=XB(e)}catch(i){throw i.message.includes("polyfill")?i:Ps(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}class eS{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ps(dn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=nO(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function eO(t){const e=new eS(t);return e.base64?jw(dn.BASE64,e.rest):jB(e.rest)}function tO(t){return new eS(t).contentType}function nO(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e,n){let r=0,i="";Fv(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,n){if(Fv(this.data_)){const r=this.data_,i=YB(r,e,n);return i===null?null:new Yn(i)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Yn(r,!0)}}static getBlob(...e){if(bp()){const n=e.map(r=>r instanceof Yn?r.data_:r);return new Yn(QB.apply(null,n))}else{const n=e.map(s=>Up(s)?ZB(dn.RAW,s).data:s.data_);let r=0;n.forEach(s=>{r+=s.byteLength});const i=new Uint8Array(r);let o=0;return n.forEach(s=>{for(let u=0;u<s.length;u++)i[o++]=s[u]}),new Yn(i,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tS(t){let e;try{e=JSON.parse(t)}catch{return null}return OB(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rO(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function iO(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function nS(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oO(t,e){return e}class ht{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||oO}}let ca=null;function sO(t){return!Up(t)||t.length<2?t:nS(t)}function rS(){if(ca)return ca;const t=[];t.push(new ht("bucket")),t.push(new ht("generation")),t.push(new ht("metageneration")),t.push(new ht("name","fullPath",!0));function e(o,s){return sO(s)}const n=new ht("name");n.xform=e,t.push(n);function r(o,s){return s!==void 0?Number(s):s}const i=new ht("size");return i.xform=r,t.push(i),t.push(new ht("timeCreated")),t.push(new ht("updated")),t.push(new ht("md5Hash",null,!0)),t.push(new ht("cacheControl",null,!0)),t.push(new ht("contentDisposition",null,!0)),t.push(new ht("contentEncoding",null,!0)),t.push(new ht("contentLanguage",null,!0)),t.push(new ht("contentType",null,!0)),t.push(new ht("metadata","customMetadata",!0)),ca=t,ca}function lO(t,e){function n(){const r=t.bucket,i=t.fullPath,o=new Vt(r,i);return e._makeStorageReference(o)}Object.defineProperty(t,"ref",{get:n})}function aO(t,e,n){const r={};r.type="file";const i=n.length;for(let o=0;o<i;o++){const s=n[o];r[s.local]=s.xform(r,e[s.server])}return lO(r,t),r}function iS(t,e,n){const r=tS(e);return r===null?null:aO(t,r,n)}function uO(t,e,n,r){const i=tS(e);if(i===null||!Up(i.downloadTokens))return null;const o=i.downloadTokens;if(o.length===0)return null;const s=encodeURIComponent;return o.split(",").map(d=>{const h=t.bucket,p=t.fullPath,m="/b/"+s(h)+"/o/"+s(p),_=ic(m,n,r),S=Xw({alt:"media",token:d});return _+S})[0]}function cO(t,e){const n={},r=e.length;for(let i=0;i<r;i++){const o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}class Bp{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t){if(!t)throw Fp()}function dO(t,e){function n(r,i){const o=iS(t,i,e);return oS(o!==null),o}return n}function fO(t,e){function n(r,i){const o=iS(t,i,e);return oS(o!==null),uO(o,i,t.host,t._protocol)}return n}function sS(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=SB():i=wB():n.getStatus()===402?i=CB(t.bucket):n.getStatus()===403?i=AB(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function lS(t){const e=sS(t);function n(r,i){let o=e(r,i);return r.getStatus()===404&&(o=IB(t.path)),o.serverResponse=i.serverResponse,o}return n}function hO(t,e,n){const r=e.fullServerUrl(),i=ic(r,t.host,t._protocol),o="GET",s=t.maxOperationRetryTime,u=new Bp(i,o,fO(t,n),s);return u.errorHandler=lS(e),u}function pO(t,e){const n=e.fullServerUrl(),r=ic(n,t.host,t._protocol),i="DELETE",o=t.maxOperationRetryTime;function s(c,d){}const u=new Bp(r,i,s,o);return u.successCodes=[200,204],u.errorHandler=lS(e),u}function mO(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function gO(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=mO(null,e)),r}function yO(t,e,n,r,i){const o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};function u(){let I="";for(let M=0;M<2;M++)I=I+Math.random().toString().slice(2);return I}const c=u();s["Content-Type"]="multipart/related; boundary="+c;const d=gO(e,r,i),h=cO(d,n),p="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+c+"--",_=Yn.getBlob(p,r,m);if(_===null)throw kB();const S={name:d.fullPath},P=ic(o,t.host,t._protocol),k="POST",C=t.maxUploadRetryTime,T=new Bp(P,k,dO(t,n),C);return T.urlParams=S,T.headers=s,T.body=_.uploadData(),T.errorHandler=sS(e),T}class _O{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Hr.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Hr.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Hr.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw is("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw is("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw is("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw is("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw is("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class vO extends _O{initXhr(){this.xhr_.responseType="text"}}function Op(){return new vO}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n){this._service=e,n instanceof Vt?this._location=n:this._location=Vt.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new si(e,n)}get root(){const e=new Vt(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return nS(this._location.path)}get storage(){return this._service}get parent(){const e=rO(this._location.path);if(e===null)return null;const n=new Vt(this._location.bucket,e);return new si(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw LB(e)}}function TO(t,e,n){t._throwIfRoot("uploadBytes");const r=yO(t.storage,t._location,rS(),new Yn(e,!0),n);return t.storage.makeRequestWithTokens(r,Op).then(i=>({metadata:i,ref:t}))}function EO(t){t._throwIfRoot("getDownloadURL");const e=hO(t.storage,t._location,rS());return t.storage.makeRequestWithTokens(e,Op).then(n=>{if(n===null)throw NB();return n})}function IO(t){t._throwIfRoot("deleteObject");const e=pO(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Op)}function CO(t,e){const n=iO(t._location.path,e),r=new Vt(t._location.bucket,n);return new si(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(t){return/^[A-Za-z]+:\/\//.test(t)}function SO(t,e){return new si(t,e)}function aS(t,e){if(t instanceof qp){const n=t;if(n._bucket==null)throw MB();const r=new si(n,n._bucket);return e!=null?aS(r,e):r}else return e!==void 0?CO(t,e):t}function AO(t,e){if(e&&wO(e)){if(t instanceof qp)return SO(t,e);throw Hf("To use ref(service, url), the first argument must be a Storage instance.")}else return aS(t,e)}function bv(t,e){const n=e==null?void 0:e[Qw];return n==null?null:Vt.makeFromBucketSpec(n,t)}function RO(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:UI(i,t.app.options.projectId))}class qp{constructor(e,n,r,i,o){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=Jw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=TB,this._maxUploadRetryTime=EB,this._requests=new Set,i!=null?this._bucket=Vt.makeFromBucketSpec(i,this._host):this._bucket=bv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Vt.makeFromBucketSpec(this._url,e):this._bucket=bv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){Uv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){Uv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new si(this,e)}_makeRequest(e,n,r,i,o=!0){if(this._deleted)return new FB(Yw());{const s=WB(e,this._appId,r,i,n,this._firebaseVersion,o);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const Bv="@firebase/storage",Ov="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="storage";function PO(t,e,n){return t=xt(t),TO(t,e,n)}function xO(t){return t=xt(t),EO(t)}function DO(t){return t=xt(t),IO(t)}function cS(t,e){return t=xt(t),AO(t,e)}function MO(t=WI(),e){t=xt(t);const r=zI(t,uS).getImmediate({identifier:e}),i=LI("storage");return i&&kO(r,...i),r}function kO(t,e,n,r={}){RO(t,e,n,r)}function NO(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new qp(n,r,i,e,HI)}function VO(){Ks(new lo(uS,NO,"PUBLIC").setMultipleInstances(!0)),dr(Bv,Ov,""),dr(Bv,Ov,"esm2017")}VO();var LO="firebase",FO="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dr(LO,FO,"app");const UO={apiKey:"AIzaSyCVT2YuAJQoHE2m5nznwhhK0_jgMBQJzk0",authDomain:"math-fest-display.firebaseapp.com",databaseURL:"https://math-fest-display-default-rtdb.firebaseio.com",projectId:"math-fest-display",storageBucket:"math-fest-display.firebasestorage.app",messagingSenderId:"252365377355",appId:"1:252365377355:web:83772c179137b3de94e2ce"},dS=KI(UO),_l=J4(dS),fS=MO(dS);Q4(_l).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore persistence failed: Multiple tabs open."):t.code=="unimplemented"&&console.warn("Firestore persistence is not available in this browser.")});const il="photos",bO=async()=>{const t=Uw(_l,il),e=lB(t,aB("createdAt","desc"));return(await mB(e)).docs.map(r=>({id:r.id,...r.data(),isFavorite:r.data().isFavorite||!1}))},BO=async(t,e,n)=>{if(!t)throw new Error("No file provided for upload.");const r=t.name.split(".").pop(),i=`${Date.now()}.${r}`,o=cS(fS,`${il}/${i}`);await PO(o,t);const s=await xO(o);await _B(Uw(_l,il),{imageUrl:s,description:e,tags:n,isFavorite:!1,createdAt:vB()})},OO=async(t,e)=>{const n=Ip(_l,il,t);await gB(n,{isFavorite:e})},qO=async t=>{if(!t||!t.id||!t.imageUrl)throw new Error("Invalid photo data provided for deletion.");const e=Ip(_l,il,t.id);await yB(e);const n=cS(fS,t.imageUrl);await DO(n)};var GO={};const $O=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result.split(",")[1]),r.onerror=i=>n(i)}),zO=({onClose:t,onUploadSuccess:e})=>{const[n,r]=ge.useState(null),[i,o]=ge.useState(null),[s,u]=ge.useState(""),[c,d]=ge.useState([]),[h,p]=ge.useState(""),[m,_]=ge.useState(!1),[S,P]=ge.useState(!1),[k,C]=ge.useState(null),T=v=>{var R;const w=(R=v.target.files)==null?void 0:R[0];if(w){if(w.size>10*1024*1024){C("File is too large. Maximum size is 10MB.");return}r(w),d([]),C(null);const D=new FileReader;D.onloadend=()=>{o(D.result)},D.readAsDataURL(w)}},I=ge.useCallback(async()=>{if(!n){C("Please select a photo first to generate tags.");return}P(!0),C(null);try{const v=new yF({apiKey:GO.API_KEY}),R={inlineData:{data:await $O(n),mimeType:n.type}},D={text:"Analyze this image and generate 3 to 5 relevant, single-word, lowercase tags that describe the main subjects, setting, or mood. Separate the tags with commas. For example: 'nature, sunset, beach, ocean, serene'."},x=(await v.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[R,D]}})).text.split(",").map(Se=>Se.trim().toLowerCase().replace(/[^a-z0-9\s-]/gi,"")).filter(Se=>Se&&Se.length>1&&Se.length<20);d(Se=>[...new Set([...Se,...x])])}catch(v){console.error("Error generating tags with Gemini:",v),C("Failed to generate tags. Please check your API key or add tags manually.")}finally{P(!1)}},[n]),M=v=>{p(v.target.value)},F=v=>{if((v.key==="Enter"||v.key===",")&&h.trim()!==""){v.preventDefault();const w=h.split(",").map(R=>R.trim().toLowerCase()).filter(R=>R&&R.length>1);d([...new Set([...c,...w])]),p("")}},b=v=>{d(c.filter(w=>w!==v))},A=ge.useCallback(async()=>{if(!n){C("Please select a photo to upload.");return}if(!s.trim()){C("Please add a description for your memory.");return}_(!0),C(null);try{await BO(n,s,c),e(),t()}catch(v){console.error("Upload error:",v),C("Upload failed. Please check the console and try again.")}finally{_(!1)}},[n,s,c,t,e]);return O.jsx("div",{className:"fixed inset-0 bg-primary-bg/80 backdrop-blur-lg flex justify-center items-center z-50 p-4 animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:t,children:O.jsxs("div",{className:"bg-secondary-bg rounded-xl shadow-gentle-lg w-full max-w-lg text-primary-text p-6 sm:p-8 border border-accent-soft/50 max-h-[90vh] overflow-y-auto",onClick:v=>v.stopPropagation(),children:[O.jsx("h2",{className:"text-2xl font-semibold text-transparent bg-clip-text bg-gradient-to-r from-accent to-pink-400 mb-6",children:"Add a New Memory"}),O.jsxs("div",{className:"space-y-6",children:[O.jsxs("div",{children:[O.jsx("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-secondary-text mb-2",children:"Photo"}),O.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-accent-soft/60 border-dashed rounded-md bg-primary-bg",children:O.jsxs("div",{className:"space-y-2 text-center",children:[i?O.jsx("img",{src:i,alt:"Preview",className:"mx-auto h-40 w-auto rounded-md object-contain"}):O.jsx("svg",{className:"mx-auto h-12 w-12 text-accent-soft",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48","aria-hidden":"true",children:O.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 4v.01M28 8L20 16m0 0h8m-8 0V8m12 12v12a4 4 0 01-4 4H12a4 4 0 01-4-4V12a4 4 0 014-4h8",strokeWidth:"1",strokeLinecap:"round",strokeLinejoin:"round"})}),O.jsxs("div",{className:"flex text-sm text-secondary-text justify-center",children:[O.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-transparent rounded-md font-medium text-accent hover:text-accent-hover focus-within:outline-none",children:[O.jsx("span",{children:n?"Change file":"Upload a file"}),O.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:T})]}),O.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),O.jsx("p",{className:"text-xs text-secondary-text/70",children:"PNG, JPG, GIF up to 10MB"})]})})]}),O.jsxs("div",{children:[O.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-secondary-text",children:"Description"}),O.jsx("textarea",{id:"description",rows:3,value:s,onChange:v=>u(v.target.value),className:"mt-1 block w-full bg-primary-bg border border-accent-soft/60 rounded-md shadow-sm focus:ring-accent focus:border-accent sm:text-sm p-2 text-primary-text placeholder-secondary-text/70 transition-colors",placeholder:"What's this memory about?"})]}),O.jsxs("div",{children:[O.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-secondary-text mb-1",children:"Tags"}),O.jsxs("div",{className:"flex gap-2 items-start",children:[O.jsxs("div",{className:"flex-grow",children:[O.jsx("input",{id:"tags",type:"text",value:h,onChange:M,onKeyDown:F,disabled:S,className:"block w-full bg-primary-bg border border-accent-soft/60 rounded-md shadow-sm focus:ring-accent focus:border-accent sm:text-sm p-2 text-primary-text placeholder-secondary-text/70 transition-colors",placeholder:"Add tags (e.g., vacation, family)"}),O.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:c.map(v=>O.jsxs("span",{className:"flex items-center bg-accent/20 text-accent text-xs font-medium px-2.5 py-1 rounded-full",children:[v,O.jsx("button",{onClick:()=>b(v),className:"ml-1.5 text-accent/70 hover:text-accent",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]},v))})]}),O.jsxs("button",{type:"button",onClick:I,disabled:!n||S||m,className:"px-3 py-2 text-sm font-medium text-white bg-accent/80 rounded-md hover:bg-accent-hover disabled:bg-secondary-bg disabled:text-secondary-text disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center h-9 shadow-md disabled:shadow-none shrink-0",children:[S?O.jsx(lf,{}):O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:O.jsx("path",{fillRule:"evenodd",d:"M9.628 2.034a1 1 0 011.228.665l.876 3.722 3.723.876a1 1 0 01.665 1.228l-2.43 5.67a1 1 0 01-1.22.665l-3.723-.876-3.722-.876a1 1 0 01-.665-1.228l2.43-5.67zM10 18a8 8 0 100-16 8 8 0 000 16z",clipRule:"evenodd"})}),S?"":"AI Tags"]})]})]}),k&&O.jsx("p",{className:"text-sm text-red-400 bg-red-900/40 p-2 rounded-md",children:k})]}),O.jsxs("div",{className:"mt-8 flex justify-end items-center space-x-4",children:[O.jsx("button",{type:"button",onClick:t,disabled:m,className:"px-4 py-2 text-sm font-medium text-secondary-text rounded-md hover:bg-accent-soft/20 disabled:opacity-50 transition-colors",children:"Cancel"}),O.jsx("button",{type:"button",onClick:A,disabled:m||!n||S,className:"px-6 py-2 text-sm font-medium text-white bg-accent rounded-md hover:bg-accent-hover disabled:bg-secondary-bg disabled:text-secondary-text disabled:cursor-not-allowed transition-all duration-300 flex items-center justify-center min-w-[100px] h-9 shadow-lg shadow-accent/30",children:m?O.jsx(lf,{}):"Upload"})]})]})})},HO=({photo:t,onClose:e})=>{const n=r=>{if(!r||!r.toDate)return"Just now";const i=r.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"numeric"}).format(i)};return O.jsx("div",{className:"fixed inset-0 bg-primary-bg/80 backdrop-blur-lg flex justify-center items-center z-50 p-4 animate-fade-in-up",style:{animationDuration:"0.3s"},onClick:e,children:O.jsxs("div",{className:"relative max-w-4xl max-h-[90vh] w-full flex flex-col items-center",onClick:r=>r.stopPropagation(),children:[O.jsx("button",{onClick:e,"aria-label":"Close lightbox",className:"absolute -top-10 -right-2 sm:top-0 sm:-right-12 p-2 bg-white/50 backdrop-blur-sm rounded-full text-primary-text hover:text-accent focus:outline-none transition-all duration-200 z-10",children:O.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:O.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),O.jsx("div",{className:"bg-white rounded-xl shadow-gentle-lg p-3",children:O.jsx("img",{src:t.imageUrl,alt:t.description||"Photo diary entry",className:"max-w-full max-h-[70vh] object-contain rounded-lg"})}),O.jsxs("div",{className:"text-center mt-4 w-full max-w-2xl px-4",children:[O.jsx("p",{className:"text-lg font-medium text-primary-text",children:t.description}),O.jsx("p",{className:"text-sm text-secondary-text mt-1",children:n(t.createdAt)})]})]})})},KO=()=>{const[t,e]=ge.useState([]),[n,r]=ge.useState(!0),[i,o]=ge.useState(null),s=ge.useCallback(async()=>{try{r(!0),o(null);const h=await bO();e(h)}catch(h){console.error("Detailed error fetching photos:",h),o("Failed to load photos. This could be due to network issues or incorrect Firebase permissions. Check the console for more details.")}finally{r(!1)}},[]);ge.useEffect(()=>{s()},[]);const u=ge.useCallback((h,p)=>{e(m=>m.map(_=>_.id===h?{..._,...p}:_))},[]),c=ge.useCallback(async h=>{const p=!h.isFavorite;u(h.id,{isFavorite:p});try{await OO(h.id,p)}catch(m){console.error("Error updating favorite status:",m),u(h.id,{isFavorite:h.isFavorite}),alert("Failed to update favorite status. Please try again.")}},[u]),d=ge.useCallback(async h=>{try{await qO(h),e(p=>p.filter(m=>m.id!==h.id))}catch(p){console.error("Error deleting photo:",p),alert("Failed to delete photo. Please check your Firebase rules and try again.")}},[]);return{photos:t,loading:n,error:i,refetchPhotos:s,removePhoto:d,toggleFavorite:c}},WO=t=>{if(!t||!t.toDate)return"";const e=t.toDate();return new Intl.DateTimeFormat("en-US",{month:"long",day:"numeric",year:"numeric"}).format(e)},JO=()=>{const[t,e]=ge.useState(!1),{photos:n,loading:r,error:i,refetchPhotos:o,removePhoto:s,toggleFavorite:u}=KO(),[c,d]=ge.useState(""),[h,p]=ge.useState(null),[m,_]=ge.useState(!1),S=ge.useCallback(()=>{o()},[o]),P=ge.useMemo(()=>{let k=n;if(m&&(k=k.filter(T=>T.isFavorite)),!c.trim())return k;const C=c.toLowerCase();return k.filter(T=>{var b;const I=T.description.toLowerCase().includes(C),M=WO(T.createdAt).toLowerCase().includes(C),F=(b=T.tags)==null?void 0:b.some(A=>A.toLowerCase().includes(C));return I||M||F})},[n,c,m]);return O.jsxs("div",{className:"min-h-screen",children:[O.jsx(vR,{onAddPhotoClick:()=>e(!0),searchTerm:c,onSearchChange:d,isGridEmpty:n.length===0&&!r,onToggleFavorites:()=>_(!m),showFavorites:m}),O.jsx("main",{className:"container mx-auto p-4 md:p-8",children:O.jsx(IR,{photos:P,loading:r,error:i,onDeletePhoto:s,onFavoritePhoto:u,onPhotoClick:p})}),t&&O.jsx(zO,{onClose:()=>e(!1),onUploadSuccess:S}),h&&O.jsx(HO,{photo:h,onClose:()=>p(null)})]})},hS=document.getElementById("root");if(!hS)throw new Error("Could not find root element to mount to");const QO=hd.createRoot(hS);QO.render(O.jsx(l0.StrictMode,{children:O.jsx(JO,{})}));
